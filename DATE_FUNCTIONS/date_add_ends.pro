

FUNCTION DATE_ADD_ENDS, DOY, Y

S = SORT(DOY)
DOYS = DOY(S)
YS = Y(S)

N = N_ELEMENTS(Y)

LEFT = WHERE(DOYS LE 100,COUNT_LEFT)
RIGHT=WHERE(DOYS  GE 265, COUNT_RIGHT)


XX = [DOYS(RIGHT),DOYS,DOYS(LEFT)]
YY = [YS(RIGHT)  , YS, YS(LEFT)]

PRINT, N,COUNT_LEFT,COUNT_RIGHT,N_ELEMENTS(YY)

NN = N_ELEMENTS(Y)/12
SM = SMOOTH(YY,NN,/EDGE_TRUNCATE)

LAST =  (COUNT_LEFT + N-1)
SM = SM(COUNT_LEFT:LAST)

XXX = XX(COUNT_RIGHT:LAST)
STOP






END