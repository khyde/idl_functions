; $ID:	MAPS_TEST.PRO,	2020-06-03-17,	USER-KJWH	$
;+
;#############################################################################################################
	PRO MAPS_TEST,STRUCT

;
; PURPOSE: MAKE AN TEST IMAGE OF A NEW MAP CALLED BY MAPS_MAKE 
;
; CATEGORY:	MAPS
;
; CALLING SEQUENCE: MAPS_TEST
;
; INPUTS: MAP [NAME]
;		
; KEYWORD PARAMETERS:
;		STRUCT  = A MAPS STRUCTURE INPUT TO THIS ROUTINE


; OUTPUTS: A PNG IS WRITTEN TO !S.IDL_TEMP
;		
; EXAMPLES: 
;  MAPS_TEST,MAPS_READ('NEC')
;  
;  
; MODIFICATION HISTORY:
;			WRITTEN MAR 29,2014 J.O'REILLY
;			MAR 30,2014, JOR REFINED AND TESTED
;			OCT 29, 2015 - KJWH: Changed INFO = MAPS_INFO(/QUIET) to INFO = MAPS_INFO(S.MAP) (MAPS_INFO requires a MAP input and QUIET is no longer a keyword)
;			
;#################################################################################
;-

  ROUTINE_NAME  = 'MAPS_TEST'
  
  SL = PATH_SEP()
  DIR_OUT = !S.IDL_DEMO + ROUTINE_NAME + SL & DIR_TEST, DIR_OUT
  
  PAL = 'PAL_LANDMASK'
  RGB_TABLE = RGBS(PAL = PAL)
  BACKGROUND_COLOR = RGBS(255)
  FONT_SIZE=8
  RES = 600
  DELAY = 2
 
; ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||

; ===> ENSURE STRUCT & MAP ARE PRESENT
  IF IDLTYPE(STRUCT) NE 'STRUCT' THEN MESSAGE,'ERROR:STRUCT IS REQUIRED'

  IF HAS(STRUCT,'MAP') THEN MP = STRUCT.MAP
  IF N_ELEMENTS(MP) NE 1 THEN MESSAGE,'ERROR: MAP IS REQUIRED'
  WINDOW_TITLE = CALLER(2)+ '-' + MP
  
  S = STRUCT
  PX = S.PX & PY = S.PY

  MAPS_SET, STRUCT=S
  MAP_CONTINENTS, /HIRES, /FILL, COLOR=253
  IM = TVRD()
  INFO = MAPS_INFO(MP)
  ZWIN
  
  I = IMAGE(IM,DIMENSIONS=[PX,PY],RGB_TABLE=RGB_TABLE,MARGIN=0.0,BACKGROUND_COLOR=BACKGROUND_COLOR,WINDOW_TITLE = WINDOW_TITLE) ; SETTING MARGIN=0 WILL MAXIMIZE THE IMAGE IN THE WINDOW
  PLT_STRUCT,I,STRUCT=S,INFO = INFO, X = 0.7,Y = 0.7,FONT_SIZE = FONT_SIZE ; DISPLAY THE MAP INFO ON THE MAP

  PNGFILE = DIR_OUT + MP  +  '.PNG'
  I.SAVE, PNGFILE, RESOLUTION=RES,BORDER = 0
  I.CLOSE
  PFILE,PNGFILE,/W

  INF =STRUPCASE(DIALOG_MESSAGE('A PNGFILE WAS MADE : '+PNGFILE, TITLE = 'A PNGFILE WAS MADE : '+PNGFILE,/DEFAULT_CANCEL,/INFORMATION))

  RETURN

END; #####################  END OF ROUTINE ################################
