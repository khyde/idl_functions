PRO JUNK_D3_PLOT

SL = PATH_SEP()
OVERWRITE = 1

YEAR = '2019'
YEAR0 = NUM2STR(YEAR-1)
YEAR1 = NUM2STR(YEAR+1)

SITES = ['GB_TMF', 'GOM_CEN','BROWNS_BANK','CHES BAY LIGHT','AMBROSE LIGHT','BOOTH BAY HARBOR','CAPE HATTERAS SBF','HUDSON CANYON']
LABELS = ['Georges Bank','Gulf of Maine','Browns Bank','Chesapeake Bay','New York Harbor','Booth Bay Harbor','Cape Hatteras','Hudson Canyon']
COLORS = INDGEN(N_ELEMENTS(SITES))*2+105;INDGEN(N_ELEMENTS(SITES))*FIX(N_TAGS(!COLOR)/N_ELEMENTS(SITES))+1

MFILE = !S.SPATIAL_ANIMATIONS + 'MAPPED_DATA_ANIMATIONS' + SL + 'BATHY_STATIONS.png'
IF ~FILE_TEST(MFILE) OR KEYWORD_SET(OVERWRITE) THEN BEGIN
  LL = LOCATE(SITES)
  MS = MAPS_SIZE('NEC',PX=PX,PY=PY)
  M = READ_BATHY('NEC',/NAME)
  IMG = READ_LANDMASK('NEC')
  PRODS_2PNG, M, PAL='PAL_OCEAN',/CURRENT, PROD='BATHY_1_1000', IMG_DIMS=[PX,PY],/ADD_CB, CB_SIZE=12, CB_TITLE = 'Depth (m)', OBJ=OBJ
  MAPS_SET,'NEC',PX=1024, PY=1024
  PXPY=MAP_DEG2IMAGE(IMG, LL.LON, LL.LAT,  X=X, Y=Y,AROUND=AROUND, SUBS=SUBS)
  ZWIN
  ;PLY = POLYGON([0,1,1,0,0],[0,0,1,1,0],FILL_COLOR='WHITE',FILL_TRANSPARENCY=80,/FILL_BACKGROUND,/CURRENT)
  FOR N=0, N_ELEMENTS(SITES)-1 DO PLT = SYMBOL(X(N),Y(N),/DEVICE,LABEL_STRING=LABELS(N),LABEL_COLOR=!COLOR.(COLORS(N)),LABEL_FONT_SIZE=12,SYMBOL='STAR',SYM_COLOR=!COLOR.(COLORS(N)),LINE_COLOR='WHITE',LINE_THICK=5,SYM_SIZE=2,/CURRENT,/SYM_FILLED)
  OBJ.SAVE, MFILE
  OBJ.CLOSE
ENDIF


PRODS = ['CHL','SST']
FOR I=0, N_ELEMENTS(PRODS)-1 DO BEGIN

  CASE PRODS(I) OF
    'CHL': BEGIN 
      D3_FILE = !S.OC + 'OCCCI/L3B4/D3/CHLOR_A-OCI/D3_'+YEAR0+'1201_'+YEAR1+'0131-OCCCI-V4_2-L3B4-PXY_1_23761676-CHLOR_A-OCI-INTERP.FLT'
      YRANGE = [0.0,6.0] 
      YTITLE=UNITS('CHLOROPHYLL')
    END  
    'SST': BEGIN
      D3_FILE = !S.SST + 'MUR/L3B2/D3/SST/D3_'+YEAR0+'1201_'+YEAR1+'0131-MUR-V04.1-L3B2-PXY_1_1827904-SST-DAT.FLT'
      YRANGE = [0.0,35.0] 
      YTITLE=UNITS('TEMPERATURE')
    END
  ENDCASE




  TFILE = !S.SPATIAL_ANIMATIONS + 'MAPPED_DATA_ANIMATIONS' + SL + YEAR + '-' + PRODS(I) + '-TIME_PLOT_STATIONS.png'
  IF ~FILE_TEST(TFILE) OR KEYWORD_SET(OVERWRITE) THEN BEGIN

    
    AX = DATE_AXIS([YEAR+'0101',YEAR+'1231'],/MONTH,/FYEAR)
    W = WINDOW(DIMENSIONS=[1200,400])
    P0 = PLOT(AX.JD,YRANGE,/NODATA,XTICKNAME=AX.TICKNAME,/CURRENT,TITLE=YEAR,YTITLE=YTITLE,FONT_SIZE=12,YRANGE=YRANGE,XRANGE=AX.JD,YMINOR=5,POSITION=[0.05,0.1,0.98,0.9])
    
    LX = 0.82
    LY = 0.85
    FOR N = 0,N_ELEMENTS(SITES) -1 DO BEGIN
      CLR = !COLOR.(COLORS(N))
      SITE = SITES(N)
      LL = LOCATE(SITE)
      LON = LL.LON
      LAT = LL.LAT
    
      D3 = D3_READ(D3_FILE, XP=XP, YP=YP, LON=LON, LAT=LAT, JDS=JDS, I_JDS=I_JDS)
      OK = WHERE(JDS GE AX.JD(0) AND JDS LE AX.JD(1),COUNT)
      P1 = PLOT(JDS(OK),D3(OK),COLOR=CLR,THICK=3,/OVERPLOT) ;, XTICKNAME=REPLICATE('',N_ELEMENTS(AX.TICKNAME)))
      SYM = SYMBOL(LX,LY-(N*.05),SYMBOL='HLINE',LABEL_STRING=LABELS(N),LABEL_COLOR=CLR, SYM_COLOR=CLR, SYM_SIZE=3, LABEL_FONT_SIZE=14)
    ENDFOR
    W.SAVE, TFILE
    W.CLOSE
  ENDIF  
ENDFOR  





STOP
END