; $ID:	PLT_SHP_BATS_DEMO.PRO,	2020-06-30-17,	USER-KJWH	$
;+
;#############################################################################################################
	PRO PLT_SHP_BATS_DEMO
;
; PURPOSE: MAKE A SHP FILE FOR BATS AND USE PLT_SHP TO PLOT IT
;
; CATEGORY:	PLT FAMILY
;
; CALLING SEQUENCE: PLT_SHP_BATS_DEMO
;
; INPUTS: NONE
;		
; OPTIONAL INPUTS:
;		NONE:	
;		
; KEYWORD PARAMETERS:
;		NONE
;
; MODIFICATION HISTORY:
;			JUN 4, 2014  WRITTEN BY J.O'REILLY 
;			NOV 22, 2017 - KJWH: Changed PLT_SHP to READ_SHPFILE
;			
;			
;			
;#################################################################################
;-
;**********************************
ROUTINE_NAME  = 'PLT_SHP_BATS_DEMO'
;**********************************

;===> DEFAULTS
;BATS -64.1000,31.6667
LON = -64.1000 & LAT = 31.6667 ;BATS
LON = [LON,-71.0] & LAT = [LAT,39.0] ;
SITES = ['BATS','CENTER']
SHP_FILE =!S.IDL_SHAPEFILES + 'MISC\BATS.SHP'
; CREATE THE NEW SHAPEFILE AND DEFINE THE ENTITY TYPE TO POINT

SHP = OBJ_NEW('IDLFFSHAPE',SHP_FILE, /UPDATE, ENTITY_TYPE=1)
; SET THE ATTRIBUTE DEFINITIONS FOR THE NEW SHAPEFILE
SHP->ADDATTRIBUTE, 'SITE', 7, 25, PRECISION=0
;SHP->ADDATTRIBUTE, 'OCEAN', 7, 25, PRECISION=0
; CREATE STRUCTURE FOR NEW ENTITY
ENTNEW = {IDL_SHAPE_ENTITY}
; DEFINE THE VALUES FOR THE NEW ENTITIES
FOR NTH = 0,N_ELEMENTS(LON)-1 DO BEGIN
  

ENTNEW.SHAPE_TYPE = 1
ENTNEW.BOUNDS[0] = LON[NTH]
ENTNEW.BOUNDS[1] = LAT[NTH]
ENTNEW.BOUNDS[2] = 0.00000000
ENTNEW.BOUNDS[3] = 0.00000000
ENTNEW.BOUNDS[4] = LON[NTH]
ENTNEW.BOUNDS[5] = LAT[NTH]
ENTNEW.BOUNDS[6] = 0.00000000
ENTNEW.BOUNDS[7] = 0.00000000
ENTNEW.N_VERTICES = 1 ; TAKE OUT OF EXAMPLE, NEED AS WORKAROUND
; CREATE STRUCTURE FOR NEW ATTRIBUTES
ATTRNEW = SHP->GETATTRIBUTES(/ATTRIBUTE_STRUCTURE)
; DEFINE THE VALUES FOR THE NEW ATTRIBUTES
ATTRNEW.ATTRIBUTE_0 = SITES[NTH]
; ADD THE NEW ENTITY TO NEW SHAPEFILE
SHP->PUTENTITY, ENTNEW
; NOTE THAT BECAUSE THIS IS A NEW SHAPEFILE, THE INDEX OF
; THE NEW ENTITY IS ZERO.
ENTITY_INDEX = NTH
; ADD THE COLORADO ATTRIBUTES TO NEW SHAPEFILE.
SHP->SETATTRIBUTES, ENTITY_INDEX, ATTRNEW
ENDFOR;FOR NTH = 0,N_ELEMENTS(LON)-1 DO BEGIN
;FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
;
; CLOSE THE SHAPEFILE
OBJ_DESTROY, SHP

PFILE,SHP_FILE
MAPS_SET,'EC'
COLOR = 11
MAP_CONTINENTS,/HIRES,/COASTS, COLOR = 0
READ_SHPFILE, SHP_FILE,COLOR=COLOR,FILL=FILL,THICK=7,VERBOSE=VERBOSE,$
                GET_RANGE=GET_RANGE,TAGNAME='SITE',VALUE='BATS',$
                RANGE_LON = RANGE_LON, RANGE_LAT = RANGE_LAT,NORMAL=NORMAL,$
                DO_ALL = 1, AUTO=AUTO,LONS=LONS,LATS=LATS,PSYM = 4,_EXTRA=_EXTRA
                
                
                
IMG = TVRD()
ZWIN
PAL_36,R,G,B
PNGFILE = !S.IDL_TEMP+ROUTINE_NAME + '.PNG'
WRITE_PNG,PNGFILE,IMG,R,G,B    & PF,PNGFILE            
OK = WHERE(IMG EQ COLOR,COUNT) & P,COUNT



END; #####################  END OF ROUTINE ################################
