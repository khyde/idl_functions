; $ID:	PLT_LME_CHL_TS.PRO,	2020-07-08-15,	USER-KJWH	$
;+
;#############################################################################################################
	PRO PLT_LME_CHL_TS

;
; PURPOSE: PLOTS MONTHLY CHLOR_A TIME-SERIES FOR ALL LMES
;
; CATEGORY:	PLT FAMILY
;
; CALLING SEQUENCE: PLT_LME_CHL_TS
;
; INPUTS: STRUCTURE
;		
; OPTIONAL INPUTS:
;		NONE:	
;		
; KEYWORD PARAMETERS:
;		

; OUTPUTS: APNG PAGE WITH THE CHL TIME SERIES FOR ALL LMES
;		
; EXAMPLES: 
;
; MODIFICATION HISTORY:
;			OCT 25,2014,  WRITTEN BY J.O'REILLY 
;		TITLE
;#################################################################################
;-
;******************************* 
ROUTINE_NAME  = 'PLT_LME_CHL_TS'
;*******************************
DIR = GET_SMI()
EXT = '.PNG'
BUFFER=0
;===> PLOT CHARACTERISTICS
AXES_FONT_SIZE =8
MARGIN = [0.2,0.2,0.2,0.35]
BACKGROUND_COLOR = 'WHITE_SMOKE'

;===> DATA LINE [LIN_COLOR VARIES WITH PROD]
LIN_THICK = 3
LIN_MID_THICK = 1
LIN_MID_COLOR = 'WHITE'

;===> PAGE
PAGE_POS = [0.5,0.94]

;===> REGRESSION
REG_ADD = 0
REG_THICK = 1
REG_MID_THICK = 1
REG_COLOR = 'BLACK'
REG_MID_COLOR= 'BLACK'

;===> LEGEND
LEG_ADD=0
LEG_POS=[0.18,0.84]
LEG_FILL_BACKGROUND = 1
LEG_BACKGROUND_COLOR = 'WHITE_SMOKE'

;===> SYMBOL
SYMBOL = 'HLINE'
SYM_SIZE = 2

SYM_THICK = 1
SYM_FILLED = 1
;SYM_FILL_COLOR 
;===> TYPE ?
TS = (GET_LME_MEAN(PROD = 'CHLOR_A',PER = 'Y',/ALL))
S = REVERSE(SORT(TS.MEAN))
TS = TS(S)
MAPS = TS.MAP
MAPS = MAPS(0:5)
ANNUAL_MEANS= TS.MEAN
SEQ = 0
W = WINDOW(BUFFER=BUFFER)
FILE= !S.IDL_TEMP + ROUTINE_NAME + EXT
;FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
FOR _MAP = 0,N_ELEMENTS(MAPS) -1 DO BEGIN
  
  LME = MAPS(_MAP)
  PF,LME,/M
  LME_TITLE = FIX_LME_NAMES(LME) 
  PROD = 'CHLOR_A'
  
  SEQ = SEQ + 1
  TS = GET_LME_TS(LME,PROD = PROD,PER = 'M') 
  DATA = TS.MEAN
  ;===> SCALE DATA
  BDATA = PRODS_2BYTE(PROD=PROD,DATA)
  ;===> MAKE XRANGE TO 2014 FOR COMPLETE AXIS LABELING  
  X = DATE_2DYEAR(PERIOD_2DATE(TS.PERIOD))
  XRANGE = [1998,2014]
  XTICKNAME = SUBSAMPLE(ROUNDS(INTERVAL(XRANGE)),2)
  TXT = REPLICATE('X',N_ELEMENTS(DATA))
  YY = REPLICATE(0.5,N_ELEMENTS(DATA))
  YRANGE = [0,1.0]
  IF _MAP EQ 0 THEN MARGIN = [0.1,0.2,0.1,0.35] ELSE MARGIN = [0.1,0.2,0.1,0.1]
  LAYOUT = [1,N_ELEMENTS(MAPS),SEQ]
P = PLOT(X,YY,COLOR = RGBS(BDATA),SYMBOL  = 'X')
STOP
    PLT_XY,X,YY,TXT,TXT_COLOR=BDATA,XRANGE = XRANGE,XTICKNAME=XTICKNAME, YRANGE=YRANGE,/YSTYLE,$
    AXES_FONT_SIZE=AXES_FONT_SIZE,TITLE=TITLE,$
    /LIN_ADD,LIN_COLOR = LIN_COLOR,LIN_THICK=LIN_THICK,$
    LIN_MID_COLOR = LIN_MID_COLOR,LIN_MID_THICK =LIN_MID_THICK,$
    REG_ADD=REG_ADD,REG_COLOR = REG_COLOR,REG_MID_COLOR= REG_MID_COLOR,REG_THICK=REG_THICK,REG_MID_THICK=REG_MID_THICK,$
    LEG_ADD=LEG_ADD,LEG_TXT=LEG_TXT,LEG_POS=LEG_POS,LEG_COLOR=LEG_COLOR,$
    LEG_FILL_COLOR=LEG_FILL_COLOR,LEG_FILL_BACKGROUND=LEG_FILL_BACKGROUND,$
    XTITLE = '',YTITLE = UNITS(FIRST(TS.PROD)),$
    /GRID_ADD,OBJ=OBJ,LAYOUT=LAYOUT,MARGIN=MARGIN,$
    BACKGROUND_COLOR=BACKGROUND_COLOR,/CURRENT
    ;===> IDENTIFY MIN MAX YEARS WITH ASTERISKS
    
;FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
;===> ADD THE LME PAGE_TITLE
;T = TEXT(PAGE_POS[0],PAGE_POS[1],PAGE_TITLE,ALIGN = 0.5,/CURRENT,FONT_SIZE = 21)
W.SAVE, FILE & PF,FILE
 
ENDFOR;FOR _MAP = 0,N_ELEMENTS(MAPS) -1 DO BEGIN
;FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
END; #####################  END OF ROUTINE ################################
