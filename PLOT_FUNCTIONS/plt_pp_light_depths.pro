; $ID:	PLT_PP_LIGHT_DEPTHS.PRO,	2020-07-08-15,	USER-KJWH	$
; #########################################################################; COEFFS
PRO PLT_PP_LIGHT_DEPTHS,MA,MB,MC,MD,ME,MF,MG,O_A,O_B,O_C,O_D,O_E,O_F,O_G,DEG=DEG,DIR_OUT=DIR_OUT,PAGE_TITLE=PAGE_TITLE,COEFFS=COEFFS 
;+
; PURPOSE:  PLOT THE PP FOR 7 LIGHT-DEPTHS FROM OPAL VERSUS MARMAP
;
; CATEGORY: 
;
;
; INPUTS:
;       MA ......... MARMAP PP AT 100% 
;       MB ......... MARMAP PP AT 69% 
;       MC ......... MARMAP PP AT 46% 
;       MD ......... MARMAP PP AT 25% 
;       ME ......... MARMAP PP AT 10% 
;       MF ......... MARMAP PP AT 3% 
;       MG ......... MARMAP PP AT 1% 
;       
;       O_A ......... OPAL PP AT 100% 
;       O_B ......... OPAL PP AT 69% 
;       O_C ......... OPAL PP AT 46% 
;       O_D ......... OPAL PP AT 25% 
;       O_E ......... OPAL PP AT 10% 
;       O_F ......... OPAL PP AT 3% 
;       O_G ......... OPAL PP AT 1%       
; KEYWORDS:  
;       DIR_OUT .........  DIR FOR THE OUTPUT PS PLOT SHOWING REGRESSIONS FOR MARMAP VS OPAL AT EACH LIGHT-DEPTH
; EXAMPLES: 
;         
;
; MODIFICATION HISTORY:
;     OCT 02, 2018  WRITTEN BY: J.E. O'REILLY  
;     SEP 07, 2019  CONFIRMED THAT THE PLOTTED SLOPES AND INTERCEPTS AGREE WITH THOSE IN PP_OPAL_OPTIMISE.CSV

; #########################################################################
;-
;*****************************
ROUTINE = 'PLT_PP_LIGHT_DEPTHS'
;*****************************
;===> DEFAULTS:
IF NONE(DIR_OUT) THEN DIR_OUT = !S.IDL_TEMP
W = WINDOW(/NO_TOOLBAR,DIMENSIONS = [3000,3000])
POS = GET_POS(COLS=3,ROWS=3,MARGIN  = [0.05,0.05,0.0,0.06])
XLOG = 1
YLOG = 1
XRANGE = [0.1,1000]
YRANGE = XRANGE
XTITLE = 'MARMAP ' +  UNITS('PP_MGCM3D')
YTITLE = 'OPAL ' +  UNITS('PP_MGCM3D')
COLORS = ['CHARTREUSE','DODGER_BLUE','GREEN','BLUE','INDIGO','PURPLE','RED']

;STOP
TITLE = '100%'
S = STATS2(ALOG10(MA),ALOG10(O_A),MODEL = 'RMA')
RESID_LD = DOUBLE( (1.0-ABS( .999999> S.SLOPE <1.000001)) + ABS(-0.000001 > S.INT < 0.000001)  + (1.0-ABS(S.RSQ)))

; D =CREATE_STRUCT('PCT_LIGHT',TITLE,'N',S.N,'INT',S.INT,'SLOPE',S.SLOPE,'RSQ',S.RSQ,'COEFFS',STRJOIN(COEFFS,';'),'RESID_LD',RESID_LD)
;IF NONE(DB) THEN DB = D ELSE DB = [DB,D]
PLT_XY,MA,O_A,XLOG=XLOG,YLOG = YLOG,/JAY,$
  TITLE =TITLE,XTITLE = XTITLE,YTITLE = YTITLE,XRANGE=XRANGE,YRANGE=YRANGE,POSITION = POS[0].POS,/CURRENT
;
TITLE = '69%'
S = STATS2(ALOG10(MA),ALOG10(O_A),MODEL = 'RMA')
RESID_LD =DOUBLE( (1.0-ABS( .999999> S.SLOPE <1.000001)) + ABS(-0.000001 > S.INT < 0.000001)  + (1.0-ABS(S.RSQ)))

;D = CREATE_STRUCT('PCT_LIGHT',TITLE,'N',S.N,'INT',S.INT,'SLOPE',S.SLOPE,'RSQ',S.RSQ,'COEFFS',STRJOIN(COEFFS,';'),'RESID_LD',RESID_LD)
;IF NONE(DB) THEN DB = D ELSE DB = [DB,D]
PLT_XY,MB,O_B,XLOG=XLOG,YLOG = YLOG,/JAY,$
  TITLE =TITLE,XTITLE = XTITLE,YTITLE = YTITLE,XRANGE=XRANGE,YRANGE=YRANGE,POSITION = POS[1].POS,/CURRENT

TITLE = '46%';
S = STATS2(ALOG10(MA),ALOG10(O_A),MODEL = 'RMA')
RESID_LD = DOUBLE( (1.0-ABS( .999999> S.SLOPE <1.000001)) + ABS(-0.000001 > S.INT < 0.000001)  + (1.0-ABS(S.RSQ)))

;D = CREATE_STRUCT('PCT_LIGHT',TITLE,'N',S.N,'INT',S.INT,'SLOPE',S.SLOPE,'RSQ',S.RSQ,'COEFFS',STRJOIN(COEFFS,';'),'RESID_LD',RESID_LD)
;IF NONE(DB) THEN DB = D ELSE DB = [DB,D]
PLT_XY,MC,O_C,XLOG=XLOG,YLOG = YLOG,/JAY,$
  TITLE =TITLE,XTITLE = XTITLE,YTITLE = YTITLE,XRANGE=XRANGE,YRANGE=YRANGE,POSITION = POS(2).POS,/CURRENT
;
TITLE = '25%'
S = STATS2(ALOG10(MA),ALOG10(O_A),MODEL = 'RMA')
RESID_LD = DOUBLE( (1.0-ABS( .999999> S.SLOPE <1.000001)) + ABS(-0.000001 > S.INT < 0.000001)  + (1.0-ABS(S.RSQ)))
;D = CREATE_STRUCT('PCT_LIGHT',TITLE,'N',S.N,'INT',S.INT,'SLOPE',S.SLOPE,'RSQ',S.RSQ,'COEFFS',STRJOIN(COEFFS,';'),'RESID_LD',RESID_LD)
;IF NONE(DB) THEN DB = D ELSE DB = [DB,D]
PLT_XY,MD,O_D,XLOG=XLOG,YLOG = YLOG,/JAY,$
  TITLE =TITLE,XTITLE = XTITLE,YTITLE = YTITLE,XRANGE=XRANGE,YRANGE=YRANGE,POSITION = POS(3).POS,/CURRENT
;
TITLE = '10%'
S = STATS2(ALOG10(MA),ALOG10(O_A),MODEL = 'RMA')
RESID_LD = DOUBLE( (1.0-ABS( .999999> S.SLOPE <1.000001)) + ABS(-0.000001 > S.INT < 0.000001)  + (1.0-ABS(S.RSQ)))
;D = CREATE_STRUCT('PCT_LIGHT',TITLE,'N',S.N,'INT',S.INT,'SLOPE',S.SLOPE,'RSQ',S.RSQ,'COEFFS',STRJOIN(COEFFS,';'),'RESID_LD',RESID_LD)
;IF NONE(DB) THEN DB = D ELSE DB = [DB,D]

PLT_XY,ME,O_E,XLOG=XLOG,YLOG = YLOG,/JAY,$
  TITLE =TITLE,XTITLE = XTITLE,YTITLE = YTITLE,XRANGE=XRANGE,YRANGE=YRANGE,POSITION = POS(4).POS,/CURRENT
;
TITLE = '3%'
S = STATS2(ALOG10(MA),ALOG10(O_A),MODEL = 'RMA')
RESID_LD = DOUBLE( (1.0-ABS( .999999> S.SLOPE <1.000001)) + ABS(-0.000001 > S.INT < 0.000001)  + (1.0-ABS(S.RSQ)))

;D = CREATE_STRUCT('PCT_LIGHT',TITLE,'N',S.N,'INT',S.INT,'SLOPE',S.SLOPE,'RSQ',S.RSQ,'COEFFS',STRJOIN(COEFFS,';'),'RESID_LD',RESID_LD)
;IF NONE(DB) THEN DB = D ELSE DB = [DB,D]
PLT_XY,MF,O_F,XLOG=XLOG,YLOG = YLOG,/JAY,$
  TITLE =TITLE,XTITLE = XTITLE,YTITLE = YTITLE,XRANGE=XRANGE,YRANGE=YRANGE,POSITION = POS(5).POS,/CURRENT
;
TITLE = '1%'
S = STATS2(ALOG10(MA),ALOG10(O_A),MODEL = 'RMA')
RESID_LD = DOUBLE( (1.0-ABS( .999999> S.SLOPE <1.000001)) + ABS(-0.000001 > S.INT < 0.000001)  + (1.0-ABS(S.RSQ)))
;D = CREATE_STRUCT('PCT_LIGHT',TITLE,'N',S.N,'INT',S.INT,'SLOPE',S.SLOPE,'RSQ',S.RSQ,'COEFFS',STRJOIN(COEFFS,';'),'RESID_LD',RESID_LD)
;IF NONE(DB) THEN DB = D ELSE DB = [DB,D]
PLT_XY,MG,O_G,XLOG=XLOG,YLOG = YLOG,/JAY,$
  TITLE =TITLE,XTITLE = XTITLE,YTITLE = YTITLE,XRANGE=XRANGE,YRANGE=YRANGE,POSITION = POS(6).POS,/CURRENT
  
;===> ADD TXT INFO TO TOP OF PAGE
PLT_TITLE,W,TXT=PAGE_TITLE
 
TXT = DATE_NOW() +'      '+ !S.USER
 PLT_CAPTION,OBJ=W,TXT=TXT;,WPL=WPL,XPOS=XPOS,YPOS = YPOS,FONT_SIZE =FONT_SIZE
 FILE = DIR_OUT + 'PLT_PP_LIGHT_DEPTHS-'+ PAGE_TITLE + '.PNG'

W.SAVE,FILE
W.CLOSE
PFILE,FILE 
;;===> SAVE THE DB AS A CSV
;CSV =  DIR_OUT +   'PLT_PP_LIGHT_DEPTHS' + '.CSV'  
;APPEND = EXISTS(CSV)
;CSV_WRITE,CSV,DB,APPEND=APPEND



END; #####################  END OF ROUTINE ################################
