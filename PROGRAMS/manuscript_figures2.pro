; $ID:	MANUSCRIPT_FIGURES2.PRO,	2020-07-08-15,	USER-KJWH	$

 PRO MANUSCRIPT_FIGURES2
;+
; NAME:
;       DISSERTATION_FIGURES_Ch3
;
; PURPOSE:
;				To create the final figures for Kim Hyde's second dissertation manuscript
;
;	NOTES:
;				Most procedures are copied from other programs
;
; MODIFICATION HISTORY:
;       Written by:  Kim Hyde
;

ROUTINE_NAME='MANUSCRIPT_FIGURES2'

TIMER

;	===> Load simple color palette
 	PAL_36,r,g,b

; **************************************************
; ***** SWITCHES CONTROLLING PROCESSING STEPS  *****
; **************************************************
;		Switch	Operation
;		0  			Do not do Step
;		1				Do Step (unless output from this step already exists, then skip this step)
; 	2     	Do Step (make output file from step and overwrite output if it already exists)

		DO_FIGURE_1           = 0
		DO_VGPM_FINAL					= 2
		DO_SEA_COMP						= 0
		DO_ANNUAL_IMAGE				= 0
		DO_COLORBAR						= 0


;	*** Define names of input and output files so that they are available to various steps

	DATA_N04_N18						= 'D:\PROJECTS\MASS_BAY\DATA\MWRA_DATA\MWRA_DATA_N04_N18.SAVE'
	PROD_DATA								= 'D:\PROJECTS\MASS_BAY\DATA\MWRA_Data\PROD_INSITU_DATA.SAVE'
	SAT_DATA								= 'D:\PROJECTS\MASS_BAY\DATA\MWRA_Data\PROD_SAT_DATA.SAVE'
	CHL_EXTRACT							= 'F:\SEAWIFS_MLAC-MASS_BAY\TS_SUBAREAS\save\!S-LATLON_SUBAREA-MASS_BAY-SITES-PXY_160_160-REPRO5-CHLOR_A.CSV'
	COR_EXTRACT							= 'F:\SEAWIFS_MLAC-MASS_BAY\TS_SUBAREAS\save\!S-LATLON_SUBAREA-MASS_BAY-SITES-PXY_160_160-REPRO5-CHLOR_A_MB.CSV'
	PPD_EXTRACT							= 'F:\SEAWIFS_MLAC-MASS_BAY\TS_SUBAREAS\save\!D-LATLON_SUBAREA-MASS_BAY-N04_N18-PXY_160_160-REPRO5-PPD-VGMB.CSV'
	SUBAREA_EXTRACT					= 'F:\SEAWIFS_MLAC-MASS_BAY\TS_SUBAREAS\save\!D-MASK_SUBAREA-MASS_BAY-PXY_160_160-MB_CCB_HYDE-REPRO5-PPD-VGMB.SAVE'

	VGPM_DATA								= 'D:\PROJECTS\MASS_BAY\DATA\MWRA_Data\PROD_SAT_VGPM_DATA.SAVE'
	SURF_DATA								= 'D:\PROJECTS\MASS_BAY\DATA\MWRA_Data\CHL_INSITU_DATA.SAVE'
	VGPM_N04_N18						= 'D:/IDL/SEAWIFS/MASS_BAY_OUTPUT/STATION_EXTRACT_VGPM_N04_N18.SAVE'
	PHYTO_FILE							= 'D:\PROJECTS\MASS_BAY\DATA\MWRA_Data\PHYTOPLANKTON_DATA.SAVE'

	INSITU_DATA							= 'D:\PROJECTS\MASS_BAY\DATA\MWRA_Data\CHL_INSITU_DATA.SAVE'
	SAT_SHIP_CHL						= 'D:\PROJECTS\MASS_BAY\DATA\MWRA_Data\CHL_SAT_SHIP_DATA.SAVE'
	SAT_SHIP_CHL2						= 'D:\PROJECTS\MASS_BAY\DATA\MWRA_Data\CHL_SAT_SHIP_DATA2.SAVE'

	BATHY_FILE							= 'D:\IDL\IMAGES\SRTM30-MASS_BAY-PXY_640_640-BATHY-SMOOTH_3.SAVE'
	OUTLINE_FILE            = 'D:\IDL\IMAGES\MASK_SUBAREA-MASS_BAY_PXY_160_160-MB_CCB-OUTLINE.PNG'

	VGPM_FINAL							= 'D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT2\VGPM_FINAL.PS'
	VGPM_FINAL2							= 'D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT2\VGPM_FINAL2.PS'
	FIGURE_1                = 'D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT2\FIGURE_1.PNG'
	FIGURE_1_PS             = 'D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT2\FIGURE_1.PS'

	SEA_COMP								= 'D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT2\SEAWIFS_VGPM_MB_MONTHLY_COMPOSITE.PNG'
	COLORBARS								= 'D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT2\COLORBARS.PS'
	COLORBARS2							= 'D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT2\COLORBARS2.PS'
	COMPOSITES							= 'D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT2\SEAWIFS_COMPOSITES'


; *******************************************************
	IF DO_FIGURE_1 GE 1 THEN BEGIN
; *******************************************************
		OVERWRITE = DO_FIGURE_1 GE 2
		EXIST = FILE_TEST(FIGURE_1)
		IF EXIST AND OVERWRITE EQ 0 THEN GOTO, SKIP_FIGURE_1 ; >>>>>>>>>>>>>>>>>>>>>>>>>

		PAL_GRAY, R,G,B
		BATHY = READALL(BATHY_FILE)
		IMAGE = BATHY.BATHY.IMAGE(0:450,0:539) & BIMAGE = IMAGE
		OK = WHERE(IMAGE LE 1, COUNT) & IF COUNT GE 1 THEN BIMAGE[OK] = 80
		OK = WHERE(IMAGE GT 0 AND IMAGE LT 20, COUNT) & IF COUNT GE 1 THEN BIMAGE[OK] = 230
		OK = WHERE(IMAGE GE 20 AND IMAGE LT 40, COUNT) & IF COUNT GE 1 THEN BIMAGE[OK] = 200
		OK = WHERE(IMAGE GE 40 AND IMAGE LT 60, COUNT) & IF COUNT GE 1 THEN BIMAGE[OK] = 170
		OK = WHERE(IMAGE GE 60 AND IMAGE LT 100, COUNT) & IF COUNT GE 1 THEN BIMAGE[OK] = 130
		OK = WHERE(IMAGE GE 100 AND IMAGE LT 200, COUNT) & IF COUNT GE 1 THEN BIMAGE[OK] = 100
		OK = WHERE(IMAGE GE 200, COUNT) & IF COUNT GE 1 THEN BIMAGE[OK] = 220
		;BATHY_SCALE = BYTSCL(BATHY.BATHY.IMAGE(0:450,0:539),MIN=0,MAX=300, TOP=245)
		SLIDEW, BIMAGE
		WRITE_PNG, FIGURE_1, BIMAGE, R,G,B

		PAL = 'PAL_GRAY'
		PNGFILE = 'D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT2\figure1_edit.png'
		PSFILE = 'D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT2\figure1_edit.PS'
		IMAGE = READ_PNG(PNGFILE,r,g,b)
		SZ=SIZE(IMAGE,/STRUCT)
		TRUE_COLOR  = SZ.N_DIMENSIONS EQ 3
  	PX_IMAGE = 1.0*SZ.DIMENSIONS(0+TRUE_COLOR)
  	PY_IMAGE = 1.0*SZ.DIMENSIONS(1+TRUE_COLOR)
   	xsize = DOUBLE(2.54*(PX_IMAGE/300.))
   	ysize = DOUBLE(2.54*(PY_IMAGE/300.))
   	width = 20.5
   	height = 26.9
		xoffset = 2
    yoffset  = 5
    SCALE = 1.05
    olddevice= !d.name  ; Get present graphics device
    SET_PLOT,'ps'
    DEVICE,FILENAME=psfile
		DEVICE, /PORTRAIT
		DEVICE,/COLOR
 		CALL_PROCEDURE,PAL,R,G,B
 		TVLCT,R,G,B
 		COLOR=1
		DEVICE,BITS_PER_PIXEL=8
    DEVICE, XOFFSET=xoffset, YOFFSET=yoffset, $
    XSIZE=xsize, YSIZE=ysize, $
    SCALE_FACTOR=scale
    TV,IMAGE, TRUE=TRUE_COLOR
    DEVICE,/CLOSE
    SET_PLOT,olddevice


		STOP

		SKIP_FIGURE_1:
	ENDIF

; *******************************************************
	IF DO_VGPM_FINAL GE 1 THEN BEGIN
; *******************************************************
		OVERWRITE = DO_VGPM_FINAL GE 2
		EXIST = FILE_TEST(VGPM_FINAL)
		IF EXIST AND OVERWRITE EQ 0 THEN GOTO, SKIP_VGPM_FINAL ; >>>>>>>>>>>>>>>>>>>>>>>>>

		SAT  = IDL_RESTORE(SAT_SHIP_CHL) & OK = WHERE(SAT.YEAR  GE 1998 AND SAT.YEAR LE 2005) & SAT  = SAT[OK]
		SHIP = IDL_RESTORE(INSITU_DATA)	 & OK = WHERE(SHIP.YEAR GE 1998 AND SHIP.YEAR LE 2005 AND SHIP.LOCATION NE 'HARBOR' AND SHIP.LOCATION NE 'MOUTH' ) & SHIP = SHIP[OK]
		SUBAREA = READALL(SUBAREA_EXTRACT)
		PPD_EXT = READALL(PPD_EXTRACT)

		OK = WHERE(SHIP.WC_TEMP EQ 0.0,COUNT) & IF COUNT GE 1 THEN SHIP[OK].WC_TEMP = MISSINGS(0.0)
		OK = WHERE(SHIP.WC_PBMAX GT 25, COUNT) & IF COUNT GE 1 THEN SHIP[OK].WC_PBMAX = MISSINGS(0.0)

;		OK = WHERE(SHIP.YEAR GT '1999') & SHIP = SHIP[OK]
;	  OK = WHERE(SHIP.YEAR EQ '2003' AND (SHIP.MONTH EQ '02' OR SHIP.MONTH EQ '03'),COMPLEMENT=COMPLEMENT) & SHIP = SHIP(COMPLEMENT)

		CIRCLE,32, COLOR=32
		PSYM = 8

;		C = IDL_RESTORE(PROD_DATA)
;		OK = WHERE(STRMID(C.GMT_DATE,0,4) GE '1998' AND STRMID(C.GMT_DATE,0,4) LE '2003')
;		C = C[OK]
;		NEW = C
;		SAT = IDL_RESTORE(VGPM_DATA)
;		OK = WHERE(STRMID(SAT.GMT_DATE,0,4) GE '1998' AND STRMID(SAT.GMT_DATE,0,4) LE '2003')
;		SAT = SAT[OK]
;		S		= IDL_RESTORE(VGPM_N04_N18)
;		OK = WHERE(STRMID(S.DATE,0,4) GE '1998' AND STRMID(S.DATE,0,4) LE '2003') & S = S[OK]
;		S		= S[SORT(S.DATE)]
;		DS = IDL_RESTORE(SURF_DATA)
;		OK = WHERE(DS.STATION EQ 'N04' OR DS.STATION EQ 'N18')
;		DD = DS[OK]

		PSPRINT,FILENAME=VGPM_FINAL,/COLOR,/Full,/TIMES
		!P.MULTI=[0,1,2]

;		OK = WHERE(SHIP.WC_PBMAX NE MISSINGS(0.0) AND SHIP.WC_TEMP NE MISSINGS(0.0) AND SHIP.WC_TEMP GT 0.0 AND SHIP.WT_CHL NE MISSINGS(0.0) AND SHIP.PER_PHAEOCYSTIS EQ 0)
;		SET = SHIP[OK]
;		TT = FINDGEN(13)*2
;		COLORS = [5,22]
;		_CHL = [0.1,0.75,64]
;		TXT = ['0.1','0.75','32']
;		PNEW = CREATE_STRUCT('TEMP_LOW',0.0,'TEMP_HIGH',0.0,'CHL_LOW',0.0,'CHL_HIGH',0.0,'MED_CHL',0.0,'N',0.0,'MEAN',0.0,'MIN',0.0,'MAX',0.0,'STD',0.0,'MED',0.0, 'CV',0.0)
;		PNEW = STRUCT_2MISSINGS(PNEW) & PNEW = REPLICATE(PNEW,N_ELEMENTS(TT)*N_ELEMENTS(_CHL))
;
;		COUNTER = 0
;		FOR NTH = 0L, N_ELEMENTS(TT)-2 DO BEGIN
;			_TEMP_LOW = TT[NTH]
;			_TEMP_HIGH = TT(NTH+1)
;			FOR STH = 0L, N_ELEMENTS(_CHL)-2 DO BEGIN
;				CHL_LOW = _CHL(STH)
;				CHL_HG  = _CHL(STH+1)
;				PNEW(COUNTER).TEMP_LOW = _TEMP_LOW
;				PNEW(COUNTER).TEMP_HIGH = _TEMP_HIGH
;				PNEW(COUNTER).CHL_LOW = CHL_LOW
;				PNEW(COUNTER).CHL_HIGH = CHL_HG
;				OK = WHERE(SET.WC_TEMP GE _TEMP_LOW AND SET.WC_TEMP LT _TEMP_HIGH AND SET.WT_CHL GE CHL_LOW AND SET.WT_CHL LT CHL_HG ,COUNT)
;				IF COUNT GE 1 THEN BEGIN
;					STAT_CHL = STATS(ALOG(SET[OK].WT_CHL))
;					PNEW(COUNTER).MED_CHL = EXP(STAT_CHL.MED)
;					_PB = SET[OK].WC_PBMAX
;					STAT = STATS(_PB,/quiet)
;					STA = STAT.MEAN + (2*STAT.STD)
;					STB = STAT.MEAN - (2*STAT.STD)
;					OK = WHERE(_PB GT STB AND _PB LT STA,COUNT)
;					IF COUNT GE 1 THEN BEGIN
;						STAT2 = STATS(_PB[OK],/QUIET)
;						PNEW(COUNTER).N			= STAT2.N
;						PNEW(COUNTER).MEAN	=	STAT2.MEAN
;						PNEW(COUNTER).MIN		=	STAT2.MIN
;						PNEW(COUNTER).MAX		=	STAT2.MAX
;						PNEW(COUNTER).STD		=	STAT2.STD
;						PNEW(COUNTER).MED		=	STAT2.MED
;						PNEW(COUNTER).CV		=	STAT2.CV
;					ENDIF
;				ENDIF	ELSE PNEW(COUNTER).N = 0
;				COUNTER = COUNTER + 1
;			ENDFOR
;		ENDFOR
;
;		!P.MULTI = [0,1,3]
;		POLY_FIT_NUM = 2
;		COEFFS_STRUCT = CREATE_STRUCT('CHL_LOW',0.0,'CHL_HIGH',0.0,'CHL_MED',0.0,'N',0L,'PB_MED',0.0,'A_COEFF',0.0,'B_COEFF',0.0,'C_COEFF',0.0)
;		COEFFS_STRUCT = REPLICATE(COEFFS_STRUCT,N_ELEMENTS(_CHL)-1)
;		COEFFS_STRUCT = STRUCT_2MISSINGS(COEFFS_STRUCT)
;		_TT = TT+1
;		FOR STH = 0L, N_ELEMENTS(_CHL)-2 DO BEGIN
;			OK = WHERE(PNEW.CHL_LOW EQ _CHL(STH) AND PNEW.MED NE MISSINGS(0.0) AND PNEW.N GE 2,COUNT)
;			COEFFS_STRUCT(STH).CHL_LOW 	= _CHL(STH)
;			COEFFS_STRUCT(STH).CHL_HIGH = _CHL(STH+1)
;			COEFFS_STRUCT(STH).N = TOTAL(PNEW[OK].N)
;			IF COUNT GE 2 THEN BEGIN
;				PLOT, [0,20], PNEW.MED,TITLE=' ', CHARSIZE=2,/NODATA, XRANGE=[0,20], YRANGE=[0,10], XTITLE='Temperature (!Eo!NC)',$
;					YTITLE='Median P!Eb!Dmax!N (mgC mgChl!e-1!N h!E-1!N)', XMARGIN=XMARGIN, YMARGIN=YMARGIN
;				STAT_CHL = STATS(ALOG(PNEW[OK].MED_CHL))
;				MED_CHL = EXP(STAT_CHL.MED)
;				COEFFS_STRUCT(STH).CHL_MED = MED_CHL
;				COEFFS_STRUCT(STH).PB_MED = MED(PNEW[OK].MED)
;				OPLOT, PNEW[OK].TEMP_LOW+1, PNEW[OK].MED, PSYM=2, COLOR=COLORS(STH), SYMSIZE=SYMSIZE, THICK = THICK
;				ERRPLOT, PNEW[OK].TEMP_LOW+1, PNEW[OK].MED-PNEW[OK].STD, PNEW[OK].MED+PNEW[OK].STD, width=0.02, COLOR=COLORS(STH), THICK=5
;				_PB   = (0.071*_TT -3.2e-3*_TT^2 + 3.0E-5*_TT^3)/MED_CHL + (1.0 + 0.17*_TT - 2.5e-3*_TT^2 - 8.0e-5*_TT^3)
;				OPLOT, _TT, _PB, COLOR=0, THICK = 12
;				COEFFS = POLY_FIT(PNEW[OK].TEMP_LOW+1, PNEW[OK].MED,POLY_FIT_NUM,YFIT=YFIT, CHISQ=CHISQ,COVAR=COVAR, /DOUBLE,MEASURE_ERRORS=MEASURE_ERRORS,SIGMA=SIGMA,STATUS=STATUS,YBAND=YBAND,YERROR=YERROR)
;				PRINT, COEFFS
;				COEFFS_STRUCT(STH).A_COEFF = COEFFLS[0]
;				COEFFS_STRUCT(STH).B_COEFF = COEFFLS[1]
;				COEFFS_STRUCT(STH).C_COEFF = COEFFLS(2)
;				MB_PBMAX = COEFFLS[0] + COEFFLS[1]*PNEW[OK].TEMP_LOW+1 + COEFFLS(2)*PNEW[OK].TEMP_LOW+1^2
;				OPLOT, PNEW[OK].TEMP_LOW+1, YFIT, COLOR=COLORS(STH), THICK=15
;;				OPLOT, PNEW[OK].TEMP, REPLICATE(MED(PNEW[OK].MED),N_ELEMENTS(OK)), COLOR=0, THICK=5, LINESTYLE=3
;				YFIT_STATS = STATS2(PNEW[OK].MED, YFIT, MODEL='RMA')
;				_TXT = ' N = ' + NUM2STR(ROUND(TOTAL(COEFFS_STRUCT(STH).N))) + '!C R!E2!N = ' + STRMID(NUM2STR(YFIT_STATS.RSQ),0,5) + $
;							'!C Chl: ' + TXT(STH) + ' - ' + TXT(STH+1) + '!C (Mean Chl = ' + STRMID(NUM2STR(MED_CHL),0,4) + ')'
;				COOR = COORD_2PLOT(0.02,0.9)
;				XYOUTS, COOR.X,COOR.Y,_TXT,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=FIGSIZE
;				IF POLY_FIT_NUM EQ 2 THEN _TXT = 'YFIT = ' + STRMID(NUM2STR(COEFFLS[0]),0,5) + ' + ' +  STRMID(NUM2STR(COEFFLS[1]),0,5) + 'x ' + ' + ' $
;							 + STRMID(NUM2STR(COEFFLS(2)),0,7) + 'x!E2!N '
;				IF POLY_FIT_NUM EQ 3 THEN _TXT = 'YFIT = ' + STRMID(NUM2STR(COEFFLS[0]),0,5) + ' + ' +  STRMID(NUM2STR(COEFFLS[1]),0,5) + 'x ' + ' + ' $
;							 + STRMID(NUM2STR(COEFFLS(2)),0,7) + 'x!E2!N ' + STRMID(NUM2STR(COEFFLS(3)),0,5) + 'x!E3!N '
;				COOR = COORD_2PLOT(0.2,0.05)
;				XYOUTS, COOR.X,COOR.Y,_TXT,/DATA,ALIGN=0.0,CHARSIZE=FIGSIZE, COLOR=COLORS(STH)
;			ENDIF
;		ENDFOR
;
;		TT = FINDGEN(26)
;		YFIT1 = COEFFS_STRUCT[0].A_COEFF + (COEFFS_STRUCT[0].B_COEFF * TT) + (COEFFS_STRUCT[0].C_COEFF*TT^2)
;		YFIT2 = COEFFS_STRUCT[1].A_COEFF + (COEFFS_STRUCT[1].B_COEFF * TT) + (COEFFS_STRUCT[1].C_COEFF*TT^2)
;		OPLOT, TT, YFIT1, COLOR=5, THICK=5
;		OPLOT, TT, YFIT2, COLOR=22, THICK=5
;
;		TT =  FINDGEN(20)+2
;		CC = [0.75,0.80,0.85,0.90,0.95,1.00,1.05,1.10,1.15,1.20,1.25,1.30,1.35,1.40,1.45,1.50,1.55,1.60,1.65,1.70,1.75,1.80,1.85,1.90,1.95,2.00]
;		COLORS = FINDGEN(26)+1
;		CBLEND = FINDGEN(12600)/10000+0.75
;		PBMODEL2 = COEFFS_STRUCT[0].A_COEFF + (COEFFS_STRUCT[0].B_COEFF * TT) + (COEFFS_STRUCT[0].C_COEFF*TT^2)
;		PBMODMED = REPLICATE(COEFFS_STRUCT[1].PB_MED,N_ELEMENTS(TT))
;		PBBLEND = BLEND(CBLEND)
;		PLOT, [0,20], [0,10],TITLE=' ', CHARSIZE=2,/NODATA, XRANGE=[0,20], YRANGE=[0,6], XTITLE='Temperature (!Eo!NC)',$
;			YTITLE='Median P!Eb!Dmax!N (mgC mgChl!e-1!N h!E-1!N)', XMARGIN=XMARGIN, YMARGIN=YMARGIN
;		OPLOT, TT, PBMODEL2, COLOR=5, THICK=10
;		OPLOT, TT, PBMODMED, COLOR=22, THICK=10
;		FOR NTH = 0L, N_ELEMENTS(CC)-1 DO BEGIN
;			OK = WHERE(FLOAT(CBLEND) EQ FLOAT(CC[NTH]))
;			W1 = REPLICATE(1-PBBLEND[OK],N_ELEMENTS(PBMODEL2))
;			W2 = REPLICATE(PBBLEND[OK],N_ELEMENTS(PBMODEL2))
;			PBNEW = (PBMODEL2*W1) + (PBMODMED*W2)
;			OPLOT, TT, PBNEW, COLOR=COLORS[NTH], THICK=2
;		ENDFOR
;
;		A1 = (COEFFS_STRUCT[0].A_COEFF - COEFFS_STRUCT[1].PB_MED) * COEFFS_STRUCT[0].CHL_MED
;		B1 = (COEFFS_STRUCT[0].B_COEFF - 0) * COEFFS_STRUCT[0].CHL_MED
;		C1 = (COEFFS_STRUCT[0].C_COEFF - 0) * COEFFS_STRUCT[0].CHL_MED
;		A2 =  COEFFS_STRUCT[1].PB_MED
;		B2 =  0
;		C2 =  0
;		PBMAX_MODEL_75 = ((A1 + (B1*TT) + (C1*TT^2))/0.75) + A2 + (B2*TT) + (C2*TT^2)
;		PBMAX_MODEL_2  = ((A1 + (B1*TT) + (C1*TT^2))/2.00) + A2 + (B2*TT) + (C2*TT^2)
;		OPLOT, TT, PBMAX_MODEL_75, COLOR = 0, THICK = 4, LINESTYLE=2
;		OPLOT, TT, PBMAX_MODEL_2,  COLOR = 0, THICK = 4, LINESTYLE=2
;
;		A3 = (COEFFS_STRUCT[0].A_COEFF - COEFFS_STRUCT[1].A_COEFF) * COEFFS_STRUCT[0].CHL_MED
;		B3 = (COEFFS_STRUCT[0].B_COEFF - COEFFS_STRUCT[1].B_COEFF) * COEFFS_STRUCT[0].CHL_MED
;		C3 = (COEFFS_STRUCT[0].C_COEFF - COEFFS_STRUCT[1].C_COEFF) * COEFFS_STRUCT[0].CHL_MED
;		A4 =  COEFFS_STRUCT[1].A_COEFF
;		B4 =  COEFFS_STRUCT[1].B_COEFF
;		C4 =  COEFFS_STRUCT[1].C_COEFF
;		PBMAX_MODEL_75 = ((A3 + (B3*TT) + (C3*TT^2))/0.75) + A4 + (B4*TT) + (C4*TT^2)
;		PBMAX_MODEL_2  = ((A3 + (B3*TT) + (C3*TT^2))/2.00) + A4 + (B4*TT) + (C4*TT^2)
;		OPLOT, TT, PBMAX_MODEL_75, COLOR = 33, THICK = 4, LINESTYLE=4
;		OPLOT, TT, PBMAX_MODEL_2,  COLOR = 33, THICK = 4, LINESTYLE=4
;
;
;
;		POLY_FIT_NUM = 2
;		OK = WHERE(SHIP.WC_PBMAX NE MISSINGS(0.0) AND SHIP.WC_TEMP NE MISSINGS(0.0) AND SHIP.WC_TEMP GT 0 AND SHIP.WC_PBMAX LT 9.9)
;		SET = SHIP[OK]
;		SET = SET[SORT(SET.WC_TEMP)]
;		BINS = [2.,3.,4.,5.,7.,10.,11.,12.,14.,16.,18.,20.]
;		!P.MULTI=[0,2,2]
;		FOR BTH = 0L, N_ELEMENTS(BINS)-1 DO BEGIN
;			BIN = BINS(BTH)
;			NBINS = ROUND(N_ELEMENTS(SET)/BIN)
;
;			PNEW = CREATE_STRUCT('TEMP_MIN',0.0,'TEMP_MAX',0.0,'TEMP_MED',0.0,'BF_PBMAX',0.0,'AM_PBMAX',0.0,'MB_PBMAX',0.0,'BF_RATIO',0.0,'AM_RATIO',0.0,'MB_RATIO',0.0,'N',0.0,'MEAN',0.0,'MIN',0.0,'MAX',0.0,'STD',0.0,'MED',0.0, 'CV',0.0)
;			PNEW = STRUCT_2MISSINGS(PNEW)
;			PNEW = REPLICATE(PNEW,NBINS)
;			COUNTER = 0
;			FOR NTH = 0L, NBINS-1 DO BEGIN
;				IF NTH EQ NBINS-1 THEN _SET = SET(COUNTER:N_ELEMENTS(SET)-1) ELSE _SET = SET(COUNTER:COUNTER+BIN-1)
;				_TEMP = MED(_SET.WC_TEMP)
;				PNEW[NTH].TEMP_MED = _TEMP
;				PNEW[NTH].TEMP_MIN = MIN(_SET.WC_TEMP)
;				PNEW[NTH].TEMP_MAX = MAX(_SET.WC_TEMP)
;				PNEW[NTH].AM_PbMAX = 1.54*10.^(0.0275*_TEMP-0.07)
;				PNEW[NTH].BF_PBmax = (-3.27e-008 * _TEMP^7) + (3.4132e-006 * _TEMP^6) + (-1.348e-004 * _TEMP^5) + (2.462e-003 * _TEMP^4)$
;	          + (-0.0205 * _TEMP^3) + (0.0617 * _TEMP^2) + (0.2749 * _TEMP) + 1.2956
;				PB = _SET.WC_PBMAX
;				STAT = STATS(PB,/quiet)
;				STA = STAT.MEAN + (2*STAT.STD)
;				STB = STAT.MEAN - (2*STAT.STD)
;				OK = WHERE(PB GT STB AND PB LT STA,COUNT)
;				IF COUNT GE 1 THEN BEGIN
;					STAT2 = STATS(PB[OK],/QUIET)
;					PNEW[NTH].N			= STAT2.N
;					PNEW[NTH].MEAN	=	STAT2.MEAN
;					PNEW[NTH].MIN		=	STAT2.MIN
;					PNEW[NTH].MAX		=	STAT2.MAX
;					PNEW[NTH].STD		=	STAT2.STD
;					PNEW[NTH].MED		=	STAT2.MED
;					PNEW[NTH].CV		=	STAT2.CV
;					PNEW[NTH].AM_RATIO = PNEW[NTH].AM_PBMAX/PNEW[NTH].MED
;					PNEW[NTH].BF_RATIO = PNEW[NTH].BF_PBMAX/PNEW[NTH].MED
;				ENDIF
;				COUNTER = COUNTER+BIN
;			ENDFOR
;
;			_TEMP = FINDGEN(26)
;			PLOT, PNEW.TEMP_MED, PNEW.MED,TITLE=' ', CHARSIZE=CHARSIZE,/NODATA, XRANGE=[0,25], YRANGE=[0,10], XTITLE='Temperature (!Eo!NC)',$
;				YTITLE='Median P!Eb!Dmax!N (mgC mgChl!e-1!N h!E-1!N)', XMARGIN=XMARGIN, YMARGIN=YMARGIN
;			COEFFS_TEMP = POLY_FIT(PNEW.TEMP_MED, PNEW.MED,POLY_FIT_NUM,YFIT=YFIT, CHISQ=CHISQ,COVAR=COVAR, /DOUBLE,MEASURE_ERRORS=MEASURE_ERRORS,SIGMA=SIGMA,STATUS=STATUS,YBAND=YBAND,YERROR=YERROR)
;			IF BIN EQ 7. THEN _COEFFS_TEMP = COEFFS_TEMP
;			PRINT, COEFFS_TEMP
;			COEFFS_CURVE = COMFIT(PNEW.TEMP_MED, PNEW.MED,[1,1.07,1], /EXPONENTIAL, SIGMA=SIGMA, YFIT=YFIT)
;			IF BIN EQ 7 THEN _COEFFS_CURVE = COEFFS_CURVE
;			IF POLY_FIT_NUM EQ 2 THEN MB_PBMAX_POLY = COEFFS_TEMP[0] + COEFFS_TEMP[1]*PNEW.TEMP_MED + COEFFS_TEMP(2)*PNEW.TEMP_MED^2
;			IF POLY_FIT_NUM EQ 3 THEN MB_PBMAX_POLY = COEFFS_TEMP[0] + COEFFS_TEMP[1]*PNEW.TEMP_MED + COEFFS_TEMP(2)*PNEW.TEMP_MED^2 + COEFFS_TEMP(3)*PNEW.TEMP_MED^3
;			PNEW_AM_PbMAX = 1.54*10.^(0.0275*_TEMP-0.07)
;			PNEW_BF_PBmax = (-3.27e-008 * _TEMP^7) + (3.4132e-006 * _TEMP^6) + (-1.348e-004 * _TEMP^5) + (2.462e-003 * _TEMP^4)$
;	          + (-0.0205 * _TEMP^3) + (0.0617 * _TEMP^2) + (0.2749 * _TEMP) + 1.2956
;	    IF POLY_FIT_NUM EQ 2 THEN PNEW_MB_PBMAX = COEFFS_TEMP[0] + COEFFS_TEMP[1]*_TEMP + COEFFS_TEMP(2)*_TEMP^2
;	    IF POLY_FIT_NUM EQ 3 THEN PNEW_MB_PBMAX = COEFFS_TEMP[0] + COEFFS_TEMP[1]*_TEMP + COEFFS_TEMP(2)*_TEMP^2 + COEFFS_TEMP(3)*_TEMP^3
;	    PNEW_POLY = (COEFFS_CURVE[0] * (COEFFS_CURVE[1]^_TEMP)) + COEFFS_CURVE(2)
;			OPLOT, _TEMP, PNEW_BF_PbMAX, COLOR=32,THICK=20, LINESTYLE=3
;			OPLOT, _TEMP, PNEW_AM_PBmax, COLOR=34, THICK=25
;			OPLOT, _TEMP, PNEW_MB_PBMAX, COLOR=22, THICK=15
;			OPLOT, _TEMP, PNEW_POLY,     COLOR=5,  THICK=15
;			OPLOT, PNEW.TEMP_MED, PNEW.MED, PSYM=PSYM, COLOR=0, SYMSIZE=SYMSIZE, THICK = THICK
;	;		ERRPLOT, PNEW.TEMP_MED, PNEW.MED-PNEW.STD, PNEW.MED+PNEW.STD, width=0.02, COLOR=0, THICK=5
;
;	;		COEFFS 			= COMFIT(PNEW[OK].TEMP, PNEW[OK].MED,[0.003,1.35,2.7],/EXPONENTIAL,YFIT=YFIT_EXP)
;	;		PRINT, COEFFS
;	;		COEFFS			= SHIFT(coeffs,1)			;Shift Coeffs_exp
;	;		MB_PBMAX = COEFFLS[0] + COEFFLS[1]*COEFFLS(2)^PNEW.TEMP
;			OPLOT, PNEW.TEMP_MED, REPLICATE(MED(PNEW.MED),N_ELEMENTS(PNEW)), COLOR=0, THICK=15
;
;		;	OPLOT, PNEW[OK].TEMP, YFIT, COLOR=22, THICK=15
;			ON = WHERE(SHIP.WC_PBMAX NE MISSINGS(0.0) AND SHIP.WC_PBMAX GT 0 AND SHIP.WC_PBMAX LE 25)
;			STAT1 = STATS(SHIP(ON).WC_PBMAX)
;
;			LEG_POS = [0.46,0.84,0.52,0.95]
;			TXT = 'Massachusetts Bay'
;			TXT = [TXT, 'Behrenfeld & Falkowski']
;			TXT = [TXT, 'Antoine & Morel']
;			COLOR = [0,32,35]
;			LEG,pos = LEG_POS,LCOLOR=0, color=COLOR,label=TXT,THICK=[10,20,25],PSYM=[-8,-3,-3],LINESTYLE=[0,3,0],LSIZE=0.75, FONT=0
;			FIGURE = 'Figure 8'
;			FIGCOOR = COORD_2PLOT(-0.1,1.10)
;	;		XYOUTS, FIGCOOR.X,FIGCOOR.Y,FIGURE,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=FIGSIZE
;			print, med(pnew(ok).med)
;			TXT = 'BIN SIZE = '+  NUM2STR(ROUND(BIN))
;			COOR = COORD_2PLOT(0.01,0.95)
;			XYOUTS, COOR.X,COOR.Y,TXT,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=1
;		ENDFOR



		HPARAMS=[0,1,2,3,4,6]
		HYMARGIN = [2,2]
		HXMARGIN = [6,8]
		HCHARSIZE = 1.5
		BAR_COLOR = 31
		PARAMS = [2,4,8,10]
		CHARSIZE = 1.75
		XMARGIN = [4,2]
		YMARGIN = [1,1]
		SYM_COLOR = 32
		STATS_CHARSIZE = 1.25
		STATS_POS = [0.02,0.95]
		SYMSIZE = 1.25
		REG_THICK = 12
		THICK = 2
		FONT = 0
;		CIR = CIRCLE(0,0,1,49)
		CIRCLE,32, COLOR=32
;		USERSYM, CIR(0,*),CIR(1,*),THICK=3,/FILL
		PSYM = 8
		ONE_COLOR = 0
		ONE_THICK = 5
		ONE_LINESTYLE = 2
		ZTITLE					= 'Z!Deu!N (m)!C'
		TTITLE					= 'Suspended Solids (mg L!E-1!N)'
		CTITLE					= 'Chlorophyll !8a!7 (mg m!E-3!N)'
		LZTITLE					= 'LOG Z!Deu!N (m)'
		LTTITLE					= 'LOG Suspended Solids (mg L!E-1!N)'
		LCTITLE					= 'LOG Chlorophyll !8a!7 (mg m!E-3!N)'
		COLORBAR_POS		=  [0.10, 0.095,0.9, 0.115]
		COLORBAR_TXT		= 'Frequencey'
		COLORBAR_CHARSIZE = 1.25
		CUM_COLOR = 0
		CUM_LINESTYLE = 2
		CUM_THICK = 5
		CUM_CHARSIZE = HCHARSIZE
		FIGSIZE = 1.5

;		OK = WHERE(SHIP.WC_PBMAX NE MISSINGS(0.0) AND SHIP.WC_CHL NE MISSINGS(0.0)); AND (SHIP.PER_PHAEOCYSTIS EQ 0 OR SHIP.PER_PHAEOCYSTIS EQ MISSINGS(0.0)))
;		_PB  = SHIP[OK].WC_PBMAX
;		_CHL = SHIP[OK].WC_CHL
;		PBSTATS = STATS2(ALOG10(_CHL),ALOG10(_PB), MODEL='RMA')
;		PBSLOPE = PBSTATS.SLOPE
;		PBINT = PBSTATS.INT


		OK = WHERE(SHIP.AREAL_PROD_ZEU NE MISSINGS(0.0) AND SHIP.WT_CHL NE MISSINGS(0.0) AND SHIP.CHL_MEAN_ZEU NE MISSINGS(0.0) AND SHIP.PB_OPT LT 25 AND $
							 SHIP.ZEU NE MISSINGS(0.0) AND SHIP.DI_PAR NE MISSINGS(0.0)AND SHIP.DI_PAR GT 0 AND SHIP.DAY_LENGTH NE MISSINGS(0.0) AND $
							 SHIP.AREAL_CHL_ZEU NE MISSINGS(0.0) AND SHIP.SST NE MISSINGS(0.0) AND SHIP.SST NE MISSINGS(0.0) AND SHIP.YEAR GE 1998 AND SHIP.YEAR LE 2005); AND $
							 ;(SHIP.PER_PHAEOCYSTIS EQ 0 OR SHIP.PER_PHAEOCYSTIS EQ MISSINGS(0.0)))

		PCHARSIZE = 3
		PXMARGIN	= [5,4]
		PYMARGIN	= [1,1]
		XRANGE = [0.030,10]
		YRANGE = [0.030,10]
		PARAMS2 = [2,4,8];

;		*** in situ ship data ***
		DATE		= SHIP[OK].GMT_DATE
		SC			= SUNCLOCK(DATE_2DOY(SHIP[OK].GMT_DATE))
		STT			= SHIP[OK].STATION
		AP			= SHIP[OK].AREAL_PROD_ZEU/1000
		MZCHL		= SHIP[OK].CHL_MEAN_ZEU
		MCHL		= SHIP[OK].MEAN_CHL
		SCHL		= SHIP[OK].SURF_CHL
		ACHL		= SHIP[OK].AREAL_CHL_ZEU
		WCHL		= SHIP[OK].WT_CHL
	;	CCHL 		= SHIP[OK].WC_CHL
		SNO3		= SHIP[OK].SURF_NO3
	;	WNO3		= SHIP[OK].WC_NO3
		MNO3		= SHIP[OK].MEAN_NO3
		CHL			= WCHL
	;	XPB			= SHIP[OK].MAX_PBMAX
	;	MPB			= SHIP[OK].MEAN_PBMAX
	;	SPB			= SHIP[OK].SURF_PBMAX
	;	CPB			= SHIP[OK].WC_PBMAX
	;	CPM			= SHIP[OK].WC_PMAX
		PB 			= SHIP[OK].PB_OPT
		ZO      = SHIP[OK].Z_OPT
		ZEU			= SHIP[OK].ZEU
		PAR			= SHIP[OK].DI_PAR
		DL			= SHIP[OK].DAY_LENGTH
		SST 		= SHIP[OK].SST
	;	TEMP		= SHIP[OK].WC_TEMP
		AC 			= SHIP[OK].AREAL_CHL_ZEU
		MBAC    = 38.0*FLOAT(CHL LT 1.)*(CHL > 0.)^0.425 + 40.2*FLOAT(CHL GE 1.)*(CHL > 0.)^0.507	; Morel/Berthon Euphotic Chlorophyll

;   **** Zeu ***
		MBZ 		= (MBAC GT 10.0)* 568.2*MBAC^(-0.746) +  (MBAC LE 10.0)* 200.*MBAC^(-0.293)		; Morel/Berthon Zeu
;		MBZ 		= (ACHL GT 10.0)* 568.2*ACHL^(-0.746) +  (ACHL LE 10.0)* 200.*ACHL^(-0.293)		; Morel/Berthon Zeu
		LZ			= MB_ZEU(CHL=CHL)																											; Mass Bay Zeu
;		COEFFS_ZEU = [1.33899,-0.156968,-0.0426605]
;		LZ2 = 10^(COEFFS_ZEU[0] + (COEFFS_ZEU[1]*ALOG10(CHL)) + (COEFFS_ZEU(2)*ALOG10(CHL)^2))
;		LZ2 = 10^(1.3372 + (-0.18633*ALOG10(CHL)))

;   *** Pbmax ***
		PBAVG		= 2.68482   																													; Mass Bay average pbopt
;		WPBBF		= PB_OPT_BF(SST_SAT = TEMP)																						; Behrenfeld/Falkowski Pbopt (water column temp)
;		WPBAM		= PB_OPT_AM(SST_SAT = TEMP)																						; Antoine/Morel Pbopt (water column temp)
		SPBBF		= PB_OPT_BF(SST_SAT = SST)                                            ; Behrenfeld/Falkowski Pbopt (sea surface temp)
		SPBAM		= PB_OPT_AM(SST_SAT = SST)																						; Antoine/Morel Pbopt (sea surface temp)
;		WKIPB   = (0.071*TEMP -3.2e-3*TEMP^2 + 3.0E-5*TEMP^3)/CHL + (1.0 + 0.17*TEMP - 2.5e-3*TEMP^2 - 8.0e-5*TEMP^3)
		SKIPB   = (0.071*SST -3.2e-3*SST^2 + 3.0E-5*SST^3)/CHL + (1.0 + 0.17*SST - 2.5e-3*SST^2 - 8.0e-5*SST^3)
;		WIIPB   = ((-12.2 + (1.7 * TEMP) - (0.025 * TEMP^2))/CHL) + $
;		           (13.3 - (0.916 * TEMP) + (0.0191 * TEMP^2))
		SIIPB   = ((-12.2 + (1.7 * SST) - (0.025 * SST^2))/CHL) + $
		           (13.3 - (0.916 * SST) + (0.0191 * SST^2))


;		CBLEND = FINDGEN(12600)/10000+0.75
;		PBBLEND = BLEND(CBLEND)
;		PBNEW = FLTARR(N_ELEMENTS(CHL))
;		FOR NTH = 0L, N_ELEMENTS(CHL)-1 DO BEGIN
;			;PBMODEL2 = 3.22783 + (0.408835 * TEMP[NTH]) + (-0.0218251*TEMP[NTH]^2)
;			PBMODEL2 = COEFFS_STRUCT[0].A_COEFF + (COEFFS_STRUCT[0].B_COEFF * TEMP[NTH]) + (COEFFS_STRUCT[0].C_COEFF*TEMP[NTH]^2)
;			PBMODMED = 2.42200
;			OK = WHERE_NEAREST(CBLEND, CHL[NTH],NEAR=0.01,COUNT,VALID=VALID)
;			IF COUNT NE 1 THEN BEGIN
;				IF CHL[NTH] LT 0.75 THEN BEGIN & W1 = 1 & W2 = 0 & ENDIF
;				IF CHL[NTH] GT 2    THEN BEGIN & W1 = 0 & W2 = 1 & ENDIF
;			ENDIF ELSE BEGIN
;				W1 = REPLICATE(1-PBBLEND[OK],N_ELEMENTS(PBMODEL2))
;				W2 = REPLICATE(PBBLEND[OK],N_ELEMENTS(PBMODEL2))
;			ENDELSE
;			PBNEW[NTH] = (PBMODEL2*W1) + (PBMODMED*W2)
;		ENDFOR
;
;		PBNEW2 = ((A1 + (B1*TEMP) + (C1*TEMP^2))/CHL) + A2 + (B2*TEMP) + (C2*TEMP^2)
;		PBNEW = ((A3 + (B3*TEMP) + (C3*TEMP^2))/CHL) + (_COEFFS_CURVE[0] * (_COEFFS_CURVE[1]^TEMP)) + _COEFFS_CURVE(2)

;		RANGE = [0.01,60.0]
;		INCREMENT = 0.001
;		LOWER = 0.75
;		UPPER = 2.00
;	  MID_CHL = (LOWER+UPPER)/2.0
;		CHLOR_A = [0.1, 0.7, 0.75, 1.0,MID_CHL,1.75, 2.0, 3.0,10]
;	;	CHL=INTERVAL(RANGE,INCREMENT)
;
;		W1 = REPLICATE(1.0,N_ELEMENTS(CHL))
;		W2 = REPLICATE(1.0,N_ELEMENTS(CHL))
;		OK=WHERE(CHL GE LOWER AND CHL LE UPPER,COUNT)
;		W2[OK]=BLEND(CHL[OK])
;		W1[OK]=1.0-W2[OK]
;		OK=WHERE(CHL LT LOWER,COUNT)
;	  IF COUNT GE 1 THEN BEGIN & W1[OK] = 1.0 & W2[OK] 	= 0.0 & ENDIF
;	  OK=WHERE(CHL GT UPPER,COUNT)
;	  IF COUNT GE 1 THEN BEGIN & W1[OK] = 0.0 & W2[OK] 	= 1.0 & ENDIF
;
;		PBNEW3 = FLTARR(N_ELEMENTS(CHL))
;		PBMODEL2 = COEFFS_STRUCT[0].A_COEFF + (COEFFS_STRUCT[0].B_COEFF * TEMP) + (COEFFS_STRUCT[0].C_COEFF*TEMP^2)
;		PBMODMED = REPLICATE(COEFFS_STRUCT[1].PB_MED,N_ELEMENTS(CHL))
;		PBNEW3 = (PBMODEL2*W2) + (PBMODMED*W1)
;		PBNEW3 = PBMODEL2
;;		PBNEW3 = 2.1409606 + (0.046632868 * TEMP) + (-0.00064162123 * TEMP^2)
;;		PBNEW3 = 1.9499591 + (0.067284310 * TEMP) + (-0.00050940812 * TEMP^2)
;;		IF N_ELEMENTS(_COEFFS_TEMP) EQ 3 THEN PBNEW3 = _COEFFS_TEMP[0] + (_COEFFS_TEMP[1] * TEMP) + (_COEFFS_TEMP(2) * TEMP^2)
;;		IF N_ELEMENTS(_COEFFS_TEMP) EQ 4 THEN PBNEW3 = _COEFFS_TEMP[0] + (_COEFFS_TEMP[1] * TEMP) + (_COEFFS_TEMP(2) * TEMP^2) + _COEFFS_TEMP(3) * TEMP^3
;;		PBNEW3 = (_COEFFS_CURVE[0] * (_COEFFS_CURVE[1]^TEMP)) + _COEFFS_CURVE(2)


;   *** Chl stats ***
;		STAT 		= STATS2(ALOG10(WCHL),ALOG10(CPM),MODEL='RMA')
;		SLOPE 	= STAT.SLOPE
;		INT 		= STAT.INT
;		PMAX 		= 10^((ALOG10(WCHL)*SLOPE)+INT)
;		PPB 		= PMAX/WCHL

;   *** in situ comparisons of VGPM parameters ***
		CZ  		= 0.66125*(CHL > 0.)*ZEU
		CP	 		= 0.66125*( PAR/(PAR+4.1)) *(CHL > 0.)
		CPZ  		= 0.66125*( PAR/(PAR+4.1)) *(CHL > 0.)*ZEU
		CPD  		= 0.66125*( PAR/(PAR+4.1)) *(CHL > 0.)*DL
		CPDZ 	 	= 0.66125*( PAR/(PAR+4.1)) *(CHL > 0.)*ZEU*DL
		CPDZMB 	= 0.66125*( PAR/(PAR+4.1)) *(CHL > 0.)*MBZ*DL
		CPDZL 	= 0.66125*( PAR/(PAR+4.1)) *(CHL > 0.)*LZ*DL
;		MVGPM 	= 0.66125*MPB*( PAR/(PAR+4.1)) *(CHL > 0.)*ZEU*DL
;		SVGPM 	= 0.66125*SPB*( PAR/(PAR+4.1)) *(CHL > 0.)*ZEU*DL
		CVGPM 	= 0.66125*PB *( PAR/(PAR+4.1)) *(CHL > 0.)*ZEU*DL
;		XVGPM 	= 0.66125*XPB*( PAR/(PAR+4.1)) *(CHL > 0.)*ZEU*DL
		VGPM		= CVGPM/1000
		CHL			= WCHL
		CPDL 		= 0.66125*( PAR/(PAR+4.1)) *(CHL > 0.)*LZ*DL

;   *** VGPM variations ***
		VGPMB 	= 0.66125*PB*(   PAR/(PAR+4.1)) *(CHL > 0.)*MBZ*DL	; WC_pbmax & Morel/Berthon Zeu
		VGPML 	= 0.66125*PB*(   PAR/(PAR+4.1)) *(CHL > 0.)*LZ*DL		; WC_pbmax & Mass Bay Zeu
		VGPMMBA = 0.66125*PBAVG*(PAR/(PAR+4.1)) *(CHL > 0.)*LZ*DL		; Avg_pbmax & Mass Bay Zeu
		VGPMMB2 = 0.66125*PBAVG*(PAR/(PAR+4.1)) *(CHL > 0.)*ZEU*DL	; Avg_pbmax & in situ Mass Bay Zeu
;		VGPMPPB = 0.66125*PPB	 *(PAR/(PAR+4.1)) *(CHL > 0.)*LZ*DL
		VGPMLBF	= 0.66125*SPBBF*(PAR/(PAR+4.1)) *(CHL > 0.)*LZ*DL		; Behrenfeld/Falkowski Pbmax & Mass Bay Zeu
		VGPMBFMB= 0.66125*SPBBF*(PAR/(PAR+4.1)) *(CHL > 0.)*MBZ*DL	; Behrenfeld/Falkowski Pbmax & Morel Berthon Zeu
		VGPMLAM	= 0.66125*SPBAM*(PAR/(PAR+4.1)) *(CHL > 0.)*LZ*DL		; Antoine/Morel & Mass Bay Zeu
		VGPMLAM7= 0.76125*SPBAM*(PAR/(PAR+4.1)) *(CHL > 0.)*LZ*DL		; Antoine/Morel & Mass Bay Zeu * 0.76125
		VGPMLKI = 0.66125*SKIPB*(PAR/(PAR+4.1)) *(CHL > 0.)*LZ*DL		; Kameda/Ishizaka & Mass Bay Zeu
		VGPMLII = 4.19   *SIIPB*(PAR/(PAR+336)) *(CHL > 0.)*LZ*DL   ; Ishizaka et al & Mass Bay Zeu
	;	VGPMNEW = 0.66125*PBNEW*(PAR/(PAR+4.1)) *(CHL > 0.)*LZ*DL
		_VGPMNEW = 0.66125*PBAVG*(PAR/(PAR+4.1)) *(CHL > 0.)*LZ*DL

;		_VGPMNEW1 = 10^(PBSLOPE*ALOG10(_VGPMNEW)+PBINT)
;		_VGPMNEW2 = 10^((ALOG10(_VGPMNEW)-PBINT)/PBSLOPE)
;		_VGPMNEW3 = 0.66125*PBNEW3*(PAR/(PAR+4.1)) *(CHL > 0.)*LZ*DL

		VGPM_NEW  = PP_VGPM(   CHL_SAT=CHL,SST_SAT=SST,PAR=PAR,DAY_LENGTH=DL,K_PAR=K_PAR,CHLOR_EUPHOTIC=CHLOR_EUPHOTIC)
		VGPM2_NEW = PP_VGPM2(  CHL_SAT=CHL,SST_SAT=SST,PAR=PAR,DAY_LENGTH=DL,K_PAR=K_PAR,CHLOR_EUPHOTIC=CHLOR_EUPHOTIC)
		VGMB_NEW  = PP_VGMB(   CHL_SAT=CHL,SST_SAT=SST,PAR=PAR,DAY_LENGTH=DL,K_PAR=K_PAR,CHLOR_EUPHOTIC=CHLOR_EUPHOTIC)
		VGKI_NEW  = PP_VGMB_KI(CHL_SAT=CHL,SST_SAT=SST,PAR=PAR,DAY_LENGTH=DL,K_PAR=K_PAR,CHLOR_EUPHOTIC=CHLOR_EUPHOTIC)
		VGII_NEW  = PP_VGMB_II(CHL_SAT=CHL,SST_SAT=SST,PAR=PAR,DAY_LENGTH=DL,K_PAR=K_PAR,CHLOR_EUPHOTIC=CHLOR_EUPHOTIC)

		VGSTATS = STATS2(ALOG10(AP),ALOG10(VGPMMBA/1000),MODEL='RMA')
		_VGPMNEW2 =  (10^((ALOG10(VGPMMBA/1000)-VGSTATS.INT)/VGSTATS.SLOPE)*1000)


;		*************************************************************************************************************************
;		********************************** MAKE TABLE TO COMPARE THE PRODUCTIVITY OUTPUTS ***************************************
;		*************************************************************************************************************************


		MODEL_NAMES = ['Mass_Bay','BF_w_MB','BF_w_Mass_Bay','AM_w_Mass_Bay','KI_w_Mass_Bay','II_w_Mass_Bay','VGPM','VGPM2','VGMB','VGKI','VGII']
		VSTAT = CREATE_STRUCT('MODEL','','N',0L,'SLOPE',0.0,'INT',0.0,'RSQ',0.0,'RMS',0.0,'COV',0.0,'BIAS',0.0)
		VSTAT = STRUCT_2MISSINGS(VSTAT)
		VSTAT = REPLICATE(VSTAT,N_ELEMENTS(MODEL_NAMES))
		FOR _VSTATS = 0L, N_ELEMENTS(MODEL_NAMES)-1 DO BEGIN
			IF _VSTATS EQ 0 THEN AMODEL = VGPMMBA/1000
			IF _VSTATS EQ 1 THEN AMODEL = VGPMBFMB/1000
			IF _VSTATS EQ 2 THEN AMODEL = VGPMLBF/1000
			IF _VSTATS EQ 3 THEN AMODEL = VGPMLAM/1000
			IF _VSTATS EQ 4 THEN AMODEL = VGPMLKI/1000
			IF _VSTATS EQ 5 THEN AMODEL = VGPMLII/1000
			IF _VSTATS EQ 6 THEN AMODEL = VGPM_NEW
			IF _VSTATS EQ 7 THEN AMODEL = VGPM2_NEW
			IF _VSTATS EQ 8 THEN AMODEL = VGMB_NEW
			IF _VSTATS EQ 9 THEN AMODEL = VGKI_NEW
			IF _VSTATS EQ 10 THEN AMODEL = VGII_NEW

			VSTATS = STATS2(ALOG10(AP),ALOG10(AMODEL),MODEL='RMA')
			VSTAT(_VSTATS).MODEL 	= MODEL_NAMES(_VSTATS)
			VSTAT(_VSTATS).N			= VSTATS.N
			VSTAT(_VSTATS).SLOPE	= VSTATS.SLOPE
			VSTAT(_VSTATS).INT		= VSTATS.INT
			VSTAT(_VSTATS).RSQ		= VSTATS.RSQ
			VSTAT(_VSTATS).RMS		= VSTATS.RMS
			VSTAT(_VSTATS).COV		= VSTATS.COV
			VSTAT(_VSTATS).BIAS		= VSTATS.BIAS
		ENDFOR


;		*************************************************************************************************************************
;		*************************************************************************************************************************
;		*************************************************************************************************************************




		!P.MULTI=[0,1,2]
		OK = WHERE(SHIP.PBMAX_PROF NE MISSINGS('') AND SHIP.YEAR GE 1998 AND SHIP.YEAR LE 2006)
		PBMAX = SHIP[OK]
		FOR NTH = 0L, N_ELEMENTS(PB)-1 DO BEGIN
			IF NTH EQ 0 THEN PB = FLOAT(STRSPLIT(PBMAX[NTH].PBMAX_PROF,';',/EXTRACT)) ELSE $
			PB = [PB, FLOAT(STRSPLIT(PBMAX[NTH].PBMAX_PROF,';',/EXTRACT))]
		ENDFOR
		OK = WHERE(PB GT 0 AND PB LT 25) & PB = PB[OK]

		HISTPLOT,ALOG10(PB),PARAMS=HPARAMS,OMIN=OMIN,MIN=-2,MAX=2,CHARSIZE=HCHARSIZE,STATS_CHARSIZE=STATS_CHARSIZE, OMAX=OMAX, BINSIZE=0.1,$
			BAR_COLOR=BAR_COLOR,DECIMALS=2,YTICKS=8,XSTYLE=5, $
			/STATS_NONE,XMARGIN=HXMARGIN,YMARGIN=HYMARGIN,XRANGE=[-2,2],YRANGE=[0,200], TITLE=' ', YTITLE='Frequency',/grids_none,/bar_opaque,$
			CUM_TITLE=cum_title, CUM_COLOR=cum_color,CUM_THICK=CUM_THICK,CUM_LINESTYLE=cum_linestyle,CUM_FMT=cum_fmt,CUM_CHARSIZE=cum_charsize
		AXIS,XAXIS=0,/XLOG, XRANGE=[0.01,100],COLOR=0, CHARSIZE=HCHARSIZE,XTICKNAME=['0.01','0.1','1','10','100'],XTITLE='!E14!NC Measured !8P!Eb!Dmax!N!7 (mgC mgChl!E-1!N hr!E-1!N)'
		AXIS,XAXIS=1,/XLOG, XRANGE=[0.01,100],COLOR=0, CHARSIZE=HCHARSIZE,XTICKNAME=[' ',' ',' ',' ',' ']
;		FIGURE = 'Figure 4'
		FIGCOOR = COORD_2PLOT(-0.1,1.10)

		OK = WHERE(SHIP.PB_OPT NE MISSINGS(0.0) AND SHIP.PB_OPT LT 25)
		PB = SHIP[OK].PB_OPT
		HISTPLOT,ALOG10(PB),PARAMS=HPARAMS,OMIN=OMIN,MIN=-2,MAX=2,CHARSIZE=HCHARSIZE,STATS_CHARSIZE=STATS_CHARSIZE, OMAX=OMAX, BINSIZE=0.1,$
			BAR_COLOR=BAR_COLOR,DECIMALS=2,YTICKS=8,XSTYLE=5, $
			/STATS_NONE,XMARGIN=HXMARGIN,YMARGIN=HYMARGIN,XRANGE=[-2,2],YRANGE=[0,50], TITLE=' ', YTITLE='Frequency',/grids_none,/bar_opaque,$
			CUM_TITLE=cum_title, CUM_COLOR=cum_color,CUM_THICK=CUM_THICK,CUM_LINESTYLE=cum_linestyle,CUM_FMT=cum_fmt,CUM_CHARSIZE=cum_charsize
		AXIS,XAXIS=0,/XLOG, XRANGE=[0.01,100],COLOR=0, CHARSIZE=HCHARSIZE,XTICKNAME=['0.01','0.1','1','10','100'],XTITLE='!E14!NC Measured !8P!Eb!Dmax!N!7 (mgC mgChl!E-1!N hr!E-1!N)'
		AXIS,XAXIS=1,/XLOG, XRANGE=[0.01,100],COLOR=0, CHARSIZE=HCHARSIZE,XTICKNAME=[' ',' ',' ',' ',' ']
;		FIGURE = 'Figure 4'
		FIGCOOR = COORD_2PLOT(-0.1,1.10)

;		PLOTXY, CPB,SPB,TITLE=' ',DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS2,psym=PSYM,THICK=THICK,CHARSIZE=HCHARSIZE,STATS_COLOR=0,YTITLE='Surface P!Eb!Dmax!N (mgC mgChl!E-1!N h!E-1!N)', $
;			/STATS_NONE,XMARGIN=HXMARGIN,YMARGIN=HYMARGIN,XTITLE='Water Column P!Eb!Dmax!N (mgC mgChl!E-1!N h!E-1!N)',SYM_COLOR=SYM_COLOR, $
;			SYMSIZE=symsize, XRANGE=[0.1,100], YRANGE=[0.1,100],STATS_CHARSIZE=STATS_CHARSIZE,REG_COLOR=0, REG_THICK=REG_THICK ,/GRID_NONE,$
;			/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle,XTICKNAME=['0.1','1','10','100'],YTICKNAME=['0.1','1','10','100']
;		FIGURE = 'Figure 5'
;		FIGCOOR = COORD_2PLOT(-0.1,1.10)
;;		XYOUTS, FIGCOOR.X,FIGCOOR.Y,FIGURE,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=FIGSIZE
;		C_S = TM_TEST((CPB),(SPB))	& PRINT, 'C_S ', C_S
;		C_S2 = TM_TEST(ALOG10(CPB),ALOG10(SPB))	& PRINT, 'C_S2 ', C_S2
;		FC_S = FV_TEST((CPB),(SPB))	& PRINT, 'FC_S ', FC_S



		OK = WHERE(SHIP.AREAL_PROD_ZEU NE MISSINGS(0.0) AND SHIP.AREAL_PROD_ZEU GT 0,COUNT)

;		HISTPLOT,AP,PARAMS=HPARAMS,OMIN=OMIN,MIN=100,MAX=5000,CHARSIZE=HCHARSIZE, STATS_CHARSIZE=STATS_CHARSIZE,OMAX=OMAX, BINSIZE=100,BAR_COLOR=BAR_COLOR,DECIMALS=2,/CUM_NONE, YTICKS=6,XSTYLE=XSTYLE,$
;			/STATS_NONE,XMARGIN=HXMARGIN,YMARGIN=HYMARGIN,XRANGE=[100,5000],YRANGE=[0,30], TITLE=' ', YTITLE='Frequency',/grids_none,/bar_opaque
		HISTPLOT,ALOG10(SHIP[OK].AREAL_PROD_ZEU/1000),PARAMS=HPARAMS,OMIN=OMIN,MIN=-1,MAX=1,CHARSIZE=HCHARSIZE, STATS_CHARSIZE=STATS_CHARSIZE,OMAX=OMAX,BINSIZE=0.1,$
			BAR_COLOR=BAR_COLOR,DECIMALS=2,YTICKS=5,XSTYLE=5,$
			/STATS_NONE,XMARGIN=HXMARGIN,YMARGIN=HYMARGIN,XRANGE=[-1,1],YRANGE=[0,30], TITLE=' ', YTITLE='Frequency',/grids_none,/bar_opaque,$
			CUM_TITLE=cum_title, CUM_COLOR=cum_color,CUM_THICK=CUM_THICK,CUM_LINESTYLE=cum_linestyle,CUM_FMT=cum_fmt,CUM_CHARSIZE=cum_charsize
		AXIS,XAXIS=0,/XLOG, XRANGE=[0.1,10], CHARSIZE=HCHARSIZE, XTITLE='!E14!NC Measured !8PP!Deu!n!7 (gC m!E-2!N d!E-1!N)'
		AXIS,XAXIS=1,/XLOG, XRANGE=[0.1,10], CHARSIZE=HCHARSIZE, XTICKNAME=[' ',' ',' ']





; ********************************************************************************


;		OK = WHERE(SHIP.WC_PBMAX NE MISSINGS(0.0) AND SHIP.SURF_PBMAX NE MISSINGS(0.0) AND SHIP.WC_PBMAX LT 25 AND SHIP.SURF_PBMAX LT 25 $
;		AND SHIP.YEAR GE 1998 AND SHIP.YEAR LE 2005)
;		_CPB = SHIP[OK].WC_PBMAX
;		_SPB = SHIP[OK].SURF_PBMAX
;
;PRINT, 10^(MEAN(ALOG10(_CPB)))
;PRINT, 10^(MEAN(ALOG10(_SPB)))
;stat = stats(alog10(_cpb))
;print, 10^stat.mean
;print, 10^stat.med
;stat = stats(alog10(_spb))
;print, 10^stat.mean
;print, 10^stat.med
	;	AXIS,YAXIS=0,YRANGE=[0,30]
	;	AXIS,YAXIS=1,YRANGE=[0,100]
;		FIGURE = 'Figure 2'
;		FIGCOOR = COORD_2PLOT(-0.1,1.10)
;		XYOUTS, FIGCOOR.X,FIGCOOR.Y,FIGURE,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=FIGSIZE

		!P.MULTI=[0,1,2]
;		PLOTXY, D[OK].AREAL_PROD_ZEU,D[OK].WT_CHL,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=PSYM,thick=THICK,CHARSIZE=CHARSIZE,STATS_COLOR=0,XTITLE='Euphotic Production (mgC m!E-2!N d!E-1!N)',$
;			/STATS_NONE,YTITLE='Chlorophyll !8a!7 (mg m!E-3!N)',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,XMARGIN=XMARGIN,YMARGIN=YMARGIN, XRANGE=[100,10000], YRANGE=[0.01,100],STATS_CHARSIZE=STATS_CHARSIZE,REG_COLOR=0, REG_THICK=REG_THICK ,/GRID_NONE,$
;			/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle,YTICKNAME=['0.01','0.1','1','10','100']
;		FIGURE = 'Figure 3'
;		FIGCOOR = COORD_2PLOT(-0.1,1.10)
;		XYOUTS, FIGCOOR.X,FIGCOOR.Y,FIGURE,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=FIGSIZE

;
;		!P.MULTI = [0,1,4]
;		OK = WHERE(SHIP.WC_PBMAX NE MISSINGS(0.0) AND SHIP.WC_TEMP NE MISSINGS(0.0) AND SHIP.WC_CHL NE MISSINGS(0.0) AND SHIP.WC_ALPHA NE MISSINGS(0.0))
;		_Y = SHIP[OK].WC_PBMAX
;		_ALPHA = SHIP[OK].WC_ALPHA
;		_CHL = SHIP[OK].WC_CHL
;		_SST = SHIP[OK].WC_TEMP
;		_AP = SHIP[OK].AREAL_PROD/1000
;		_YA = _ALPHA/_CHL
;		_X = FLTARR(2,N_ELEMENTS(_Y))
;		_X(0,*) = _SST
;		_X(1,*) = ALOG10(_CHL)
;
;
;;		PLOTXY,_AP,_ALPHA,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = STATS_POS, $
;;			YTITLE='Alpha',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,YRANGE=[0.001,1],XRANGE=[0.01,10],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK ,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN
;;
;;		PLOTXY,_AP,_YA,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=PCHARSIZE,XTITLE='Areal Productivity',THICK=THICK, STATS_POS = STATS_POS, $
;;			YTITLE='Alpha/Chl',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,YRANGE=[0.001,1],XRANGE=[0.01,10],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK ,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN
;
;		PLOTXY,_CHL,_YA,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=PCHARSIZE,XTITLE='Chlorophyll',THICK=THICK, STATS_POS = STATS_POS, $
;			YTITLE='Alpha/Chl',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,XRANGE=[0.1,100],YRANGE=[0.001,1],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK ,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN
;		PLOTXY,_CHL,_Y,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=[3,4,8],psym=psym,CHARSIZE=PCHARSIZE,XTITLE='Chlorophyll',THICK=THICK, STATS_POS = STATS_POS, $
;			YTITLE='Pbmax',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,XRANGE=[0.1,100],YRANGE=[0.1,100],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK ,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN
;		PBSTATS = STATS2(ALOG10(_CHL),ALOG10(_Y), MODEL='RMA')
;		SLOPE = PBSTATS.SLOPE
;		INT = PBSTATS.INT
;		_PBMODEL = 10^((SLOPE*ALOG10(_CHL))+INT)
;		OPLOT, _CHL, _PBMODEL, COLOR=22, PSYM=2, SYMSIZE=0.5
;
;		RESULT2 = REGRESS(ALOG10(_CHL),ALOG10(_Y),/DOUBLE,CONST=CONST2,CORRELATION=CORRELATION2,FTEST=FTEST2,MCORRELATION=MCORRELATION2,$
;			MEASURE_ERRORS=MEASURE_ERRORS2,SIGMA=SIGMA2,STATUS=STATUS2,YFIT=YFIT2)
;		PLOTXY,_Y,10^YFIT2,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = STATS_POS, $
;			YTITLE='YFIT',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,YRANGE=[0.1,100],XRANGE=[0.1,100],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK ,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN
;			LABEL = 'Chl'
;			COOR = COORD_2PLOT(0.85,0.87)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;
;
;;		RESULT1 = REGRESS(_X(0,*),_Y,/DOUBLE,CONST=CONST1,CORRELATION=CORRELATION1,FTEST=FTEST1,MCORRELATION=MCORRELATION1,$
;;			MEASURE_ERRORS=MEASURE_ERRORS,SIGMA=SIGMA1,STATUS=STATUS1,YFIT=YFIT1)
;
;
;;		PLOTXY,_Y,_X(0,*),DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = STATS_POS, $
;;			YTITLE='SST',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,YRANGE=[0.1,100],XRANGE=[0.1,100],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK ,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN
;;
;;		RESULT1 = REGRESS(_X(0,*),_Y,/DOUBLE,CONST=CONST1,CORRELATION=CORRELATION1,FTEST=FTEST1,MCORRELATION=MCORRELATION1,$
;;			MEASURE_ERRORS=MEASURE_ERRORS,SIGMA=SIGMA1,STATUS=STATUS1,YFIT=YFIT1)
;;		PLOTXY,_Y,YFIT1,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = STATS_POS, $
;;			YTITLE='YFIT',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,YRANGE=[0.1,100],XRANGE=[0.1,100],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK ,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN
;;			LABEL = 'SST'
;;			COOR = COORD_2PLOT(0.85,0.87)
;;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;
;
;
;		RESULT4 = REGRESS(_X,_Y,/DOUBLE,CONST=CONST3,CORRELATION=CORRELATION4,FTEST=FTEST4,MCORRELATION=MCORRELATION4,$
;			MEASURE_ERRORS=MEASURE_ERRORS4,SIGMA=SIGMA4,STATUS=STATUS4,YFIT=YFIT4)
;		PLOTXY,_Y,YFIT4,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=PCHARSIZE,THICK=THICK, STATS_POS = STATS_POS, $
;			XTITLE='Observed',YTITLE='YFIT',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,YRANGE=[0.1,100],XRANGE=[0.1,100],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK ,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN
;			LABEL = 'SST-Chl'
;			COOR = COORD_2PLOT(0.85,0.87)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;
;
;		!P.MULTI=[0,1,3]
;		PARAMS = [2,4,8]
;		OK = WHERE(SHIP.WC_PBMAX NE MISSINGS(0.0) AND SHIP.WC_CHL NE MISSINGS(0.0) AND SHIP.WC_CHL LT 1 AND SHIP.WC_TEMP NE MISSINGS(0.0))
;		PLOTXY,SHIP[OK].WC_PBMAX,SHIP[OK].WC_TEMP,DECIMALS=3,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = [0.8,0.95], $
;			YTITLE='Temp: Chl < 1',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,YRANGE=[0,25],XRANGE=[0,16],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK ,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN
;		OK = WHERE(SHIP.WC_PBMAX NE MISSINGS(0.0) AND SHIP.WC_CHL NE MISSINGS(0.0) AND SHIP.WC_CHL GE 1 AND SHIP.WC_TEMP NE MISSINGS(0.0))
;		PLOTXY,SHIP[OK].WC_PBMAX,SHIP[OK].WC_TEMP,DECIMALS=3,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = [0.8,0.95], $
;			YTITLE='Temp: Chl > 1',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,YRANGE=[0,25],XRANGE=[0,16],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK ,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN
;
;		!P.MULTI=[0,1,3]
;		PARAMS = [2,4,8]
;		OK = WHERE(SHIP.WC_PBMAX NE MISSINGS(0.0) AND SHIP.WC_CHL NE MISSINGS(0.0) AND SHIP.WC_CHL LT 1 AND SHIP.SST NE MISSINGS(0.0))
;		PLOTXY,SHIP[OK].WC_PBMAX,SHIP[OK].SST,DECIMALS=3,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = [0.8,0.95], $
;			YTITLE='Temp: Chl < 1',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,YRANGE=[0,25],XRANGE=[0,16],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK ,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN
;		OK = WHERE(SHIP.WC_PBMAX NE MISSINGS(0.0) AND SHIP.WC_CHL NE MISSINGS(0.0) AND SHIP.WC_CHL GE 1 AND SHIP.SST NE MISSINGS(0.0))
;		PLOTXY,SHIP[OK].WC_PBMAX,SHIP[OK].SST,DECIMALS=3,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = [0.8,0.95], $
;			YTITLE='Temp: Chl > 1',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,YRANGE=[0,25],XRANGE=[0,16],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK ,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN
;
;
;
;		!P.MULTI=[0,1,5]
;		PARAMS = [2,4,8]
;		OK = WHERE(SHIP.WC_PBMAX NE MISSINGS(0.0) AND SHIP.WT_CHL NE MISSINGS(0.0) AND SHIP.PER_DIATOM NE MISSINGS(0.0) AND SHIP.PER_DIATOM GT 0)
;		PLOTXY,SHIP[OK].WC_PBMAX,SHIP[OK].PER_DIATOM*100,DECIMALS=3,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = [0.8,0.95], $
;			YTITLE='Diatoms',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,YRANGE=[0,100],XRANGE=[0,16],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK ,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN
;		OK = WHERE(SHIP.WC_PBMAX NE MISSINGS(0.0) AND SHIP.WT_CHL NE MISSINGS(0.0) AND SHIP.PER_MICROFLAGELLATES NE MISSINGS(0.0) AND SHIP.PER_MICROFLAGELLATES GT 0)
;		PLOTXY,SHIP[OK].WC_PBMAX,SHIP[OK].PER_MICROFLAGELLATES*100,DECIMALS=3,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = [0.8,0.95], $
;			YTITLE='Microflagellates',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,YRANGE=[0,100],XRANGE=[0,16],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK ,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN
;		OK = WHERE(SHIP.WC_PBMAX NE MISSINGS(0.0) AND SHIP.WT_CHL NE MISSINGS(0.0) AND SHIP.PER_DINOFLAGELLATE NE MISSINGS(0.0) AND SHIP.PER_DINOFLAGELLATE GT 0)
;		PLOTXY,SHIP[OK].WC_PBMAX,SHIP[OK].PER_DINOFLAGELLATE*100,DECIMALS=3,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = [0.8,0.95], $
;			YTITLE='Dinoflagellates',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,YRANGE=[0,100],XRANGE=[0,16],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK ,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN
;		OK = WHERE(SHIP.WC_PBMAX NE MISSINGS(0.0) AND SHIP.WT_CHL NE MISSINGS(0.0) AND SHIP.PER_PHAEOCYSTIS NE MISSINGS(0.0) AND SHIP.PER_PHAEOCYSTIS GT 0)
;		PLOTXY,SHIP[OK].WC_PBMAX,SHIP[OK].PER_PHAEOCYSTIS*100,DECIMALS=3,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = [0.8,0.95], $
;			YTITLE='Phaeocystis',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,YRANGE=[0,100],XRANGE=[0,16],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK ,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN
;		OK = WHERE(SHIP.WC_PBMAX NE MISSINGS(0.0) AND SHIP.WT_CHL NE MISSINGS(0.0) AND SHIP.PER_OTHER NE MISSINGS(0.0) AND SHIP.PER_OTHER GT 0)
;		PLOTXY,SHIP[OK].WC_PBMAX,SHIP[OK].PER_OTHER*100,DECIMALS=3,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = [0.8,0.95], $
;			YTITLE='Other',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,YRANGE=[0,100],XRANGE=[0,16],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK ,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN
;
;		!P.MULTI=[0,1,5]
;		PARAMS = [2,4,8]
;		OK = WHERE(SHIP.WC_PBMAX NE MISSINGS(0.0) AND SHIP.WT_CHL NE MISSINGS(0.0) AND SHIP.PER_DIATOM NE MISSINGS(0.0) AND SHIP.PER_DIATOM GT 0)
;		PLOTXY,SHIP[OK].WC_PBMAX,SHIP[OK].PER_DIATOM*SHIP[OK].TOTAL_PHYTO,DECIMALS=3,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = [0.8,0.95], $
;			YTITLE='Diatoms',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,XRANGE=[0,16],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK ,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN
;		OK = WHERE(SHIP.WC_PBMAX NE MISSINGS(0.0) AND SHIP.WT_CHL NE MISSINGS(0.0) AND SHIP.PER_MICROFLAGELLATES NE MISSINGS(0.0) AND SHIP.PER_MICROFLAGELLATES GT 0)
;		PLOTXY,SHIP[OK].WC_PBMAX,SHIP[OK].PER_MICROFLAGELLATES*SHIP[OK].TOTAL_PHYTO,DECIMALS=3,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = [0.8,0.95], $
;			YTITLE='Microflagellates',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,XRANGE=[0,16],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK ,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN
;		OK = WHERE(SHIP.WC_PBMAX NE MISSINGS(0.0) AND SHIP.WT_CHL NE MISSINGS(0.0) AND SHIP.PER_DINOFLAGELLATE NE MISSINGS(0.0) AND SHIP.PER_DINOFLAGELLATE GT 0)
;		PLOTXY,SHIP[OK].WC_PBMAX,SHIP[OK].PER_DINOFLAGELLATE*SHIP[OK].TOTAL_PHYTO,DECIMALS=3,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = [0.8,0.95], $
;			YTITLE='Dinoflagellates',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,XRANGE=[0,16],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK ,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN
;		OK = WHERE(SHIP.WC_PBMAX NE MISSINGS(0.0) AND SHIP.WT_CHL NE MISSINGS(0.0) AND SHIP.PER_PHAEOCYSTIS NE MISSINGS(0.0) AND SHIP.PER_PHAEOCYSTIS GT 0)
;		PLOTXY,SHIP[OK].WC_PBMAX,SHIP[OK].PER_PHAEOCYSTIS*SHIP[OK].TOTAL_PHYTO,DECIMALS=3,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = [0.8,0.95], $
;			YTITLE='Phaeocystis',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,XRANGE=[0,16],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK ,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN
;		OK = WHERE(SHIP.WC_PBMAX NE MISSINGS(0.0) AND SHIP.WT_CHL NE MISSINGS(0.0) AND SHIP.PER_OTHER NE MISSINGS(0.0) AND SHIP.PER_OTHER GT 0)
;		PLOTXY,SHIP[OK].WC_PBMAX,SHIP[OK].PER_OTHER*SHIP[OK].TOTAL_PHYTO,DECIMALS=3,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = [0.8,0.95], $
;			YTITLE='Other',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,XRANGE=[0,16],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK ,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN
;




;
;	!P.MULTI=[0,1,3]
;		PARAMS = [2,4,8]
;		PLOTXY,CPB,CHL,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = STATS_POS, $
;			YTITLE='Chl',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,YRANGE=[0.1,100],XRANGE=[0.1,100],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK ,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN
;			LABEL = 'A'
;			COOR = COORD_2PLOT(0.95,0.87)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;		PLOTXY,ALOG10(CPB),SST,DECIMALS=3,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = STATS_POS, $
;			YTITLE='SST',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,YRANGE=[0,25],XRANGE=ALOG10([0.1,100]),STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK ,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN
;			LABEL = 'B'
;			COOR = COORD_2PLOT(0.95,0.87)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;		PLOTXY,ALOG10(CPB),PAR,DECIMALS=3,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = STATS_POS, $
;			YTITLE='PAR',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,YRANGE=[0,60],XRANGE=ALOG10([0.1,100]),STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK ,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN
;			LABEL = 'C'
;			COOR = COORD_2PLOT(0.95,0.87)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;	!P.MULTI=[0,1,5]
;		PLOTXY,CPB,WPBBF,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = STATS_POS, $
;			YTITLE='Modeled',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,YRANGE=[0.1,100],XRANGE=[0.1,100],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK ,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN
;			LABEL = 'A - BF'
;			COOR = COORD_2PLOT(0.85,0.87)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;		PLOTXY,CPB,WPBAM,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = STATS_POS, $
;			YTITLE='Modeled',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,YRANGE=[0.1,100],XRANGE=[0.1,100],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK ,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN
;			LABEL = 'B - AM'
;			COOR = COORD_2PLOT(0.85,0.87)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;		PLOTXY,CPB,WKIPB,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = STATS_POS, $
;			YTITLE='Modeled',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,YRANGE=[0.1,100],XRANGE=[0.1,100],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK ,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN
;			LABEL = 'C - KI'
;			COOR = COORD_2PLOT(0.85,0.87)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;		PLOTXY,CPB,PBNEW,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = STATS_POS, $
;			YTITLE='Modeled',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,YRANGE=[0.1,100],XRANGE=[0.1,100],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK ,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN
;			LABEL = 'D - MB_CT'
;			COOR = COORD_2PLOT(0.85,0.87)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;		PLOTXY,CPB,PBNEW2,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = STATS_POS, $
;			YTITLE='Modeled',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,YRANGE=[0.1,100],XRANGE=[0.1,100],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK ,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN
;			LABEL = 'E - MB_CHL'
;			COOR = COORD_2PLOT(0.85,0.87)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1


		!P.MULTI=[0,1,4]
		PARAMS = [4,8,10]
		YYMARGIN=[0.15,0.15]
		PLOTXY,AP,CHL,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=PCHARSIZE,XTITLE=' ',XTICKNAME=[' ',' ',' '],THICK=THICK,YTICKNAME=['0.01','0.1','1','10','100'], STATS_POS = STATS_POS, $
			YTITLE='Chlorophyll !8a!7 (mg m!E-3!N)',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,YRANGE=[0.01,100],XRANGE=XRANGE,STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK ,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=YYMARGIN,$
			/STATS_NONE, STATS_STRUCT=STATS_STRUCT
			TXT = 'Slope = ' + STRMID(NUM2STR(STATS_STRUCT.SLOPE),0,4) + $
			    '!CR!E2!N       = ' + STRMID(NUM2STR(STATS_STRUCT.RSQ),0,4) + $
			    '!CRMS  = ' + STRMID(NUM2STR(STATS_STRUCT.RMS),0,4)
			COOR = COORD_2PLOT(0.005,0.9)
			XYOUTS, COOR.X,COOR.Y,TXT, ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1
			LABEL = 'A'
			COOR = COORD_2PLOT(0.95,0.87)
			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1

;		PLOTXY,AP,ACHL,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = STATS_POS, $
;			YTITLE='Areal Chlorophyll !8a!7 (mg m!E-2!N)',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,YRANGE=[1,1000],XRANGE=XRANGE,STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK ,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN
;			LABEL = 'aa'
;			COOR = COORD_2PLOT(0.95,0.87)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1


;			LABEL = 'Chl'
;			COOR = COORD_2PLOT(0.915,0.1)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;			FIGURE = 'Figure 3'
;			FIGCOOR = COORD_2PLOT(-0.1,1.10)
;			XYOUTS, FIGCOOR.X,FIGCOOR.Y,FIGURE,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=FIGSIZE
;		PLOTXY,AP,CZ,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=PSYM,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK,YTICKNAME=['0.1','1','10','100','1000'], STATS_POS = STATS_POS, $
;			YTITLE=' ',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,YRANGE=[0.1,1000],XRANGE=XRANGE,STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN
;			LABEL = 'Chl * Z!Deu!N'
;			COOR = COORD_2PLOT(0.835,0.1)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;		PLOTXY,AP,CPZ,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=PSYM,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK,YTICKNAME=['0.1','1','10','100','1000'], STATS_POS = STATS_POS, $
;			YTITLE=' ',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,YRANGE=[0.1,1000],XRANGE=XRANGE,STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN
;			LABEL = 'Chl * Z!Deu!N * PAR'
;			COOR = COORD_2PLOT(0.71,0.1)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;		PLOTXY, AP,CPDZ/1000,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=PSYM,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = STATS_POS, $
;			YTITLE=' ',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,XRANGE=XRANGE,YRANGE=YRANGE,STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN,$
;			/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=2
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=0.5
;			COOR = COORD_2PLOT(0.61,0.1)
;			LABEL = 'Chl * Z!Deu!N * PAR * DL'
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
		PLOTXY, AP,VGPM,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=PSYM,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = STATS_POS, $
			YTITLE=' ',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,XRANGE=XRANGE,YRANGE=YRANGE,STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=YYMARGIN,$
			/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle,XTICKNAME=[' ',' ',' '],YTICKNAME=['0.1','1','10'],$
			/STATS_NONE, STATS_STRUCT=STATS_STRUCT
			TXT = 'Slope = ' + NUM2STR(STATS_STRUCT.SLOPE, DECIMALS=3) + $
			    '!CR!E2!N       = ' + NUM2STR(STATS_STRUCT.RSQ, DECIMALS=3) + $
			    '!CRMS  = ' + NUM2STR(STATS_STRUCT.RMS, DECIMALS=3)
			COOR = COORD_2PLOT(0.005,0.9)
			XYOUTS, COOR.X,COOR.Y,TXT, ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1

			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=2
			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=0.5

			COUNT_IN = 0
			FOR ATH = 0L, N_ELEMENTS(AP)-1 DO BEGIN
				IF VGPM(ATH) GE AP(ATH)/2 AND VGPM(ATH) LE AP(ATH)*2 THEN COUNT_IN = COUNT_IN + 1
			ENDFOR
			PRINT, NUM2STR(COUNT_IN) + ' out of ' + NUM2STR(N_ELEMENTS(AP)) + ' VGPM (in situ) estimates (' + $
			       NUM2STR(FLOAT(COUNT_IN)/N_ELEMENTS(AP)*100, DECIMALS=2) + '%) within a factor of two'

			LABEL = 'Chl * Z!Deu!N * PAR * DL * P!Eb!Dopt!N'
			LABEL = '!E14!NC Measured !8P!Eb!Dopt!N!7 and !8Z!Deu!N!7'
			LABEL = '!E14!NC Measured !8P!Eb!Dopt!N!7'
			COOR = COORD_2PLOT(0.65,0.17)
			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
			LABEL = 'Measured !8Z!Deu!N!7'
			COOR = COORD_2PLOT(0.67,0.06)
			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
			LABEL = 'B'
			COOR = COORD_2PLOT(0.95,0.87)
			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1

;		PLOTXY, AP,VGPMMB2/1000,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=PSYM,CHARSIZE=PCHARSIZE,XTITLE='Production (gC m!E-2!N d!E-1!N)',THICK=THICK, STATS_POS = STATS_POS, $
;			YTITLE='													Modeled Production (gC m!E-2!N d!E-1!N)',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,XRANGE=XRANGE,YRANGE=YRANGE,STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN,$
;			/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=2
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=0.5
;			LABEL = 'Chl * Z!Deu!N * PAR * DL * P!Eb!Dmax!N=2.51'
;			COOR = COORD_2PLOT(0.39,0.1)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
		PLOTXY, AP,VGPM_NEW,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=PSYM,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = STATS_POS, $
			YTITLE='Modeled !8PP!Deu!n!7 (gC m!E-2!N d!E-1!N)',$
			TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,XRANGE=XRANGE,YRANGE=YRANGE,STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=YYMARGIN,$
			/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle,XTICKNAME=[' ',' ',' '],YTICKNAME=['0.1','1','10'],$
			/STATS_NONE, STATS_STRUCT=STATS_STRUCT
			TXT = 'Slope = ' + NUM2STR(STATS_STRUCT.SLOPE, DECIMALS=3) + $
			    '!CR!E2!N       = ' + NUM2STR(STATS_STRUCT.RSQ, DECIMALS=3) + $
			    '!CRMS  = ' + NUM2STR(STATS_STRUCT.RMS, DECIMALS=3)
			COOR = COORD_2PLOT(0.005,0.9)
			XYOUTS, COOR.X,COOR.Y,TXT, ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1
			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=2
			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=0.5

			COUNT_VGPM = 0
			FOR ATH = 0L, N_ELEMENTS(AP)-1 DO BEGIN
				IF VGPM_NEW(ATH) GE AP(ATH)/2 AND VGPM_NEW(ATH) LE AP(ATH)*2 THEN COUNT_VGPM = COUNT_VGPM + 1
			ENDFOR
		 	PRINT, NUM2STR(COUNT_VGPM) + ' out of ' + NUM2STR(N_ELEMENTS(AP)) + ' VGPM estimates (' + $
			       NUM2STR(FLOAT(COUNT_VGPM)/N_ELEMENTS(AP)*100, DECIMALS=2) + '%) within a factor of two'


			LABEL = 'BF Modeled !8P!Eb!Dopt!N!7'
			COOR = COORD_2PLOT(0.66,0.17)
			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
			LABEL = 'MB Modeled !8Z!Deu!N!7'
			COOR = COORD_2PLOT(0.66,0.06)
			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
			LABEL = 'C'
			COOR = COORD_2PLOT(0.95,0.87)
			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1

;		PLOTXY, AP,VGPM2_NEW,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=PSYM,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = STATS_POS, $
;			;YTITLE='Modeled !8PP!Deu!n!7 (gC m!E-2!N d!E-1!N)',$
;			TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,XRANGE=XRANGE,YRANGE=YRANGE,STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN,$
;			/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle,$
;			/STATS_NONE, STATS_STRUCT=STATS_STRUCT
;			TXT = 'Slope = ' + NUM2STR(STATS_STRUCT.SLOPE, DECIMALS=3) + $
;			    '!CR!E2!N       = ' + NUM2STR(STATS_STRUCT.RSQ, DECIMALS=3) + $
;			    '!CRMS  = ' + NUM2STR(STATS_STRUCT.RMS, DECIMALS=3)
;			COOR = COORD_2PLOT(0.005,0.91)
;			XYOUTS, COOR.X,COOR.Y,TXT, ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=2
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=0.5
;
;			COUNT_VGPM2 = 0
;			FOR ATH = 0L, N_ELEMENTS(AP)-1 DO BEGIN
;				IF VGPM2_NEW(ATH) GE AP(ATH)/2 AND VGPM2_NEW(ATH) LE AP(ATH)*2 THEN COUNT_VGPM2 = COUNT_VGPM2 + 1
;			ENDFOR
;		 	PRINT, NUM2STR(COUNT_VGPM2) + ' out of ' + NUM2STR(N_ELEMENTS(AP)) + ' VGPM2 estimates (' + $
;			       NUM2STR(FLOAT(COUNT_VGPM2)/N_ELEMENTS(AP)*100, DECIMALS=2) + '%) within a factor of two'
;
;
;			LABEL = 'AM Modeled !8P!Eb!Dmax!N!7'
;			COOR = COORD_2PLOT(0.66,0.2)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;			LABEL = 'MB Modeled !8Z!Deu!N!7'
;			COOR = COORD_2PLOT(0.66,0.08)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;			LABEL = 'C'
;			COOR = COORD_2PLOT(0.95,0.87)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1

		PLOTXY, AP,VGMB_NEW,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=PSYM,CHARSIZE=PCHARSIZE,XTITLE='!E14!NC Measured !8PP!Deu!n!7 (gC m!E-2!N d!E-1!N)',THICK=THICK, STATS_POS = STATS_POS, $
			YTITLE=' ',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,XRANGE=XRANGE,YRANGE=YRANGE,STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=YYMARGIN,$
			/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle,YTICKNAME=['0.1','1','10'],$
			/STATS_NONE, STATS_STRUCT=STATS_STRUCT
			TXT = 'Slope = ' + NUM2STR(STATS_STRUCT.SLOPE, DECIMALS=3) + $
			    '!CR!E2!N       = ' + NUM2STR(STATS_STRUCT.RSQ, DECIMALS=3) + $
			    '!CRMS  = ' + NUM2STR(STATS_STRUCT.RMS, DECIMALS=3)
			COOR = COORD_2PLOT(0.005,0.9)
			XYOUTS, COOR.X,COOR.Y,TXT, ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1
			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=2
			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=0.5

;		PLOTXY, AP,VGMB_OLD,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=PSYM,CHARSIZE=PCHARSIZE,XTITLE='!E14!NC Measured !8PP!Deu!n!7 (gC m!E-2!N d!E-1!N)',THICK=THICK, STATS_POS = STATS_POS, $
;			YTITLE=' ',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,XRANGE=XRANGE,YRANGE=YRANGE,STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=YYMARGIN,$
;			/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle,YTICKNAME=['0.1','1','10'],$
;			/STATS_NONE, STATS_STRUCT=STATS_STRUCT
;			TXT = 'Slope = ' + NUM2STR(STATS_STRUCT.SLOPE, DECIMALS=3) + $
;			    '!CR!E2!N       = ' + NUM2STR(STATS_STRUCT.RSQ, DECIMALS=3) + $
;			    '!CRMS  = ' + NUM2STR(STATS_STRUCT.RMS, DECIMALS=3)
;			COOR = COORD_2PLOT(0.005,0.9)
;			XYOUTS, COOR.X,COOR.Y,TXT, ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=2
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=0.5
;
;
;		PLOTXY, AP,VGMB_ADJUSTED,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=PSYM,CHARSIZE=PCHARSIZE,XTITLE='!E14!NC Measured !8PP!Deu!n!7 (gC m!E-2!N d!E-1!N)',THICK=THICK, STATS_POS = STATS_POS, $
;			YTITLE=' ',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,XRANGE=XRANGE,YRANGE=YRANGE,STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=YYMARGIN,$
;			/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle,YTICKNAME=['0.1','1','10'],$
;			/STATS_NONE, STATS_STRUCT=STATS_STRUCT
;			TXT = 'Slope = ' + NUM2STR(STATS_STRUCT.SLOPE, DECIMALS=3) + $
;			    '!CR!E2!N       = ' + NUM2STR(STATS_STRUCT.RSQ, DECIMALS=3) + $
;			    '!CRMS  = ' + NUM2STR(STATS_STRUCT.RMS, DECIMALS=3)
;			COOR = COORD_2PLOT(0.005,0.9)
;			XYOUTS, COOR.X,COOR.Y,TXT, ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=2
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=0.5
;		VGMB_NEW2 = 10^((ALOG10(VGMB_NEW)-STATS_STRUCT.INT)/STATS_STRUCT.SLOPE)
;		PLOTXY, AP,VGMB_NEW2,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=PSYM,CHARSIZE=PCHARSIZE,XTITLE='!E14!NC Measured !8PP!Deu!n!7 (gC m!E-2!N d!E-1!N)',THICK=THICK, STATS_POS = STATS_POS, $
;			YTITLE=' ',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,XRANGE=XRANGE,YRANGE=YRANGE,STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=YYMARGIN,$
;			/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle,YTICKNAME=['0.1','1','10'],$
;			/STATS_NONE, STATS_STRUCT=STATS_STRUCT
;			TXT = 'Slope = ' + NUM2STR(STATS_STRUCT.SLOPE, DECIMALS=3) + $
;			    '!CR!E2!N       = ' + NUM2STR(STATS_STRUCT.RSQ, DECIMALS=3) + $
;			    '!CRMS  = ' + NUM2STR(STATS_STRUCT.RMS, DECIMALS=3)
;			COOR = COORD_2PLOT(0.005,0.9)
;			XYOUTS, COOR.X,COOR.Y,TXT, ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=2
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=0.5

			COUNT_VGMB = 0
			FOR ATH = 0L, N_ELEMENTS(AP)-1 DO BEGIN
				IF VGMB_NEW(ATH) GE AP(ATH)/2 AND VGMB_NEW(ATH) LE AP(ATH)*2 THEN COUNT_VGMB = COUNT_VGMB + 1
			ENDFOR
			PRINT, NUM2STR(COUNT_VGMB) + ' out of ' + NUM2STR(N_ELEMENTS(AP)) + ' VGMB estimates (' + $
			       NUM2STR(FLOAT(COUNT_VGMB)/N_ELEMENTS(AP)*100, DECIMALS=2) + '%) within a factor of two'

			LABEL = 'Mass Bay Median !8P!Eb!Dopt!N!7'
			COOR = COORD_2PLOT(0.59,0.16)
			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
			LABEL = ' Mass Bay !8Z!Deu!N!7'
			COOR = COORD_2PLOT(0.595,0.06)
			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
			LABEL = 'D'
			COOR = COORD_2PLOT(0.95,0.87)
			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1


;		PLOTXY,AP, VGMB_NEW,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=2,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = STATS_POS, $
;			YTITLE=' ',TITLE=' ',SYM_COLOR=5,SYMSIZE=symsize,XRANGE=XRANGE,YRANGE=YRANGE,STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN,$
;			/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=2
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=0.5
;			LABEL = 'Mass Bay Mean !8P!Eb!Dmax!N!7'
;			COOR = COORD_2PLOT(0.625,0.2)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;			LABEL = 'Mass Bay !8Z!Deu!N!7'
;			COOR = COORD_2PLOT(0.625,0.08)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;			LABEL = 'D'
;			COOR = COORD_2PLOT(0.95,0.87)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1


;		PLOTXY, AP,VGPMLKI/1000,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=PSYM,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = STATS_POS, $
;			YTITLE=' ',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,XRANGE=XRANGE,YRANGE=YRANGE,STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN,$
;			/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=2
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=0.5
;			LABEL = 'KI Modeled !8P!Eb!Dmax!N!7'
;			COOR = COORD_2PLOT(0.675,0.2)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;			LABEL = 'Mass Bay !8Z!Deu!N!7'
;			COOR = COORD_2PLOT(0.68,0.08)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;			LABEL = 'D'
;			COOR = COORD_2PLOT(0.95,0.87)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;
;		PLOTXY, AP,VGPMNEW/1000,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=2,CHARSIZE=PCHARSIZE,XTITLE=' ',THICK=THICK, STATS_POS = STATS_POS, $
;			YTITLE=' ',TITLE=' ',SYM_COLOR=22,SYMSIZE=symsize,XRANGE=XRANGE,YRANGE=YRANGE,STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN,$
;			/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=2
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=0.5
;			LABEL = 'Chl-Temp (KI) !8P!Eb!Dmax!N!7'
;			COOR = COORD_2PLOT(0.675,0.2)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;			LABEL = 'Mass Bay !8Z!Deu!N!7'
;			COOR = COORD_2PLOT(0.68,0.08)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;			LABEL = 'D'
;			COOR = COORD_2PLOT(0.95,0.87)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;
;		PLOTXY,AP, _VGPMNEW3/1000,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=2,CHARSIZE=PCHARSIZE,XTITLE='!E14!NC Measured !8PP!Deu!n!7 (gC m!E-2!N d!E-1!N)',THICK=THICK, STATS_POS = STATS_POS, $
;			YTITLE=' ',TITLE=' ',SYM_COLOR=12,SYMSIZE=symsize,XRANGE=XRANGE,YRANGE=YRANGE,STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN,$
;			/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=2
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=0.5
;			LABEL = 'Temp (All) !8P!Eb!Dmax!N!7'
;			COOR = COORD_2PLOT(0.675,0.2)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;			LABEL = 'Mass Bay !8Z!Deu!N!7'
;			COOR = COORD_2PLOT(0.68,0.08)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;			LABEL = 'D'
;			COOR = COORD_2PLOT(0.95,0.87)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1


;		PLOTXY, AP,VGPMNEW/1000,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=PSYM,CHARSIZE=PCHARSIZE,XTITLE='!E14!NC Measured !8PP!Deu!n!7 (gC m!E-2!N d!E-1!N)',THICK=THICK, STATS_POS = STATS_POS, $
;			YTITLE=' ',TITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,XRANGE=XRANGE,YRANGE=YRANGE,STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,XMARGIN=PXMARGIN,YMARGIN=PYMARGIN,$
;			/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=2
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=0.5
;			LABEL = 'Chl * Z!Deu!N * PAR * DL * P!Eb!Dmax!N'
;			LABEL = '!E14!NC Measured !8P!Eb!Dmax!N!7 and !8Z!Deu!N!7'
;			LABEL = 'Kameda & Ishizaka (2005)'
;			COOR = COORD_2PLOT(0.51,0.2)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;			LABEL = 'Modeled !8P!Eb!Dmax!N!7'
;			COOR = COORD_2PLOT(0.725,0.08)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;			LABEL = 'D'
;			COOR = COORD_2PLOT(0.95,0.87)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1

		VGPM1_TTEST = T_TEST_2SLOPES(X1=AP, X2=AP, Y1=VGPM, Y2=VGPM_NEW, ALPHA=0.01, SLOPE_P=SLOPE_P, INT_P=INT_P)
		VGPM2_TTEST = T_TEST_2SLOPES(X1=AP, X2=AP, Y1=VGPM, Y2=VGMB_NEW, ALPHA=0.01, SLOPE_P=SLOPE_P, INT_P=INT_P)
		VGPM3_TTEST = T_TEST_2SLOPES(X1=AP, X2=AP, Y1=VGMB_NEW, Y2=VGPM_NEW, ALPHA=0.01, SLOPE_P=SLOPE_P, INT_P=INT_P)


; *******************************************************************************

		OK 			= WHERE(SHIP.WT_CHL NE MISSINGS(0.0) AND SHIP.TSS NE MISSINGS(0.0) AND SHIP.WT_CHL GT 0.01 AND SHIP.ZEU LT SHIP.BOTTOM_DEPTH AND SHIP.ZEU NE MISSINGS(0.0))

		TSS 		= SHIP[OK].SURF_TSS
		ZEU 		= SHIP[OK].ZEU
		CHL 		= SHIP[OK].WT_CHL
		CHL_EU 	= SHIP[OK].AREAL_CHL_ZEU
		SRT 		= SORT(TSS)
		TSS 		= TSS(SRT)
		ZEU 		= ZEU(SRT)
		CHL 		= CHL(SRT)
		CHL_EU 	= CHL_EU(SRT)
		ZEU2 		= (CHL_EU GT 10.0)* 568.2*CHL_EU^(-0.746) +  (CHL_EU LE 10.0)* 200.*CHL_EU^(-0.293)

		CHLOR_EUPHOTIC=38.0*FLOAT(CHL LT 1.)*(CHL > 0.)^0.425 +40.2*FLOAT(CHL GE 1.)*(CHL > 0.)^0.507;

		Z_eu  =  (CHLOR_EUPHOTIC GT 10.0)* 568.2*CHLOR_EUPHOTIC^(-0.746) +  (CHLOR_EUPHOTIC LE 10.0)* 200.*CHLOR_EUPHOTIC^(-0.293)
		Z_EU2 = MB_ZEU(CHL=CHL)


		!P.MULTI=[0,1,2]
		stats_none=1

		PLOTXY, ZEU,Z_EU,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=[4,8],psym=PSYM,THICK=THICK,XMARGIN=[5,5],YMARGIN=[2,2],CHARSIZE=2,XTITLE=ZTITLE,$
			YTITLE='Modeled Z!Deu!N (m)',SYM_COLOR=SYM_COLOR,SYMSIZE=0.75,XRANGE=[5,180],YRANGE=[5,180],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,$
			/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle,stats_none=stats_none
		LABEL = 'Morel and Berthon (1989)'
		COOR = COORD_2PLOT(-0.03,0.9)
		XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
		LABEL = 'A'
		COOR = COORD_2PLOT(0.93,0.86)
		XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=2, COLOR=0, CHARTHICK=1

;
;		PLOTXY, CHL_EU,CHLOR_EUPHOTIC,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=[4,8],psym=PSYM,THICK=THICK,XMARGIN=[5,5],YMARGIN=[2,2],CHARSIZE=2,XTITLE='CHL EU',$
;			YTITLE='Modeled CHL EU',SYM_COLOR=SYM_COLOR,SYMSIZE=0.75,XRANGE=[5,300],YRANGE=[5,300],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,$
;			/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle,stats_none=stats_none

;		PLOTXY, TSS,ZEU,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=[4,8],psym=PSYM,THICK=THICK,XMARGIN=[4,4],YMARGIN=[2,2],CHARSIZE=3,XTITLE=TTITLE,$
;			STATS_POS=[0.03,0.15],YTITLE='Z!Deu!N (m)',SYM_COLOR=SYM_COLOR,SYMSIZE=0.75,XRANGE=[0.01,10],XTICKNAME=['0.01','0.1','1','10'],YRANGE=[1,100],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,stats_none=stats_none
;		PLOTXY, CHL,CHL_EU,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=[4,8],psym=PSYM,THICK=THICK,XMARGIN=[15,15],YMARGIN=[2,2],CHARSIZE=3,XTITLE=CTITLE,$
;			YTITLE='Chlorophyll !Deu!X!N (mg m!U-2!N)',SYM_COLOR=SYM_COLOR,SYMSIZE=0.75,XRANGE=[0.1,100],YRANGE=[5,300],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,stats_none=stats_none
;			;/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle,
;		LABEL = 'B'
;		COOR = COORD_2PLOT(0.91,0.88)
;		XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1

;		PLOTXY, CHL,TSS,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=[4,8],psym=PSYM,THICK=THICK,XMARGIN=[4,4],YMARGIN=[2,2],CHARSIZE=3,XTITLE=CTITLE,STATS_POS=[0.03,0.15],$
;			YTITLE=TTITLE,SYM_COLOR=SYM_COLOR,SYMSIZE=0.75,XRANGE=[0.1,100],XTICKNAME=['0.1','1','10','100'],YRANGE=[0.01,10],YTICKNAME=['0.01','0.1','1','10','10'],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,stats_none=stats_none
;		LABEL = 'C'
;		COOR = COORD_2PLOT(0.91,0.88)
;		XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;		PLOTXY, CHL,ZEU,DECIMALS=3,/LOGLOG,/QUIET,MODEL='LSY',PARAMS=[4,8],psym=PSYM,THICK=THICK,XMARGIN=[5,5],YMARGIN=[2,2],CHARSIZE=2,XTITLE=CTITLE,$
;			STATS_POS=[0.03,0.15],YTITLE='Z!Deu!N (m)',SYM_COLOR=SYM_COLOR,SYMSIZE=0.75,XRANGE=[0.1,50],XTICKNAME=['0.1','1','10'],YRANGE=[5,100],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,stats_none=stats_none
;		STATS_ZEU = STATS2(ALOG10(CHL),ALOG10(ZEU),MODEL='RMA')
;		LABEL = 'B'
;		COOR = COORD_2PLOT(0.93,0.88)
;		XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=2, COLOR=0, CHARTHICK=1
;		FIT = 10^((ALOG10(CHL) * STATS_ZEU.SLOPE)+STATS_ZEU.INT)

		STATS_EU = STATS2(ALOG10(CHL),ALOG10(CHL_EU),MODEL='RMA')
		CHLOR_EU = 10^((ALOG10(CHL)*STATS_EU.SLOPE)+STATS_EU.INT)
		STATS_ZEU = STATS2(ALOG10(CHLOR_EUPHOTIC),ALOG10(ZEU),MODEL='RMA')
		FIT = 10^((ALOG10(CHLOR_EUPHOTIC) * STATS_ZEU.SLOPE)+STATS_ZEU.INT)

;		PLOTXY, CHL_EU,CHLOR_EUPHOTIC,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=[3,4,8],psym=PSYM,THICK=THICK,XMARGIN=[5,5],YMARGIN=[2,2],CHARSIZE=2,$
;			YTITLE='MODELED CHL!Deu!N',XTITLE='Chlorophyll !Deu!X!N (mg m!U-2!N)',SYM_COLOR=SYM_COLOR,SYMSIZE=0.75,YRANGE=[5,300],XRANGE=[5,300],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE
;;			/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle,stats_none=stats_none

		PLOTXY,CHLOR_EUPHOTIC,ZEU,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=[3,4,8],psym=PSYM,THICK=THICK,XMARGIN=[5,5],YMARGIN=[2,2],CHARSIZE=2,/REG_NONE,STATS_NONE=STATS_NONE,$
			YTITLE='Z!Deu!N (m)',XTITLE='Chlorophyll !Deu!X!N (mg m!U-2!N)',SYM_COLOR=SYM_COLOR,SYMSIZE=0.75,YRANGE=[5,100],XRANGE=[10,300],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE
		LABEL = 'B'
		COOR = COORD_2PLOT(0.93,0.88)
		XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=2, COLOR=0, CHARTHICK=1

;
;		PLOTXY, CHLOR_EUPHOTIC,FIT,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=[3,4,8],psym=PSYM,THICK=THICK,XMARGIN=[5,5],YMARGIN=[2,2],CHARSIZE=2,XTITLE=ZTITLE,$
;			YTITLE='Modeled Z!Deu!N (m)',SYM_COLOR=SYM_COLOR,SYMSIZE=0.75,XRANGE=[5,180],YRANGE=[5,180],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,$
;			/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle,stats_none=stats_none

		STAT_ZEU = STATS2(ALOG10(ZEU),ALOG10(Z_EU2),MODEL='RMA')
		SLOPE = STAT_ZEU.SLOPE
		INT = STAT_ZEU.INT

;		PLOTXY, ZEU,CHLOR_EU,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=[4,8],psym=PSYM,THICK=THICK,XMARGIN=[5,5],YMARGIN=[2,2],CHARSIZE=2,XTITLE='Z!Deu!N',$
;			STATS_POS=[0.03,0.15],YTITLE='Chlorophyll !Deu!X!N (mg m!U-2!N)',SYM_COLOR=SYM_COLOR,SYMSIZE=0.75,XRANGE=[5,180],YRANGE=[5,300],STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,stats_none=stats_none,$
;			/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle

		COEFFS_ZEU = POLY_FIT(ALOG10(CHLOR_EUPHOTIC),ALOG10(ZEU),2,YFIT=YFIT)
		FIT = 10^(COEFFS_ZEU[0] + (COEFFS_ZEU[1]*ALOG10(CHLOR_EUPHOTIC)) + (COEFFS_ZEU(2)*ALOG10(CHLOR_EUPHOTIC)^2))
		SRT = SORT(FIT)
		OPLOT, CHLOR_EUPHOTIC(SRT), FIT(SRT), COLOR=0,THICK=REG_THICK
		ZEU_RSQ = STATS2(ZEU,YFIT,MODEL='RMA')
		COMFIT_ZEU = COMFIT(ALOG10(CHLOR_EUPHOTIC),ALOG10(ZEU),[1,1,1], /EXPONENTIAL, SIGMA=SIGMA, YFIT=YFIT)
		FIT2 = 10^((COMFIT_ZEU[0]*COMFIT_ZEU[1]^ALOG10(CHLOR_EUPHOTIC)) + COMFIT_ZEU(2))
	;	OPLOT, CHLOR_EUPHOTIC, FIT2, COLOR=12
		ZEU_RSQ2 = STATS2(ZEU,YFIT,MODEL='RMA')

;		===> Goodness of fit  GOF = TOTAL[((OBSERVEDi-EXPECTEDi)^2)/EXPECTEDi]
		EXPECTED = ZEU
		OBSERVED = MB_Zeu(CHL=CHL)
		GOF = TOTAL(((OBSERVED-EXPECTED)^2)/EXPECTED)
		EXPECTED = ZEU
		OBSERVED = ZEU2
		GOF2 = TOTAL(((OBSERVED-EXPECTED)^2)/EXPECTED)
;

		!P.MULTI=[0,1,2]
		XRANGE = [0.03,10]
		YRANGE = [0.03,10]

;		PLOTXY, AP,VGPML/1000,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=PSYM,CHARSIZE=CHARSIZE,STATS_COLOR=0,XTITLE=' ',THICK=THICK, $
;			YTITLE='Modeled Production (gC m!E-2!N d!E-1!N)',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,XRANGE=XRANGE,YRANGE=YRANGE,STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,XMARGIN=[6,2],YMARGIN=[1,1],$
;			/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=2
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=0.5
;			LABEL = 'With linear Z!Deu!E !Nmodel'
;			COOR = COORD_2PLOT(0.5,0.05)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
;			LABEL = 'A'
;			COOR = COORD_2PLOT(0.93,0.87)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=2, COLOR=0, CHARTHICK=1
;			FIGURE = 'Figure 7'
;			FIGCOOR = COORD_2PLOT(-0.1,1.10)
;;			XYOUTS, FIGCOOR.X,FIGCOOR.Y,FIGURE,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=FIGSIZE
;
;		PLOTXY, AP,VGPMB/1000,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=PSYM,CHARSIZE=CHARSIZE,XTITLE='Observed Production (gC m!E-2!N d!E-1!N)',THICK=THICK, $
;			YTITLE='Modeled Production (gC m!E-2!N d!E-1!N)',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,XRANGE=XRANGE,YRANGE=YRANGE,STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,XMARGIN=[6,2],YMARGIN=[1,1],$
;			/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=2
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=0.5
;			LABEL = 'With Morel & Berthon Z!Deu!E !Nmodel'
;			COOR = COORD_2PLOT(0.2,0.05)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
;			LABEL = 'B'
;			COOR = COORD_2PLOT(0.93,0.87)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=2, COLOR=0, CHARTHICK=1


;*********************************************************************************
;*********************************************************************************
;*********************************************************************************
;*********************************************************************************
;*********************************************************************************

		POLY_FIT_NUM = 2
		OK = WHERE(SHIP.PB_OPT NE MISSINGS(0.0) AND SHIP.SST NE MISSINGS(0.0) AND SHIP.PB_OPT LT 20 AND SHIP.YEAR GE '1998' AND SHIP.YEAR LE '2005')
		SET = SHIP[OK]
		TEMP = FINDGEN(14)*2
		PNEW = CREATE_STRUCT('TEMP',0.0,'BF_PBOPT',0.0,'AM_PBOPT',0.0,'MB_PBOPT',0.0,'BF_RATIO',0.0,'AM_RATIO',0.0,'MB_RATIO',0.0,'N',0.0,'MEAN',0.0,'MIN',0.0,'MAX',0.0,'STD',0.0,'MED',0.0, 'CV',0.0)
		PNEW = STRUCT_2MISSINGS(PNEW)
		PNEW = REPLICATE(PNEW,N_ELEMENTS(TEMP))
		FOR NTH = 0L, N_ELEMENTS(TEMP)-2 DO BEGIN
			_TEMP = TEMP[NTH]+1
			PNEW[NTH].TEMP = _TEMP
			PNEW[NTH].AM_PBOPT = 1.54*10.^(0.0275*_TEMP-0.07)
			PNEW[NTH].BF_PBOPT = (-3.27e-008 * _TEMP^7) + (3.4132e-006 * _TEMP^6) + (-1.348e-004 * _TEMP^5) + (2.462e-003 * _TEMP^4)$
          + (-0.0205 * _TEMP^3) + (0.0617 * _TEMP^2) + (0.2749 * _TEMP) + 1.2956
			OK = WHERE(SET.SST GE TEMP[NTH] AND SET.SST LT TEMP(NTH+1),COUNT)
			IF COUNT GE 1 THEN BEGIN
				PB = SET[OK].PB_OPT
				STAT = STATS(PB,/quiet)
				STA = STAT.MEAN + (2*STAT.STD)
				STB = STAT.MEAN - (2*STAT.STD)
				OK = WHERE(PB GT STB AND PB LT STA,COUNT)
				IF COUNT GE 2 THEN BEGIN
					STAT2 = STATS(PB[OK],/QUIET)
					PNEW[NTH].N			= STAT2.N
					PNEW[NTH].MEAN	=	STAT2.MEAN
					PNEW[NTH].MIN		=	STAT2.MIN
					PNEW[NTH].MAX		=	STAT2.MAX
					PNEW[NTH].STD		=	STAT2.STD
					PNEW[NTH].MED		=	STAT2.MED
					PNEW[NTH].CV		=	STAT2.CV
					PNEW[NTH].AM_RATIO = PNEW[NTH].AM_PBOPT/PNEW[NTH].MED
					PNEW[NTH].BF_RATIO = PNEW[NTH].BF_PBOPT/PNEW[NTH].MED
				ENDIF
			ENDIF	ELSE PNEW[NTH].N = 0
		ENDFOR
		OK = WHERE(PNEW.N GT 5 AND PNEW.MED NE MISSINGS(0.0))
		!P.MULTI=[0,1,2]
		_TEMP = FINDGEN(26)
		PLOT, PNEW[OK].TEMP, PNEW[OK].MED,TITLE=' ', CHARSIZE=CHARSIZE,/NODATA, XRANGE=[0,25], YRANGE=[0,10], XTITLE='Temperature (!Eo!NC)',$
			YTITLE='Median P!Eb!Dopt!N (mgC mgChl!e-1!N h!E-1!N)', XMARGIN=XMARGIN, YMARGIN=YMARGIN
		COEFFS = POLY_FIT(PNEW[OK].TEMP, PNEW[OK].MED,POLY_FIT_NUM,YFIT=YFIT, CHISQ=CHISQ,COVAR=COVAR, /DOUBLE,MEASURE_ERRORS=MEASURE_ERRORS,SIGMA=SIGMA,STATUS=STATUS,YBAND=YBAND,YERROR=YERROR)
		PRINT, COEFFS
		MB_PBMAX_POLY = COEFFLS[0] + COEFFLS[1]*PNEW[OK].TEMP + COEFFLS(2)*PNEW[OK].TEMP^2
		PNEW_AM_PBOPT = 1.54*10.^(0.0275*_TEMP-0.07)
		PNEW_BF_PBOPT = (-3.27e-008 * _TEMP^7) + (3.4132e-006 * _TEMP^6) + (-1.348e-004 * _TEMP^5) + (2.462e-003 * _TEMP^4)$
          + (-0.0205 * _TEMP^3) + (0.0617 * _TEMP^2) + (0.2749 * _TEMP) + 1.2956
    PNEW_MB_PBOPT = COEFFLS[0] + COEFFLS[1]*_TEMP + COEFFLS(2)*_TEMP^2
		OPLOT, _TEMP, PNEW_BF_PBOPT, COLOR=32,THICK=20, LINESTYLE=3
		OPLOT, _TEMP, PNEW_AM_PBOPT, COLOR=34, THICK=25
		OPLOT, _TEMP, REPLICATE(PBOPT_MB(),N_ELEMENTS(_TEMP)), COLOR=0, THICK=15
;		OPLOT, _TEMP, PNEW_MB_PBMAX, COLOR=22, THICK=15
		OPLOT, PNEW[OK].TEMP, PNEW[OK].MED, PSYM=PSYM, SYMSIZE=SYMSIZE, THICK = THICK
		ERRPLOT, PNEW[OK].TEMP, PNEW[OK].MED-PNEW[OK].STD, PNEW[OK].MED+PNEW[OK].STD, width=0.02, COLOR=0, THICK=5
;		COEFFS 			= COMFIT(PNEW[OK].TEMP, PNEW[OK].MED,[0.003,1.35,2.7],/EXPONENTIAL,YFIT=YFIT_EXP)
;		PRINT, COEFFS
;		COEFFS			= SHIFT(coeffs,1)			;Shift Coeffs_exp
;		MB_PBMAX = COEFFLS[0] + COEFFLS[1]*COEFFLS(2)^PNEW.TEMP

	;	OPLOT, PNEW[OK].TEMP, YFIT, COLOR=22, THICK=15
		ON = WHERE(SHIP.WC_PBMAX NE MISSINGS(0.0) AND SHIP.WC_PBMAX GT 0 AND SHIP.WC_PBMAX LE 25)
		STAT1 = STATS(SHIP(ON).WC_PBMAX)

		LEG_POS = [0.46,0.82,0.52,0.94]
		TXT = 'Massachusetts Bay Median'
		TXT = [TXT, 'Behrenfeld & Falkowski']
		TXT = [TXT, 'Antoine & Morel']
		COLOR = [0,32,35]
		LEG,pos = LEG_POS,LCOLOR=0, color=COLOR,label=TXT,THICK=[10,20,25],PSYM=[-3,-3,-3],LINESTYLE=[0,3,0],LSIZE=1.65, FONT=0
		FIGURE = 'Figure 8'
		FIGCOOR = COORD_2PLOT(-0.1,1.10)
;		XYOUTS, FIGCOOR.X,FIGCOOR.Y,FIGURE,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=FIGSIZE
		print, MEDIAN(pnew(ok).med)

;
;		OK = WHERE(SHIP.WC_PBMAX NE MISSINGS(0.0) AND SHIP.WC_TEMP NE MISSINGS(0.0))
;		SET = SHIP[OK]
;		TEMP = FINDGEN(26)
;		PNEW = CREATE_STRUCT('TEMP',0.0,'BF_PBMAX',0.0,'AM_PBMAX',0.0,'MB_PBMAX',0.0,'BF_RATIO',0.0,'AM_RATIO',0.0,'MB_RATIO',0.0,'N',0.0,'MEAN',0.0,'MIN',0.0,'MAX',0.0,'STD',0.0,'MED',0.0, 'CV',0.0)
;		PNEW = STRUCT_2MISSINGS(PNEW)
;		PNEW = REPLICATE(PNEW,N_ELEMENTS(TEMP))
;		FOR NTH = 0L, N_ELEMENTS(TEMP)-1 DO BEGIN
;			_TEMP = TEMP[NTH]
;			PNEW[NTH].TEMP = _TEMP
;			PNEW[NTH].AM_PbMAX = 1.54*10.^(0.0275*_TEMP-0.07)
;			PNEW[NTH].BF_PBmax = (-3.27e-008 * _TEMP^7) + (3.4132e-006 * _TEMP^6) + (-1.348e-004 * _TEMP^5) + (2.462e-003 * _TEMP^4)$
;          + (-0.0205 * _TEMP^3) + (0.0617 * _TEMP^2) + (0.2749 * _TEMP) + 1.2956
;			OK = WHERE(ROUND(SET.WC_TEMP) EQ _TEMP,COUNT)
;			IF COUNT GE 1 THEN BEGIN
;				PB = SET[OK].WC_PBMAX
;				STAT = STATS(PB,/quiet)
;				STA = STAT.MEAN + (2*STAT.STD)
;				STB = STAT.MEAN - (2*STAT.STD)
;				OK = WHERE(PB GT STB AND PB LT STA,COUNT)
;				IF COUNT GE 1 THEN BEGIN
;					STAT2 = STATS(PB[OK],/QUIET)
;					PNEW[NTH].N			= STAT2.N
;					PNEW[NTH].MEAN	=	STAT2.MEAN
;					PNEW[NTH].MIN		=	STAT2.MIN
;					PNEW[NTH].MAX		=	STAT2.MAX
;					PNEW[NTH].STD		=	STAT2.STD
;					PNEW[NTH].MED		=	STAT2.MED
;					PNEW[NTH].CV		=	STAT2.CV
;					PNEW[NTH].AM_RATIO = PNEW[NTH].AM_PBMAX/PNEW[NTH].MED
;					PNEW[NTH].BF_RATIO = PNEW[NTH].BF_PBMAX/PNEW[NTH].MED
;				ENDIF
;			ENDIF	ELSE PNEW[NTH].N = 0
;		ENDFOR
;		OK = WHERE(PNEW.N GT 5 AND PNEW.MED NE MISSINGS(0.0))
;		!P.MULTI=[0,1,2]
;		_TEMP = FINDGEN(26)
;		PLOT, PNEW[OK].TEMP, PNEW[OK].MED,TITLE=' ', CHARSIZE=CHARSIZE,/NODATA, XRANGE=[0,25], YRANGE=[0,10], XTITLE='Temperature (!Eo!NC)',$
;			YTITLE='Median P!Eb!Dmax!N (mgC mgChl!e-1!N h!E-1!N)', XMARGIN=XMARGIN, YMARGIN=YMARGIN
;		COEFFS = POLY_FIT(PNEW[OK].TEMP, PNEW[OK].MED,POLY_FIT_NUM,YFIT=YFIT, CHISQ=CHISQ,COVAR=COVAR, /DOUBLE,MEASURE_ERRORS=MEASURE_ERRORS,SIGMA=SIGMA,STATUS=STATUS,YBAND=YBAND,YERROR=YERROR)
;		PRINT, COEFFS
;		MB_PBMAX_POLY = COEFFLS[0] + COEFFLS[1]*PNEW[OK].TEMP + COEFFLS(2)*PNEW[OK].TEMP^2
;		PNEW_AM_PbMAX = 1.54*10.^(0.0275*_TEMP-0.07)
;		PNEW_BF_PBmax = (-3.27e-008 * _TEMP^7) + (3.4132e-006 * _TEMP^6) + (-1.348e-004 * _TEMP^5) + (2.462e-003 * _TEMP^4)$
;          + (-0.0205 * _TEMP^3) + (0.0617 * _TEMP^2) + (0.2749 * _TEMP) + 1.2956
;    PNEW_MB_PBMAX = COEFFLS[0] + COEFFLS[1]*_TEMP + COEFFLS(2)*_TEMP^2
;		OPLOT, _TEMP, PNEW_BF_PbMAX, COLOR=32,THICK=20, LINESTYLE=3
;		OPLOT, _TEMP, PNEW_AM_PBmax, COLOR=34, THICK=25
;		OPLOT, _TEMP, PNEW_MB_PBMAX, COLOR=22, THICK=15
;		OPLOT, PNEW[OK].TEMP, PNEW[OK].MED, PSYM=PSYM, COLOR=0, SYMSIZE=SYMSIZE, THICK = THICK
;		ERRPLOT, PNEW[OK].TEMP, PNEW[OK].MED-PNEW[OK].STD, PNEW[OK].MED+PNEW[OK].STD, width=0.02, COLOR=0, THICK=5
;;		COEFFS 			= COMFIT(PNEW[OK].TEMP, PNEW[OK].MED,[0.003,1.35,2.7],/EXPONENTIAL,YFIT=YFIT_EXP)
;;		PRINT, COEFFS
;;		COEFFS			= SHIFT(coeffs,1)			;Shift Coeffs_exp
;;		MB_PBMAX = COEFFLS[0] + COEFFLS[1]*COEFFLS(2)^PNEW.TEMP
;		OPLOT, PNEW[OK].TEMP, REPLICATE(MED(PNEW[OK].MED),N_ELEMENTS(OK)), COLOR=0, THICK=15
;
;	;	OPLOT, PNEW[OK].TEMP, YFIT, COLOR=22, THICK=15
;		ON = WHERE(SHIP.WC_PBMAX NE MISSINGS(0.0) AND SHIP.WC_PBMAX GT 0 AND SHIP.WC_PBMAX LE 25)
;		STAT1 = STATS(SHIP(ON).WC_PBMAX)
;
;		LEG_POS = [0.46,0.84,0.52,0.95]
;		TXT = 'Massachusetts Bay'
;		TXT = [TXT, 'Behrenfeld & Falkowski']
;		TXT = [TXT, 'Antoine & Morel']
;		COLOR = [0,32,35]
;		LEG,pos = LEG_POS,LCOLOR=0, color=COLOR,label=TXT,THICK=[10,20,25],PSYM=[-8,-3,-3],LINESTYLE=[0,3,0],LSIZE=1.75, FONT=0
;		FIGURE = 'Figure 8'
;		FIGCOOR = COORD_2PLOT(-0.1,1.10)
;;		XYOUTS, FIGCOOR.X,FIGCOOR.Y,FIGURE,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=FIGSIZE
;		print, med(pnew(ok).med)
;
;
;
;
;;||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
;;||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
;;||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
;;||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
;
;		OK = WHERE(SHIP.WC_PBMAX NE MISSINGS(0.0) AND SHIP.WC_TEMP NE MISSINGS(0.0) AND SHIP.WC_TEMP GT 0.0 AND SHIP.WT_CHL NE MISSINGS(0.0) AND SHIP.PER_PHAEOCYSTIS EQ 0)
;		SET = SHIP[OK]
;		TEMP = FINDGEN(13)*2
;		COLORS = [5,22,12,9,20,2,28,16]
;		CHL = 10^[-2,-0.5,0,0.5,1,1.5]
;		CHL = [-0.1,0.75,64]
;		TXT = ['0.01','0.75','32']
;		PNEW = CREATE_STRUCT('TEMP_LOW',0.0,'TEMP_HIGH',0.0,'CHL_LOW',0.0,'CHL_HIGH',0.0,'MED_CHL',0.0,'N',0.0,'MEAN',0.0,'MIN',0.0,'MAX',0.0,'STD',0.0,'MED',0.0, 'CV',0.0)
;		PNEW = STRUCT_2MISSINGS(PNEW) & PNEW = REPLICATE(PNEW,N_ELEMENTS(TEMP)*N_ELEMENTS(CHL))
;
;		COUNTER = 0
;		FOR NTH = 0L, N_ELEMENTS(TEMP)-2 DO BEGIN
;			_TEMP_LOW = TEMP[NTH]
;			_TEMP_HIGH = TEMP(NTH+1)
;			FOR STH = 0L, N_ELEMENTS(CHL)-2 DO BEGIN
;				CHL_LOW = CHL(STH)
;				CHL_HG  = CHL(STH+1)
;				PNEW(COUNTER).TEMP_LOW = _TEMP_LOW
;				PNEW(COUNTER).TEMP_HIGH = _TEMP_HIGH
;				PNEW(COUNTER).CHL_LOW = CHL_LOW
;				PNEW(COUNTER).CHL_HIGH = CHL_HG
;				OK = WHERE(SET.WC_TEMP GE _TEMP_LOW AND SET.WC_TEMP LT _TEMP_HIGH AND SET.WT_CHL GE CHL_LOW AND SET.WT_CHL LT CHL_HG ,COUNT)
;				IF COUNT GE 1 THEN BEGIN
;					STAT_CHL = STATS(ALOG(SET[OK].WT_CHL))
;					PNEW(COUNTER).MED_CHL = EXP(STAT_CHL.MED)
;					PB = SET[OK].WC_PBMAX
;					STAT = STATS(PB,/quiet)
;					STA = STAT.MEAN + (2*STAT.STD)
;					STB = STAT.MEAN - (2*STAT.STD)
;					OK = WHERE(PB GT STB AND PB LT STA,COUNT)
;					IF COUNT GE 1 THEN BEGIN
;						STAT2 = STATS(PB[OK],/QUIET)
;						PNEW(COUNTER).N			= STAT2.N
;						PNEW(COUNTER).MEAN	=	STAT2.MEAN
;						PNEW(COUNTER).MIN		=	STAT2.MIN
;						PNEW(COUNTER).MAX		=	STAT2.MAX
;						PNEW(COUNTER).STD		=	STAT2.STD
;						PNEW(COUNTER).MED		=	STAT2.MED
;						PNEW(COUNTER).CV		=	STAT2.CV
;					ENDIF
;				ENDIF	ELSE PNEW(COUNTER).N = 0
;;				IF _TEMP EQ 0 THEN BEGIN
;;					PNEW(COUNTER).MED = 1
;;					PNEW(COUNTER).N = 3
;;				ENDIF
;				COUNTER = COUNTER + 1
;			ENDFOR
;		ENDFOR
;
;		!P.MULTI = [0,1,3]
;		POLY_FIT_NUM = 2
;		COEFFS_STRUCT = CREATE_STRUCT('CHL_LOW',0.0,'CHL_HIGH',0.0,'CHL_MED',0.0,'N',0L,'PB_MED',0.0,'A_COEFF',0.0,'B_COEFF',0.0,'C_COEFF',0.0)
;		COEFFS_STRUCT = REPLICATE(COEFFS_STRUCT,N_ELEMENTS(CHL)-1)
;		COEFFS_STRUCT = STRUCT_2MISSINGS(COEFFS_STRUCT)
;		_TEMP = TEMP+1
;		FOR STH = 0L, N_ELEMENTS(CHL)-2 DO BEGIN
;			OK = WHERE(PNEW.CHL_LOW EQ CHL(STH) AND PNEW.MED NE MISSINGS(0.0) AND PNEW.N GE 2,COUNT)
;			COEFFS_STRUCT(STH).CHL_LOW 	= CHL(STH)
;			COEFFS_STRUCT(STH).CHL_HIGH = CHL(STH+1)
;			COEFFS_STRUCT(STH).N = TOTAL(PNEW[OK].N)
;			IF COUNT GE 2 THEN BEGIN
;				PLOT, [0,20], PNEW.MED,TITLE=' ', CHARSIZE=2,/NODATA, XRANGE=[0,20], YRANGE=[0,10], XTITLE='Temperature (!Eo!NC)',$
;					YTITLE='Median P!Eb!Dmax!N (mgC mgChl!e-1!N h!E-1!N)', XMARGIN=XMARGIN, YMARGIN=YMARGIN
;				STAT_CHL = STATS(ALOG(PNEW[OK].MED_CHL))
;				MED_CHL = EXP(STAT_CHL.MED)
;				COEFFS_STRUCT(STH).CHL_MED = MED_CHL
;				COEFFS_STRUCT(STH).PB_MED = MED(PNEW[OK].MED)
;				OPLOT, PNEW[OK].TEMP_LOW+1, PNEW[OK].MED, PSYM=2, COLOR=COLORS(STH), SYMSIZE=SYMSIZE, THICK = THICK
;				ERRPLOT, PNEW[OK].TEMP_LOW+1, PNEW[OK].MED-PNEW[OK].STD, PNEW[OK].MED+PNEW[OK].STD, width=0.02, COLOR=COLORS(STH), THICK=5
;				PB   = (0.071*_TEMP -3.2e-3*_TEMP^2 + 3.0E-5*_TEMP^3)/MED_CHL + (1.0 + 0.17*_TEMP - 2.5e-3*_TEMP^2 - 8.0e-5*_TEMP^3)
;				OPLOT, _TEMP, PB, COLOR=0, THICK = 12
;				COEFFS = POLY_FIT(PNEW[OK].TEMP_LOW+1, PNEW[OK].MED,POLY_FIT_NUM,YFIT=YFIT, CHISQ=CHISQ,COVAR=COVAR, /DOUBLE,MEASURE_ERRORS=MEASURE_ERRORS,SIGMA=SIGMA,STATUS=STATUS,YBAND=YBAND,YERROR=YERROR)
;				PRINT, COEFFS
;				COEFFS_STRUCT(STH).A_COEFF = COEFFLS[0]
;				COEFFS_STRUCT(STH).B_COEFF = COEFFLS[1]
;				COEFFS_STRUCT(STH).C_COEFF = COEFFLS(2)
;				MB_PBMAX = COEFFLS[0] + COEFFLS[1]*PNEW[OK].TEMP_LOW+1 + COEFFLS(2)*PNEW[OK].TEMP_LOW+1^2
;				OPLOT, PNEW[OK].TEMP_LOW+1, YFIT, COLOR=COLORS(STH), THICK=15
;;				OPLOT, PNEW[OK].TEMP, REPLICATE(MED(PNEW[OK].MED),N_ELEMENTS(OK)), COLOR=0, THICK=5, LINESTYLE=3
;				YFIT_STATS = STATS2(PNEW[OK].MED, YFIT, MODEL='RMA')
;				_TXT = ' N = ' + NUM2STR(ROUND(TOTAL(COEFFS_STRUCT(STH).N))) + '!C R!E2!N = ' + STRMID(NUM2STR(YFIT_STATS.RSQ),0,5) + $
;							'!C Chl: ' + TXT(STH) + ' - ' + TXT(STH+1) + '!C (Mean Chl = ' + STRMID(NUM2STR(MED_CHL),0,4) + ')'
;				COOR = COORD_2PLOT(0.02,0.9)
;				XYOUTS, COOR.X,COOR.Y,_TXT,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=FIGSIZE
;				IF POLY_FIT_NUM EQ 2 THEN _TXT = 'YFIT = ' + STRMID(NUM2STR(COEFFLS[0]),0,5) + ' + ' +  STRMID(NUM2STR(COEFFLS[1]),0,5) + 'x ' + ' + ' $
;							 + STRMID(NUM2STR(COEFFLS(2)),0,7) + 'x!E2!N '
;				IF POLY_FIT_NUM EQ 3 THEN _TXT = 'YFIT = ' + STRMID(NUM2STR(COEFFLS[0]),0,5) + ' + ' +  STRMID(NUM2STR(COEFFLS[1]),0,5) + 'x ' + ' + ' $
;							 + STRMID(NUM2STR(COEFFLS(2)),0,7) + 'x!E2!N ' + STRMID(NUM2STR(COEFFLS(3)),0,5) + 'x!E3!N '
;				COOR = COORD_2PLOT(0.2,0.05)
;				XYOUTS, COOR.X,COOR.Y,_TXT,/DATA,ALIGN=0.0,CHARSIZE=FIGSIZE, COLOR=COLORS(STH)
;			ENDIF
;		ENDFOR
;
;		TT = FINDGEN(26)
;		YFIT1 = COEFFS_STRUCT[0].A_COEFF + (COEFFS_STRUCT[0].B_COEFF * TT) + (COEFFS_STRUCT[0].C_COEFF*TT^2)
;		YFIT2 = COEFFS_STRUCT[1].A_COEFF + (COEFFS_STRUCT[1].B_COEFF * TT) + (COEFFS_STRUCT[1].C_COEFF*TT^2)
;		;YFIT3 = COEFFS_STRUCT(2).A_COEFF + (COEFFS_STRUCT(2).B_COEFF * TT) + (COEFFS_STRUCT(2).C_COEFF*TT^2)
;		OPLOT, TT, YFIT1, COLOR=5, THICK=5
;		OPLOT, TT, YFIT2, COLOR=22, THICK=5
;		;OPLOT, TT, YFIT3, COLOR=12, THICK=5, LINESTYLE=2
;
;		TT =  FINDGEN(20)+2
;		CC = [0.75,0.80,0.85,0.90,0.95,1.00,1.05,1.10,1.15,1.20,1.25,1.30,1.35,1.40,1.45,1.50,1.55,1.60,1.65,1.70,1.75,1.80,1.85,1.90,1.95,2.00]
;		COLORS = FINDGEN(26)+1
;		CBLEND = FINDGEN(12600)/10000+0.75
;		PBMODEL2 = COEFFS_STRUCT[0].A_COEFF + (COEFFS_STRUCT[0].B_COEFF * TT) + (COEFFS_STRUCT[0].C_COEFF*TT^2)
;		PBMODMED = REPLICATE(COEFFS_STRUCT[1].PB_MED,N_ELEMENTS(TT))
;		PBBLEND = BLEND(CBLEND)
;		PLOT, [0,20], [0,10],TITLE=' ', CHARSIZE=2,/NODATA, XRANGE=[0,20], YRANGE=[0,6], XTITLE='Temperature (!Eo!NC)',$
;			YTITLE='Median P!Eb!Dmax!N (mgC mgChl!e-1!N h!E-1!N)', XMARGIN=XMARGIN, YMARGIN=YMARGIN
;		OPLOT, TT, PBMODEL2, COLOR=5, THICK=10
;		OPLOT, TT, PBMODMED, COLOR=22, THICK=10
;		FOR NTH = 0L, N_ELEMENTS(CC)-1 DO BEGIN
;			OK = WHERE(FLOAT(CBLEND) EQ FLOAT(CC[NTH]))
;			W1 = REPLICATE(1-PBBLEND[OK],N_ELEMENTS(PBMODEL2))
;			W2 = REPLICATE(PBBLEND[OK],N_ELEMENTS(PBMODEL2))
;			PBNEW = (PBMODEL2*W1) + (PBMODMED*W2)
;			OPLOT, TT, PBNEW, COLOR=COLORS[NTH], THICK=2
;		ENDFOR
;
;		A1 = (COEFFS_STRUCT[0].A_COEFF - COEFFS_STRUCT[1].A_COEFF) * COEFFS_STRUCT[0].CHL_MED
;		B1 = (COEFFS_STRUCT[0].B_COEFF - COEFFS_STRUCT[1].B_COEFF) * COEFFS_STRUCT[0].CHL_MED
;		C1 = (COEFFS_STRUCT[0].C_COEFF - COEFFS_STRUCT[1].C_COEFF) * COEFFS_STRUCT[0].CHL_MED
;		A2 =  COEFFS_STRUCT[1].A_COEFF
;		B2 =  COEFFS_STRUCT[1].B_COEFF
;		C2 =  COEFFS_STRUCT[1].C_COEFF
;		PBMAX_MODEL_75 = ((A1 + (B1*TT) + (C1*TT^2))/0.75) + A2 + (B2*TT) + (C2*TT^2)
;		PBMAX_MODEL_2  = ((A1 + (B1*TT) + (C1*TT^2))/2.00) + A2 + (B2*TT) + (C2*TT^2)
;		OPLOT, TT, PBMAX_MODEL_75, COLOR = 0, THICK = 4, LINESTYLE=2
;		OPLOT, TT, PBMAX_MODEL_2,  COLOR = 0, THICK = 4, LINESTYLE=2
;
;
;
;
;
;		!P.MULTI = [0,1,3]
;		PLOTXY, COEFFS_STRUCT.CHL_LOW,COEFFS_STRUCT.A_COEFF,DECIMALS=3,/QUIET,MODEL='RMA',PARAMS=[3,4,8],psym=PSYM,THICK=THICK,XMARGIN=[4,4],YMARGIN=[2,2],CHARSIZE=3,XTITLE=' ',$
;			STATS_POS=[0.8,0.3],YTITLE='COEFFS-A',SYM_COLOR=SYM_COLOR,SYMSIZE=2.5,STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE
;		COEFFS = POLY_FIT(COEFFS_STRUCT.CHL_LOW,COEFFS_STRUCT.A_COEFF,POLY_FIT_NUM,YFIT=YFIT, CHISQ=CHISQ,COVAR=COVAR, /DOUBLE,MEASURE_ERRORS=MEASURE_ERRORS,SIGMA=SIGMA,STATUS=STATUS,YBAND=YBAND,YERROR=YERROR)
;		OPLOT, COEFFS_STRUCT.CHL_LOW, YFIT, COLOR=22, THICK=10
;		 _TXT = 'YFIT = ' + STRMID(NUM2STR(COEFFLS[0]),0,5) + ' + ' +  STRMID(NUM2STR(COEFFLS[1]),0,5) + 'x ' + ' + ' $
;							 + STRMID(NUM2STR(COEFFLS(2)),0,5) + 'x!E2!N '
;		COOR = COORD_2PLOT(0.2,0.05)
;		XYOUTS, COOR.X,COOR.Y,_TXT,/DATA,ALIGN=0.0,CHARSIZE=FIGSIZE, COLOR=22
;		LABEL = 'A - COEFF'
;		COOR = COORD_2PLOT(0.02,0.88)
;		XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;		PLOTXY, COEFFS_STRUCT.CHL_LOW,COEFFS_STRUCT.B_COEFF,DECIMALS=3,/QUIET,MODEL='RMA',PARAMS=[3,4,8],psym=PSYM,THICK=THICK,XMARGIN=[4,4],YMARGIN=[2,2],CHARSIZE=3,XTITLE=' ',$
;			STATS_POS=[0.8,0.95],YTITLE='COEFFS-B',SYM_COLOR=SYM_COLOR,SYMSIZE=2.5,STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE
;		COEFFS = POLY_FIT(COEFFS_STRUCT.CHL_LOW,COEFFS_STRUCT.B_COEFF,POLY_FIT_NUM,YFIT=YFIT, CHISQ=CHISQ,COVAR=COVAR, /DOUBLE,MEASURE_ERRORS=MEASURE_ERRORS,SIGMA=SIGMA,STATUS=STATUS,YBAND=YBAND,YERROR=YERROR)
;		OPLOT, COEFFS_STRUCT.CHL_LOW, YFIT, COLOR=22, THICK=10
;		 _TXT = 'YFIT = ' + STRMID(NUM2STR(COEFFLS[0]),0,5) + ' + ' +  STRMID(NUM2STR(COEFFLS[1]),0,5) + 'x ' + ' + ' $
;							 + STRMID(NUM2STR(COEFFLS(2)),0,5) + 'x!E2!N '
;		COOR = COORD_2PLOT(0.2,0.05)
;		XYOUTS, COOR.X,COOR.Y,_TXT,/DATA,ALIGN=0.0,CHARSIZE=FIGSIZE, COLOR=22
;		LABEL = 'B - COEFF'
;		COOR = COORD_2PLOT(0.02,0.88)
;		XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;		PLOTXY, COEFFS_STRUCT.CHL_LOW,COEFFS_STRUCT.C_COEFF,DECIMALS=3,/QUIET,MODEL='RMA',PARAMS=[3,4,8],psym=PSYM,THICK=THICK,XMARGIN=[4,4],YMARGIN=[2,2],CHARSIZE=3,XTITLE=CTITLE,$
;			STATS_POS=[0.8,0.3],YTITLE='COEFFS-C',SYM_COLOR=SYM_COLOR,SYMSIZE=2.5,STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE
;		COEFFS = POLY_FIT(COEFFS_STRUCT.CHL_LOW,COEFFS_STRUCT.C_COEFF,POLY_FIT_NUM,YFIT=YFIT, CHISQ=CHISQ,COVAR=COVAR, /DOUBLE,MEASURE_ERRORS=MEASURE_ERRORS,SIGMA=SIGMA,STATUS=STATUS,YBAND=YBAND,YERROR=YERROR)
;		OPLOT, COEFFS_STRUCT.CHL_LOW, YFIT, COLOR=22, THICK=10
;		 _TXT = 'YFIT = ' + STRMID(NUM2STR(COEFFLS[0]),0,5) + ' + ' +  STRMID(NUM2STR(COEFFLS[1]),0,5) + 'x ' + ' + ' $
;							 + STRMID(NUM2STR(COEFFLS(2)),0,5) + 'x!E2!N '
;		COOR = COORD_2PLOT(0.2,0.05)
;		XYOUTS, COOR.X,COOR.Y,_TXT,/DATA,ALIGN=0.0,CHARSIZE=FIGSIZE, COLOR=22
;		LABEL = 'C - COEFF'
;		COOR = COORD_2PLOT(0.02,0.88)
;		XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;
;
;
;
;
;
;
;;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;
;
;		OK = WHERE(SHIP.WC_PBMAX NE MISSINGS(0.0) AND SHIP.WC_TEMP NE MISSINGS(0.0) AND SHIP.WT_CHL NE MISSINGS(0.0))
;		SET = SHIP[OK]
;		TEMP = FINDGEN(26)
;		COLORS = [5,22]
;		CHL = [0.01,1,64]
;		TXT = ['0.01','1','20']
;		PNEW = CREATE_STRUCT('TEMP',0.0,'CHL_LOW',0.0,'CHL_HIGH',0.0,'MEAN_CHL',0.0,'PBMAX',0.0,'N',0.0,'MEAN',0.0,'MIN',0.0,'MAX',0.0,'STD',0.0,'MED',0.0, 'CV',0.0)
;		PNEW = STRUCT_2MISSINGS(PNEW) & PNEW = REPLICATE(PNEW,N_ELEMENTS(TEMP)*N_ELEMENTS(CHL))
;		COUNTER = 0
;		FOR NTH = 0L, N_ELEMENTS(TEMP)-1 DO BEGIN
;			_TEMP = TEMP[NTH]
;			FOR STH = 0L, N_ELEMENTS(CHL)-2 DO BEGIN
;				CHL_LOW = CHL(STH)
;				CHL_HG  = CHL(STH+1)
;				PNEW(COUNTER).TEMP = _TEMP
;				PNEW(COUNTER).CHL_LOW = CHL_LOW
;				PNEW(COUNTER).CHL_HIGH = CHL_HG
;				OK = WHERE(ROUND(SET.WC_TEMP) EQ _TEMP AND SET.WT_CHL GE CHL_LOW AND SET.WT_CHL LT CHL_HG ,COUNT)
;				IF COUNT GE 1 THEN BEGIN
;					STAT_CHL = STATS(ALOG(SET[OK].WT_CHL))
;					PNEW(COUNTER).MEAN_CHL = EXP(STAT_CHL.MEAN)
;					PB = SET[OK].WC_PBMAX
;					STAT = STATS(PB,/quiet)
;					STA = STAT.MEAN + (2*STAT.STD)
;					STB = STAT.MEAN - (2*STAT.STD)
;					OK = WHERE(PB GT STB AND PB LT STA,COUNT)
;					IF COUNT GE 1 THEN BEGIN
;						STAT2 = STATS(PB[OK],/QUIET)
;						PNEW(COUNTER).N			= STAT2.N
;						PNEW(COUNTER).MEAN	=	STAT2.MEAN
;						PNEW(COUNTER).MIN		=	STAT2.MIN
;						PNEW(COUNTER).MAX		=	STAT2.MAX
;						PNEW(COUNTER).STD		=	STAT2.STD
;						PNEW(COUNTER).MED		=	STAT2.MED
;						PNEW(COUNTER).CV		=	STAT2.CV
;					ENDIF
;				ENDIF	ELSE PNEW(COUNTER).N = 0
;				COUNTER = COUNTER + 1
;			ENDFOR
;		ENDFOR
;
;		!P.MULTI = [0,1,2]
;		FOR STH = 0L, N_ELEMENTS(CHL)-2 DO BEGIN
;			OK = WHERE(PNEW.CHL_LOW EQ CHL(STH) AND PNEW.MED NE MISSINGS(0.0),COUNT)
;			IF COUNT GE 3 THEN BEGIN
;				STAT_CHL = STATS(ALOG(PNEW[OK].MEAN_CHL))
;				MEAN_CHL = EXP(STAT_CHL.MEAN)
;				PLOT, PNEW.TEMP, PNEW.MED,TITLE=' ', CHARSIZE=2,/NODATA, XRANGE=[0,25], YRANGE=[0,10], XTITLE='Temperature (!Eo!NC)',$
;					YTITLE='Median P!Eb!Dmax!N (mgC mgChl!e-1!N h!E-1!N)', XMARGIN=XMARGIN, YMARGIN=YMARGIN
;				OPLOT, PNEW[OK].TEMP, PNEW[OK].MED, PSYM=2, COLOR=COLORS(STH), SYMSIZE=SYMSIZE, THICK = THICK
;			;	ERRPLOT, PNEW[OK].TEMP, PNEW[OK].MED-PNEW[OK].STD, PNEW[OK].MED+PNEW[OK].STD, width=0.02, COLOR=COLORS(STH), THICK=5
;;				IF STH EQ 0L THEN PB   = (0.071*TEMP -3.2e-3*TEMP^2 + 3.0E-5*TEMP^3)/0.05 + (1.0 + 0.17*TEMP - 2.5e-3*TEMP^2 - 8.0e-5*TEMP^3)
;;				IF STH EQ 1L THEN PB   = (0.071*TEMP -3.2e-3*TEMP^2 + 3.0E-5*TEMP^3)/0.5 + (1.0 + 0.17*TEMP - 2.5e-3*TEMP^2 - 8.0e-5*TEMP^3)
;;				IF STH EQ 2L THEN PB   = (0.071*TEMP -3.2e-3*TEMP^2 + 3.0E-5*TEMP^3)/7.5 + (1.0 + 0.17*TEMP - 2.5e-3*TEMP^2 - 8.0e-5*TEMP^3)
;				PB   = (0.071*TEMP -3.2e-3*TEMP^2 + 3.0E-5*TEMP^3)/MEAN_CHL + (1.0 + 0.17*TEMP - 2.5e-3*TEMP^2 - 8.0e-5*TEMP^3)
;				OPLOT, TEMP, PB, COLOR=0, THICK = 12
;				COEFFS = POLY_FIT(PNEW[OK].TEMP, PNEW[OK].MED,POLY_FIT_NUM,YFIT=YFIT, CHISQ=CHISQ,COVAR=COVAR, /DOUBLE,MEASURE_ERRORS=MEASURE_ERRORS,SIGMA=SIGMA,STATUS=STATUS,YBAND=YBAND,YERROR=YERROR)
;				PRINT, COEFFS
;				MB_PBMAX = COEFFLS[0] + COEFFLS[1]*PNEW[OK].TEMP + COEFFLS(2)*PNEW[OK].TEMP^2
;				OPLOT, PNEW[OK].TEMP, YFIT, COLOR=COLORS(STH), THICK=15
;				OPLOT, PNEW[OK].TEMP, REPLICATE(MED(PNEW[OK].MED),N_ELEMENTS(OK)), COLOR=0, THICK=5, LINESTYLE=3
;				_TXT = ' N = ' + NUM2STR(ROUND(TOTAL(PNEW[OK].N))) + '!C Chl: ' + TXT(STH) + ' - ' + TXT(STH+1) + '!C (Mean Chl = ' + STRMID(NUM2STR(MEAN_CHL),0,4) + ')'
;				COOR = COORD_2PLOT(0.02,0.9)
;				XYOUTS, COOR.X,COOR.Y,_TXT,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=FIGSIZE
;				IF POLY_FIT_NUM EQ 2 THEN _TXT = 'YFIT = ' + STRMID(NUM2STR(COEFFLS[0]),0,5) + ' + ' +  STRMID(NUM2STR(COEFFLS[1]),0,5) + 'x ' + ' + ' $
;							 + STRMID(NUM2STR(COEFFLS(2)),0,5) + 'x!E2!N '
;				IF POLY_FIT_NUM EQ 3 THEN _TXT = 'YFIT = ' + STRMID(NUM2STR(COEFFLS[0]),0,5) + ' + ' +  STRMID(NUM2STR(COEFFLS[1]),0,5) + 'x ' + ' + ' $
;							 + STRMID(NUM2STR(COEFFLS(2)),0,5) + 'x!E2!N ' + STRMID(NUM2STR(COEFFLS(3)),0,5) + 'x!E3!N '
;				COOR = COORD_2PLOT(0.2,0.05)
;				XYOUTS, COOR.X,COOR.Y,_TXT,/DATA,ALIGN=0.0,CHARSIZE=FIGSIZE, COLOR=COLORS(STH)
;			ENDIF
;		ENDFOR
;
;;		OK = WHERE(PNEW.N GT 5 AND PNEW.MED NE MISSINGS(0.0))
;;		!P.MULTI=[0,1,2]
;;		PLOT, PNEW[OK].TEMP, PNEW[OK].MED,TITLE=' ', CHARSIZE=CHARSIZE,/NODATA, XRANGE=[0,25], YRANGE=[0,10], XTITLE='Temperature (!Eo!NC)',$
;;			YTITLE='Median P!Eb!Dmax!N (mgC mgChl!e-1!N h!E-1!N)', XMARGIN=XMARGIN, YMARGIN=YMARGIN
;;		OPLOT, PNEW[OK].TEMP, PNEW[OK].MED, PSYM=PSYM, COLOR=0, SYMSIZE=SYMSIZE, THICK = THICK
;;		ERRPLOT, PNEW[OK].TEMP, PNEW[OK].MED-PNEW[OK].STD, PNEW[OK].MED+PNEW[OK].STD, width=0.02, COLOR=0, THICK=5
;;		COEFFS 			= COMFIT(PNEW[OK].TEMP, PNEW[OK].MED,[0.003,1.35,2.7],/EXPONENTIAL,YFIT=YFIT_EXP)
;;		PRINT, COEFFS
;;		COEFFS			= SHIFT(coeffs,1)			;Shift Coeffs_exp
;;		MB_PBMAX = COEFFLS[0] + COEFFLS[1]*COEFFLS(2)^PNEW.TEMP
;;		OPLOT, PNEW[OK].TEMP, REPLICATE(med(PNEW[OK].MED),N_ELEMENTS(OK)), COLOR=0, THICK=15
;;		ON = WHERE(SHIP.WC_PBMAX NE MISSINGS(0.0) AND SHIP.WC_PBMAX GT 0 AND SHIP.WC_PBMAX LE 25)
;;		STAT1 = STATS(SHIP(ON).WC_PBMAX)
;;		OPLOT, PNEW.TEMP, PNEW.BF_PBMAX, COLOR=32,THICK=20, LINESTYLE=3
;;		OPLOT, PNEW.TEMP, PNEW.AM_PBMAX, COLOR=34, THICK=25
;;		LEG_POS = [0.46,0.84,0.52,0.95]
;;		TXT = 'Massachusetts Bay'
;;		TXT = [TXT, 'Behrenfeld & Falkowski']
;;		TXT = [TXT, 'Antoine & Morel']
;;		COLOR = [0,32,35]
;;		LEG,pos = LEG_POS,LCOLOR=0, color=COLOR,label=TXT,THICK=[10,20,25],PSYM=[-8,-3,-3],LINESTYLE=[0,3,0],LSIZE=1.75, FONT=0
;;		FIGURE = 'Figure 8'
;;		FIGCOOR = COORD_2PLOT(-0.1,1.10)
;;;		XYOUTS, FIGCOOR.X,FIGCOOR.Y,FIGURE,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=FIGSIZE
;;		print, med(pnew(ok).med)
;
;
;		!P.MULTI = [0,1,2]
;		TEMP = FINDGEN(31)
;		COLORS = [0,4,5,9,12,16,19,22]
;		CHL = [0.1,0.2,0.5,1,2,5,10,15]
;		COUNTER = 0
;		POLY_FIT_NUM = 2
;		COEFFS_STRUCT2 = CREATE_STRUCT('CHL',0.0,'A_COEFF',0.0,'B_COEFF',0.0,'C_COEFF',0.0,'D_COEFF',0.0)
;		COEFFS_STRUCT2 = REPLICATE(COEFFS_STRUCT2,N_ELEMENTS(CHL))
;		COEFFS_STRUCT2 = STRUCT_2MISSINGS(COEFFS_STRUCT2)
;
;		PLOT, [0,30], [0,10],TITLE=' ', CHARSIZE=CHARSIZE,/NODATA, XRANGE=[0,30], YRANGE=[0,10], XTITLE='Temperature (!Eo!NC)',$
;			YTITLE='Median P!Eb!Dmax!N (mgC mgChl!e-1!N h!E-1!N)', XMARGIN=XMARGIN, YMARGIN=YMARGIN
;		FOR NTH = 0L, N_ELEMENTS(CHL)-1 DO BEGIN
;			_CHL = CHL[NTH]
;			PB   = (0.071*TEMP -3.2e-3*TEMP^2 + 3.0E-5*TEMP^3)/_CHL + (1.0 + 0.17*TEMP - 2.5e-3*TEMP^2 - 8.0e-5*TEMP^3)
;			COEFFS_STRUCT2[NTH].CHL 	= _CHL
;			COEFFS = POLY_FIT(TEMP, PB,3,YFIT=YFIT, CHISQ=CHISQ,COVAR=COVAR, /DOUBLE,MEASURE_ERRORS=MEASURE_ERRORS,SIGMA=SIGMA,STATUS=STATUS,YBAND=YBAND,YERROR=YERROR)
;			YFIT1 = COEFFLS[0] + (COEFFLS[1] * TEMP) + (COEFFLS(2)*TEMP^2) + (COEFFLS(3)*TEMP^3)
;			OPLOT, TEMP, YFIT1, COLOR=COLORS[NTH], THICK=5, LINESTYLE=2
;			OPLOT, TEMP, PB, PSYM=(-1*PSYM), COLOR=COLORS[NTH], SYMSIZE=0.5, THICK = 2
;			PRINT, COEFFS
;			COEFFS_STRUCT2[NTH].A_COEFF = COEFFLS[0]
;			COEFFS_STRUCT2[NTH].B_COEFF = COEFFLS[1]
;			COEFFS_STRUCT2[NTH].C_COEFF = COEFFLS(2)
;			COEFFS_STRUCT2[NTH].D_COEFF = COEFFLS(3)
;		ENDFOR
;		LEG_POS = [0.01,0.54,0.07,0.95]
;		TXT = ['0.1','0.2','0.5','1','2','5','10','15']
;		LEG,pos = LEG_POS,LCOLOR=0, color=COLORS,label=TXT,THICK=3,PSYM=-1*PSYM,LSIZE=1.5, FONT=0
;
;		!P.MULTI = [0,2,3]
;		TEMP = FINDGEN(31)
;		COLORS = [2,5,9,12,16,22]
;		CHL = [0.1,0.5,1,2,5,10,20]
;		TXT = ['0.1','0.5','1','2','5','10','20']
;		PNEW = CREATE_STRUCT('TEMP',0.0,'CHL_LOW',0.0,'CHL_HIGH',0.0,'PBMAX',0.0,'N',0.0,'MEAN',0.0,'MIN',0.0,'MAX',0.0,'STD',0.0,'MED',0.0, 'CV',0.0)
;		PNEW = STRUCT_2MISSINGS(PNEW) & PNEW = REPLICATE(PNEW,N_ELEMENTS(TEMP)*N_ELEMENTS(CHL))
;		COUNTER = 0
;		FOR NTH = 0L, N_ELEMENTS(CHL)-2 DO BEGIN
;			PLOT, [0,25], [0,10],TITLE=' ', CHARSIZE=CHARSIZE,/NODATA, XRANGE=[0,30], YRANGE=[0,10], XTITLE='Temperature (!Eo!NC)',$
;			YTITLE='P!Eb!Dmax!N (mgC mgChl!e-1!N h!E-1!N)', XMARGIN=XMARGIN, YMARGIN=YMARGIN
;			_CHL1 = CHL[NTH]
;			_CHL2 = CHL(NTH+1)
;			_CHL  = 10^(MEAN(ALOG10([_CHL1,_CHL2])))
;			PB   = (0.071*TEMP -3.2e-3*TEMP^2 + 3.0E-5*TEMP^3)/_CHL + (1.0 + 0.17*TEMP - 2.5e-3*TEMP^2 - 8.0e-5*TEMP^3)
;			OPLOT, TEMP, PB, PSYM=-3, COLOR=COLORS[NTH], SYMSIZE=0.5, THICK = 5
;			OK = WHERE(SHIP.WC_PBMAX NE MISSINGS(0.0) AND SHIP.WC_TEMP NE MISSINGS(0.0) AND SHIP.WT_CHL GE _CHL1 AND SHIP.WT_CHL LT _CHL2,COUNT)
;			IF COUNT GE 2 THEN OPLOT, SHIP[OK].WC_TEMP, SHIP[OK].WC_PBMAX, PSYM=PSYM, COLOR=COLORS[NTH], SYMSIZE=1.5
;			_TXT = 'Chl: ' + TXT[NTH] + ' - ' + TXT(NTH+1)
;			COOR = COORD_2PLOT(0.1,0.9)
;			XYOUTS, COOR.X,COOR.Y,_TXT,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=FIGSIZE
;		ENDFOR


		;XTICKNAME = REPLICATE(' ',N_ELEMENTS(AX.TICKNAME))
		COLORS = [0,31]
		THICKS = [3,3]
 		SYMS = [-8,-2]
 		LINES = [0,0]
 		LCOLOR = [0,0]
 		BOX = [36,0,2]
 		LEG_POS = [0.02 ,0.81,0.06,0.89]
 		STATION = 'N04'

		OK 			= WHERE(SHIP.AREAL_PROD_ZEU NE MISSINGS(0.0))
		AP			= SHIP[OK].AREAL_PROD_ZEU/1000
		DATE    = SHIP[OK].YEAR + SHIP[OK].MONTH + SHIP[OK].DAY
		SHIPSET = WHERE_SETS(DATE)
		FOR _SHIP = 0L, N_ELEMENTS(SHIPSET)-1 DO BEGIN
			_SUBS = WHERE_SETS_SUBS(SHIPSET(_SHIP))
			IF _SHIP EQ 0 THEN IN_AP   = MEAN(AP(_SUBS))      ELSE IN_AP   = [IN_AP,MEAN(AP(_SUBS))]
			IF _SHIP EQ 0 THEN IN_DATE = SHIPSET(_SHIP).VALUE ELSE IN_DATE = [IN_DATE,SHIPSET(_SHIP).VALUE]
		ENDFOR
		IN_DATE 	= DATE_2JD(IN_DATE) &	SRT = SORT(IN_DATE) & IN_DATE = IN_DATE(SRT) & IN_AP = IN_AP(SRT)

		OK 			= WHERE(PPD_EXT.SUBAREA_NAME EQ 'N04' OR PPD_EXT.SUBAREA_NAME EQ 'N18')
		SOK			= WHERE(FLOAT(PPD_EXT[OK].MEAN) NE MISSINGS(0.0) AND LONG(PPD_EXT[OK].N) GE 11)
		AP			= FLOAT(PPD_EXT(OK(SOK)).MEAN)
		_FN			= PARSE_IT(PPD_EXT(OK(SOK)).FIRST_NAME,/ALL)
		DATE    = _FN.YEAR_START + _FN.MONTH_START + _FN.DAY_START
		PPDSET  = WHERE_SETS(DATE)
		FOR _PPD = 0L, N_ELEMENTS(PPDSET)-1 DO BEGIN
			_SUBS = WHERE_SETS_SUBS(PPDSET(_PPD))
			IF _PPD EQ 0 THEN SAT_AP   = MEAN(AP(_SUBS))      ELSE SAT_AP   = [SAT_AP,MEAN(AP(_SUBS))]
			IF _PPD EQ 0 THEN SA_SATE = SHIPSET(_PPD).VALUE   ELSE SA_SATE  = [SA_SATE,PPDSET(_PPD).VALUE]
		ENDFOR
		SA_SATE 	= DATE_2JD(SA_SATE) &	SRT = SORT(SA_SATE) & SA_SATE = SA_SATE(SRT) & SAT_AP = SAT_AP(SRT)

		OK 			= WHERE(SHIP.AREAL_PROD_ZEU NE MISSINGS(0.0) AND SHIP.STATION EQ 'N04')
		N4_AP		= SHIP[OK].AREAL_PROD_ZEU/1000
		N4_DATE = DATE_2JD(SHIP[OK].GMT_DATE) &	SRT = SORT(N4_DATE) & N4_DATE = N4_DATE(SRT) & N4_AP = N4_AP(SRT)

		OK 			= WHERE(SHIP.AREAL_PROD_ZEU NE MISSINGS(0.0) AND SHIP.STATION EQ 'N18')
		N8_AP		= SHIP[OK].AREAL_PROD_ZEU/1000
		N8_DATE = DATE_2JD(SHIP[OK].GMT_DATE) &	SRT = SORT(N8_DATE) & N8_DATE = N8_DATE(SRT) & N8_AP = N8_AP(SRT)

		OK = WHERE(PPD_EXT.SUBAREA_NAME EQ 'N04' AND FLOAT(PPD_EXT.MEAN) NE MISSINGS(0.0) AND LONG(PPD_EXT.N) GE 11)
		N4_SP = FLOAT(PPD_EXT[OK].MEAN)
		N4_SA = PARSE_IT(PPD_EXT[OK].FIRST_NAME,/ALL)
		N4_SATE = PERIOD_2JD(N4_SA.PERIOD) & SRT = SORT(N4_SATE) & N4_SATE = N4_SATE(SRT) & N4_SP = N4_SP(SRT)

		OK = WHERE(PPD_EXT.SUBAREA_NAME EQ 'N18' AND FLOAT(PPD_EXT.MEAN) NE MISSINGS(0.0) AND LONG(PPD_EXT.N) GE 11)
		N8_SP = FLOAT(PPD_EXT[OK].MEAN)
		N8_SA = PARSE_IT(PPD_EXT[OK].FIRST_NAME,/ALL)
		N8_SATE = PERIOD_2JD(N8_SA.PERIOD) & SRT = SORT(N8_SATE) & N8_SATE = N4_SATE(SRT) & N8_SP = N8_SP(SRT)

		OK = WHERE(SUBAREA.SUBAREA_NAME EQ 'Mass_Bay' AND SUBAREA.MEAN NE MISSINGS(0.0))
		MB_AP = FLOAT(SUBAREA[OK].MEAN)
		MB_FA = PARSE_IT(SUBAREA[OK].FIRST_NAME,/ALL)
		MB_DATE = PERIOD_2JD(MB_FA.PERIOD) & SRT = SORT(MB_DATE) & MB_DATE = MB_DATE(SRT) & MB_AP = MB_AP(SRT)
		MB_STATS = STATS(ALOG(MB_AP))
		MB_MEAN = EXP(MB_STATS.MEAN)
		MB_MIN = EXP(MB_STATS.MIN)
		MB_MAX = EXP(MB_STATS.MAX)
		MB_STD = EXP(MB_STATS.MEAN + MB_STATS.STD) - EXP(MB_STATS.MEAN)
		OK = WHERE(MB_FA.MONTH_START EQ '12' OR MB_FA.MONTH_START EQ '01' OR MB_FA.MONTH_START EQ '02')
		MB_WIN = EXP(MEAN(ALOG(MB_AP[OK])))
		OK = WHERE(MB_FA.MONTH_START EQ '03' OR MB_FA.MONTH_START EQ '04' OR MB_FA.MONTH_START EQ '05')
		MB_SPR = EXP(MEAN(ALOG(MB_AP[OK])))
		OK = WHERE(MB_FA.MONTH_START EQ '06' OR MB_FA.MONTH_START EQ '07' OR MB_FA.MONTH_START EQ '08')
		MB_SUM = EXP(MEAN(ALOG(MB_AP[OK])))
		OK = WHERE(MB_FA.MONTH_START EQ '09' OR MB_FA.MONTH_START EQ '10' OR MB_FA.MONTH_START EQ '11')
		MB_FAL = EXP(MEAN(ALOG(MB_AP[OK])))

		OK = WHERE(SUBAREA.SUBAREA_NAME EQ 'Cape_Cod_Bay' AND SUBAREA.MEAN NE MISSINGS(0.0))
		CC_AP = FLOAT(SUBAREA[OK].MEAN)
		CC_FA = PARSE_IT(SUBAREA[OK].FIRST_NAME,/ALL)
		CC_DATE = PERIOD_2JD(CC_FA.PERIOD) & SRT = SORT(CC_DATE) & CC_DATE = CC_DATE(SRT) & CC_AP = CC_AP(SRT)
		CC_STATS = STATS(ALOG(CC_AP))
		CC_MEAN = EXP(CC_STATS.MEAN)
		CC_MIN = EXP(CC_STATS.MIN)
		CC_MAX = EXP(CC_STATS.MAX)
		CC_STD = EXP(CC_STATS.MEAN + CC_STATS.STD) - EXP(CC_STATS.MEAN)
		OK = WHERE(CC_FA.MONTH_START EQ '12' OR CC_FA.MONTH_START EQ '01' OR CC_FA.MONTH_START EQ '02')
		CC_WIN = EXP(MEAN(ALOG(CC_AP[OK])))
		OK = WHERE(CC_FA.MONTH_START EQ '03' OR CC_FA.MONTH_START EQ '04' OR CC_FA.MONTH_START EQ '05')
		CC_SPR = EXP(MEAN(ALOG(CC_AP[OK])))
		OK = WHERE(CC_FA.MONTH_START EQ '06' OR CC_FA.MONTH_START EQ '07' OR CC_FA.MONTH_START EQ '08')
		CC_SUM = EXP(MEAN(ALOG(CC_AP[OK])))
		OK = WHERE(CC_FA.MONTH_START EQ '09' OR CC_FA.MONTH_START EQ '10' OR CC_FA.MONTH_START EQ '11')
		CC_FAL = EXP(MEAN(ALOG(CC_AP[OK])))



		!P.MULTI=[0,1,40]
		DATES = DATE_2JD([19980101,20060101])
		AX = DATE_AXIS(DATES,/MONTH)
		AYR = DATE_AXIS(DATES,/YEAR)
		XTICKNAME = REPLICATE(' ',N_ELEMENTS(AX.TICKNAME))
		MAXDEPTH = 1
		DEPTHS = 3

		N4DATE = STRMID(JD_2DATE(N4_DATE),0,8) + '000000'
		N8DATE = STRMID(JD_2DATE(N8_DATE),0,8) + '000000'
		INDATE = STRMID(JD_2DATE(IN_DATE),0,8) + '000000'
		N4SATE = STRMID(JD_2DATE(N4_SATE),0,8) + '000000'
		N8SATE = STRMID(JD_2DATE(N8_SATE),0,8) + '000000'
		SASATE = STRMID(JD_2DATE(SA_SATE),0,8) + '000000'
		MBDATE = STRMID(JD_2DATE(MB_DATE),0,8) + '000000'
		CCDATE = STRMID(JD_2DATE(CC_DATE),0,8) + '000000'
		ND = N_ELEMENTS(DEPTHS)
		YRANGE = [-MAXDEPTH,0]

		TXMARGIN=[5.8,6.92]
		TYMARGIN = [0.4,0.4]

		ND = N_ELEMENTS(DEPTHS)
		YRANGE = [-MAXDEPTH,0]
		MINDATE = '20200101000000'
		MAXDATE = '20210101000000'
		VRANGE=[0.1,6]
		AX2 = DATE_AXIS([MINDATE,MAXDATE], /FYEAR)
		X2TICKNAME = REPLICATE(' ',N_ELEMENTS(AX2.TICKNAME))
		PAL_SW3 ,R,G,B
		YTICKNAMES=[' ',' ',' ']
		CHARSIZE = 2.5
		CCHARSIZE = 1.25
		XMARGIN = [5.8,6.9]


;		PLOT,AX2.JD,[0,1],YSTYLE=1,XMARGIN=XMARGIN,YMARGIN=[0,0],YTICKS=1,YMINOR=0,YTICKNAME=YTICKNAMES,XTICKNAME=X2TICKNAME,/NODATA,CHARSIZE=CHARSIZE
;		LABEL = 'N04 !8  In situ!7 !E14!NC PPD (gC m!E-2!N d!E-1!N)'
;		LABEL2 = 'A'
;		COOR = COORD_2PLOT(-0.05,0.3)
;		XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=CCHARSIZE, COLOR=0, CHARTHICK=1
;		COOR = COORD_2PLOT(0.95,0.3)
;		XYOUTS, COOR.X,COOR.Y,LABEL2, ALIGN=-0.1, CHARSIZE=CCHARSIZE, COLOR=0, CHARTHICK=1
;		YEARS = ['1998','1999','2000','2001','2002','2003','2004','2005']
;		YDOY = DATE_2DOY(N4DATE)
;		YDATE = YDOY_2DATE('2020',YDOY)
;		USERSYM,[-0.4,0,0.4],[0,-0.6,0],THICK=2
;		FOR YTH = 0L, N_ELEMENTS(YEARS)-1 DO BEGIN
;			OK = WHERE(STRMID(N4DATE,0,4) EQ YEARS(YTH))
;			_YDATE = YDATE[OK]
;			_YDEPTH = REPLICATE(0.5,N_ELEMENTS(_YDATE))
;			_YAP = N4_AP[OK]
;			PAL_SW3 ,R,G,B
;			TIME_DEPTH_GRID,_YDATE,_YDEPTH,_YAP,/LOG,DEPTH_INTERVAL=0.5,MDATE=[MINDATE,MAXDATE],MDEPTH=[MAXDEPTH,0],VRANGE=VRANGE,CUTOFF=[1,0],YTICKS=1,YTICKNAME=[' ',' ',' '],$
;				XTICKLENTH=-0.3,/NODEPTH,DIMENSIONS=[500,50],AX_INTERVAL='MONTH',AY_GRID='MONTH',/FYEAR,YTITLE=' ',YMARGIN=[0,0],XMARGIN=TXMARGIN,CHARSIZE=CHARSIZE,/INTERPOLATE,YMINOR=0,/NOXDATES,/MAKE_MISSING
;			PAL_36,r,g,b
;			LABEL = YEARS(YTH)
;			COOR = COORD_2PLOT(-0.08,0.3)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1
;			OPLOT,DATE_2DOY(N4DATE[OK]),REPLICATE(0,N_ELEMENTS(OK)),COLOR=31,PSYM=8,SYMSIZE=1.85
;		ENDFOR
;
;		PLOT,AX2.JD,[0,1],YSTYLE=1,XMARGIN=XMARGIN,YMARGIN=[0,0],YTICKS=1,YMINOR=0,YTICKNAME=YTICKNAMES,XTICKNAME=X2TICKNAME,/NODATA,CHARSIZE=CHARSIZE
;		LABEL = 'N18 !8  In situ!7 !E14!NC PPD (gC m!E-2!N d!E-1!N)'
;		LABEL2 = 'A'
;		COOR = COORD_2PLOT(-0.05,0.3)
;		XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=CCHARSIZE, COLOR=0, CHARTHICK=1
;		COOR = COORD_2PLOT(0.95,0.3)
;		XYOUTS, COOR.X,COOR.Y,LABEL2, ALIGN=-0.1, CHARSIZE=CCHARSIZE, COLOR=0, CHARTHICK=1
;		YEARS = ['1998','1999','2000','2001','2002','2003','2004','2005']
;		YDOY = DATE_2DOY(N8DATE)
;		YDATE = YDOY_2DATE('2020',YDOY)
;		USERSYM,[-0.4,0,0.4],[0,-0.6,0],THICK=2
;		FOR YTH = 0L, N_ELEMENTS(YEARS)-1 DO BEGIN
;			OK = WHERE(STRMID(N8DATE,0,4) EQ YEARS(YTH))
;			_YDATE = YDATE[OK]
;			_YDEPTH = REPLICATE(0.5,N_ELEMENTS(_YDATE))
;			_YAP = N8_AP[OK]
;			PAL_SW3 ,R,G,B
;			TIME_DEPTH_GRID,_YDATE,_YDEPTH,_YAP,/LOG,DEPTH_INTERVAL=0.5,MDATE=[MINDATE,MAXDATE],MDEPTH=[MAXDEPTH,0],VRANGE=VRANGE,CUTOFF=[1,0],YTICKS=1,YTICKNAME=[' ',' ',' '],$
;				XTICKLENTH=-0.3,/NODEPTH,DIMENSIONS=[500,50],AX_INTERVAL='MONTH',AY_GRID='MONTH',/FYEAR,YTITLE=' ',YMARGIN=[0,0],XMARGIN=TXMARGIN,CHARSIZE=CHARSIZE,/INTERPOLATE,YMINOR=0,/NOXDATES,/MAKE_MISSING
;			PAL_36,r,g,b
;			LABEL = YEARS(YTH)
;			COOR = COORD_2PLOT(-0.08,0.3)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1
;			OPLOT,DATE_2DOY(N8DATE[OK]),REPLICATE(0,N_ELEMENTS(OK)),COLOR=31,PSYM=8,SYMSIZE=1.85
;		ENDFOR
;



		PLOT,AX2.JD,[0,1],YSTYLE=1,XMARGIN=XMARGIN,YMARGIN=[0,0],YTICKS=1,YMINOR=0,YTICKNAME=YTICKNAMES,XTICKNAME=X2TICKNAME,/NODATA,CHARSIZE=CHARSIZE
		LABEL = '!7 N04 !8  In situ!7 !E14!NC !8PP!Deu!n!7 (gC m!E-2!N d!E-1!N) at N04/N18'
		LABEL2 = 'A'
		COOR = COORD_2PLOT(-0.05,0.3)
		XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=CCHARSIZE, COLOR=0, CHARTHICK=1
		COOR = COORD_2PLOT(0.95,0.3)
		XYOUTS, COOR.X,COOR.Y,LABEL2, ALIGN=-0.1, CHARSIZE=CCHARSIZE, COLOR=0, CHARTHICK=1
		YEARS = ['1998','1999','2000','2001','2002','2003','2004','2005']
		YDOY = DATE_2DOY(N4DATE)
		YDATE = YDOY_2DATE('2020',YDOY)
		USERSYM,[-0.4,0,0.4],[0,-0.6,0],THICK=2
		FOR YTH = 0L, N_ELEMENTS(YEARS)-1 DO BEGIN
			OK = WHERE(STRMID(N4DATE,0,4) EQ YEARS(YTH))
			_YDATE = YDATE[OK]
			_YDEPTH = REPLICATE(0.5,N_ELEMENTS(_YDATE))
			_YAP = N4_AP[OK]
			PAL_SW3 ,R,G,B
			TIME_DEPTH_GRID,_YDATE,_YDEPTH,_YAP,/LOG,DEPTH_INTERVAL=0.5,MDATE=[MINDATE,MAXDATE],MDEPTH=[MAXDEPTH,0],VRANGE=VRANGE,CUTOFF=[1,0],YTICKS=1,YTICKNAME=[' ',' ',' '],$
				XTICKLENTH=-0.3,/NODEPTH,DIMENSIONS=[500,50],AX_INTERVAL='MONTH',AY_GRID='MONTH',/FYEAR,YTITLE=' ',YMARGIN=[0,0],XMARGIN=TXMARGIN,CHARSIZE=CHARSIZE,/INTERPOLATE,YMINOR=0,/NOXDATES,/MAKE_MISSING
			PAL_36,r,g,b
			LABEL = YEARS(YTH)
			COOR = COORD_2PLOT(-0.08,0.3)
			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1
			OPLOT,DATE_2DOY(N4DATE[OK]),REPLICATE(0,N_ELEMENTS(OK)),COLOR=31,PSYM=8,SYMSIZE=1.85
		ENDFOR

		PLOT,AX2.JD,[0,1],YSTYLE=1,XMARGIN=XMARGIN,YMARGIN=[0,0],YTICKS=1,YMINOR=0,YTICKNAME=YTICKNAMES,XTICKNAME=X2TICKNAME,/NODATA,CHARSIZE=CHARSIZE
		LABEL = '!7 N04 Satellite !8PP!Deu!n!7 (gC m!E-2!N d!E-1!N)'
		LABEL2 = 'A'
		COOR = COORD_2PLOT(-0.05,0.3)
		XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=CCHARSIZE, COLOR=0, CHARTHICK=1
		COOR = COORD_2PLOT(0.95,0.3)
		XYOUTS, COOR.X,COOR.Y,LABEL2, ALIGN=-0.1, CHARSIZE=CCHARSIZE, COLOR=0, CHARTHICK=1
		YEARS = ['1998','1999','2000','2001','2002','2003','2004','2005']
		YDOY = DATE_2DOY(N4SATE)
		YDATE = YDOY_2DATE('2020',YDOY)
		USERSYM,[-0.4,0,0.4],[0,-0.6,0],THICK=2
		FOR YTH = 0L, N_ELEMENTS(YEARS)-1 DO BEGIN
			OK = WHERE(STRMID(N4SATE,0,4) EQ YEARS(YTH))
			_YDATE = YDATE[OK]
			_YDEPTH = REPLICATE(0.5,N_ELEMENTS(_YDATE))
			_YAP = N4_SP[OK]
			PAL_SW3 ,R,G,B
			TIME_DEPTH_GRID,_YDATE,_YDEPTH,_YAP,/LOG,DEPTH_INTERVAL=0.5,MDATE=[MINDATE,MAXDATE],MDEPTH=[MAXDEPTH,0],VRANGE=VRANGE,CUTOFF=[1,0],YTICKS=1,YTICKNAME=[' ',' ',' '],$
				XTICKLENTH=-0.3,/NODEPTH,DIMENSIONS=[500,50],AX_INTERVAL='MONTH',AY_GRID='MONTH',/FYEAR,YTITLE=' ',YMARGIN=[0,0],XMARGIN=TXMARGIN,CHARSIZE=CHARSIZE,/INTERPOLATE,YMINOR=0,/NOXDATES
			PAL_36,r,g,b
			LABEL = YEARS(YTH)
			COOR = COORD_2PLOT(-0.08,0.3)
			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1
		ENDFOR

		PLOT,AX2.JD,[0,1],YSTYLE=1,XMARGIN=XMARGIN,YMARGIN=[0,0],YTICKS=1,YMINOR=0,YTICKNAME=YTICKNAMES,XTICKNAME=X2TICKNAME,/NODATA,CHARSIZE=CHARSIZE
		LABEL = '!7 Massachusetts Bay !8PP!Deu!n!7 (gC m!E-2!N d!E-1!N)'
		LABEL2 = 'B'
		COOR = COORD_2PLOT(-0.05,0.3)
		XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=CCHARSIZE, COLOR=0, CHARTHICK=1
		COOR = COORD_2PLOT(0.95,0.3)
		XYOUTS, COOR.X,COOR.Y,LABEL2, ALIGN=-0.1, CHARSIZE=CCHARSIZE, COLOR=0, CHARTHICK=1
		YDOY = DATE_2DOY(MBDATE)
		YDATE = YDOY_2DATE('2020',YDOY)
		FOR YTH = 0L, N_ELEMENTS(YEARS)-1 DO BEGIN
			OK = WHERE(STRMID(MBDATE,0,4) EQ YEARS(YTH))
			_YDEPTH = REPLICATE(0.5,N_ELEMENTS(OK))
			PAL_SW3 ,R,G,B
			TIME_DEPTH_GRID,YDATE[OK],_YDEPTH,MB_AP[OK],/LOG,DEPTH_INTERVAL=0.5,MDATE=[MINDATE,MAXDATE],MDEPTH=[MAXDEPTH,0],VRANGE=VRANGE,CUTOFF=[1,0],YTICKS=1,YTICKNAME=[' ',' ',' '],$
					/NODEPTH,DIMENSIONS=[500,50],AX_INTERVAL='MONTH',AY_GRID='MONTH',/FYEAR,YTITLE=' ',YMARGIN=[0,0],XMARGIN=TXMARGIN,CHARSIZE=CHARSIZE,/INTERPOLATE,YMINOR=0,/NOXDATES
			PAL_36,r,g,b
			LABEL = YEARS(YTH)
			COOR = COORD_2PLOT(-0.08,0.3)
			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1
;			OPLOT,DATE_2DOY(YDATE[OK]),REPLICATE(0,N_ELEMENTS(OK)),COLOR=31,PSYM=8,SYMSIZE=1.5
		ENDFOR


		PLOT,AX2.JD,[0,1],YSTYLE=1,XMARGIN=XMARGIN,YMARGIN=[0,0],YTICKS=1,YMINOR=0,YTICKNAME=YTICKNAMES,XTICKNAME=X2TICKNAME,/NODATA,CHARSIZE=CHARSIZE
		LABEL = '!7 Cape Cod Bay !8PP!Deu!n!7 (gC m!E-2!N d!E-1!N)'
		LABEL2 = 'C'
		COOR = COORD_2PLOT(-0.05,0.3)
		XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=CCHARSIZE, COLOR=0, CHARTHICK=1
		COOR = COORD_2PLOT(0.95,0.3)
		XYOUTS, COOR.X,COOR.Y,LABEL2, ALIGN=-0.1, CHARSIZE=CCHARSIZE, COLOR=0, CHARTHICK=1
		YDOY = DATE_2DOY(CCDATE)
		YDATE = YDOY_2DATE('2020',YDOY)
		FOR YTH = 0L, N_ELEMENTS(YEARS)-1 DO BEGIN
			OK = WHERE(STRMID(CCDATE,0,4) EQ YEARS(YTH))
			_YDEPTH = REPLICATE(0.5,N_ELEMENTS(OK))
			PAL_SW3 ,R,G,B
			IF YTH LT N_ELEMENTS(YEARS)-1 THEN $
			TIME_DEPTH_GRID,YDATE[OK],_YDEPTH,CC_AP[OK],/LOG,DEPTH_INTERVAL=0.5,MDATE=[MINDATE,MAXDATE],MDEPTH=[MAXDEPTH,0],VRANGE=VRANGE,CUTOFF=[1,0],YTICKS=1,YTICKNAME=[' ',' ',' '],$
					/NODEPTH,DIMENSIONS=[500,50],AX_INTERVAL='MONTH',AY_GRID='MONTH',/FYEAR,YTITLE=' ',YMARGIN=[0,0],XMARGIN=TXMARGIN,CHARSIZE=CHARSIZE,/INTERPOLATE,YMINOR=0,/NOXDATES $
			ELSE $
				TIME_DEPTH_GRID,YDATE[OK],_YDEPTH,CC_AP[OK],/LOG,DEPTH_INTERVAL=0.5,MDATE=[MINDATE,MAXDATE],MDEPTH=[MAXDEPTH,0],VRANGE=VRANGE,CUTOFF=[1,0],YTICKS=1,YTICKNAME=[' ',' ',' '],$
					/NODEPTH,DIMENSIONS=[500,50],AX_INTERVAL='MONTH',AY_GRID='MONTH',/FYEAR,YTITLE=' ',YMARGIN=[0,0],XMARGIN=TXMARGIN,CHARSIZE=CHARSIZE,/INTERPOLATE,YMINOR=0
			PAL_36,r,g,b
			LABEL = YEARS(YTH)
			COOR = COORD_2PLOT(-0.08,0.3)
			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1
;			OPLOT,DATE_2DOY(YDATE[OK]),REPLICATE(0,N_ELEMENTS(OK)),COLOR=31,PSYM=8,SYMSIZE=1.5
		ENDFOR
		TICKNAMES = ['0.1','0.3','1','3','10','30']
		TICKV	= [0.1,0.3,1,3,10,30]
		PAL_SW3 ,R,G,B

		BAR=COLOR_BAR_SCALE(POSITION=[0.92, 0.1, 0.95, 0.998],PAL='PAL_SW3',CHARSIZE=3,MINVAL=ALOG10(0.1),MAXVAL=ALOG10(5),MINCOLOR=1,MAXCOLOR=250,YTICKS=3,/YLOG,/VERTICAL,YTICKV=[0.1,0.3,1,3],YTICKNAME=['0.1','0.3','1','3'])

	PAL_36,r,g,b

PSPRINT
;STOP

;		XMARGIN=[5,4]
;		YMARGIN=[1,1]
;		CHARSIZE = 3
;		SYMSIZE = 1
;
;		!P.MULTI=[0,1,3]
;	;	PARAMS=[2,3,4,8]
;
;		XRANGE=[0.03,10]
;		YRANGE=[0.03,10]
;
;!p.multi = [0,1,4]
;PARAMS = [3,4,8]
;
;		PLOTXY, AP,VGPMMBA/1000,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=PSYM,CHARSIZE=CHARSIZE,XTITLE=' ',THICK=THICK, $
;			YTITLE=' ',SYM_COLOR=31,SYMSIZE=symsize, XRANGE=XRANGE, YRANGE=YRANGE,STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,XMARGIN=XMARGIN,YMARGIN=YMARGIN,$
;			/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=2
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=0.5
;			LABEL = 'Uncorrected VGMB'
;			COOR = COORD_2PLOT(0.64,0.13)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;			LABEL = 'A'
;			COOR = COORD_2PLOT(0.945,0.87)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;			FIGURE = 'Figure 9'
;			FIGCOOR = COORD_2PLOT(-0.1,1.10)
;
;		PLOTXY, AP,VGMB_NEW,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=PSYM,CHARSIZE=CHARSIZE,XTITLE=' ',THICK=THICK, $
;			YTITLE=' ',SYM_COLOR=31,SYMSIZE=symsize, XRANGE=XRANGE, YRANGE=YRANGE,STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,XMARGIN=XMARGIN,YMARGIN=YMARGIN,$
;			/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=2
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=0.5
;			LABEL = 'Adjusted VGMB'
;			COOR = COORD_2PLOT(0.7,0.13)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;			LABEL = 'B'
;			COOR = COORD_2PLOT(0.945,0.87)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;			FIGURE = 'Figure 9'
;			FIGCOOR = COORD_2PLOT(-0.1,1.10)
;		;	XYOUTS, FIGCOOR.X,FIGCOOR.Y,FIGURE,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=FIGSIZE
;
;
;		PLOTXY, AP,VGPM_NEW,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=PSYM,CHARSIZE=CHARSIZE,XTITLE=' ',THICK=THICK, $
;			YTITLE='																						Modeled Production (gC m!E-2!N d!E-1!N)',SYM_COLOR=31,SYMSIZE=symsize,XRANGE=XRANGE,YRANGE=YRANGE,STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,XMARGIN=XMARGIN,YMARGIN=YMARGIN,$
;			/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=2
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=0.5
;			LABEL = 'VGPM'
;			COOR = COORD_2PLOT(0.84,0.16)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;			LABEL = 'with Behrenfeld & Falkowski P!Eb!Dmax!N'
;			COOR = COORD_2PLOT(0.38,0.05)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;			LABEL = 'C'
;			COOR = COORD_2PLOT(0.945,0.86)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;
;		PLOTXY, AP,VGPM2_NEW,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=PSYM,CHARSIZE=CHARSIZE,XTITLE='Observed Production (gC m!E-2!N d!E-1!N)',THICK=THICK, $
;			YTITLE=' ',SYM_COLOR=31,SYMSIZE=symsize, XRANGE=XRANGE, YRANGE=YRANGE,STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,XMARGIN=XMARGIN,YMARGIN=YMARGIN,$
;			/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=2
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=0.5
;			LABEL = 'VGPM'
;			COOR = COORD_2PLOT(0.84,0.16)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;			LABEL = 'with Antoine & Morel P!Eb!Dmax!N'
;			COOR = COORD_2PLOT(0.5,0.05)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;			LABEL = 'D'
;			COOR = COORD_2PLOT(0.945,0.87)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1

;		PLOTXY, AP,VGPMMBA/1000,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=PSYM,CHARSIZE=CHARSIZE,XTITLE=' ',THICK=THICK, $
;			YTITLE=' ',SYM_COLOR=31,SYMSIZE=symsize, XRANGE=XRANGE, YRANGE=YRANGE,STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,XMARGIN=XMARGIN,YMARGIN=YMARGIN,$
;			/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=2
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=0.5
;			LABEL = 'Massachusetts Bay Median P!Eb!Dmax!N'
;			COOR = COORD_2PLOT(0.425,0.1)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;			LABEL = 'A'
;			COOR = COORD_2PLOT(0.945,0.87)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;			FIGURE = 'Figure 9'
;			FIGCOOR = COORD_2PLOT(-0.1,1.10)
;		;	XYOUTS, FIGCOOR.X,FIGCOOR.Y,FIGURE,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=FIGSIZE
;
;
;		PLOTXY, AP,VGPMLBF/1000,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=PSYM,CHARSIZE=CHARSIZE,XTITLE=' ',THICK=THICK, $
;			YTITLE='Modeled Production (gC m!E-2!N d!E-1!N)',SYM_COLOR=31,SYMSIZE=symsize,XRANGE=XRANGE,YRANGE=YRANGE,STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,XMARGIN=XMARGIN,YMARGIN=YMARGIN,$
;			/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=2
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=0.5
;			LABEL = 'Behrenfeld & Falkowski P!Eb!Dmax!N'
;			COOR = COORD_2PLOT(0.47,0.1)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;			LABEL = 'B'
;			COOR = COORD_2PLOT(0.945,0.86)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;
;		PLOTXY, AP,VGPMLAM/1000,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=PSYM,CHARSIZE=CHARSIZE,XTITLE='Observed Production (gC m!E-2!N d!E-1!N)',THICK=THICK, $
;			YTITLE=' ',SYM_COLOR=31,SYMSIZE=symsize, XRANGE=XRANGE, YRANGE=YRANGE,STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,XMARGIN=XMARGIN,YMARGIN=YMARGIN,$
;			/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=2
;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=0.5
;			LABEL = 'Antoine & Morel P!Eb!Dmax!N'
;			COOR = COORD_2PLOT(0.6,0.1)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;			LABEL = 'C'
;			COOR = COORD_2PLOT(0.945,0.87)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;
;;		OK = WHERE(SAT.AREAL_PROD_ZEU NE MISSINGS(0.0) AND SAT.VGPM_MBZ_MEAN NE MISSINGS(0.0) AND SAT.VGPM_MBZ_N GE 11)
;;		AREAL = SAT[OK].AREAL_PROD_ZEU
;;		XRANGE=[40,17000]
;;		YRANGE=[40,17000]
;;
;;		PLOTXY, AREAL,SAT[OK].VGMB_MEAN*1000,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=PSYM,CHARSIZE=CHARSIZE,THICK=THICK, $
;;			YTITLE=' ',XTITLE=' ',SYM_COLOR=31,SYMSIZE=symsize,XRANGE=XRANGE,YRANGE=YRANGE,STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,XMARGIN=XMARGIN,YMARGIN=YMARGIN,/GRID_NONE,$
;;			/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle
;;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=2
;;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=0.5
;;			FIGURE = 'Figure 11'
;;			FIGCOOR = COORD_2PLOT(-0.1,1.10)
;;			XYOUTS, FIGCOOR.X,FIGCOOR.Y,FIGURE,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=FIGSIZE
;;			LABEL = 'Massachusetts Bay Median P!Eb!Dmax!N'
;;			COOR = COORD_2PLOT(0.425,0.1)
;;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;;			LABEL = 'A'
;;			COOR = COORD_2PLOT(0.945,0.87)
;;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;;			D_MB = ALOG10(SAT[OK].VGMB_MEAN*1000) - ALOG10(AREAL)
;;			S_MB = STATS(D_MB)
;;			R_MB = MEAN(D_MB^2.0)^0.5
;;			F_MB = [10^S_MB.MEAN,10^(S_MB.MEAN - S_MB.STD), 10^(S_MB.MEAN + S_MB.STD)]
;;			A_MB = AREAL/SAT[OK].VGMB_MEAN*1000
;;			MBOK = WHERE(A_MB GE 0.5 AND A_MB LE 2)
;;
;;		PLOTXY, AREAL,SAT[OK].VGPM_MBZ_MEAN*1000,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=PSYM,CHARSIZE=CHARSIZE,THICK=THICK,$
;;			YTITLE='Satellite Production (mgC m!E-2!N d!E-1!N)',XTITLE=' ',SYM_COLOR=31,SYMSIZE=symsize,XRANGE=XRANGE,YRANGE=YRANGE,STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,XMARGIN=XMARGIN,YMARGIN=YMARGIN,$
;;			/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle
;;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=2
;;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=0.5
;;			LABEL = 'Behrenfeld & Falkowski P!Eb!Dmax!N'
;;			COOR = COORD_2PLOT(0.47,0.1)
;;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;;			LABEL = 'B'
;;			COOR = COORD_2PLOT(0.945,0.86)
;;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;;			D_BF = ALOG10(SAT[OK].VGPM_MBZ_MEAN*1000) - ALOG10(AREAL)
;;			S_BF = STATS(D_BF)
;;			R_BF = MEAN(D_BF^2.0)^0.5
;;			F_BF = [10^S_BF.MEAN,10^(S_BF.MEAN - S_BF.STD), 10^(S_BF.MEAN + S_BF.STD)]
;;			A_BF = AREAL/SAT[OK].VGPM_MBZ_MEAN*1000
;;			BFOK = WHERE(A_BF GE 0.5 AND A_BF LE 2)
;;
;;		PLOTXY, AREAL,SAT[OK].VGPM2_MBZ_MEAN*1000,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=PSYM,CHARSIZE=CHARSIZE,THICK=THICK,$
;;			YTITLE=' ',XTITLE='Observed Production (mgC m!E-2!N d!E-1!N)',SYM_COLOR=31,SYMSIZE=symsize,XRANGE=XRANGE, YRANGE=YRANGE,STATS_CHARSIZE=STATS_CHARSIZE,REG_THICK=REG_THICK,/GRID_NONE,XMARGIN=XMARGIN,YMARGIN=YMARGIN,$
;;			/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle
;;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=2
;;			ONE2ONE, COLOR=32, THICK=THICK, LINESTYLE=1, RATIO=0.5
;;			LABEL = 'Antoine & Morel P!Eb!Dmax!N'
;;			COOR = COORD_2PLOT(0.6,0.1)
;;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;;			LABEL = 'C'
;;			COOR = COORD_2PLOT(0.945,0.87)
;;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.5, COLOR=0, CHARTHICK=1
;;			D_AM = ALOG10(SAT[OK].VGPM2_MBZ_MEAN*1000) - ALOG10(AREAL)
;;			S_AM = STATS(D_AM)
;;			R_AM = MEAN(D_AM^2.0)^0.5
;;			F_AM = [10^S_AM.MEAN,10^(S_AM.MEAN - S_AM.STD), 10^(S_AM.MEAN + S_AM.STD)]
;;			A_AM = AREAL/SAT[OK].VGPM2_MBZ_MEAN*1000
;;			AMOK = WHERE(A_AM GE 0.5 AND A_AM LE 2)
;
		PSPRINT

		D = IDL_RESTORE(DATA_N04_N18)
		OK = WHERE(STRMID(D.GMT_DATE,0,4) GE '1998' AND STRMID(D.GMT_DATE,0,4) LE '2005')
		D = D[OK]
		PSPRINT,FILENAME=VGPM_FINAL2,/COLOR,/Full,/TIMES,/LANDSCAPE

		!P.MULTI=[0,1,20]
		PLOT,AX2.JD,[0,1],YSTYLE=1,XMARGIN=XMARGIN,YMARGIN=[0,0],YTICKS=1,YMINOR=0,YTICKNAME=YTICKNAMES,XTICKNAME=X2TICKNAME,/NODATA,CHARSIZE=CHARSIZE
		LABEL = '!7 Massachusetts Bay !8PP!Deu!n!7 (gC m!E-2!N d!E-1!N)'
		LABEL2 = 'A'
		COOR = COORD_2PLOT(-0.02,0.3)
		XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=CCHARSIZE, COLOR=0, CHARTHICK=1
		COOR = COORD_2PLOT(0.95,0.3)
		XYOUTS, COOR.X,COOR.Y,LABEL2, ALIGN=-0.1, CHARSIZE=CCHARSIZE, COLOR=0, CHARTHICK=1
		YDOY = DATE_2DOY(MBDATE)
		YDATE = YDOY_2DATE('2020',YDOY)
		FOR YTH = 0L, N_ELEMENTS(YEARS)-1 DO BEGIN
			OK = WHERE(STRMID(MBDATE,0,4) EQ YEARS(YTH))
			_YDEPTH = REPLICATE(0.5,N_ELEMENTS(OK))
			PAL_SW3 ,R,G,B
			TIME_DEPTH_GRID,YDATE[OK],_YDEPTH,MB_AP[OK],/LOG,DEPTH_INTERVAL=0.5,MDATE=[MINDATE,MAXDATE],MDEPTH=[MAXDEPTH,0],VRANGE=VRANGE,CUTOFF=[1,0],YTICKS=1,YTICKNAME=[' ',' ',' '],$
					/NODEPTH,DIMENSIONS=[500,50],AX_INTERVAL='MONTH',AY_GRID='MONTH',/FYEAR,YTITLE=' ',YMARGIN=[0,0],XMARGIN=TXMARGIN,CHARSIZE=CHARSIZE,/INTERPOLATE,YMINOR=0,/NOXDATES
			PAL_36,r,g,b
			LABEL = YEARS(YTH)
			COOR = COORD_2PLOT(-0.08,0.3)
			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1
;			OPLOT,DATE_2DOY(YDATE[OK]),REPLICATE(0,N_ELEMENTS(OK)),COLOR=31,PSYM=8,SYMSIZE=1.5
		ENDFOR


		PLOT,AX2.JD,[0,1],YSTYLE=1,XMARGIN=XMARGIN,YMARGIN=[0,0],YTICKS=1,YMINOR=0,YTICKNAME=YTICKNAMES,XTICKNAME=X2TICKNAME,/NODATA,CHARSIZE=CHARSIZE
		LABEL = '!7 Cape Cod Bay !8PP!Deu!n!7 (gC m!E-2!N d!E-1!N)'
		LABEL2 = 'B'
		COOR = COORD_2PLOT(-0.02,0.3)
		XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=CCHARSIZE, COLOR=0, CHARTHICK=1
		COOR = COORD_2PLOT(0.95,0.3)
		XYOUTS, COOR.X,COOR.Y,LABEL2, ALIGN=-0.1, CHARSIZE=CCHARSIZE, COLOR=0, CHARTHICK=1
		YDOY = DATE_2DOY(CCDATE)
		YDATE = YDOY_2DATE('2020',YDOY)
		FOR YTH = 0L, N_ELEMENTS(YEARS)-1 DO BEGIN
			OK = WHERE(STRMID(CCDATE,0,4) EQ YEARS(YTH))
			_YDEPTH = REPLICATE(0.5,N_ELEMENTS(OK))
			PAL_SW3 ,R,G,B
			IF YTH LT N_ELEMENTS(YEARS)-1 THEN $
			TIME_DEPTH_GRID,YDATE[OK],_YDEPTH,CC_AP[OK],/LOG,DEPTH_INTERVAL=0.5,MDATE=[MINDATE,MAXDATE],MDEPTH=[MAXDEPTH,0],VRANGE=VRANGE,CUTOFF=[1,0],YTICKS=1,YTICKNAME=[' ',' ',' '],$
					/NODEPTH,DIMENSIONS=[500,50],AX_INTERVAL='MONTH',AY_GRID='MONTH',/FYEAR,YTITLE=' ',YMARGIN=[0,0],XMARGIN=TXMARGIN,CHARSIZE=CHARSIZE,/INTERPOLATE,YMINOR=0,/NOXDATES $
			ELSE $
				TIME_DEPTH_GRID,YDATE[OK],_YDEPTH,CC_AP[OK],/LOG,DEPTH_INTERVAL=0.5,MDATE=[MINDATE,MAXDATE],MDEPTH=[MAXDEPTH,0],VRANGE=VRANGE,CUTOFF=[1,0],YTICKS=1,YTICKNAME=[' ',' ',' '],$
					/NODEPTH,DIMENSIONS=[500,50],AX_INTERVAL='MONTH',AY_GRID='MONTH',/FYEAR,YTITLE=' ',YMARGIN=[0,0],XMARGIN=TXMARGIN,CHARSIZE=CHARSIZE,/INTERPOLATE,YMINOR=0
			PAL_36,r,g,b
			LABEL = YEARS(YTH)
			COOR = COORD_2PLOT(-0.08,0.3)
			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1
;			OPLOT,DATE_2DOY(YDATE[OK]),REPLICATE(0,N_ELEMENTS(OK)),COLOR=31,PSYM=8,SYMSIZE=1.5
		ENDFOR
		TICKNAMES = ['0.1','0.3','1','3','10','30']
		TICKV	= [0.1,0.3,1,3,10,30]
		PAL_SW3 ,R,G,B

		BAR=COLOR_BAR_SCALE(POSITION=[0.93, 0.105, 0.96, 0.998],PAL='PAL_SW3',CHARSIZE=3,MINVAL=ALOG10(0.1),MAXVAL=ALOG10(5),MINCOLOR=1,MAXCOLOR=250,YTICKS=3,/YLOG,/VERTICAL,YTICKV=[0.1,0.3,1,3],YTICKNAME=['0.1','0.3','1','3'])
		PAL_36,r,g,b



		OK = WHERE(SHIP.PB_OPT NE MISSINGS(0.0) AND SHIP.PB_OPT LT 25)
		SET = SHIP[OK]

		X = DATE_2JD([19980101,20060101])
		X2 = DATE_2JD([19971220,19971230])
		AX = DATE_AXIS(X,/MONTH)
		AY = [0.01,60]

		CHARSIZE = 2
		FONT = 0
		!P.FONT = 0
		XTICKNAMES = REPLICATE(' ',N_ELEMENTS(AX.TICKNAME))
		AYR = DATE_AXIS(X,/YEAR)
		LEG_POS = [0.85,0.7,0.88,0.95]
		STATIONS = ['N04','N18']
		STATIONS = 'N04'
	 	IF N_ELEMENTS(STATIONS) EQ 1 THEN BEGIN
			YMARGIN = [0.25,0.25]
			XMARGIN = [6,3]
			!P.MULTI=[0,1,5]
			XPOS1 = 0.98
			XPOS2 = 1
		ENDIF ELSE BEGIN
			XMARGIN = [4,4]
			YMARGIN = [0.5,0.5]
			!P.MULTI=[0,2,5]
			XPOS1 = 0.97
			XPOS2 = 0.99
		ENDELSE

		P = IDL_RESTORE(PHYTO_FILE)
		OK = WHERE(STRMID(P.DATE,0,4) GE 1998 AND STRMID(P.DATE,0,4) LE 2005) & P = P[OK]
		PRANGE=[0,5]
		PY = PRANGE
		NAMES = TAG_NAMES(P)
		GROUPS = ['TOTAL_DIATOMS','MICROFLAGELLATES','DINOFLAGELLATES','OTHER','PHAEOCYSTIS']
		GPS = ['Diatoms','Microflagellates','Dinoflagellates','Other','Phaeocystis']
		COLORS = [12,34,19,9,22]

		FOR NTH = 0L, N_ELEMENTS(STATIONS)-1 DO BEGIN
			STATION = STATIONS[NTH]
			OK = WHERE(SET.STATION EQ STATIONS[NTH])
			SET4 = SET[OK]
			SET4 = SET4[SORT(SET4.GMT_DATE)]
			DATE = DATE_2JD(SET4.GMT_DATE)
			PB	 = SET4.PB_OPT
wpb = set4.wc_pbmax
			ALPHA = SET4.WC_ALPHA
			IF STATIONS[NTH] EQ 'N04' THEN BEGIN & MDEPTH=[0,50] & YRANGE=[-50,0] & CUTOFF=[50,1] & YTITLE='Depth (m)' & ENDIF ELSE BEGIN & YTITLE=' ' & MDEPTH=[0,30] & YRANGE=[-30,0] & CUTOFF=[30,1] & ENDELSE

			VRANGE=[0,25]
			PAL_SW3,R,G,B
			OK = WHERE(D.TEMP_DOWN NE MISSINGS(0.0) AND D.TEMP_DOWN GT 0 AND D.STATION EQ STATIONS[NTH] AND D.DEPTH LT CUTOFF[0])
			TIME_DEPTH_GRID,D[OK].GMT_DATE,D[OK].DEPTH,D[OK].TEMP_DOWN,DEPTH_INTERVAL=0.5,NEAR=0.5,MDATE=JD_2DATE(X),MDEPTH=MDEPTH,YRANGE=YRANGE,VRANGE=VRANGE,CUTOFF=CUTOFF,$
				DIMENSIONS=[4000,200],AX_INTERVAL='MONTH',AY_GRID='YEAR',YTITLE=YTITLE,YMARGIN=YMARGIN,XMARGIN=XMARGIN,CHARSIZE=charsize,/INTERPOLATE, /NOXDATES, YMINOR=5;, YSTYLE=8
			POSITION = [XPOS1, 0.81,XPOS2, 0.99]
			IF STATIONS[NTH] EQ 'N18' THEN COLORBAR,BOTTOM=0, NCOLORS=210,/VERTICAL,/RIGHT,POSITION=POSITION,DIVISIONS=6,RANGE=[0,25], MINOR=1,charsize=CHARSIZE
			IF N_ELEMENTS(STATIONS) EQ 1 THEN $;COLORBAR,BOTTOM=0, NCOLORS=210,/VERTICAL,/RIGHT,POSITION=POSITION,DIVISIONS=6,RANGE=[0,25], MINOR=1,charsize=CHARSIZE
			CBAR,vmin=min(vrange),vmax=max(vrange),cmin=1,cmax=250,POS=POSITION,charsize=CHARSIZE,/vertical,top=250,bottom=1
;			FIGURE = 'Figure 10'
;			FIGCOOR = COORD_2PLOT(-0.2,1.20)
;			IF STATIONS[NTH] EQ 'N04' THEN XYOUTS, FIGCOOR.X,FIGCOOR.Y,FIGURE,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=1.25
;			COOR = COORD_2PLOT(0.45,1.10)
;			XYOUTS, COOR.X,COOR.Y,STATION,ALIGN=-0.1,CHARSIZE=1.25,COLOR=0,CHARTHICK=1
			TXT = 'Temperature (!Uo!NC)'
			COOR = COORD_2PLOT(0.6,0.8)
			IF STATIONS[NTH] EQ 'N18' THEN XYOUTS, COOR.X,COOR.Y,TXT, ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1
			COOR = COORD_2PLOT(0.05,0.8)
			IF STATIONS[NTH] EQ 'N04' AND N_ELEMENTS(STATIONS) GT 1 THEN XYOUTS, COOR.X,COOR.Y,'A', ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1
			IF N_ELEMENTS(STATIONS) EQ 1 THEN XYOUTS, COOR.X,COOR.Y,'A - Temperature (!Uo!NC)', ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1
			TRANGE = [X2[0],X2[1]]
			IF STATION EQ 'N04' AND N_ELEMENTS(STATIONS) GT 1 THEN AXIS,-400,0,YAXIS=0,YRANGE=[0,15],/SAVE, /YSTYLE,YTITLE='P!Eb!Dmax!N (mgC mgChl!E-1!N hr!E-1!N)',CHARSIZE=charsize,YTICKS=5, YMINOR=5
			IF STATION EQ 'N18' THEN AXIS,-220,0,YAXIS=0,YRANGE=[0,15],/SAVE, /YSTYLE,YTITLE=' ',CHARSIZE=charsize,YTICKS=5, YMINOR=5
			IF N_ELEMENTS(STATIONS) EQ 1 THEN AXIS,-240,0,YAXIS=0,YRANGE=[0,20],/SAVE, /YSTYLE,YTITLE='P!Eb!Dopt!N (mgC mgChl!E-1!N hr!E-1!N)',CHARSIZE=charsize,YTICKS=5, YMINOR=5
			OPLOT,DATE-X[0],PB,COLOR=35,THICK=10
			OPLOT,DATE-X[0],PB,COLOR=255,THICK=5
			OPLOT,[X[0]-X[0],X[1]-X[0]],[PBAVG,PBAVG],COLOR=235,THICK=8, LINESTYLE=2
			IF STATIONS[NTH] EQ 'N04' THEN BEGIN
				TXT = ['P!Eb!Dopt!N','Median P!Eb!Dopt!N']
				IF N_ELEMENTS(STATIONS) GT 1 THEN LEG_POS = [0.6,0.72,0.65,0.87] ELSE LEG_POS = [0.79,0.72,0.84,0.87]
				COLOR = [35,235]
				LEG,pos = LEG_POS,LCOLOR=0, color=COLOR,label=TXT,THICK=10,LSIZE=1.35, FONT=7, LINESTYLE = [0,2]
				COLOR = [255,235]
				LEG,pos = LEG_POS,LCOLOR=0, color=COLOR,label=TXT,THICK=5,LSIZE=1.35, FONT=7, LINESTYLE = [0,2]
			ENDIF
		ENDFOR

		FOR NTH = 0L, N_ELEMENTS(STATIONS)-1 DO BEGIN
			STATION = STATIONS[NTH]
			OK = WHERE(SET.STATION EQ STATIONS[NTH])
			SET4 = SET[OK]
			SET4 = SET4[SORT(SET4.GMT_DATE)]
			DATE = DATE_2JD(SET4.GMT_DATE)
			IF STATIONS[NTH] EQ 'N04' THEN BEGIN & MDEPTH=[0,50] & YRANGE=[-50,0] & CUTOFF=[50,1] & YTITLE='Depth (m)' & ENDIF ELSE BEGIN & YTITLE=' ' & MDEPTH=[0,30] & YRANGE=[-30,0] & CUTOFF=[30,1] & ENDELSE

			PAL_SW3,R,G,B
			VRANGE=[0.01,800]
			OK = WHERE(D.DAILY_PROD NE MISSINGS(0.0) AND D.DAILY_PROD GT 0.01 AND D.STATION EQ STATIONS[NTH])
			TIME_DEPTH_GRID,D[OK].GMT_DATE,D[OK].DEPTH,D[OK].DAILY_PROD,DEPTH_INTERVAL=1,NEAR=0.5,MDATE=JD_2DATE(X),MDEPTH=MDEPTH,YRANGE=YRANGE,VRANGE=VRANGE,CUTOFF=CUTOFF,$
				DIMENSIONS=[4000,200],AX_INTERVAL='MONTH',AY_GRID='YEAR',YTITLE=YTITLE,YMARGIN=YMARGIN,XMARGIN=XMARGIN,CHARSIZE=CHARSIZE,/log,/INTERPOLATE, /NOXDATES, YMINOR=5;, YSTYLE=8

			POSITION = [XPOS1, 0.61,XPOS2, 0.79]
			;IF STATIONS(NTH) EQ 'N18' THEN COLORBAR,BOTTOM=0, NCOLORS=225, POSITION=POSITION,DIVISIONS=4,/xlog,TICKNAMES=TICKNAMES,/VERTICAL,/RIGHT,CHARSIZE=CHARSIZE

			LOGIT=1
			_TICKV = [0.01,0.1,1.,10.,100.]
      _TICKname = NUM2STR(_TICKv,trim=3) &  _TICKs=N_ELEMENTS(_TICKv)-1
      minval = ALOG10(min(vrange)) & maxval = ALOG10(max(vrange))

			IF N_ELEMENTS(STATIONS) EQ 1 THEN $;COLORBAR,BOTTOM=73, NCOLORS=177, POSITION=POSITION,/VERTICAL,/RIGHT,DIVISIONS=7, MINOR=1,charsize=CHARSIZE,/xlog,TICKNAMES=TICKNAMES
			CBAR,ylog=logit,vmin=minval,vmax=maxval,cmin=1,cmax=250,POS=POSITION,charsize=CHARSIZE,/vertical,top=250,bottom=1,title=' ',ytickv=_tickv,ytickname=_tickname,yticks=_ticks

;			IF STATION EQ 'N04' AND N_ELEMENTS(STATIONS) GT 1 THEN AXIS,-400,0,YAXIS=0,YRANGE=[0,0.3],/SAVE, /YSTYLE,YTITLE='Alpha',CHARSIZE=charsize,YTICKS=3, YMINOR=2
			IF STATION EQ 'N04' AND N_ELEMENTS(STATIONS) GT 1 THEN AXIS,-400,0,YAXIS=0,YRANGE=[0,15],/SAVE, /YSTYLE,YTITLE='P!Eb!Dopt!N (mgC mgChl!E-1!N hr!E-1!N)',CHARSIZE=charsize,YTICKS=5, YMINOR=5
			IF STATION EQ 'N18' THEN AXIS,-220,0,YAXIS=0,YRANGE=[0,0.3],/SAVE, /YSTYLE,YTITLE=' ',CHARSIZE=charsize,YTICKS=3, YMINOR=2
		;	IF N_ELEMENTS(STATIONS) EQ 1 THEN AXIS,-240,0,YAXIS=0,YRANGE=[0,0.3],/SAVE, /YSTYLE,YTITLE='Alpha',CHARSIZE=charsize,YTICKS=3, YMINOR=2
		;	IF N_ELEMENTS(STATIONS) EQ 1 THEN AXIS,-240,0,YAXIS=0,YRANGE=[0,15],/SAVE, /YSTYLE,YTITLE='P!Eb!Dmax!N (mgC mgChl!E-1!N hr!E-1!N)',CHARSIZE=charsize,YTICKS=5, YMINOR=5
		;	OPLOT,DATE-X[0],PB,COLOR=35,THICK=10
		;	OPLOT,DATE-X[0],PB,COLOR=255,THICK=5
		;	OPLOT,DATE-X[0],ALPHA,COLOR=35,THICK=10
		;	OPLOT,DATE-X[0],ALPHA,COLOR=255,THICK=5
			COOR = COORD_2PLOT(0.05,0.8)
			IF STATIONS[NTH] EQ 'N04' AND N_ELEMENTS(STATIONS) GT 1 THEN XYOUTS, COOR.X,COOR.Y,'B', ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1
			IF N_ELEMENTS(STATIONS) EQ 1 THEN XYOUTS, COOR.X,COOR.Y,'B - Production (mg m!U-3!Nd!U-1!N)', ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1
		;	TXT = 'Productivity (mg m!U-3!Nd!U-1!N)'
		;	COOR = COORD_2PLOT(0.45,0.8)
		;	IF STATIONS(NTH) EQ 'N18' THEN XYOUTS, COOR.X,COOR.Y,TXT, ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1
		;	IF STATIONS(NTH) EQ 'N04' THEN BEGIN
		;		TXT = ['P!Eb!Dmax!N','Median P!Eb!Dmax!N']
		;		IF N_ELEMENTS(STATIONS) GT 1 THEN LEG_POS = [0.6,0.72,0.65,0.87] ELSE LEG_POS = [0.79,0.72,0.84,0.87]
		;		COLOR = [35,235]
		;		LEG,pos = LEG_POS,LCOLOR=0, color=COLOR,label=TXT,THICK=10,LSIZE=1.35, FONT=7, LINESTYLE = [0,2]
		;		COLOR = [255,235]
		;		LEG,pos = LEG_POS,LCOLOR=0, color=COLOR,label=TXT,THICK=5,LSIZE=1.35, FONT=7, LINESTYLE = [0,2]
		;	ENDIF
;			IF STATIONS[NTH] EQ 'N04' THEN BEGIN
;				TXT = 'Alpha'
;			 	COOR = COORD_2PLOT(0.05,0.8)
;				LEG_POS = [0.84,0.82,0.88,0.85]
;				LEG,pos = LEG_POS,LCOLOR=0, color=35,label=TXT,THICK=10,LSIZE=1.25, FONT=7
;				LEG,pos = LEG_POS,LCOLOR=0, color=255,label=TXT,THICK=5,LSIZE=1.25, FONT=7
;			ENDIF
		ENDFOR

		FOR NTH = 0L, N_ELEMENTS(STATIONS)-1 DO BEGIN
			OK = WHERE(SET.STATION EQ STATIONS[NTH])
			SET4 = SET[OK]
			SET4 = SET4[SORT(SET4.GMT_DATE)]
			DATE = DATE_2JD(SET4.GMT_DATE)
			CHL  = SET4.WC_CHL
			IF STATIONS[NTH] EQ 'N04' THEN BEGIN & MDEPTH=[0,50] & YRANGE=[-50,0] & CUTOFF=[50,1] & YTITLE='Depth (m)' & ENDIF ELSE BEGIN & YTITLE=' ' & MDEPTH=[0,30] & YRANGE=[-30,0] & CUTOFF=[30,1] & ENDELSE

			VRANGE=[0.01,70]
			PAL_SW3,R,G,B
			OK = WHERE(D.CHLA NE MISSINGS(0.0) AND D.CHLA GT 0 AND D.STATION EQ STATIONS[NTH])
			TIME_DEPTH_GRID,D[OK].GMT_DATE,D[OK].DEPTH,D[OK].CHLA,DEPTH_INTERVAL=1,NEAR=0.5,MDATE=JD_2DATE(X),MDEPTH=MDEPTH,YRANGE=YRANGE,VRANGE=VRANGE,CUTOFF=CUTOFF,$
				DIMENSIONS=[4000,200],AX_INTERVAL='MONTH',AY_GRID='YEAR',YTITLE=YTITLE,YMARGIN=YMARGIN,XMARGIN=XMARGIN,CHARSIZE=CHARSIZE,/log,/INTERPOLATE, /NOXDATES, YMINOR=5 ;, YSTYLE=8
			TICKNAMES = ['0.1','0.2','0.5','1.1','2.3','5','11','25']
			POSITION = [XPOS1, 0.41,XPOS2, 0.59]
			;IF STATIONS(NTH) EQ 'N18' THEN COLORBAR,BOTTOM=73, NCOLORS=177, POSITION=POSITION,/VERTICAL,/RIGHT,DIVISIONS=7, MINOR=1,charsize=CHARSIZE,/xlog,TICKNAMES=TICKNAMES

			LOGIT=1
			_TICKV = [0.01,0.1,1.,10.,60.]
      _TICKname = NUM2STR(_TICKv,trim=3) &  _TICKs=N_ELEMENTS(_TICKv)-1
      minval = ALOG10(min(vrange)) & maxval = ALOG10(max(vrange))

			IF N_ELEMENTS(STATIONS) EQ 1 THEN $;COLORBAR,BOTTOM=73, NCOLORS=177, POSITION=POSITION,/VERTICAL,/RIGHT,DIVISIONS=7, MINOR=1,charsize=CHARSIZE,/xlog,TICKNAMES=TICKNAMES
			CBAR,ylog=logit,vmin=minval,vmax=maxval,cmin=1,cmax=250,POS=POSITION,charsize=CHARSIZE,/vertical,top=250,bottom=1,title=' ',ytickv=_tickv,ytickname=_tickname,yticks=_ticks
			TXT = 'Chlorophyll (mg m!U-3!n)'
			COOR = COORD_2PLOT(0.5,0.8)
			IF STATIONS[NTH] EQ 'N18' THEN XYOUTS, COOR.X,COOR.Y,TXT, ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1
			IF STATION EQ 'N04' AND N_ELEMENTS(STATIONS) GT 1 THEN AXIS,-400,0,YAXIS=0,YRANGE=[0,15],/SAVE, /YSTYLE,YTITLE='P!Eb!Dmax!N (mgC mgChl!E-1!N hr!E-1!N)',CHARSIZE=charsize,YTICKS=5, YMINOR=5
			IF STATION EQ 'N18' THEN AXIS,-220,0,YAXIS=0,YRANGE=[0,15],/SAVE, /YSTYLE,YTITLE=' ',CHARSIZE=charsize,YTICKS=5, YMINOR=5
;			IF N_ELEMENTS(STATIONS) EQ 1 THEN AXIS,-240,0,YAXIS=0,YRANGE=[0,15],/SAVE, /YSTYLE,YTITLE='P!Eb!Dmax!N (mgC mgChl!E-1!N hr!E-1!N)',CHARSIZE=charsize,YTICKS=5, YMINOR=5
;			OPLOT,DATE-X[0],PB,COLOR=35,THICK=10
;			OPLOT,DATE-X[0],PB,COLOR=255,THICK=5
			OK = WHERE(SHIP.ZEU NE MISSINGS(0.0) AND SHIP.ZEU LT SHIP.BOTTOM_DEPTH AND SHIP.STATION EQ STATIONS[NTH])
			OPLOT,DATE_2JD(SHIP[OK].GMT_DATE)-X[0],-SHIP[OK].ZEU,COLOR=35,THICK=10
			OPLOT,DATE_2JD(SHIP[OK].GMT_DATE)-X[0],-SHIP[OK].ZEU,COLOR=255,THICK=5
			IF STATIONS[NTH] EQ 'N04' THEN BEGIN
				TXT = 'Zeu'
				COLOR = 35
				LEG_POS = [0.84,0.82,0.88,0.85]
				LEG,pos = LEG_POS,LCOLOR=0, color=35,label=TXT,THICK=10,LSIZE=1.25, FONT=7
				LEG,pos = LEG_POS,LCOLOR=0, color=255,label=TXT,THICK=5,LSIZE=1.25, FONT=7
			ENDIF
			IF N_ELEMENTS(STATIONS) EQ 1 THEN BEGIN
				COOR = COORD_2PLOT(0.05,0.8)
				XYOUTS, COOR.X,COOR.Y,'C - Chlorophyll (mg m!U-3!n)', ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1
				LEG_POS = [0.84,0.82,0.88,0.85]
;				TXT = ['P!Eb!Dmax!N']
;				LEG,pos = LEG_POS,LCOLOR=0, color=35,label=TXT,THICK=10,LSIZE=1.25, FONT=7
;				LEG,pos = LEG_POS,LCOLOR=0, color=255,label=TXT,THICK=5,LSIZE=1.25, FONT=7
;				TXT = 'Zeu'
;				LEG,pos = LEG_POS,LCOLOR=0, color=35,label=TXT,THICK=10,LSIZE=1.25, FONT=7
;				LEG,pos = LEG_POS,LCOLOR=0, color=255,label=TXT,THICK=5,LSIZE=1.25, FONT=7
			ENDIF
		ENDFOR

		FOR NTH = 0L, N_ELEMENTS(STATIONS)-1 DO BEGIN
			STATION = STATIONS[NTH]
			OK = WHERE(SET.STATION EQ STATIONS[NTH])
			SET4 = SET[OK]
			SET4 = SET4[SORT(SET4.GMT_DATE)]
			DATE = DATE_2JD(SET4.GMT_DATE)

			IF STATIONS[NTH] EQ 'N04' THEN BEGIN & MDEPTH=[0,50] & YRANGE=[-50,0] & CUTOFF=[50,1] & YTITLE='Depth (m)' & ENDIF ELSE BEGIN & YTITLE=' ' & MDEPTH=[0,30] & YRANGE=[-30,0] & CUTOFF=[30,1] & ENDELSE

			OK = WHERE(D.NO3 NE MISSINGS(0.0) AND D.NO3 GT 0 AND D.STATION EQ STATIONS[NTH])
			VRANGE = [0.01,60]
			TIME_DEPTH_GRID,D[OK].GMT_DATE,D[OK].DEPTH,D[OK].NO3,DEPTH_INTERVAL=1,NEAR=0.5,MDATE=JD_2DATE(X),MDEPTH=MDEPTH,YRANGE=YRANGE,VRANGE=VRANGE,CUTOFF=CUTOFF,$
				DIMENSIONS=[4000,200],AX_INTERVAL='MONTH',AY_GRID='YEAR',YTITLE=YTITLE,YMARGIN=YMARGIN,XMARGIN=XMARGIN,CHARSIZE=CHARSIZE,/LOG,/INTERPOLATE, /NOXDATES, YMINOR=5;, YSTYLE=8
			POSITION = [XPOS1, 0.21,XPOS2, 0.39]
;			IF STATIONS[NTH] EQ 'N18' THEN COLORBAR,BOTTOM=0, NCOLORS=210,/VERTICAL,/RIGHT,POSITION=POSITION,DIVISIONS=4,/XLOG,TICKNAMES=['0.01','0.07','0.45','3','20'], MINOR=1,charsize=charsize
			LOGIT=1
			_TICKV = [0.01,0.1,1.,10.]
      _TICKname = NUM2STR(_TICKv,trim=3) &  _TICKs=N_ELEMENTS(_TICKv)-1
      minval = ALOG10(min(vrange)) & maxval = ALOG10(max(vrange))

			IF N_ELEMENTS(STATIONS) EQ 1 THEN $;COLORBAR,BOTTOM=73, NCOLORS=177, POSITION=POSITION,/VERTICAL,/RIGHT,DIVISIONS=7, MINOR=1,charsize=CHARSIZE,/xlog,TICKNAMES=TICKNAMES
			CBAR,ylog=logit,vmin=minval,vmax=maxval,cmin=1,cmax=250,POS=POSITION,charsize=CHARSIZE,/vertical,top=250,bottom=1,title=' ',ytickv=_tickv,ytickname=_tickname,yticks=_ticks


			IF STATION EQ 'N04' AND N_ELEMENTS(STATIONS) GT 1 THEN AXIS,-400,0,YAXIS=0,YRANGE=[0,15],/SAVE, /YSTYLE,YTITLE='P!Eb!Dmax!N (mgC mgChl!E-1!N hr!E-1!N)',CHARSIZE=charsize,YTICKS=5, YMINOR=5
			TXT = 'NO!D3!N (!9m!7M)'
			COOR = COORD_2PLOT(0.75,0.8)
			IF STATIONS[NTH] EQ 'N18' THEN XYOUTS, COOR.X,COOR.Y,TXT, ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1
			COOR = COORD_2PLOT(0.05,0.8)
			IF STATIONS[NTH] EQ 'N04' AND N_ELEMENTS(STATIONS) GT 1 THEN XYOUTS, COOR.X,COOR.Y,'D', ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1
			IF N_ELEMENTS(STATIONS) EQ 1 THEN XYOUTS, COOR.X,COOR.Y,'D - NO!D3!N (!9m!7M)', ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1
;			IF N_ELEMENTS(STATIONS) EQ 1 THEN AXIS,-240,0,YAXIS=0,YRANGE=[0,15],/SAVE, /YSTYLE,YTITLE='P!Eb!Dmax!N (mgC mgChl!E-1!N hr!E-1!N)',CHARSIZE=charsize,YTICKS=5, YMINOR=5
;			OPLOT,DATE-X[0],PB,COLOR=35,THICK=10
;			OPLOT,DATE-X[0],PB,COLOR=255,THICK=5
;			IF STATIONS[NTH] EQ 'N04' THEN BEGIN
;				LEG_POS = [0.79,0.72,0.84,0.87]
;				TXT = ['P!Eb!Dmax!N']
;				LEG,pos = LEG_POS,LCOLOR=0, color=35,label=TXT,THICK=10,LSIZE=1.25, FONT=7
;				LEG,pos = LEG_POS,LCOLOR=0, color=255,label=TXT,THICK=5,LSIZE=1.25, FONT=7
;			ENDIF
		ENDFOR

		FOR NTH = 0L, N_ELEMENTS(STATIONS)-1 DO BEGIN
			PAL_36,R,G,B
			OK = WHERE(P.SURFACE NE MISSINGS('') AND P.STATION EQ STATIONS[NTH] AND STRMID(P.DATE,0,4) GE 1998 AND STRMID(P.DATE,0,4) LE 2005)
			SP  = P[OK]
			PDATE = DATE_2JD(SP.DATE)
			YY = REPLICATE(8000,N_ELEMENTS(PDATE))
			AVEDEPTH = MEAN(SP.DEPTH)
			PDEPTH = SP.DEPTH
			TOT = SP.TOTAL
			BOTTOM = 0
			PER1 = REPLICATE(0,N_ELEMENTS(SP))
			XP = FINDGEN(N_ELEMENTS(SP))
			FOR PTH = 0L, N_ELEMENTS(GROUPS) -1 DO BEGIN
				GROUP = GROUPS(PTH)
				POS = WHERE(NAMES EQ GROUP,COUNT)
				IF COUNT EQ 1 THEN PHY = SP.(POS) ELSE STOP
				PER = (PHY/TOT)*100
				OK = WHERE(PHY EQ MISSINGS(0.0),COUNT) & IF COUNT GE 1 THEN PER[OK] = 0
				IF PTH EQ 0 THEN BEGIN
					IF NTH EQ 1 THEN XTICKNAME = AX.TICKNAME ELSE XTICKNAME = XTICKNAMES
					IF STATIONS[NTH] EQ 'N04' THEN YTITLE='Percent Composition (%)' ELSE YTITLE = ' '
					PLOT, AX.JD, PY,YTITLE=YTITLE,XRANGE=AX.JD,YRANGE=[0,100],/XSTYLE,YSTYLE=8,XMARGIN=XMARGIN,YMARGIN=YMARGIN,$
						XTICKS=AX.TICKS,XTICKNAME=AX.TICKNAME,XTICKV=AX.TICKV,XTICK_GET=XTICK_GET,CHARSIZE=CHARSIZE,/NODATA
						BOT = REPLICATE(0, N_ELEMENTS(PER))
						YY = [PER,BOT]
						XX = [PDATE,REVERSE(PDATE)]
						POLYFILL, XX, YY, COLOR = COLORS(PTH)
				ENDIF
				PER1 = PER + PER1
				YY = [PER1,REVERSE(BOTTOM)]
				XX = [PDATE,REVERSE(PDATE)]
				IF PTH GE 1 THEN POLYFILL, XX, YY, COLOR = COLORS(PTH)
				BOTTOM = PER1
			ENDFOR
			PAL_SW3,R,G,B
			GRIDS,X=AYR.TICKV, /NO_Y
			IF STATIONS[NTH] EQ 'N18' OR N_ELEMENTS(STATIONS) EQ 1 THEN PTITLE = 'Total Phytoplankton!C!C(Cells/L x 10!E6!N)' ELSE PTITLE = ' '
			AXIS,YAXIS=1,YRANGE=[0,8],/SAVE, YTITLE=PTITLE ,CHARSIZE=CHARSIZE
			OPLOT, PDATE,TOT/1000,COLOR=35,THICK=10,LINESTYLE=0
			OPLOT, PDATE,TOT/1000,COLOR=255,THICK=3,LINESTYLE=0
			IF STATION EQ 'N04' AND N_ELEMENTS(STATIONS) GT 1 THEN AXIS,-400,0,YAXIS=0,YRANGE=[0,15],/SAVE, /YSTYLE,YTITLE='P!Eb!Dmax!N (mgC mgChl!E-1!N hr!E-1!N)',CHARSIZE=charsize,YTICKS=5, YMINOR=5
			IF STATIONS[NTH] EQ 'N04' THEN BEGIN
				COOR = COORD_2PLOT(0.05,0.8)
				XYOUTS, COOR.X,COOR.Y,'E - Species Composition', ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1
				LGD2 = 'Total Phytoplankton'
				COLOR = 35
				IF N_ELEMENTS(STATIONS) GT 1 THEN LEG_POS = [0.45,0.89,0.53,0.92] ELSE LEG_POS = [0.73,0.89,0.78,0.92]
				LEG,pos = LEG_POS,LCOLOR=0, color=35,label=lgd2,THICK=12,LSIZE=1.25, FONT=7
				LEG,pos = LEG_POS,LCOLOR=0, color=255,label=lgd2,THICK=5,LSIZE=1.25, FONT=7
			ENDIF
		;	USERSYM, [-6,-6,0,0],[-0.75,0.75,0.75,-0.75],THICK=3,/FILL
		;	LEGEND,LGD2,POSITION=[0.55,-0.055],/NORMAL,BOX=0,/HORIZONTAL,PSYM=8,CHARSIZE=1.25,COLOR=35
		;	USERSYM, [-5.5,-5.5,-0.5,-0.5],[-0.35,0.35,0.35,-0.35],THICK=3,/FILL
		;	LEGEND,LGD2,POSITION=[0.55,-0.055],/NORMAL,BOX=0,/HORIZONTAL,PSYM=8,CHARSIZE=1.25,COLOR=255
			PAL_36,R,G,B
			LGD = ['Diatoms','Microflagellates','Dinoflagellates','Other','Phaeocystis']
			USERSYM, [-3.5,1.5,1.5,-3.5],[-1.3,-1.3,1.7,1.7],THICK=3,/FILL

			IF STATIONS[NTH] EQ 'N04' THEN	LEGEND,LGD,POSITION=[0.135,-0.05],/NORMAL,BOX=0,/HORIZONTAL,PSYM=8,CHARSIZE=1.25,COLOR=COLORS

	;		LEGEND,LGD(0:2),POSITION=[0.2,-0.03],/NORMAL,BOX=0,/HORIZONTAL,PSYM=8,CHARSIZE=1.25,COLOR=COLORS(0:2)
		;	LEGEND,LGD(3:4),POSITION=[0.23,-0.05],/NORMAL,BOX=0,/HORIZONTAL,PSYM=8,CHARSIZE=1.25,COLOR=COLORS(3:4)

		ENDFOR

;		!p.multi = [0,1,3]
;		FOR NTH = 0L, N_ELEMENTS(STATIONS)-1 DO BEGIN
;			STATION = STATIONS[NTH]
;			OK = WHERE(SET.STATION EQ STATIONS[NTH])
;			SET4 = SET[OK]
;			SET4 = SET4[SORT(SET4.GMT_DATE)]
;			DATE = DATE_2JD(SET4.GMT_DATE)
;			PB	 = SET4.PB_OPT
;;			ALPHA = SET4.WC_ALPHA
;			IF STATIONS[NTH] EQ 'N04' THEN BEGIN & MDEPTH=[0,50] & YRANGE=[-50,0] & CUTOFF=[50,1] & YTITLE='Depth (m)' & ENDIF ELSE BEGIN & YTITLE=' ' & MDEPTH=[0,30] & YRANGE=[-30,0] & CUTOFF=[30,1] & ENDELSE
;
;			VRANGE=[0,25]
;			PAL_SW3,R,G,B
;			OK = WHERE(D.TEMP_DOWN NE MISSINGS(0.0) AND D.TEMP_DOWN GT 0 AND D.STATION EQ STATIONS[NTH] AND D.DEPTH LT CUTOFF[0])
;			TIME_DEPTH_GRID,D[OK].GMT_DATE,D[OK].DEPTH,D[OK].TEMP_DOWN,DEPTH_INTERVAL=0.5,NEAR=0.5,MDATE=JD_2DATE(X),MDEPTH=MDEPTH,YRANGE=YRANGE,VRANGE=VRANGE,CUTOFF=CUTOFF,$
;				DIMENSIONS=[4000,200],AX_INTERVAL='MONTH',AY_GRID='YEAR',YTITLE=YTITLE,YMARGIN=YMARGIN,XMARGIN=XMARGIN,CHARSIZE=charsize,/INTERPOLATE, /NOXDATES, YMINOR=5;, YSTYLE=8
;			POSITION = [XPOS1, 0.675,XPOS2, 0.99]
;			IF STATIONS[NTH] EQ 'N18' THEN COLORBAR,BOTTOM=0, NCOLORS=210,/VERTICAL,/RIGHT,POSITION=POSITION,DIVISIONS=6,RANGE=[0,25], MINOR=1,charsize=CHARSIZE, TITLE='Temperature (!Uo!NC)'
;			IF N_ELEMENTS(STATIONS) EQ 1 THEN COLORBAR,BOTTOM=0, NCOLORS=210,/VERTICAL,/RIGHT,POSITION=POSITION,DIVISIONS=6,RANGE=[0,25], MINOR=1,charsize=CHARSIZE, TITLE='Temperature (!Uo!NC)'
;;			FIGURE = 'Figure 10'
;;			FIGCOOR = COORD_2PLOT(-0.2,1.20)
;;			IF STATIONS[NTH] EQ 'N04' THEN XYOUTS, FIGCOOR.X,FIGCOOR.Y,FIGURE,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=1.25
;;			COOR = COORD_2PLOT(0.45,1.10)
;;			XYOUTS, COOR.X,COOR.Y,STATION,ALIGN=-0.1,CHARSIZE=1.25,COLOR=0,CHARTHICK=1
;			TXT = 'Temperature (!Uo!NC)'
;			COOR = COORD_2PLOT(0.6,0.8)
;			IF STATIONS[NTH] EQ 'N18' THEN XYOUTS, COOR.X,COOR.Y,TXT, ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1
;			COOR = COORD_2PLOT(0.05,0.8)
;			IF STATIONS[NTH] EQ 'N04' AND N_ELEMENTS(STATIONS) GT 1 THEN XYOUTS, COOR.X,COOR.Y,'A', ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1
;			IF N_ELEMENTS(STATIONS) EQ 1 THEN XYOUTS, COOR.X,COOR.Y,'A', ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1
;			TRANGE = [X2[0],X2[1]]
;			IF STATION EQ 'N04' AND N_ELEMENTS(STATIONS) GT 1 THEN AXIS,-400,0,YAXIS=0,YRANGE=[0,15],/SAVE, /YSTYLE,YTITLE='P!Eb!Dopt!N (mgC mgChl!E-1!N hr!E-1!N)',CHARSIZE=charsize,YTICKS=5, YMINOR=5
;			IF STATION EQ 'N18' THEN AXIS,-220,0,YAXIS=0,YRANGE=[0,15],/SAVE, /YSTYLE,YTITLE=' ',CHARSIZE=charsize,YTICKS=5, YMINOR=5
;			IF N_ELEMENTS(STATIONS) EQ 1 THEN AXIS,-240,0,YAXIS=0,YRANGE=[0,15],/SAVE, /YSTYLE,YTITLE='P!Eb!Dopt!N (mgC mgChl!E-1!N hr!E-1!N)',CHARSIZE=charsize,YTICKS=5, YMINOR=5
;			OPLOT,DATE-X[0],PB,COLOR=35,THICK=10
;			OPLOT,DATE-X[0],PB,COLOR=255,THICK=5
;			OPLOT,[X[0]-X[0],X[1]-X[0]],[PBAVG,PBAVG],COLOR=235,THICK=8, LINESTYLE=2
;			IF STATIONS[NTH] EQ 'N04' THEN BEGIN
;				TXT = ['P!Eb!Dopt!N','Median P!Eb!Dopt!N']
;				IF N_ELEMENTS(STATIONS) GT 1 THEN LEG_POS = [0.6,0.72,0.65,0.87] ELSE LEG_POS = [0.79,0.72,0.84,0.87]
;				COLOR = [35,235]
;				LEG,pos = LEG_POS,LCOLOR=0, color=COLOR,label=TXT,THICK=10,LSIZE=1.35, FONT=7, LINESTYLE = [0,2]
;				COLOR = [255,235]
;				LEG,pos = LEG_POS,LCOLOR=0, color=COLOR,label=TXT,THICK=5,LSIZE=1.35, FONT=7, LINESTYLE = [0,2]
;			ENDIF
;		ENDFOR
;
;		FOR NTH = 0L, N_ELEMENTS(STATIONS)-1 DO BEGIN
;			PAL_36,R,G,B
;			OK = WHERE(P.SURFACE NE MISSINGS('') AND P.STATION EQ STATIONS[NTH] AND STRMID(P.DATE,0,4) GE 1998 AND STRMID(P.DATE,0,4) LE 2005)
;			SP  = P[OK]
;			PDATE = DATE_2JD(SP.DATE)
;			YY = REPLICATE(8000,N_ELEMENTS(PDATE))
;			AVEDEPTH = MEAN(SP.DEPTH)
;			PDEPTH = SP.DEPTH
;			TOT = SP.TOTAL
;			BOTTOM = 0
;			PER1 = REPLICATE(0,N_ELEMENTS(SP))
;			XP = FINDGEN(N_ELEMENTS(SP))
;			FOR PTH = 0L, N_ELEMENTS(GROUPS) -1 DO BEGIN
;				GROUP = GROUPS(PTH)
;				POS = WHERE(NAMES EQ GROUP,COUNT)
;				IF COUNT EQ 1 THEN PHY = SP.(POS) ELSE STOP
;				PER = (PHY/TOT)*100
;				OK = WHERE(PHY EQ MISSINGS(0.0),COUNT) & IF COUNT GE 1 THEN PER[OK] = 0
;				IF PTH EQ 0 THEN BEGIN
;					IF NTH EQ 1 THEN XTICKNAME = AX.TICKNAME ELSE XTICKNAME = XTICKNAMES
;					IF STATIONS[NTH] EQ 'N04' THEN YTITLE='Percent Composition (%)' ELSE YTITLE = ' '
;					PLOT, AX.JD, PY,YTITLE=YTITLE,XRANGE=AX.JD,YRANGE=[0,100],/XSTYLE,YSTYLE=8,XMARGIN=XMARGIN,YMARGIN=YMARGIN,$
;						XTICKS=AX.TICKS,XTICKNAME=AX.TICKNAME,XTICKV=AX.TICKV,XTICK_GET=XTICK_GET,CHARSIZE=CHARSIZE,/NODATA
;						BOT = REPLICATE(0, N_ELEMENTS(PER))
;						YY = [PER,BOT]
;						XX = [PDATE,REVERSE(PDATE)]
;						POLYFILL, XX, YY, COLOR = COLORS(PTH)
;				ENDIF
;				PER1 = PER + PER1
;				YY = [PER1,REVERSE(BOTTOM)]
;				XX = [PDATE,REVERSE(PDATE)]
;				IF PTH GE 1 THEN POLYFILL, XX, YY, COLOR = COLORS(PTH)
;				BOTTOM = PER1
;			ENDFOR
;			PAL_SW3,R,G,B
;			GRIDS,X=AYR.TICKV, /NO_Y
;			IF STATIONS[NTH] EQ 'N18' OR N_ELEMENTS(STATIONS) EQ 1 THEN PTITLE = 'Total Phytoplankton!C!C(Cells/L x 10!E6!N)' ELSE PTITLE = ' '
;			AXIS,YAXIS=1,YRANGE=[0,8],/SAVE, YTITLE=PTITLE ,CHARSIZE=CHARSIZE
;			OPLOT, PDATE,TOT/1000,COLOR=35,THICK=10,LINESTYLE=0
;			OPLOT, PDATE,TOT/1000,COLOR=255,THICK=3,LINESTYLE=0
;			IF STATIONS[NTH] EQ 'N04' THEN BEGIN
;				COOR = COORD_2PLOT(0.05,0.8)
;				XYOUTS, COOR.X,COOR.Y,'B', ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1
;				LGD2 = 'Total Phytoplankton'
;				COLOR = 35
;				IF N_ELEMENTS(STATIONS) GT 1 THEN LEG_POS = [0.45,0.89,0.53,0.92] ELSE LEG_POS = [0.73,0.89,0.78,0.92]
;				LEG,pos = LEG_POS,LCOLOR=0, color=35,label=lgd2,THICK=12,LSIZE=1.25, FONT=7
;				LEG,pos = LEG_POS,LCOLOR=0, color=255,label=lgd2,THICK=5,LSIZE=1.25, FONT=7
;			ENDIF
;		;	USERSYM, [-6,-6,0,0],[-0.75,0.75,0.75,-0.75],THICK=3,/FILL
;		;	LEGEND,LGD2,POSITION=[0.55,-0.055],/NORMAL,BOX=0,/HORIZONTAL,PSYM=8,CHARSIZE=1.25,COLOR=35
;		;	USERSYM, [-5.5,-5.5,-0.5,-0.5],[-0.35,0.35,0.35,-0.35],THICK=3,/FILL
;		;	LEGEND,LGD2,POSITION=[0.55,-0.055],/NORMAL,BOX=0,/HORIZONTAL,PSYM=8,CHARSIZE=1.25,COLOR=255
;			PAL_36,R,G,B
;			LGD = ['Diatoms','Microflagellates','Dinoflagellates','Other','Phaeocystis']
;			USERSYM, [-3.5,1.5,1.5,-3.5],[-1.3,-1.3,1.7,1.7],THICK=3,/FILL
;
;			IF STATIONS[NTH] EQ 'N04' THEN	LEGEND,LGD,POSITION=[0.135,0.27],/NORMAL,BOX=0,/HORIZONTAL,PSYM=8,CHARSIZE=1.25,COLOR=COLORS
;
;	;		LEGEND,LGD(0:2),POSITION=[0.2,-0.03],/NORMAL,BOX=0,/HORIZONTAL,PSYM=8,CHARSIZE=1.25,COLOR=COLORS(0:2)
;		;	LEGEND,LGD(3:4),POSITION=[0.23,-0.05],/NORMAL,BOX=0,/HORIZONTAL,PSYM=8,CHARSIZE=1.25,COLOR=COLORS(3:4)
;
;		ENDFOR
;		spread, new

		ok = where(PPD_EXT.first_name ne missings('')) & EXT = PPD_ext(ok)
		X = DATE_2JD([19980101,20060101])
		AX = DATE_AXIS(X,/MONTH)
		X2 = DATE_2JD([20200101,20210101])
		AX2 = DATE_AXIS(X2, /FYEAR)
		AY = YRANGE
		AYR = DATE_AXIS(X,/YEAR)
		YTITLE='!8PP!Deu!N!7 (mgC m!E-2!Nd!E-1!N)'
		XMARGIN = [2,2]
		YMARGIN = [0.5,0.5]

		FA = PARSE_IT(EXT.FIRST_NAME,/ALL)
		PERIOD = FA.PERIOD
		JDATE = PERIOD_2JD(PERIOD)


		OK = WHERE(JDATE GE X[0] AND JDATE LE X[1])
		JDATE = JDATE[OK]
		DATES = JD_2DATE(JDATE)
		EXT = EXT[OK]


		COLORS = [22,12]
 		THICKS = [3,3]
 	;	PSYM =   [5,-3]
 		LCOLOR = [0,0]
 		FONT = 0

	!P.MULTI = [0,1,2]
; ===> STATION TIME PLOTS
	 	STATIONS = ['N04','N18']
	 	STATIONS = 'N04'

		FOR NTH = 0L, N_ELEMENTS(STATIONS)-1 DO BEGIN
			OK = WHERE(SHIP.STATION EQ STATIONS[NTH])
			STATION = SHIP[OK]
			STATION = STATION[SORT(STATION.GMT_DATE)]
			OK = WHERE(STATION.AREAL_PROD_ZEU NE MISSINGS(0.0))
			PROD = STATION[OK].AREAL_PROD_ZEU/1000
			PDATE = DATE_2JD(STATION[OK].GMT_DATE)
			NP 		= N_ELEMENTS(PROD)

			OK = WHERE(EXT.SUBAREA_NAME EQ STATIONS[NTH] AND FLOAT(EXT.MEAN) NE MISSINGS(0.0) AND LONG(EXT.N) GE 11)
			SSET = EXT[OK]

			VG = FLOAT(SSET.MEAN)
			SDATE = JDATE[OK]
			SRT = SORT(SDATE)
			SDATE = SDATE(SRT)
			VG = VG(SRT)
			NS = N_ELEMENTS(VG)
;			VALUES = STRMID(JD_2DATE(PDATE),0,8)
;			ARRAY = STRMID(JD_2DATE(SDATE),0,8)
;			OK = WHERE_MATCH(ARRAY, VALUES,COUNT,VALID=VALID,NCOMPLEMENT=ncomplement,COMPLEMENT=complement,ninvalid=ninvalid,invalid=invalid)
;			STPROD = VG[OK]
;			STDATE = SDATE[OK]

;			OK = WHERE(S.STATION EQ STATIONS[NTH] AND S.VGPM_MBZ_MEAN NE MISSINGS(0.0) AND S.VGPM_N GE 4)
;			VSET = S[OK]
;			VGZ = VSET.VGPM_MBZ_MEAN
;			VDATE = DATE_2JD(VSET.DATE)
;			VS = N_ELEMENTS(VG)
;			VALUES = STRMID(JD_2DATE(PDATE),0,8)
;			ARRAY = STRMID(JD_2DATE(VDATE),0,8)
;			OK = WHERE_MATCH(ARRAY, VALUES,COUNT,VALID=VALID,NCOMPLEMENT=ncomplement,COMPLEMENT=complement,ninvalid=ninvalid,invalid=invalid)
;			VTPROD = VGZ[OK]
;			VTDATE = VDATE[OK]
			CIRCLE,32, COLOR=0

			IF NTH EQ 0 AND N_ELEMENTS(STATIONS) GT 1 THEN PLOT, AX.JD, AY,YTITLE=YTITLE,/YLOG,YRANGE=[0.03,10],/XSTYLE,/YSTYLE,XMARGIN=[1,1],YMARGIN=YMARGIN,$
				XTICKS=AX.TICKS,XTICKNAME=REPLICATE(' ',N_ELEMENTS(AX.TICKNAME)),XTICKV=AX.TICKV,XTICK_GET=XTICK_GET,CHARSIZE=1.5,/NODATA
			IF NTH EQ 1 OR N_ELEMENTS(STATIONS) EQ 1 THEN PLOT, AX.JD, AY,YTITLE=YTITLE,/YLOG,YRANGE=[0.03,10],/XSTYLE,/YSTYLE,XMARGIN=[1,1],YMARGIN=YMARGIN,$
				XTICKS=AX.TICKS,XTICKNAME=AX.TICKNAME,XTICKV=AX.TICKV,XTICK_GET=XTICK_GET,CHARSIZE=1.5,/NODATA
			GRIDS,X=AYR.TICKV, /NO_Y
			OPLOT, SDATE, VG, COLOR = 32, THICK = 3
			OPLOT, PDATE, PROD, PSYM=-8,  COLOR = 0, THICK = 2.5

			TXT = '!E14!NC (n = ' + STRTRIM(NP,2) + ')'
			TXT = [TXT, 'SeaWiFS VGPM!DMB!N (n = ' + STRTRIM(NS,2) + ')']
			LEG_POS = [0.08 ,0.07,0.11,0.15]
			LEG,pos = LEG_POS,LCOLOR=LCOLOR, color=[0,33],label=TXT,THICK=[THICK,THICK],PSYM=[-8,-3],LSIZE=1.5,FONT=FONT
			TITLE = STRTRIM(STATIONS[NTH],2)
			COOR = COORD_2PLOT(0.89,0.865)
	;		XYOUTS, COOR.X,COOR.Y,TITLE, ALIGN=-0.1, CHARSIZE=2, COLOR=0, CHARTHICK=1
			IF NTH EQ 0 THEN BEGIN
				LABEL = 'A'
				COOR = COORD_2PLOT(0.015,0.865)
		;		XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=2, COLOR=0, CHARTHICK=1
				FIGURE = 'Figure 11'
				FIGCOOR = COORD_2PLOT(-0.1,1.10)
;				XYOUTS, FIGCOOR.X,FIGCOOR.Y,FIGURE,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=FIGSIZE
			ENDIF ELSE BEGIN
				LABEL = 'B'
				COOR = COORD_2PLOT(0.015,0.865)
			;	XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=2, COLOR=0, CHARTHICK=1
			ENDELSE
		ENDFOR


		!P.MULTI = [0,1,3]
		FOR NTH = 0L, N_ELEMENTS(STATIONS)-1 DO BEGIN
			OK = WHERE(SHIP.STATION EQ STATIONS[NTH])
			STATION = SHIP[OK]
			STATION = STATION[SORT(STATION.GMT_DATE)]
			OK = WHERE(STATION.WC_PBMAX NE MISSINGS(0.0) AND STATION.WC_ALPHA NE MISSINGS(0.0) AND STATION.WC_CHL NE MISSINGS(0.0),COUNT)
			_PB = STATION[OK].WC_PBMAX
			_AL = STATION[OK].WC_ALPHA/STATION[OK].WC_CHL
			PB_AL = _PB/_AL
			PDATE = DATE_2JD(STATION[OK].GMT_DATE)
			NP 		= COUNT

			CIRCLE,32, COLOR=0

			IF NTH EQ 0 AND N_ELEMENTS(STATIONS) GT 1 THEN PLOT, AX.JD, AY,YTITLE='P!Eb!Dopt!N : !9a!7!Eb!N',YRANGE=[0,150],/XSTYLE,/YSTYLE,XMARGIN=[5,1],YMARGIN=YMARGIN,$
				XTICKS=AX.TICKS,XTICKNAME=REPLICATE(' ',N_ELEMENTS(AX.TICKNAME)),XTICKV=AX.TICKV,XTICK_GET=XTICK_GET,CHARSIZE=3,/NODATA
			IF NTH EQ 1 OR N_ELEMENTS(STATIONS) EQ 1 THEN PLOT, AX.JD, AY,YTITLE='P!Eb!Dopt!N : !9a!7!Eb!N',YRANGE=[0,150],/XSTYLE,/YSTYLE,XMARGIN=[5,1],YMARGIN=YMARGIN,$
				XTICKS=AX.TICKS,XTICKNAME=AX.TICKNAME,XTICKV=AX.TICKV,XTICK_GET=XTICK_GET,CHARSIZE=3,/NODATA
			GRIDS,X=AYR.TICKV, /NO_Y
		;	OPLOT, SDATE, VG, COLOR = 32, THICK = 3
			OPLOT, PDATE, PB_AL, PSYM=-8,  COLOR = 0, THICK = 2.5
		ENDFOR



		PSPRINT
stop
		SKIP_VGPM_FINAL:
	ENDIF


; *******************************************************
	IF DO_SEA_COMP GE 1 THEN BEGIN
; *******************************************************
		OVERWRITE = DO_SEA_COMP GE 2
		EXIST = FILE_TEST('D:\PROJECTS\MASS_BAY\PLOT\SEAWIFS_COR_CHL_MON_BY_YEAR_COMPOSITE.PNG')
		IF EXIST AND OVERWRITE EQ 0 THEN GOTO, SKIP_SEA_COMP  ; >>>>>>>>>>>>>>>>>>>>>>>>>

		PAL_SW3,R,G,B
;
;;	MAKE BLANK IMAGE TO CREATE A PLACE HOLDER
;		IM = BYTARR(640,640)
;		IM(*,*) = 255
		BLANK = 'D:\IDL\Images\BLANK_640_BY_640_IMAGE.PNG'
;		WRITE_PNG,BLANK, IM, R,G,B

		PAL = 'PAL_SW3'
		BACKGROUND = 255
		SPACE = 20
		PX = 160
		PY = 160
		!P.FONT = 0
		FIGSIZE = 1.5

;		MAKE !M 2006 COMPOSITE
		FILES = FILE_SEARCH('F:\SEAWIFS_MLAC-MASS_BAY\ts_images\PRIMARY_PROD\stats\!M_2006*-SEAWIFS-REPRO5-MASS_BAY-PPD-MEAN.SAVE')
		DIR_OUT='D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT2\'
;		FOR NTH=0L, N_ELEMENTS(FILES)-1 DO BEGIN
;			FA = PARSE_IT(FILES[NTH])
;			IM=STRUCT_SD_CONTOUR(FILES[NTH], LEVELS=[0.5],C_COLOR=[0],C_THICK=3, MED=7,MISS_COLOR=0, SPECIAL_SCALE='LOW',/ADD_LAND,/ADD_COASTM)
;			PNG_FILE = DIR_OUT + FA.NAME + '-CONTOUR.PNG'
;			WRITE_PNG,PNG_FILE,IM,R,G,B
;		ENDFOR

;		STRUCT_SD_2PNG,[FILES],DIR_OUT=DIR_OUT,/ADD_LAND,/ADD_COAST,MISS_COLOR=0,/OVERWRITE, SPECIAL_SCALE='LOW'
		FILES = FILE_SEARCH(DIR_OUT+'!M_2006*-SEAWIFS-REPRO5-MASS_BAY-PXY_640_640-PPD-MEAN.PNG')
		CFILES = FILE_SEARCH(DIR_OUT+'!M_2006*-SEAWIFS-REPRO5-MASS_BAY-PPD-MEAN-CONTOUR.PNG')
		ROWS = 5
		COLS = 3
		PNGFILE = 'D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT2\SEAWIFS_VGMB_2006_COMPOSITE.PNG'
		PSFILE 	= 'D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT2\SEAWIFS_VGMB_2006_COMPOSITE.PS'
;		IMAGE_WELD_PAGE,FILES=FILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=pngfile,SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM
		CPNGFILE = 'D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT2\SEAWIFS_VGMB-CONTOUR_2006_COMPOSITE.PNG'
		CPSFILE 	= 'D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT2\SEAWIFS_VGMB-CONTOUR_2006_COMPOSITE.PS'
;		IMAGE_WELD_PAGE,FILES=CFILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=cpngfile,SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM
		PSFILES = [PSFILE,CPSFILE]
		PNGFILES = [PNGFILE,CPNGFILE]

		FOR NTH=0L, N_ELEMENTS(PSFILES)-1 DO BEGIN
			IMAGE = READ_PNG(PNGFILES[NTH],r,g,b)
			SZ=SIZE(IMAGE,/STRUCT)
			TRUE_COLOR  = SZ.N_DIMENSIONS EQ 3
  		PX_IMAGE = 1.0*SZ.DIMENSIONS(0+TRUE_COLOR)
  		PY_IMAGE = 1.0*SZ.DIMENSIONS(1+TRUE_COLOR)
;  		===> Postscript (idl) has 1000/cm resolution
;  		A 2400 pixel wide PCX or PNG file printed at 300dpi  will be 8 inches wide or 2.54cm*8
   		xsize = DOUBLE(2.54*(PX_IMAGE/300.))    &   ysize = DOUBLE(2.54*(PY_IMAGE/300.))
;  		===> Dimensions of postscript page
   		HEIGHT = 20.5  &   WIDTH = 26.9  ; MAX SIZE
			xoffset = 1.85
	  	yoffset = -0.5
	    SCALE = 1.

; 		===> Set up the postscript device
	    olddevice= !d.name  ; Get present graphics device
	    SET_PLOT,'ps'
	    DEVICE,FILENAME=PSFILES[NTH]
			DEVICE, /PORTRAIT
			DEVICE,/COLOR
	 		CALL_PROCEDURE,PAL,R,G,B
	 		TVLCT,R,G,B
	 		COLOR=1
			DEVICE,BITS_PER_PIXEL=8
	    DEVICE, XOFFSET=xoffset, YOFFSET=yoffset, $
	    XSIZE=xsize, YSIZE=ysize, $
	    SCALE_FACTOR=scale
	    TV,IMAGE, TRUE=TRUE_COLOR

			X = 0.01 ;0.002
			Y = 0.975 ;1.62
			IX = 0.337 ;0.168
			IY = 0.205 ;-0.34
			CHARSIZE = 1.75
			XYOUTS,X,Y,'!7J', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+IX,Y,'!7F', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+2*IX,Y,'!7M', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X,Y-IY,'!7A', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+IX,Y-IY,'!7M', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+2*IX,Y-IY,'!7J', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X,Y-(2*IY),'!7J', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+IX,Y-(2*IY),'!7A', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+2*IX,Y-(2*IY),'!7S', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X,Y-(3*IY),'!7O', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+IX,Y-(3*IY),'!7N', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+2*IX,Y-(3*IY),'!7D', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1

			TITLE = '!7 Daily Production ' + UNITS('PPD',/NO_NAME)
			LEG=COLOR_BAR_SCALE(PROD='PPD',POSITION=[0.02, 0.15,0.98, 0.17],PAL='PAL_SW3',CHARSIZE=1.5,/BOTTOM,TITLE=TITLE,/NO_UNIT,$
													TICKLEN=-0.75, SPECIAL_SCALE='LOW')

	    DEVICE,/CLOSE
	    SET_PLOT,olddevice
	  ENDFOR


;		MAKE !MONTH AND !Y COMPOSITE
		FILE1 = FILE_SEARCH('F:\SEAWIFS_MLAC-MASS_BAY\stats\!MONTH*-SEAWIFS-MASS_BAY-PPD-VGMB-MEAN.SAVE')
		FILE2 = FILE_SEARCH('F:\SEAWIFS_MLAC-MASS_BAY\stats\!Y_*-SEAWIFS-MASS_BAY-PPD-VGMB-MEAN.SAVE')
		DIR_OUT='D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT2\'
		FILES = [FILE1,FILE2]
		FOR NTH=0L, N_ELEMENTS(FILES)-1 DO BEGIN
			FA = PARSE_IT(FILES[NTH])
			IM=STRUCT_SD_CONTOUR(FILES[NTH], LEVELS=[0.5],C_COLOR=[0],C_THICK=3, MED=7,MISS_COLOR=0, SPECIAL_SCALE='LOW',/ADD_LAND,/ADD_COASTM)
			PNG_FILE = DIR_OUT + FA.NAME + '-CONTOUR.PNG'
			WRITE_PNG,PNG_FILE,IM,R,G,B
		ENDFOR

		STRUCT_SD_2PNG,[FILE1,FILE2],DIR_OUT=DIR_OUT,/ADD_LAND,/ADD_COAST,MISS_COLOR=0,/OVERWRITE, SPECIAL_SCALE='LOW'
		FILE1 = FILE_SEARCH(DIR_OUT+'!MONTH_*-SEAWIFS-REPRO5-MASS_BAY-PXY_640_640-PPD-MEAN.PNG')
		FILE2 = FILE_SEARCH(DIR_OUT+'!Y_*-SEAWIFS-REPRO5-MASS_BAY-PXY_640_640-PPD-MEAN.PNG')
		FILES = [BLANK,FILE2(1:4),BLANK,BLANK,FILE2(5:8),BLANK,FILE1]
		CFILE1 = FILE_SEARCH(DIR_OUT+'!MONTH_*-SEAWIFS-REPRO5-MASS_BAY-PPD-MEAN-CONTOUR.PNG')
		CFILE2 = FILE_SEARCH(DIR_OUT+'!Y_*-SEAWIFS-REPRO5-MASS_BAY-PPD-MEAN-CONTOUR.PNG')
		CFILES = [BLANK,CFILE2(1:4),BLANK,BLANK,CFILE2(5:8),BLANK,CFILE1]
		ROWS = 5
		COLS = 6
		PNGFILE = 'D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT2\SEAWIFS_VGMB_COMPOSITE.PNG'
		PSFILE 	= 'D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT2\SEAWIFS_VGMB_COMPOSITE.PS'
		IMAGE_WELD_PAGE,FILES=FILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=pngfile,SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM
		CPNGFILE = 'D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT2\SEAWIFS_VGMB-CONTOUR_COMPOSITE.PNG'
		CPSFILE 	= 'D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT2\SEAWIFS_VGMB-CONTOUR_COMPOSITE.PS'
	;	IMAGE_WELD_PAGE,FILES=CFILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=cpngfile,SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM
		PSFILES = [PSFILE,CPSFILE]
		PNGFILES = [PNGFILE,CPNGFILE]

		FOR NTH=0L, N_ELEMENTS(PSFILES)-1 DO BEGIN
			IMAGE = READ_PNG(PNGFILES[NTH],r,g,b)
			SZ=SIZE(IMAGE,/STRUCT)
			TRUE_COLOR  = SZ.N_DIMENSIONS EQ 3
  		PX_IMAGE = 1.0*SZ.DIMENSIONS(0+TRUE_COLOR)
  		PY_IMAGE = 1.0*SZ.DIMENSIONS(1+TRUE_COLOR)
;  		===> Postscript (idl) has 1000/cm resolution
;  		A 2400 pixel wide PCX or PNG file printed at 300dpi  will be 8 inches wide or 2.54cm*8
   		xsize = DOUBLE(2.54*(PX_IMAGE/300.))    &   ysize = DOUBLE(2.54*(PY_IMAGE/300.))
;  		===> Dimensions of postscript page
   		HEIGHT = 20.5  &   WIDTH = 26.9  ; MAX SIZE
			xoffset = -1
	  	yoffset = 27
	    SCALE = 0.75

; 		===> Set up the postscript device
	    olddevice= !d.name  ; Get present graphics device
	    SET_PLOT,'ps'
	    DEVICE,FILENAME=PSFILES[NTH]
			DEVICE, /LANDSCAPE
			DEVICE,/COLOR
	 		CALL_PROCEDURE,PAL,R,G,B
	 		TVLCT,R,G,B
	 		COLOR=1
			DEVICE,BITS_PER_PIXEL=8
	    DEVICE, XOFFSET=xoffset, YOFFSET=yoffset, $
	    XSIZE=xsize, YSIZE=ysize, $
	    SCALE_FACTOR=scale
	    TV,IMAGE, TRUE=TRUE_COLOR

			X = 0.002
			Y = 0.97
			IX = 0.168
			IY = -0.203
			CHARSIZE = 2.25
			XYOUTS,X,Y+(2*IY),'!7J', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+IX,Y+(2*IY),'!7F', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+2*IX,Y+(2*IY),'!7M', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+3*IX,Y+(2*IY),'!7A', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+4*IX,Y+(2*IY),'!7M', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+5*IX,Y+(2*IY),'!7J', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X,Y+(3*IY),'!7J', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+IX,Y+(3*IY),'!7A', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+2*IX,Y+(3*IY),'!7S', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+3*IX,Y+(3*IY),'!7O', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+4*IX,Y+(3*IY),'!7N', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+5*IX,Y+(3*IY),'!7D', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			X = -0.003
			CHARSIZE = 2
			XYOUTS,X+1*IX,Y,'!71998', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+2*IX,Y,'!71999', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+3*IX,Y,'!72000', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+4*IX,Y,'!72001', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+1*IX,Y+1*IY,'!72002', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+2*IX,Y+1*IY,'!72003', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+3*IX,Y+1*IY,'!72004', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+4*IX,Y+1*IY,'!72005', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1


			TITLE = '!7 Daily Production ' + UNITS('PPD',/NO_NAME)
			LEG=COLOR_BAR_SCALE(PROD='PPD',POSITION=[0.1, 0.165,0.9, 0.185],PAL='PAL_SW3',CHARSIZE=2,/BOTTOM,TITLE=TITLE,/NO_UNIT, SPECIAL_SCALE='LOW')
			FIGURE = 'Figure 15'
		;	XYOUTS,0,1.08,FIGURE,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=FIGSIZE

	    DEVICE,/CLOSE
	    SET_PLOT,olddevice
	  ENDFOR

		STOP

		SKIP_SEA_COMP:
	ENDIF




END; #####################  End of Routine ################################



