; $ID:	STATS_PERIOD_PLOT.PRO,	2020-07-08-15,	USER-KJWH	$
	PRO STATS_PERIOD_PLOT, STATS_P, DATE_RANGE=date_range ,MIN_CPY=min_cpy,MAX_CPY=MAX_CPY, SWITCHES=SWITCHES ,LABEL=label,PAGE_TITLE=PAGE_TITLE,$
											 USE_PROD=use_prod,MAX_LABELS=MAX_LABELS,FRAMES=FRAMES,$
											 LON=LON, LAT=LAT, XP=XP,YP=YP,N_PIXELS=N_PIXELS

;+
; NAME:
;	STATS_PERIOD_PLOT.PRO
;
; PURPOSE:
;		PLOTS TIME SERIES RESULTS FOR STATISTICS GENERATED BY STATS_PERIOD_ALL AND STATS_PERIOD
;

; MODIFICATION HISTORY:
;	J.O'Reilly, NOAA Jan 30, 2004X


	ROUTINE_NAME='STATS_PERIOD_PLOT'
  COMPUTER=GET_COMPUTER()

	IF N_ELEMENTS(MIN_CPY) NE 1 THEN MIN_CPY = 0.02
	IF N_ELEMENTS(MAX_CPY) NE 1 THEN MAX_CPY = 100.0
	IF N_ELEMENTS(PAGE_TITLE) EQ 1 THEN _PAGE_TITLE = PAGE_TITLE ELSE _PAGE_TITLE = ''

;	===> Get a date range to the nearest whole year
	IF N_ELEMENTS(DATE_RANGE) NE 2 THEN BEGIN
 		YEARS = FIX((PERIOD_2STRUCT(STATS_P.Y.PERIOD)).YEAR_START)
	  jd_range = date_2jd(MINMAX(YEARS,/FIN))
	  jd_range[0]=jd_2jd(jd_range[0],/START,/year) & jd_range[1]=JD_2JD(jd_range[1],/YEAR,/END)
 	ENDIF	ELSE BEGIN
 		jd_range 		= DATE_2JD(DATE_RANGE)
	ENDELSE

	IF N_ELEMENTS(LABEL) EQ 0 THEN LABEL = ''

	PAL_36
	PAL_SW3,R,G,B
	LNP_XLOG = 1
	LNP_YLOG = 0


 	PROD=STATS_P.PROD
 	IF N_ELEMENTS(USE_PROD) NE 1 THEN USE_PROD = PROD

 	PROD_TITLE = UNITS(PROD)
 	ANOMALY_TITLE = 'Anomaly '+UNITS(PROD,/NO_NAME)

  MPY_MIN = 12


	IF N_ELEMENTS(SWITCHES) EQ 0 THEN BEGIN
;		*****************************************
;		*** D E F A U L T    S W I T C H E S  ***
;		*****************************************

		DO_M						 		=	1
		DO_W						 		=	0
		DO_M_BLOCK    			=	1

		DO_AC								= 1
		DO_M_AC 						= 1
		DO_DOY							=	1

		DO_M_ANOM 					= 1
		DO_M_ANOM_BLOCK 		= 1

		DO_MONTH_ANOM_TREND = 1

		DO_M_MONTH 					= 0

		DO_Y						 		=	1

		DO_Y_SPAN      			= 1

		DO_LNP_D						=	1
		DO_LNP_M_ANOM       = 1

		DO_LNP_MONTHS_ANOM  = 0


     HELP, NAMES='DO_*', OUTPUT=DO_LIST
     DO_LIST=STRCOMPRESS(DO_LIST,/REMOVE_ALL)
     OK=WHERE_STRING(DO_LIST,'=1',COUNT)
     DO_LIST=DO_LIST[OK]
     SWITCHES=REPLACE(DO_LIST,'INT=1','')
	ENDIF



;	===> Determine number of years
	N_YEARS = N_ELEMENTS(STATS_P.Y)


;	*********************************
;	$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
;	$$$$$  P   L   O   T   S     $$$$
;	$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
;	*********************************

	IF N_ELEMENTS(FRAMES) EQ 0 THEN !P.MULTI = [0,1,13] ELSE !P.MULTI = [0,1,FRAMES]
	!X.OMARGIN = [0,0]
	!Y.MARGIN = [1,4]
	LNP_XTICKLEN = -0.08

	YTICKLEN = -0.001
	AX_CHARSIZE = 1.25

;	===> COLORS
	PAL_36,R,G,B
	BACKGROUND_COLOR = TC(35)
	BACKGROUND_GREY = 254
	PER_COLORS = [0,0,21,15,10,6]
	PER_COLORS = [0,0,21,10,15,6]
	IF PROD EQ 'SST' 			THEN YEAR_COLORS = 2+INDGEN(22) ;
	IF PROD EQ 'CHLOR_A' 	THEN YEAR_COLORS =  [4,8,10,11,13,16,18,19,21,26,32] ; 8 YEARS
	IF PROD EQ 'RIVER_FLOW_CFS' THEN YEAR_COLORS = 2+INDGEN(57)
	D_COLOR  = TC[0]
	W_COLOR  = TC[0]
	WEEK_COLOR  = TC[0]
	M_COLOR  = TC(21)
	CYCLE_COLOR = TC(26)

	OVERLINE_COLOR = TC[0]
	FRAME_COLOR 	 = TC[0]
	ANOM_COLOR     = TC(8)
	TREND_COLOR 	 = TC(26)
	SPAN_COLOR		 = TC(10)
	ANNUAL_MEAN_COLOR = TC(21)
	MINMAX_COLOR      = TC(255)

;	===> THICK
	GRID_YEAR_THICK = 2
	GRID_Y_THICK		= 1
	CYCLE_THICK     = 5
	FRAME_THICK 		= 2
	ANOM_THICK      = 5
	TREND_THICK			= 3
	MINMAX_THICK    = 1

;	===> SYMBOLS
	MINMAX_SYM = 1

;	===> LEGEND
	LEG_SPACING = 0
	LEG_PSPACING = 2.0
	LEG_MARGIN   = [0.3,0.3]

;	===> AXES ***
  AX_M		=DATE_AXIS(JD_RANGE,/MONTH,MAX_LABELS=MAX_LABELS)
  AX_Y		=DATE_AXIS(JD_RANGE,/YEAR,MAX_LABELS=MAX_LABELS)
  AX_DOY	=DATE_AXIS( /FYEAR)
  AX_MONTH=DATE_AXIS(/FYEAR,ROOM=[0,1])

;	===> AXIS FOR Future Year 2020 (Mid-Month)
  AX_MIDMONTH=DATE_AXIS(/FYEAR)
  AX_MIDMONTH.TICKV = JD_2JD(AX_MIDMONTH.TICKV,/MONTH,/MID)
  AX_MIDMONTH.TICKV = JD_2JD(AX_MIDMONTH.TICKV)
  N_4_YEAR_AXIS = 6 ;  IF GE 6 YEARS IN SERIES THEN SWITCH FROM AX_M TO AX_Y

;	===> FORMAT
	FMT_SLOPE	='(F-7.4)'
	FMT_R     ='(F-6.3)'
	FMT_PERIOD='(F-6.3)'
	FMT_SIG   ='(F-8.6)'
	FMT_T0_ACF='(F-7.4)'


;	===> Initialize top of page position
	page_y = 0.0


	_SWITCHES = SWITCHES

;	LLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLL
	FOR _SWITCH = 0,N_ELEMENTS(SWITCHES)-1 DO BEGIN

		; ===> TURN OFF ANY SWITCHES THAT ARE ON
    FOR NTH = 1,N_ELEMENTS(SWITCHES)-1 DO BEGIN & TXT=STRSPLIT(SWITCHES[NTH],' ',/EXTRACT) & CMD = TXT[0] + ' = 0' & A = EXECUTE(CMD) & ENDFOR

		CMD = SWITCHES(_SWITCH) + ' = 1' & A = EXECUTE(CMD)
		PRINT, CMD


;	***********************************************************
	IF KEYWORD_SET(DO_M) THEN BEGIN	 ;	*** PLOT !D, !M ***
;	***********************************************************
		TITLE = 'Daily & Monthly Means' + ' ' + LABEL
		FONTS,'TIMES' & PAL_36,R,G,B & TVLCT,R,G,B
		AX = AX_Y
		XRANGE = MINMAX(AX.TICKV)

		IF N_ELEMENTS(STATS_P.D) GT N_ELEMENTS(STATS_P.M) THEN BEGIN
			DO_D = 1
		ENDIF ELSE BEGIN
			TITLE = 'Monthly'+ ' ' + LABEL
			DO_D = 0
		ENDELSE
		Y = STATS_P.D.MEAN & 	YY= STATS_P.M.MEAN & YRANGE = MINMAX(Y,/FIN)


		IF STATS_P.TRANSFORMATION EQ 'ALOG' THEN BEGIN
			YLOG = 1 & Y=EXP(Y) &	YY=EXP(YY) & YRANGE = EXP(YRANGE)
			AY=LOG_AXIS(YRANGE)
			YTICKS=AY.TICKS & YTICKV=AY.TICKV & YTICKNAME=AY.TICKNAME_MAJOR
			YRANGE = MINMAX(AY.TICKV)
		ENDIF ELSE BEGIN
			YLOG=0 & YTICKS=0 & YTICKV=0 & YTICKNAME=''
		ENDELSE

		PLOT, AX.JD,Y, YLOG=YLOG,XRANGE=XRANGE,/XSTYLE,YRANGE=YRANGE,/YSTYLE,TITLE=TITLE, YTITLE=PROD_TITLE, $
					YTICKS=YTICKS,YTICKV=YTICKV,YTICKNAME=YTICKNAME,$
					YTICKLEN = YTICKLEN,$
					XTICKS=AX.TICKS,XTICKNAME=AX.TICKNAME,XTICKV=AX.TICKV,$
					XTICK_GET=XTICK_GET,YTICK_GET=ytick_get,CHARSIZE=AXIS_CHARSIZE,/NODATA

		BACKGROUND,COLOR=BACKGROUND_COLOR,/PLOT
		GRIDS, X= AX_Y.TICKV,/NO_Y, COLOR=TC[0],	THICK=GRID_YEAR_THICK,/ALL
		GRIDS, Y= Y_TICK_GET,/NO_X, COLOR=TC(33),THICK=GRID_Y_THICK,/ALL

		OPLOT, STATS_P.D.JD,  Y,COLOR=D_COLOR,PSYM=1,SYMSIZE=0.6
		OPLOT, STATS_P.M.JD, YY,COLOR=M_COLOR,THICK=5
		OPLOT, STATS_P.M.JD, YY,COLOR=OVERLINE_COLOR,THICK=OVERLINE_THICK

		IF DO_D EQ 1 THEN BEGIN
			LABELS = ['Daily ('+STRTRIM(N_ELEMENTS(STATS_P.D.JD),2)+')','Monthly']
			COLORS = [D_COLOR,M_COLOR]
		ENDIF ELSE BEGIN
			LABELS = ['Monthly ('+STRTRIM(N_ELEMENTS(STATS_P.D.JD),2)+')','Monthly']
			COLORS = [D_COLOR,M_COLOR]
		ENDELSE


;		===> Plot minimum, maximum
;;;		PLOTS, STATS_P.JD_MIN, Y(STATS_P.SUB_MIN),PSYM=MINMAX_SYM,COLOR=MINMAX_COLOR,THICK=MINMAX_THICK
;;;		PLOTS, STATS_P.JD_MAX, Y(STATS_P.SUB_MAX),PSYM=MINMAX_SYM,COLOR=MINMAX_COLOR,THICK=MINMAX_THICK


		COLORS = [D_COLOR,M_COLOR]
	  THICKS = [1,5]
	  LINESTYLE = [0,0]
	  PSYM= [1,0]

	  XPOS= !X.CRANGE[1] &  YPOS = !Y.CRANGE[1] + 0.025*SPAN(!Y.CRANGE) & IF YLOG EQ 1 THEN YPOS = 10^(YPOS)
   	LEGEND,position =[XPOS ,YPOS],/BOTTOM,/RIGHT,/data,LABELS,COLORS=COLORS, PSYM=psym, LINESTYLE=LINESTYLE,$
    				 PSPACING=LEG_PSPACING,SPACING=LEG_SPACING,MARGIN=LEG_MARGIN,THICK=THICKS,$
    				  /BOX,/HORIZONTAL,/CLEAR,BACKGROUND_COLOR=BACKGROUND_COLOR,CHARSIZE=0.5

		COLORS[1] =0 & THICKS[1] = 1

		LEGEND,position =[XPOS ,YPOS],/BOTTOM,/RIGHT,/data,LABELS,COLORS=COLORS, PSYM=psym, LINESTYLE=LINESTYLE,$
   				 PSPACING=LEG_PSPACING,SPACING=LEG_SPACING,MARGIN=LEG_MARGIN,THICK=THICKS,$
   				  /BOX,/HORIZONTAL, CHARSIZE=0.5

		FRAME,/PLOT,COLOR=FRAME_COLOR,THICK=FRAME_THICK

		page_y = page_y > !y.region[1]
		DO_M = 0
	ENDIF
;	||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||


;	***********************************************************
	IF KEYWORD_SET(DO_W) THEN BEGIN	 ;	*** PLOT !W, !M ***
;	***********************************************************
		TITLE = 'Weekly & Monthly Means' + ' ' + LABEL
		AX = AX_Y
		IF N_ELEMENTS(STATS_P.	W) GT N_ELEMENTS(STATS_P.M) THEN BEGIN
			DO_W = 1
		ENDIF ELSE BEGIN
			TITLE = 'Monthly'+ ' ' + LABEL
			DO_W = 0
		ENDELSE
		Y = STATS_P.W.MEAN & 	YY= STATS_P.M.MEAN & YRANGE = MINMAX(Y,/FIN)

		FONTS,'TIMES' & PAL_36,R,G,B & TVLCT,R,G,B

		IF STATS_P.TRANSFORMATION EQ 'ALOG' THEN BEGIN
			YLOG = 1 & Y=EXP(Y) &	YY=EXP(YY) & YRANGE = EXP(YRANGE)
			AY=LOG_AXIS(YRANGE)
			YTICKS=AY.TICKS & YTICKV=AY.TICKV & YTICKNAME=AY.TICKNAME_MAJOR
			YRANGE = MINMAX(AY.TICKV)
		ENDIF ELSE BEGIN
			YLOG=0 & YTICKS=0 & YTICKV=0 & YTICKNAME=''
		ENDELSE

		PLOT, AX.JD,Y, YLOG=YLOG, YRANGE=YRANGE,/YSTYLE,TITLE=TITLE, YTITLE=PROD_TITLE, $
					YTICKS=YTICKS,YTICKV=YTICKV,YTICKNAME=YTICKNAME,$
					YTICKLEN = YTICKLEN,$
					XTICKS=AX.TICKS,XTICKNAME=AX.TICKNAME,XTICKV=AX.TICKV,$
					XTICK_GET=XTICK_GET,YTICK_GET=ytick_get,CHARSIZE=AXIS_CHARSIZE,/NODATA

		BACKGROUND,COLOR=BACKGROUND_COLOR,/PLOT
		GRIDS, X= AX_Y.TICKV,/NO_Y, COLOR=TC[0],	THICK=GRID_YEAR_THICK,/ALL
		GRIDS, Y= Y_TICK_GET,/NO_X, COLOR=TC(33),THICK=GRID_Y_THICK,/ALL

		OPLOT, STATS_P.W.JD,  Y,COLOR=W_COLOR,PSYM=1,SYMSIZE=0.6
		OPLOT, STATS_P.M.JD, YY,COLOR=M_COLOR,THICK=5
		OPLOT, STATS_P.M.JD, YY,COLOR=OVERLINE_COLOR,THICK=OVERLINE_THICK

		IF DO_W EQ 1 THEN BEGIN
			LABELS = ['Weekly ('+STRTRIM(N_ELEMENTS(STATS_P.D.JD),2)+')','Monthly']
			COLORS = [D_COLOR,M_COLOR]
		ENDIF ELSE BEGIN
			LABELS = ['Monthly ('+STRTRIM(N_ELEMENTS(STATS_P.D.JD),2)+')','Monthly']
			COLORS = [D_COLOR,M_COLOR]
		ENDELSE


;		===> Plot minimum, maximum
;		PLOTS, STATS_P.JD_MIN, Y(STATS_P.SUB_MIN),PSYM=MINMAX_SYM,COLOR=MINMAX_COLOR,THICK=MINMAX_THICK
;		PLOTS, STATS_P.JD_MAX, Y(STATS_P.SUB_MAX),PSYM=MINMAX_SYM,COLOR=MINMAX_COLOR,THICK=MINMAX_THICK


		COLORS = [W_COLOR,M_COLOR]
	  THICKS = [1,5]
	  LINESTYLE = [0,0]
	  PSYM= [1,0]

	  XPOS= !X.CRANGE[1] &  YPOS = !Y.CRANGE[1] + 0.025*SPAN(!Y.CRANGE) & IF YLOG EQ 1 THEN YPOS = 10^(YPOS)
   	LEGEND,position =[XPOS ,YPOS],/BOTTOM,/RIGHT,/data,LABELS,COLORS=COLORS, PSYM=psym, LINESTYLE=LINESTYLE,$
    				 PSPACING=LEG_PSPACING,SPACING=LEG_SPACING,MARGIN=LEG_MARGIN,THICK=THICKS,$
    				  /BOX,/HORIZONTAL,/CLEAR,BACKGROUND_COLOR=BACKGROUND_COLOR,CHARSIZE=0.5

		COLORS[1] =0 & THICKS[1] = 1

		LEGEND,position =[XPOS ,YPOS],/BOTTOM,/RIGHT,/data,LABELS,COLORS=COLORS, PSYM=psym, LINESTYLE=LINESTYLE,$
   				 PSPACING=LEG_PSPACING,SPACING=LEG_SPACING,MARGIN=LEG_MARGIN,THICK=THICKS,$
   				  /BOX,/HORIZONTAL, CHARSIZE=0.5

		FRAME,/PLOT,COLOR=FRAME_COLOR,THICK=FRAME_THICK
		page_y = page_y > !y.region[1]
		DO_W = 0
	ENDIF
;	||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||


;	***********************************************************
	IF KEYWORD_SET(DO_M_BLOCK) THEN BEGIN	 ;
;	***********************************************************
		TITLE = 'Monthly Means'+ ' ' + LABEL
		FONTS,'TIMES' & PAL_SW3,R,G,B & TVLCT,R,G,B
		AX = AX_Y
		N_YEARS=SPAN(JD_2YEAR(AX.TICKV))
		_YTICKLEN = 0.005
		Z=(STATS_P.M.MEAN)

		IF STATS_P.TRANSFORMATION EQ 'ALOG' THEN Z=EXP(Z)
		YRANGE = MINMAX(Z,/FIN)

		JD = PERIOD_2JD(STATS_P.M.PERIOD) &
		YEARS = JD_2YEAR(PERIOD_2JD(STATS_P.M.PERIOD)) & YEAR = (WHERE_SETS(YEARS)).VALUE
		MONTHS= JD_2MONTH(JD)

		YEAR_AXIS_START = JD_2YEAR(AX.TICKV[0])

		DATA = FLTARR(N_YEARS,12) & DATA(*)=MISSINGS(DATA)
		DATA(FIX(YEARS)-FIX(YEAR_AXIS_START),MONTHS-1) = Z
		OK_MISS = WHERE(DATA EQ MISSINGS(DATA),COUNT_MISS)

;		===> RELATIVE SCALING OF DATA
 		NR= NICE_RANGE(DATA) & LNR = ALOG10(NR) & BDATA=SCALE(ALOG10(DATA), [1,250],MIN=LNR[0],MAX=LNR[1])

;		===> Fixed range
; 		BDATA = SD_SCALES(PROD=USE_PROD,DATA,/DATA2BIN)


	  IF COUNT_MISS GE 1 THEN BDATA(OK_MISS) = 254

    YTICKS = 13 & YTICKV = FINDGEN(13)+0.5 & YRANGE=[1,13]
    MONTH_LETTER= MONTH_NAMES(/LETTER)

    IMG_CON,BDATA,BDATA,XSTYLE=5,YSTYLE=5,/NOCONTOUR,CHARSIZE=AXIS_CHARSIZE,TITLE=TITLE

    XRANGE = MINMAX(AX.TICKV)
		AXIS,XAXIS=0,XTICKS = AX.TICKS,XTICKV = AX.TICKV,XTICKNAME=AX.TICKNAME,COLOR=0,XRANGE=XRANGE,/XSTYLE,CHARSIZE=AXIS_CHARSIZE
 		AXIS,YAXIS=0,YTICKS = YTICKS,YTICKV = YTICKV,YTICKNAME=MONTH_LETTER,COLOR=0,YRANGE=YRANGE,/YSTYLE,YTICKLEN=_YTICKLEN,CHARSIZE=AXIS_CHARSIZE
 		XY=COORD_2PLOT(0.783,1.02, /TO_NORMAL)
 		X = XY.X
 		Y = XY.Y


;		LEG=COLOR_BAR_SCALE(PROD=PROD,POS = [X,Y,X+.2,Y+.003],XTITLE= PROD_TITLE,PX=1000,PY=100,CHARSIZE=1,/PS)

    leg=color_bar_scale(minval= nr[0]  , maxval= nr[1]   , mincolor= 1,  maxcolor = 250  ,xtickv=NR,POS = [X,Y,X+.2,Y+.003],XTITLE= PROD_TITLE,PX=1000,PY=100,CHARSIZE=1,/PS)

		FRAME,/PLOT,COLOR=FRAME_COLOR,THICK=FRAME_THICK
		page_y = page_y > !y.region[1]
		DO_M_BLOCK = 0
  ENDIF
;	||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||


;	***************************************************************************************************************
	IF KEYWORD_SET(DO_M_ANOM) THEN BEGIN ;	*** PLOT (!M-!MONTH)
;	***************************************************************************************************************
		TITLE = 'Monthly Anomaly & Trend' + ' ' + LABEL
		AX = AX_Y
		AX = AX_Y
		XRANGE = MINMAX(AX.TICKV)
		Y 	= STATS_P.M.ANOM
		YRANGE = MINMAX(Y,/FIN)

;		===> Get the !M Anomaly Trend x,y
		DYEAR = JD_2DYEAR(STATS_P.M.JD)
		YY = STATS_P.TREND_M_ANOM.INT + STATS_P.TREND_M_ANOM.SLOPE*DYEAR

		IF STATS_P.TRANSFORMATION EQ 'ALOG' THEN BEGIN
			YLOG=1 & Y=EXP(Y) &	YY=EXP(YY) & YRANGE=EXP(YRANGE)	& Y_ZERO = 1.0
			AY=LOG_AXIS(YRANGE) & YTICKS=AY.TICKS &	YTICKV=AY.TICKV & YTICKNAME=AY.TICKNAME_MAJOR
			YRANGE = MINMAX(AY.TICKV)
      RATIO = 1 & Y_ZERO = 0.0
      YTITLE = 'Anomaly Ratio'
		ENDIF ELSE BEGIN
			YLOG = 0 & & Y_ZERO = 0.0
			YTICKS=0 & YTICKV=0 & YTICKNAME='' & YMINOR = 1 & RATIO = 0
			YTITLE = 'Anomaly '+UNITS(PROD,/NO_NAME)
		ENDELSE

		FONTS,'TIMES' & PAL_36,R,G,B & TVLCT,R,G,B

		PLOT, AX.JD,Y, YLOG=YLOG, XRANGE=XRANGE,/XSTYLE, YRANGE=YRANGE,/YSTYLE,TITLE=TITLE, YTITLE=YTITLE, $
					YTICKS=YTICKS,YTICKV=YTICKV,YTICKNAME=YTICKNAME,YMINOR=YMINOR,$
					YTICKLEN = YTICKLEN,$
					XTICKS=AX.TICKS,XTICKNAME=AX.TICKNAME,XTICKV=AX.TICKV,$
					XTICK_GET=XTICK_GET,YTICK_GET=ytick_get,CHARSIZE=AXIS_CHARSIZE,/NODATA

		FONTS,'TIMES' & PAL_36,R,G,B & TVLCT,R,G,B

		BACKGROUND,COLOR=BACKGROUND_COLOR,/PLOT

		GRIDS, X= AX_Y.TICKV,/NO_Y, COLOR=TC[0],THICK=GRID_YEAR_THICK,/ALL
		GRIDS, Y= YTICK_GET,/NO_X, COLOR=TC(33),THICK=GRID_Y_THICK,/ALL

	;	===> 0 LINE
		PLOT_LINE,Y=Y_ZERO,COLOR=TC(PER_COLORS[0]),THICK=1,LINESTYLE=1

	;	===> Plot the !M ANOMALY
		OPLOT, STATS_P.M.JD,	Y,COLOR=ANOM_COLOR,THICK=ANOM_THICK
		OPLOT, STATS_P.M.JD,	Y,COLOR=OVERLINE_COLOR,THICK=OVERLINE_THICK


		OPLOT, STATS_P.M.JD, YY, COLOR= TREND_COLOR,THICK=TREND_THICK
		OPLOT, STATS_P.M.JD, YY, COLOR= OVERLINE_COLOR,THICK=OVERLINE_THICK,LINESTYLE=1

		LABELS = ['Anomaly ','Trend '+STRING(STATS_P.TREND_M_ANOM.SLOPE,FORMAT=FMT_SLOPE)+'/Yr']
	  COLORS = [ANOM_COLOR,TREND_COLOR]
	  THICKS = [ANOM_THICK,TREND_THICK]
	  PSYM= [0,0]
	  LSIZE=0.5
	  LINESTYLE= [0,1]
		XPOS= !X.CRANGE[1] &  YPOS = !Y.CRANGE[1] + 0.025*SPAN(!Y.CRANGE) & IF YLOG EQ 1 THEN YPOS = 10^(YPOS)
   	LEGEND,position =[XPOS ,YPOS],/BOTTOM,/RIGHT,/data,LABELS,COLORS=COLORS, PSYM=psym, LINESTYLE=LINESTYLE,$
    				 PSPACING=LEG_PSPACING,SPACING=LEG_SPACING,MARGIN=LEG_MARGIN,THICK=THICKS,$
    				  /BOX,/HORIZONTAL,/CLEAR,BACKGROUND_COLOR=BACKGROUND_COLOR,CHARSIZE=0.5

		COLORS(*) =0 & THICKS(*) = 1
		LEGEND,position =[XPOS ,YPOS],/BOTTOM,/RIGHT,/data,LABELS,COLORS=COLORS, PSYM=psym, LINESTYLE=LINESTYLE,$
   				 PSPACING=LEG_PSPACING,SPACING=LEG_SPACING,MARGIN=LEG_MARGIN,THICK=THICKS,$
   				  /BOX,/HORIZONTAL, CHARSIZE=0.5

		FRAME,/PLOT,COLOR=FRAME_COLOR,THICK=FRAME_THICK
		page_y = page_y > !y.region[1]
		DO_M_ANOM = 0
	ENDIF
;	|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||


;	***************************************************************************************************************
	IF KEYWORD_SET(DO_M_AC) THEN BEGIN ; 	*** PLOT !M ANOMALY (!M-!MONTH) BY M  ***
;	***************************************************************************************************************
		TITLE = 'Monthly & Mean Annual Cycle' + ' ' + LABEL
		AX = AX_Y
		XRANGE = MINMAX(AX.TICKV)
		Y = STATS_P.M.MEAN
		YY= STATS_P.M.PERIOD_MEAN
		YRANGE = MINMAX(Y,/FIN)

		IF STATS_P.TRANSFORMATION EQ 'ALOG' THEN BEGIN
			YLOG=1 & Y=EXP(Y) &	YY=EXP(YY) & YRANGE=EXP(YRANGE)
			AY=LOG_AXIS(YRANGE) & YTICKS=AY.TICKS &	YTICKV=AY.TICKV & YTICKNAME=AY.TICKNAME_MAJOR
			YRANGE = MINMAX(AY.TICKV)
		ENDIF ELSE BEGIN
			YLOG = 0 & YTICKS=0 & YTICKV=0 & YTICKNAME=''
		ENDELSE

		FONTS,'TIMES' & PAL_36,R,G,B & TVLCT,R,G,B

		PLOT, AX.JD,Y, YLOG=YLOG,XRANGE=XRANGE,/XSTYLE, YRANGE=YRANGE,/YSTYLE,TITLE=TITLE, YTITLE=PROD_TITLE, $
					YTICKS=YTICKS,YTICKV=YTICKV,YTICKNAME=YTICKNAME,$
					YTICKLEN = YTICKLEN,$
					XTICKS=AX.TICKS,XTICKNAME=AX.TICKNAME,XTICKV=AX.TICKV,$
					XTICK_GET=XTICK_GET,YTICK_GET=ytick_get,CHARSIZE=AXIS_CHARSIZE,/NODATA

		BACKGROUND,COLOR=BACKGROUND_COLOR,/PLOT

		GRIDS, X= AX_Y.TICKV,/NO_Y, 	COLOR=TC[0],THICK=GRID_YEAR_THICK,/ALL
		GRIDS, Y= YTICK_GET,	/NO_X, 	COLOR=TC(33),THICK=GRID_Y_THICK,/ALL

	;	===> Plot the !MONTH cycle repetedly
		OPLOT, STATS_P.M.JD,	YY, COLOR=TC(PER_COLORS(3)),THICK=3,LINESTYLE=0
		OPLOT, STATS_P.M.JD,	YY, COLOR=TC(PER_COLORS[0]),THICK=1,LINESTYLE=0

	;	===> Plot the !M-!MONTH anomaly
		OPLOT, STATS_P.M.JD,	Y,	COLOR=TC(PER_COLORS(2)),THICK=5
		OPLOT, STATS_P.M.JD,	Y,	COLOR=OVERLINE_COLOR,THICK=OVERLINE_THICK

		LABELS = ['Monthly', 'Mean Annual Cycle']
	  COLORS = [PER_COLORS(2),PER_COLORS(3)]
	  THICKS = [5,5]
	  PSYM= [0,0]
	  LSIZE=0.5
		LINESTYLE=[0,0]
		XPOS= !X.CRANGE[1] &  YPOS = !Y.CRANGE[1] + 0.025*SPAN(!Y.CRANGE) & IF YLOG EQ 1 THEN YPOS = 10^(YPOS)
   	LEGEND,position =[XPOS ,YPOS],/BOTTOM,/RIGHT,/data,LABELS,COLORS=COLORS, PSYM=psym, LINESTYLE=LINESTYLE,$
    				 PSPACING=LEG_PSPACING,SPACING=LEG_SPACING,MARGIN=LEG_MARGIN,THICK=THICKS,$
    				  /BOX,/HORIZONTAL,/CLEAR,BACKGROUND_COLOR=BACKGROUND_COLOR,CHARSIZE=0.5

		COLORS(*) =0 & THICKS(*) = 1
		LEGEND,position =[XPOS ,YPOS],/BOTTOM,/RIGHT,/data,LABELS,COLORS=COLORS, PSYM=psym, LINESTYLE=LINESTYLE,$
   				 PSPACING=LEG_PSPACING,SPACING=LEG_SPACING,MARGIN=LEG_MARGIN,THICK=THICKS,$
   				  /BOX,/HORIZONTAL, CHARSIZE=0.5



		FRAME,/PLOT,COLOR=FRAME_COLOR,THICK=FRAME_THICK
		page_y = page_y > !y.region[1]
		DO_M_AC = 0
	ENDIF ;
;	||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||


;	***************************************************************************************************************
	IF KEYWORD_SET(DO_DOY) THEN BEGIN ; 	*** PLOT !DOY  ***
;	***************************************************************************************************************
		TITLE = 'Annual DOY Cycle' + ' ' + LABEL
		AX = AX_DOY
		Y = STATS_P.DOY.MEAN
	;	YY= STATS_P.DOY.MEAN
	;	YY= STATS_P.M.PERIOD_MEAN
		YRANGE = MINMAX(Y,/FIN)

		IF STATS_P.TRANSFORMATION EQ 'ALOG' THEN BEGIN
			YLOG=1 & Y=EXP(Y) &	YY=EXP(YY) & YRANGE=EXP(YRANGE)
			AY=LOG_AXIS(YRANGE) & YTICKS=AY.TICKS &	YTICKV=AY.TICKV & YTICKNAME=AY.TICKNAME_MAJOR
			YRANGE = MINMAX(AY.TICKV)
		ENDIF ELSE BEGIN
			YLOG = 0 & YTICKS=0 & YTICKV=0 & YTICKNAME=''
		ENDELSE

		FONTS,'TIMES' & PAL_36,R,G,B & TVLCT,R,G,B


		PLOT, AX.JD,Y, YLOG=YLOG, YRANGE=YRANGE,/YSTYLE,TITLE=TITLE, YTITLE=PROD_TITLE, $
					YTICKS=YTICKS,YTICKV=YTICKV,YTICKNAME=YTICKNAME,$
					YTICKLEN = YTICKLEN,$
					XTICKS=AX.TICKS,XTICKNAME=AX.TICKNAME,XTICKV=AX.TICKV,$
					XTICK_GET=XTICK_GET,YTICK_GET=ytick_get,CHARSIZE=AXIS_CHARSIZE,/NODATA

		BACKGROUND,COLOR=BACKGROUND_COLOR,/PLOT

		GRIDS, X= AX_M.TICKV,/NO_Y, 	COLOR=TC[0],THICK=GRID_YEAR_THICK,/ALL
		GRIDS, Y= YTICK_GET,	/NO_X, 	COLOR=TC(33),THICK=GRID_Y_THICK,/ALL

	;	===> Plot the !MONTH cycle repetedly
;		OPLOT, STATS_P.M.JD,	YY, COLOR=TC(PER_COLORS(3)),THICK=3,LINESTYLE=0
;		OPLOT, STATS_P.M.JD,	YY, COLOR=TC(PER_COLORS[0]),THICK=1,LINESTYLE=0

	;	===> Plot the !M-!MONTH anomaly
		OPLOT, STATS_P.DOY.JD,	Y,	COLOR=TC(PER_COLORS(2)),THICK=5
		OPLOT, STATS_P.DOY.JD,	Y,	COLOR=OVERLINE_COLOR,THICK=OVERLINE_THICK

		LABELS = ['DOY', 'Mean Annual Cycle']
	  COLORS = [PER_COLORS(2),PER_COLORS(3)]
	  THICKS = [5,5]
	  PSYM= [0,0]
	  LSIZE=0.5
		LINESTYLE=[0,0]
		XPOS= !X.CRANGE[1] &  YPOS = !Y.CRANGE[1] + 0.025*SPAN(!Y.CRANGE) & IF YLOG EQ 1 THEN YPOS = 10^(YPOS)
   	LEGEND,position =[XPOS ,YPOS],/BOTTOM,/RIGHT,/data,LABELS,COLORS=COLORS, PSYM=psym, LINESTYLE=LINESTYLE,$
    				 PSPACING=LEG_PSPACING,SPACING=LEG_SPACING,MARGIN=LEG_MARGIN,THICK=THICKS,$
    				  /BOX,/HORIZONTAL,/CLEAR,BACKGROUND_COLOR=BACKGROUND_COLOR,CHARSIZE=0.5

		COLORS(*) =0 & THICKS(*) = 1
		LEGEND,position =[XPOS ,YPOS],/BOTTOM,/RIGHT,/data,LABELS,COLORS=COLORS, PSYM=psym, LINESTYLE=LINESTYLE,$
   				 PSPACING=LEG_PSPACING,SPACING=LEG_SPACING,MARGIN=LEG_MARGIN,THICK=THICKS,$
   				  /BOX,/HORIZONTAL, CHARSIZE=0.5



		FRAME,/PLOT,COLOR=FRAME_COLOR,THICK=FRAME_THICK
		page_y = page_y > !y.region[1]
		DO_DOY = 0
	ENDIF ;
;	||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||


;	********************************************************************
	IF KEYWORD_SET(DO_AC) THEN BEGIN	 ;	*** PLOT !MONTH				 ***
;	********************************************************************
		TITLE = 'Mean Annual Cycle' + ' ' + LABEL
		AX = AX_MONTH
		Y=STATS_P.MONTH.MEAN & Y_MIN=STATS_P.MONTH.MIN & Y_MAX=STATS_P.MONTH.MAX & YRANGE = MINMAX([Y_MIN,Y_MAX],/FIN)
		FONTS,'TIMES' & PAL_36,R,G,B & TVLCT,R,G,B

		IF STATS_P.TRANSFORMATION EQ 'ALOG' THEN BEGIN
			YLOG=1 & Y=EXP(Y) &	Y_MIN=EXP(Y_MIN) & Y_MAX=EXP(Y_MAX) & YRANGE=EXP(YRANGE)
			AY=LOG_AXIS(YRANGE) & YTICKS=AY.TICKS &	YTICKV=AY.TICKV & YTICKNAME=AY.TICKNAME_MAJOR
			YRANGE = MINMAX(AY.TICKV)
		ENDIF ELSE BEGIN
			YLOG = 0 & YTICKS=0 & YTICKV=0 & YTICKNAME=''
		ENDELSE

		PLOT, AX.JD,Y, YLOG=YLOG, YRANGE=YRANGE,/YSTYLE,TITLE=TITLE, YTITLE=PROD_TITLE, $
					YTICKS=YTICKS,YTICKV=YTICKV,YTICKNAME=YTICKNAME,$
					YTICKLEN = YTICKLEN,$
					XTICKS=AX.TICKS,XTICKNAME=AX.TICKNAME,XTICKV=AX.TICKV,$
					XTICK_GET=XTICK_GET,YTICK_GET=ytick_get,CHARSIZE=AXIS_CHARSIZE,/NODATA

		BACKGROUND,COLOR=BACKGROUND_COLOR,/PLOT

		GRIDS, X= AX_MONTH.TICKV,/NO_Y, COLOR=TC[0],THICK=GRID_YEAR_THICK,/ALL
		GRIDS, Y= YTICK_GET,/NO_X, COLOR=TC(33),THICK=GRID_Y_THICK,/ALL

		OPLOT, STATS_P.MONTH.JD,	Y,COLOR=TC(PER_COLORS(3)),THICK=7
		OPLOT, STATS_P.MONTH.JD,	Y,COLOR=OVERLINE_COLOR,THICK=OVERLINE_THICK

		OPLOT, STATS_P.MONTH.JD,	Y_MIN,COLOR=TC(PER_COLORS[0]),THICK=2,LINESTYLE = 2
		OPLOT, STATS_P.MONTH.JD,	Y_MAX,COLOR=TC(PER_COLORS[0]),THICK=2,LINESTYLE = 1

 ;	===> Min and Max Month
		PLOTS, STATS_P.ANNUAL.JD_MIN, Y(STATS_P.ANNUAL.SUB_MIN),PSYM=MINMAX_SYM,COLOR=MINMAX_COLOR,THICK=MINMAX_THICK
		PLOTS, STATS_P.ANNUAL.JD_MAX, Y(STATS_P.ANNUAL.SUB_MAX),PSYM=MINMAX_SYM,COLOR=MINMAX_COLOR,THICK=MINMAX_THICK

		LABELS = ['Maximum',STRTRIM(STATS_P.YEAR.N,2) +'-Yr Mean','Minimum']
	  COLORS = [0,PER_COLORS(3),0]
	  linestyle = [1,0,2]
	  THICKS = [2,5,2]
	  PSYM= [0,0,0]

	  XPOS= !X.CRANGE[1] &  YPOS = !Y.CRANGE[1] + 0.025*SPAN(!Y.CRANGE) & IF YLOG EQ 1 THEN YPOS = 10^(YPOS)
   	LEGEND,position =[XPOS ,YPOS],/BOTTOM,/RIGHT,/data,LABELS,COLORS=COLORS, PSYM=psym, LINESTYLE=LINESTYLE,$
    				 PSPACING=LEG_PSPACING,SPACING=LEG_SPACING,MARGIN=LEG_MARGIN,THICK=THICKS,$
    				  /BOX,/HORIZONTAL,/CLEAR,BACKGROUND_COLOR=BACKGROUND_COLOR,CHARSIZE=0.5

		COLORS[1] =0 & THICKS[1] = 1
		LEGEND,position =[XPOS ,YPOS],/BOTTOM,/RIGHT,/data,LABELS,COLORS=COLORS, PSYM=psym, LINESTYLE=LINESTYLE,$
   				 PSPACING=LEG_PSPACING,SPACING=LEG_SPACING,MARGIN=LEG_MARGIN,THICK=THICKS,$
   				  /BOX,/HORIZONTAL, CHARSIZE=0.5

		FRAME,/PLOT,COLOR=FRAME_COLOR,THICK=FRAME_THICK
		page_y = page_y > !y.region[1]
		DO_AC = 0
	ENDIF
;	|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||





;	***************************************************************************************************************
	IF KEYWORD_SET(DO_M_MONTH) THEN BEGIN ;	*** PLOT !M ANOMALY (!M-!MONTH) BY MONTH
;	***************************************************************************************************************
		TITLE = 'Annual Cycle' + ' ' + LABEL
		YTITLE = PROD_TITLE

		Y = STATS_P.M.MEAN
		YY = STATS_P.MONTH.MEAN
		YRANGE = MINMAX(Y,/FIN)
		SETS 	= WHERE_SETS(JD_2YEAR(STATS_P.M.JD))

		IF STATS_P.TRANSFORMATION EQ 'ALOG' THEN BEGIN
			YLOG = 1 & Y=EXP(Y) & YY=EXP(YY) & YRANGE = EXP(YRANGE)
			AY=LOG_AXIS(YRANGE)
			YTICKS=AY.TICKS & YTICKV=AY.TICKV & YTICKNAME=AY.TICKNAME_MAJOR
			YRANGE = MINMAX(AY.TICKV)
		ENDIF ELSE BEGIN
			YLOG=0 & YTICKS=0 & YTICKV=0 & YTICKNAME=''
		ENDELSE

	 	FONTS,'TIMES' & PAL_36,R,G,B & TVLCT,R,G,B

		PLOT, STATS_P.MONTH.JD,Y,XTICKS=AX_MONTH.TICKS,XTICKNAME=AX_MONTH.TICKNAME,XTICKV=AX_MONTH.TICKV,$
					YTITLE=YTITLE,YTICKS=YTICKS,YTICKV=YTICKV,YTICKNAME=YTICKNAME,YMINOR=YMINOR,$
					TITLE=TITLE,$
					YRANGE=YRANGE, XTICK_GET=XTICK_GET,YTICK_GET=ytick_get,/YSTYLE,CHARSIZE=AXIS_CHARSIZE,	/NODATA
		BACKGROUND,COLOR=BACKGROUND_COLOR,/PLOT
		GRIDS, X= AX_MONTH.TICKV,/NO_Y, COLOR=TC[0],THICK=GRID_YEAR_THICK,/ALL
		GRIDS, Y= YTICK_GET,/NO_X, 			COLOR=TC(33),THICK=GRID_Y_THICK,/ALL

;		===> PLOT THE !MONTH MEAN
		OPLOT, STATS_P.MONTH.JD, YY,COLOR=TC(PER_COLORS[0]),THICK=9,LINESTYLE=2
		OPLOT, STATS_P.MONTH.JD,	YY,COLOR=OVERLINE_COLOR,THICK=OVERLINE_THICK
	  TXT_YEAR= STRTRIM(N_ELEMENTS(SETS),2)+'-Yr'

	;	LLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLL
		FOR _SETS = 0,N_ELEMENTS(SETS)-1 DO BEGIN
		 ASET = SETS(_SETS)
		 AYEAR = SETS(_SETS).VALUE
		 ACOLOR = YEAR_COLORS(_SETS)
		 SUBS = WHERE_SETS_SUBS(ASET)
		 _STATS_P=STATS_P.M(SUBS)
		 DATE = JD_2DATE(_STATS_P.JD)
		 DATE = '2020'+STRMID(DATE,4)
		 JD   = DATE_2JD(DATE)
		 YY		= Y(SUBS)
		 IF N_ELEMENTS(JD) GT 1 THEN BEGIN
		 	OPLOT, JD,	YY,COLOR=TC(ACOLOR),THICK=5
		 	OPLOT, JD,	YY,COLOR=TC[0],THICK=1
		 ENDIF ELSE BEGIN
		 	PLOTS, JD,	YY,COLOR=TC(ACOLOR),THICK=5
		 	PLOTS, JD,	YY,COLOR=TC[0],THICK=1
		 ENDELSE
		 TXT_YEAR = [TXT_YEAR,STRTRIM(AYEAR,2)]
		ENDFOR


		LABELS = REVERSE(TXT_YEAR)
	  COLORS = REVERSE([0,YEAR_COLORS(0:N_ELEMENTS(TXT_YEAR)-2 )])
	  LINESTYLE = REVERSE([1,REPLICATE(0,N_ELEMENTS(TXT_YEAR)-1)])

	  THICKS = REPLICATE(5,N_ELEMENTS(LABELS))
	  PSYM=   REPLICATE(0,N_ELEMENTS(LABELS))

	  LSIZE=0.35

		XPOS= !X.CRANGE[1] &  YPOS = !Y.CRANGE[1] + 0.025*SPAN(!Y.CRANGE) ;;& IF YLOG EQ 1 THEN YPOS = 10^(YPOS)

   	LEGEND,position =[XPOS ,YPOS],/BOTTOM,/RIGHT,/data,LABELS,COLORS=COLORS, PSYM=psym, LINESTYLE=LINESTYLE,$
    				 PSPACING=LEG_PSPACING,SPACING=LEG_SPACING,MARGIN=LEG_MARGIN,THICK=THICKS,$
    				  /BOX,/HORIZONTAL,/CLEAR,BACKGROUND_COLOR=BACKGROUND_COLOR,CHARSIZE=0.5

		COLORS(*) =0 & THICKS(*) = 1
		LEGEND,position =[XPOS ,YPOS],/BOTTOM,/RIGHT,/data,LABELS,COLORS=COLORS, PSYM=psym, LINESTYLE=LINESTYLE,$
   				 PSPACING=LEG_PSPACING,SPACING=LEG_SPACING,MARGIN=LEG_MARGIN,THICK=THICKS,$
   				  /BOX,/HORIZONTAL, CHARSIZE=0.5


		FRAME,/PLOT,COLOR=FRAME_COLOR,THICK=FRAME_THICK
		page_y = page_y > !y.region[1]
		DO_M_MONTH = 0
	ENDIF;
;	|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||




;	***********************************************************
	IF KEYWORD_SET(DO_M_ANOM_BLOCK) THEN BEGIN	 ;
;	***********************************************************
		TITLE = 'Monthly Anomaly' + ' ' + LABEL
		FONTS,'TIMES' & PAL_ANOM,R,G,B & TVLCT,R,G,B
		AX = AX_Y
		N_YEARS=SPAN(JD_2YEAR(AX.TICKV))

		XRANGE = MINMAX(AX.TICKV)
		Z=(STATS_P.M.ANOM)
		IF STATS_P.TRANSFORMATION EQ 'ALOG' THEN BEGIN
			Z=EXP(Z)
			RATIO = 1
			BAR_TITLE = 'Anomaly Ratio'
		ENDIF ELSE BEGIN
			RATIO = 0
			BAR_TITLE = 'Anomaly '+UNITS(PROD,/NO_NAME)
		ENDELSE

		YRANGE = MINMAX(Z,/FIN)
	 	JD = PERIOD_2JD(STATS_P.M.PERIOD) &
		YEARS = JD_2YEAR(PERIOD_2JD(STATS_P.M.PERIOD)) & YEAR = (WHERE_SETS(YEARS)).VALUE
		MONTHS= JD_2MONTH(JD)

		YEAR_AXIS_START = JD_2YEAR(AX.TICKV[0])

		DATA = FLTARR(N_YEARS,12) & DATA(*)=MISSINGS(DATA)
		DATA(FIX(YEARS)-FIX(YEAR_AXIS_START),MONTHS-1) = Z
		OK_MISS = WHERE(DATA EQ MISSINGS(DATA),COUNT_MISS)

		PROD_SCALE = GET_ANOM_PROD(DATA,RATIO=RATIO)

	  BDATA = SD_SCALES(PROD=PROD_SCALE,DATA,/DATA2BIN)
	  IF COUNT_MISS GE 1 THEN BDATA(OK_MISS) = 254

		XRANGE=[FIRST(YEARS),LAST(YEARS)+1]

   	YTICKS = 13 & YTICKV = FINDGEN(13)+0.5 & YRANGE=[1,13]
    MONTH_LETTER= MONTH_NAMES(/LETTER)

    IMG_CON,BDATA,BDATA,XSTYLE=5,YSTYLE=5,/NOCONTOUR,CHARSIZE=AXIS_CHARSIZE,TITLE=TITLE

		YTICKNAME = (MONTH_NAMES(/SHORT))(1:*)
		XTICKV = YEAR
		XTICKNAME=STRTRIM(YEAR,2)

 		XRANGE = MINMAX(AX.TICKV)
		AXIS,XAXIS=0,XTICKS = AX.TICKS,XTICKV = AX.TICKV,XTICKNAME=AX.TICKNAME,COLOR=0,XRANGE=XRANGE,/XSTYLE,CHARSIZE=AXIS_CHARSIZE
 		AXIS,YAXIS=0,YTICKS = YTICKS,YTICKV = YTICKV,YTICKNAME=MONTH_LETTER,COLOR=0,YRANGE=YRANGE,/YSTYLE,YTICKLEN=_YTICKLEN,CHARSIZE=AXIS_CHARSIZE

 		XY=COORD_2PLOT(0.783,1.02, /TO_NORMAL)
 		X = XY.X
 		Y = XY.Y

		LEG=COLOR_BAR_SCALE(PROD=PROD_SCALE,POS = [X,Y,X+.2,Y+.003],XTITLE=BAR_TITLE,PX=1000,PY=100,CHARSIZE=1,/PS)
		FRAME,/PLOT,COLOR=FRAME_COLOR,THICK=FRAME_THICK
		FRAME,/PLOT,COLOR=FRAME_COLOR,THICK=FRAME_THICK
		page_y = page_y > !y.region[1]
		DO_M_ANOM_BLOCK = 0
  ENDIF
;	|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\


;	*************************************************************************************************
	IF KEYWORD_SET(DO_MONTH_ANOM_TREND) THEN BEGIN ; 	*** PLOT !MONTH ANOMALY (!M-!MONTH) For each MONTH  ***
;	*************************************************************************************************
		TITLE = 'Trends by Month' + ' ' + LABEL
		AX = AX_MONTH

		Y = STATS_P.TREND_MONTH_ANOM.SLOPE
		YRANGE = NICE_RANGE(MINMAX(Y,/FIN))
		FONTS,'TIMES' & PAL_36,R,G,B & TVLCT,R,G,B


		IF STATS_P.TRANSFORMATION EQ 'ALOG' THEN BEGIN
			YLOG=1 & Y=EXP(Y) &	Y_MIN=EXP(Y_MIN) & Y_MAX=EXP(Y_MAX) & YRANGE=EXP(YRANGE)
			AY=LOG_AXIS(YRANGE) & YTICKS=AY.TICKS &	YTICKV=AY.TICKV & YTICKNAME=AY.TICKNAME_MAJOR
			YRANGE = MINMAX(AY.TICKV)
		ENDIF ELSE BEGIN
			YLOG = 0 & YTICKS=0 & YTICKV=0 & YTICKNAME=''
		ENDELSE

		PLOT, AX.JD,Y, YLOG=YLOG, YRANGE=YRANGE,/YSTYLE,TITLE=TITLE, YTITLE=PROD_TITLE, $
					YTICKS=YTICKS,YTICKV=YTICKV,YTICKNAME=YTICKNAME,$
					YTICKLEN = YTICKLEN,$
					XTICKS=AX.TICKS,XTICKNAME=AX.TICKNAME,XTICKV=AX.TICKV,$
					XTICK_GET=XTICK_GET,YTICK_GET=ytick_get,CHARSIZE=AXIS_CHARSIZE,/NODATA

		BACKGROUND,COLOR=BACKGROUND_COLOR,/PLOT

		GRIDS, X= AX_MONTH.TICKV,/NO_Y, COLOR=TC[0],THICK=GRID_YEAR_THICK,/ALL
		GRIDS, Y= YTICK_GET,/NO_X, COLOR=TC(33),THICK=GRID_Y_THICK,/ALL

		OPLOT, PERIOD_2JD(STATS_P.TREND_MONTH_ANOM.PERIOD)+15,	Y,COLOR=TC(PER_COLORS(3)),THICK=7
		OPLOT, PERIOD_2JD(STATS_P.TREND_MONTH_ANOM.PERIOD)+15,	Y,COLOR=OVERLINE_COLOR,THICK=OVERLINE_THICK


		LABELS = [STRTRIM(STATS_P.YEAR.N,2) +'-Yr Trend']
	  COLORS = [PER_COLORS(3)]
	  linestyle = [0]
	  THICKS = [5]
	  PSYM= [0]

	  XPOS= !X.CRANGE[1] &  YPOS = !Y.CRANGE[1] + 0.025*SPAN(!Y.CRANGE) & IF YLOG EQ 1 THEN YPOS = 10^(YPOS)
   	LEGEND,position =[XPOS ,YPOS],/BOTTOM,/RIGHT,/data,LABELS,COLORS=COLORS, PSYM=psym, LINESTYLE=LINESTYLE,$
    				 PSPACING=LEG_PSPACING,SPACING=LEG_SPACING,MARGIN=LEG_MARGIN,THICK=THICKS,$
    				  /BOX,/HORIZONTAL,/CLEAR,BACKGROUND_COLOR=BACKGROUND_COLOR,CHARSIZE=0.5

		COLORS[0] =0 & THICKS[0] = 1
		LEGEND,position =[XPOS ,YPOS],/BOTTOM,/RIGHT,/data,LABELS,COLORS=COLORS, PSYM=psym, LINESTYLE=LINESTYLE,$
   				 PSPACING=LEG_PSPACING,SPACING=LEG_SPACING,MARGIN=LEG_MARGIN,THICK=THICKS,$
   				  /BOX,/HORIZONTAL, CHARSIZE=0.5

		FRAME,/PLOT,COLOR=FRAME_COLOR,THICK=FRAME_THICK
		page_y = page_y > !y.region[1]
		DO_MONTH_ANOM_TREND = 0
	ENDIF
;	|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||




;	***************************************************************************************************************
	IF KEYWORD_SET(DO_Y) THEN BEGIN ; 	*** PLOT !Y
;	***************************************************************************************************************
		TITLE = 'Annual Mean' + ' ' + LABEL
		AX = AX_Y
		Y = STATS_P.Y.MEAN
		MISS=WHERE(STATS_P.Y.N LT MPY_MIN,COUNT)
		IF COUNT GE 1 THEN Y(MISS)=MISSINGS(Y(MISS))
		YTITLE = PROD_TITLE

		IF STATS_P.TRANSFORMATION EQ 'ALOG' THEN BEGIN
			Y=EXP(Y)
			YLOG=1
		ENDIF ELSE BEGIN
			YLOG=0
		ENDELSE

		YRANGE = MINMAX(Y,/FIN)
		JD = STATS_P.Y.JD
;		===> Adjust to plot at the year line
		JD=JD_2JD(JD,/YEAR,/START)
		JD_MIN=JD_2JD(STATS_P.YEAR.JD_MIN,/YEAR,/START)
		JD_MAX=JD_2JD(STATS_P.YEAR.JD_MAX,/YEAR,/START)

		FONTS,'TIMES' & PAL_36,R,G,B & TVLCT,R,G,B
		PLOT, JD,	Y,	YRANGE=YRANGE,/YSTYLE,TITLE=TITLE, YTITLE=YTITLE,$
					/XSTYLE,XTICKS=AX.TICKS,XTICKNAME=AX.TICKNAME,XTICKV=AX.TICKV,$
					XTICK_GET=XTICK_GET,YTICK_GET=ytick_get ,CHARSIZE=AXIS_CHARSIZE,/NODATA
		BACKGROUND,COLOR=BACKGROUND_COLOR,/PLOT

		GRIDS, X= AX_Y.TICKV,/NO_Y, COLOR=TC[0],THICK=GRID_YEAR_THICK,/ALL
		GRIDS, Y= YTICK_GET,/NO_X, COLOR=TC(33),THICK=GRID_Y_THICK,/ALL


	;	===> Plot the Annual Mean
		OPLOT, JD,	Y,COLOR=M_COLOR,THICK=5
		OPLOT, JD,  Y,COLOR=TC(PER_COLORS[0]),THICK=1


;		===> Plot symbols for each annual mean
		PLOTS, JD,	Y,COLOR=M_COLOR,THICK=5
		PLOTS, JD,  Y,COLOR=TC(PER_COLORS[0]),THICK=1

		PLOTS, JD, Y ,PSYM=1,COLOR=M_COLOR,THICK=3


;	===> Min and Max Year
		PLOTS, JD_MIN, Y(STATS_P.YEAR.SUB_MIN),PSYM=MINMAX_SYM,COLOR=MINMAX_COLOR,THICK=MINMAX_THICK
		PLOTS, JD_MAX, Y(STATS_P.YEAR.SUB_MAX),PSYM=MINMAX_SYM,COLOR=MINMAX_COLOR,THICK=MINMAX_THICK

		LABELS = ['Annual Mean']
	  COLORS = [M_COLOR]
	  THICKS = [5]
	  PSYM= [0]
	  LINESTYLE = [0]

 		LINESTYLE= [0]

		XPOS= !X.CRANGE[1] &  YPOS = !Y.CRANGE[1] + 0.025*SPAN(!Y.CRANGE) ;& IF YLOG EQ 1 THEN YPOS = 10^(YPOS)
   	LEGEND,position =[XPOS ,YPOS],/BOTTOM,/RIGHT,/data,LABELS,COLORS=COLORS, PSYM=psym, LINESTYLE=LINESTYLE,$
    				 PSPACING=LEG_PSPACING,SPACING=LEG_SPACING,MARGIN=LEG_MARGIN,THICK=THICKS,$
    				  /BOX,/HORIZONTAL,/CLEAR,BACKGROUND_COLOR=BACKGROUND_COLOR,CHARSIZE=0.5

		COLORS(*) =0 & THICKS(*) = 1
		LEGEND,position =[XPOS ,YPOS],/BOTTOM,/RIGHT,/data,LABELS,COLORS=COLORS, PSYM=psym, LINESTYLE=LINESTYLE,$
   				 PSPACING=LEG_PSPACING,SPACING=LEG_SPACING,MARGIN=LEG_MARGIN,THICK=THICKS,$
   				  /BOX,/HORIZONTAL, CHARSIZE=0.5


		FRAME,/PLOT,COLOR=FRAME_COLOR,THICK=FRAME_THICK
		page_y = page_y > !y.region[1]
		DO_Y = 0
	ENDIF ;
;	||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||


;	***************************************************************************************************************
	IF KEYWORD_SET(DO_Y_SPAN) THEN BEGIN ; 	*** PLOT !M ANOMALY (!M-!MONTH) BY M  ***
;	***************************************************************************************************************
		TITLE = 'Annual Span' + ' ' + LABEL
		AX = AX_Y
		Y = STATS_P.Y.SPAN

		IF STATS_P.TRANSFORMATION EQ 'ALOG' THEN BEGIN
			Y=EXP(Y) & YLOG = 1
			RATIO = 1
			YTITLE = 'Span Ratio'
		ENDIF ELSE BEGIN
			RATIO = 0 & YLOG = 0
			YTITLE = 'Span '+UNITS(PROD,/NO_NAME)
		ENDELSE

		YRANGE = MINMAX(Y,/FIN)

		FONTS,'TIMES' & PAL_36,R,G,B & TVLCT,R,G,B
		PLOT, STATS_P.Y.JD,	Y,	YRANGE=YRANGE,/YSTYLE,TITLE=TITLE, YTITLE=YTITLE,$
					XTICKS=AX.TICKS,XTICKNAME=AX.TICKNAME,XTICKV=AX.TICKV,$
					XTICK_GET=XTICK_GET,YTICK_GET=ytick_get ,CHARSIZE=AXIS_CHARSIZE,/NODATA
		BACKGROUND,COLOR=BACKGROUND_COLOR,/PLOT

		GRIDS, X= AX_Y.TICKV,/NO_Y, COLOR=TC[0],THICK=GRID_YEAR_THICK,/ALL
		GRIDS, Y= YTICK_GET,/NO_X, COLOR=TC(33),THICK=GRID_Y_THICK,/ALL

	;	===> Plot the Annual Span
		OPLOT, STATS_P.Y.JD,	Y,COLOR=SPAN_COLOR,THICK=5
		OPLOT, STATS_P.Y.JD,  Y,COLOR=OVERLINE_COLOR,THICK=1

		LABELS = ['Annual Span']
	  COLORS = [SPAN_COLOR]
	  THICKS = [5]
	  PSYM= [0]
	  LINESTYLE = [0]

 		LINESTYLE= [0]
		XPOS= !X.CRANGE[1] &  YPOS = !Y.CRANGE[1] + 0.025*SPAN(!Y.CRANGE) & IF YLOG EQ 1 THEN YPOS = 10^(YPOS)
   	LEGEND,position =[XPOS ,YPOS],/BOTTOM,/RIGHT,/data,LABELS,COLORS=COLORS, PSYM=psym, LINESTYLE=LINESTYLE,$
    				 PSPACING=LEG_PSPACING,SPACING=LEG_SPACING,MARGIN=LEG_MARGIN,THICK=THICKS,$
    				  /BOX,/HORIZONTAL,/CLEAR,BACKGROUND_COLOR=BACKGROUND_COLOR,CHARSIZE=0.5

		COLORS(*) =0 & THICKS(*) = 1
		LEGEND,position =[XPOS ,YPOS],/BOTTOM,/RIGHT,/data,LABELS,COLORS=COLORS, PSYM=psym, LINESTYLE=LINESTYLE,$
   				 PSPACING=LEG_PSPACING,SPACING=LEG_SPACING,MARGIN=LEG_MARGIN,THICK=THICKS,$
   				  /BOX,/HORIZONTAL, CHARSIZE=0.5


		FRAME,/PLOT,COLOR=FRAME_COLOR,THICK=FRAME_THICK
		page_y = page_y > !y.region[1]
		DO_Y_SPAN = 0
	ENDIF ;
;	||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||




;	***************************************************************************************************************
	IF KEYWORD_SET(DO_LNP_D) AND WHERE(TAG_NAMES(STATS_P) EQ 'LNP_D') GE 1 THEN BEGIN ;	***
;	***************************************************************************************************************
  	PAL_36
		TITLE = '' + ' ' + LABEL + ' (Daily Means)'
		XTITLE 	= UNITS('FREQ_Y')
		XTITLE2 = UNITS('PERIOD_Y')

	  YRANGE = MINMAX(DATA,/FIN)
 		XSTYLE = 5

			PLOT, STATS_P.LNP_D.FREQUENCY,STATS_P.LNP_D.SPECTRUM,XLOG=LNP_XLOG,YLOG=LNP_YLOG ,XRANGE=[MIN_CPY,MAX_CPY],XSTYLE=XSTYLE, YRANGE=_YRANGE_LNP,$
   		TITLE=TITLE,XTITLE=XTITLE, YTITLE='Power',$
   		XTHICK=2,YTHICK=1,YMINOR=1,COLOR=_COLOR_AXIS,$
   		XTICK_GET=XTICK_GET,YTICK_GET=YTICK_GET,CHARSIZE=AXIS_CHARSIZE,XTICKLEN=XTICKLEN, /NODATA

			BACKGROUND,COLOR=BACKGROUND_COLOR,/PLOT
			GRIDS, X= XTICK_GET,/NO_Y, COLOR=TC[0],THICK=GRID_YEAR_THICK,/ALL
			GRIDS, Y= YTICK_GET,/NO_X, COLOR=TC(33),THICK=GRID_Y_THICK,/ALL

			OPLOT, STATS_P.LNP_D.FREQUENCY,STATS_P.LNP_D.SPECTRUM, COLOR= CYCLE_COLOR,THICK=CYCLE_THICK
			OPLOT, STATS_P.LNP_D.FREQUENCY,STATS_P.LNP_D.SPECTRUM, COLOR=OVERLINE_COLOR,THICK=OVERLINE_THICK

			XTICKV   = XTICK_GET
			XTICKV2  = 1.0/XTICK_GET
   		XTICKNAME = NUM2STR(XTICKV,TRIM=2)
   		XTICKNAME2 = NUM2STR(XTICKV2,TRIM=2)
 ; 		YPOS = !Y.CRANGE[0] - 0.005*SPAN(!Y.CRANGE)

   		XY=COORD_2PLOT(0.5,-0.20)
   		XY2=COORD_2PLOT(0.25,1.09)

			XYOUTS, XY.X, XY.Y, XTITLE, /DATA,ALIGN = -0.05 ,CHARSIZE=0.75
   		XYOUTS, XY2.X,XY2.Y,XTITLE2,/DATA,ALIGN = 0.0 ,CHARSIZE=0.75

   		AXIS,XAXIS=0,XRANGE=10^!X.CRANGE,/XSTYLE,XTICKV=XTICKV,XTICKNAME=XTICKNAME,CHARSIZE=AXIS_CHARSIZE,XTICKLEN=LNP_XTICKLEN,XTHICK=2
   		AXIS,XAXIS=1,XRANGE = 1.0/(10^!X.CRANGE),/XSTYLE,/XLOG, XTICKV= XTICKV2,XTICKNAME=XTICKNAME2,CHARSIZE=AXIS_CHARSIZE,XTICKLEN=LNP_XTICKLEN,XTHICK=2

      ;STRUCT_SPREAD,SS, POSITION = [XY.X[0],XY.Y[0],XY.X(1),XY.Y(1)],COLOR_LINES=0,BACKGROUND=BACKGROUND_COLOR,/NO_LINES,CHARSIZE_TAGS=.5,CHARSIZE_DATA=0.5,/NO_TAGS

			LABELS = 'Normalized Power'
			COLORS=[CYCLE_COLOR]
 			LINESTYLE= [0]
 			THICKS = [CYCLE_THICK]

			XPOS= 10^!X.CRANGE[1] - 10^(0.025*SPAN(!X.CRANGE)) &  YPOS = !Y.CRANGE[1] + 0.025*SPAN(!Y.CRANGE) & IF YLOG EQ 1 THEN YPOS = 10^(YPOS)
   		LEGEND,position =[XPOS ,YPOS],/BOTTOM,/RIGHT,/data,LABELS,COLORS=COLORS, PSYM=psym, LINESTYLE=LINESTYLE,$
    				 PSPACING=LEG_PSPACING,SPACING=LEG_SPACING,MARGIN=LEG_MARGIN,THICK=THICKS,$
    				  /BOX,/HORIZONTAL,/CLEAR,BACKGROUND_COLOR=BACKGROUND_COLOR,CHARSIZE=0.5

			COLORS(*) =0 & THICKS(*) = 1
			LEGEND,position =[XPOS ,YPOS],/BOTTOM,/RIGHT,/data,LABELS,COLORS=COLORS, PSYM=psym, LINESTYLE=LINESTYLE,$
   				 PSPACING=LEG_PSPACING,SPACING=LEG_SPACING,MARGIN=LEG_MARGIN,THICK=THICKS,$
   				  /BOX,/HORIZONTAL, CHARSIZE=0.5

			FRAME,/PLOT,COLOR=FRAME_COLOR,THICK=FRAME_THICK

			page_y = page_y > !y.region[1]
			DO_LNP_D = 0
	ENDIF ;
;	||||||||||||||||||||||||||||||||||



;	***************************************************************************************************************
	IF KEYWORD_SET(DO_LNP_M_ANOM) AND WHERE(TAG_NAMES(STATS_P) EQ 'LNP_M_ANOM') GE 1 THEN BEGIN ;	***
;	***************************************************************************************************************
  	PAL_36
		TITLE = '' + ' ' + LABEL +   ' (Monthly Anomalies)'
		XTITLE 	= UNITS('FREQ_Y')
		XTITLE2 = UNITS('PERIOD_Y')


	  YRANGE = MINMAX(STATS_P.LNP_M_ANOM.SPECTRUM,/FIN)
 		XSTYLE = 5

			PLOT, STATS_P.LNP_M_ANOM.FREQUENCY,STATS_P.LNP_M_ANOM.SPECTRUM,XLOG=LNP_XLOG,YLOG=LNP_YLOG ,XRANGE=[MIN_CPY, MAX_CPY],XSTYLE=XSTYLE, YRANGE=YRANGE,$
   		TITLE=TITLE,XTITLE=XTITLE, YTITLE='Power',$
   		XTHICK=2,YTHICK=1,YMINOR=1,COLOR=_COLOR_AXIS,$
   		XTICK_GET=XTICK_GET,YTICK_GET=YTICK_GET,CHARSIZE=AXIS_CHARSIZE,XTICKLEN=XTICKLEN, /NODATA

			BACKGROUND,COLOR=BACKGROUND_COLOR,/PLOT
			GRIDS, X= XTICK_GET,/NO_Y, COLOR=TC[0],THICK=GRID_YEAR_THICK,/ALL
			GRIDS, Y= YTICK_GET,/NO_X, COLOR=TC(33),THICK=GRID_Y_THICK,/ALL

			OPLOT, STATS_P.LNP_M_ANOM.FREQUENCY,STATS_P.LNP_M_ANOM.SPECTRUM, COLOR= CYCLE_COLOR,THICK=CYCLE_THICK
			OPLOT, STATS_P.LNP_M_ANOM.FREQUENCY,STATS_P.LNP_M_ANOM.SPECTRUM, COLOR=OVERLINE_COLOR,THICK=OVERLINE_THICK

			XTICKV   = XTICK_GET
			XTICKV2  = 1.0/XTICK_GET
   		XTICKNAME = NUM2STR(XTICKV,TRIM=2)
   		XTICKNAME2 = NUM2STR(XTICKV2,TRIM=2)
 ; 		YPOS = !Y.CRANGE[0] - 0.005*SPAN(!Y.CRANGE)

   		XY=COORD_2PLOT(0.5,-0.20)
   		XY2=COORD_2PLOT(0.25,1.09)

			XYOUTS, XY.X, XY.Y, XTITLE, /DATA,ALIGN = -0.05 ,CHARSIZE=0.75
   		XYOUTS, XY2.X,XY2.Y,XTITLE2,/DATA,ALIGN = 0.0 ,CHARSIZE=0.75

   		AXIS,XAXIS=0,XRANGE=10^!X.CRANGE,/XSTYLE,XTICKV=XTICKV,XTICKNAME=XTICKNAME,CHARSIZE=AXIS_CHARSIZE,XTICKLEN=LNP_XTICKLEN,XTHICK=2
   		AXIS,XAXIS=1,XRANGE = 1.0/(10^!X.CRANGE),/XSTYLE,/XLOG, XTICKV= XTICKV2,XTICKNAME=XTICKNAME2,CHARSIZE=AXIS_CHARSIZE,XTICKLEN=LNP_XTICKLEN,XTHICK=2

      ;STRUCT_SPREAD,SS, POSITION = [XY.X[0],XY.Y[0],XY.X(1),XY.Y(1)],COLOR_LINES=0,BACKGROUND=BACKGROUND_COLOR,/NO_LINES,CHARSIZE_TAGS=.5,CHARSIZE_DATA=0.5,/NO_TAGS

			LABELS = 'Normalized Power'
			COLORS=[CYCLE_COLOR]
 			LINESTYLE= [0]
 			THICKS = [CYCLE_THICK]

			XPOS= 10^!X.CRANGE[1] - 10^(0.025*SPAN(!X.CRANGE)) &  YPOS = !Y.CRANGE[1] + 0.025*SPAN(!Y.CRANGE) & IF YLOG EQ 1 THEN YPOS = 10^(YPOS)
   		LEGEND,position =[XPOS ,YPOS],/BOTTOM,/RIGHT,/data,LABELS,COLORS=COLORS, PSYM=psym, LINESTYLE=LINESTYLE,$
    				 PSPACING=LEG_PSPACING,SPACING=LEG_SPACING,MARGIN=LEG_MARGIN,THICK=THICKS,$
    				  /BOX,/HORIZONTAL,/CLEAR,BACKGROUND_COLOR=BACKGROUND_COLOR,CHARSIZE=0.5

			COLORS(*) =0 & THICKS(*) = 1
			LEGEND,position =[XPOS ,YPOS],/BOTTOM,/RIGHT,/data,LABELS,COLORS=COLORS, PSYM=psym, LINESTYLE=LINESTYLE,$
   				 PSPACING=LEG_PSPACING,SPACING=LEG_SPACING,MARGIN=LEG_MARGIN,THICK=THICKS,$
   				  /BOX,/HORIZONTAL, CHARSIZE=0.5

			FRAME,/PLOT,COLOR=FRAME_COLOR,THICK=FRAME_THICK

			page_y = page_y > !y.region[1]
			DO_LNP_M_ANOM = 0
	ENDIF ;
;	||||||||||||||||||||||||||||||||||





;	***************************************************************************************************************
	IF KEYWORD_SET(DO_LNP_MONTHS_ANOM) THEN BEGIN ;	***
;	***************************************************************************************************************
		LOOP_START = 1 & LOOP_END = 3
		IF DO_LNP_ANOM_MONTH GE 1 THEN LOOP_END = 15
		PAL_36
;		LLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLL
		FOR LOOP = LOOP_START,LOOP_END DO BEGIN

		TITLE = '' + ' ' + LABEL
		XTITLE 	= UNITS('FREQ_Y')
		XTITLE2 = UNITS('PERIOD_Y')

		IF LOOP EQ 1 THEN XTITLE2= 'Monthly Means '+XTITLE2
		IF LOOP EQ 2 THEN XTITLE2= 'Monthly Anomalies '+XTITLE2
		IF LOOP EQ 3 THEN XTITLE2= 'Annual Spans '+XTITLE2


		IF LOOP EQ 4 THEN !P.MULTI = [0,1,12]

			IF LOOP EQ 1 THEN BEGIN
				JD = STATS_P.M.JD
				DATA = FLOAT(STATS_P.M.MEAN)
			ENDIF
			IF LOOP EQ 2 THEN BEGIN
				DATA = FLOAT(STATS_P.M.ANOM)
				JD = STATS_P.M.JD
			ENDIF
			IF LOOP EQ 3 THEN BEGIN
				DATA = FLOAT([STATS_P.Y.max - STATS_P.Y.min])
				JD =STATS_P.Y.JD
			ENDIF
			IF LOOP GE 4 AND LOOP LE 15 THEN BEGIN
				PER = PERIOD_2STRUCT(STATS_P.M.PERIOD)
				MONTH = LOOP-3
				OK=WHERE(FIX(PER.MONTH_START) EQ MONTH)
				DATA = STATS_P.M[OK].MEAN
				JD =STATS_P.Y.JD
				XTITLE2 = + XTITLE2+' '+  MONTH_NAMES(MONTH,/SHORT)
			ENDIF

			YRANGE = MINMAX(DATA,/FIN)

;IF LOOP GE 4 THEN BEGIN
;	PLOT,DATA
;	CONTINUE
;	ENDIF


			XSTYLE = 5

			PLOT, STATS_P.LNP_D.FREQUENCY,STATS_P.LNP_D.SPECTRUM,XLOG=LNP_XLOG,YLOG=LNP_YLOG ,XRANGE=[STATS_P.LNP_D.MIN_CPY,STATS_P.LNP_D.MAX_CPY],XSTYLE=XSTYLE, YRANGE=_YRANGE_LNP,$
   		TITLE=TITLE,XTITLE=XTITLE, YTITLE='Power',$
   		XTHICK=2,YTHICK=1,YMINOR=1,COLOR=_COLOR_AXIS,$
   		XTICK_GET=XTICK_GET,YTICK_GET=YTICK_GET,CHARSIZE=AXIS_CHARSIZE,XTICKLEN=XTICKLEN, /NODATA

			BACKGROUND,COLOR=BACKGROUND_COLOR,/PLOT
			GRIDS, X= XTICK_GET,/NO_Y, COLOR=TC[0],THICK=GRID_YEAR_THICK,/ALL
			GRIDS, Y= YTICK_GET,/NO_X, COLOR=TC(33),THICK=GRID_Y_THICK,/ALL

			OPLOT, STATS_P.LNP_D.FREQUENCY,STATS_P.LNP_D.SPECTRUM, COLOR= CYCLE_COLOR,THICK=CYCLE_THICK
			OPLOT, STATS_P.LNP_D.FREQUENCY,STATS_P.LNP_D.SPECTRUM, COLOR=OVERLINE_COLOR,THICK=OVERLINE_THICK

			XTICKV   = XTICK_GET
			XTICKV2  = 1.0/XTICK_GET
   		XTICKNAME = NUM2STR(XTICKV,TRIM=2)
   		XTICKNAME2 = NUM2STR(XTICKV2,TRIM=2)
 ; 		YPOS = !Y.CRANGE[0] - 0.005*SPAN(!Y.CRANGE)

   		XY=COORD_2PLOT(0.5,-0.20)
   		XY2=COORD_2PLOT(0.25,1.09)

			XYOUTS, XY.X, XY.Y, XTITLE, /DATA,ALIGN = -0.05 ,CHARSIZE=0.75
   		XYOUTS, XY2.X,XY2.Y,XTITLE2,/DATA,ALIGN = 0.0 ,CHARSIZE=0.75

   		AXIS,XAXIS=0,XRANGE=10^!X.CRANGE,/XSTYLE,XTICKV=XTICKV,XTICKNAME=XTICKNAME,CHARSIZE=AXIS_CHARSIZE,XTICKLEN=LNP_XTICKLEN,XTHICK=2
   		AXIS,XAXIS=1,XRANGE = 1.0/(10^!X.CRANGE),/XSTYLE,/XLOG, XTICKV= XTICKV2,XTICKNAME=XTICKNAME2,CHARSIZE=AXIS_CHARSIZE,XTICKLEN=LNP_XTICKLEN,XTHICK=2

      ;STRUCT_SPREAD,SS, POSITION = [XY.X[0],XY.Y[0],XY.X(1),XY.Y(1)],COLOR_LINES=0,BACKGROUND=BACKGROUND_COLOR,/NO_LINES,CHARSIZE_TAGS=.5,CHARSIZE_DATA=0.5,/NO_TAGS

			LABELS = 'Normalized Power'
			COLORS=[CYCLE_COLOR]
 			LINESTYLE= [0]
 			THICKS = [CYCLE_THICK]

			XPOS= 10^!X.CRANGE[1] - 10^(0.025*SPAN(!X.CRANGE)) &  YPOS = !Y.CRANGE[1] + 0.025*SPAN(!Y.CRANGE) & IF YLOG EQ 1 THEN YPOS = 10^(YPOS)
   		LEGEND,position =[XPOS ,YPOS],/BOTTOM,/RIGHT,/data,LABELS,COLORS=COLORS, PSYM=psym, LINESTYLE=LINESTYLE,$
    				 PSPACING=LEG_PSPACING,SPACING=LEG_SPACING,MARGIN=LEG_MARGIN,THICK=THICKS,$
    				  /BOX,/HORIZONTAL,/CLEAR,BACKGROUND_COLOR=BACKGROUND_COLOR,CHARSIZE=0.5

			COLORS(*) =0 & THICKS(*) = 1
			LEGEND,position =[XPOS ,YPOS],/BOTTOM,/RIGHT,/data,LABELS,COLORS=COLORS, PSYM=psym, LINESTYLE=LINESTYLE,$
   				 PSPACING=LEG_PSPACING,SPACING=LEG_SPACING,MARGIN=LEG_MARGIN,THICK=THICKS,$
   				  /BOX,/HORIZONTAL, CHARSIZE=0.5

			FRAME,/PLOT,COLOR=FRAME_COLOR,THICK=FRAME_THICK
			page_y = page_y > !y.region[1]

		ENDFOR ; FOR LOOP = 0,1 DO BEGIN
		DO_LNP_MONTHS_ANOM = 0
	ENDIF ;
;	||||||||||||||||||||||||||||||||||


ENDFOR ; SWITCHES

	IF STATS_P.N_PIXELS EQ 1 THEN TXT_PIXELS = 'Pixel' ELSE TXT_PIXELS = 'Pixels'


	IF STATS_P.LON NE MISSINGS(STATS_P.LON) AND STATS_P.LAT NE MISSINGS(STATS_P.LAT) THEN BEGIN
		TXT = STATS_P.PROD+', '+ROUNDS(STATS_P.LON,3)+UNITS('LON',/NO_NAME)+', '+ROUNDS(STATS_P.LAT,3)+UNITS('LAT',/NO_NAME)+' Map: '+STATS_P.MAP+', '+ROUNDS(STATS_P.XP)+'x, '+ROUNDS(STATS_P.YP)+ $
		'y, ('+ROUNDS(STATS_P.N_PIXELS)+' '+TXT_PIXELS+')' + ' ' + STATS_P.DATE_RANGE[0]+' '+ STATS_P.DATE_RANGE[1]
		XYOUTS,0.05,page_y,/NORMAL,TXT,CHARSIZE=1
	ENDIF ELSE BEGIN
			XYOUTS,0.05,page_y,/NORMAL,_PAGE_TITLE,CHARSIZE=1
	ENDELSE



 !X.OMARGIN=[0,0]


END; #####################  End of Routine ################################
