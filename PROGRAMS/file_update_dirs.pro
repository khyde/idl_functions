; $Id:	file_update_dirs.pro,	March 29 2011	$
;+
;
;	FILE_UPDATE

; EXAMPLE:
; FILE_UPDATE_DIRS,'D:\IDL\PROGRAMS\','Z'
; FILE_UPDATE_DIRS,'D:\IDL\PROGRAMS\','F:\BACKUP\PROGRAMS\', /FOLDER

; HISTORY:
;		May 20, 2003     Written by:	J.E. O'Reilly, NOAA, 28 Tarzwell Drive, Narragansett, RI 02882
;   April 26, 2007   Modified by: K.J.W.Hyde   Added the FOLDER keyword if the output directory does not match the input directory
;-
; *************************************************************************

PRO FILE_UPDATE_DIRS, DIR_IN,DISK_OUT, FOLDER=FOLDER

  SLASH = DELIMITER(/SLASH)

  ROUTINE_NAME='FILE_UPDATE_DIRS'
  IF N_ELEMENTS(DIR_IN) NE 1 THEN BEGIN
  	DIR_IN=''
  	READ,DIR_IN,PROMPT='ENTER INPUT SOURCE DIRECTORY: '
  ENDIF
  IF N_ELEMENTS(DISK_OUT) NE 1 THEN BEGIN
  	DISK_OUT=''
  	READ,DISK_OUT,PROMPT='ENTER TARGET DISK DRIVE FOR COPYING SOURCE DIRECTORY: '
  ENDIF
	_DISK_OUT = REMOVE_LAST_SLASH(DISK_OUT) & IF FILE_TEST(_DISK_OUT+':',/DIR) EQ 0 AND NOT KEYWORD_SET(FOLDER) THEN STOP
  DIRS = FILE_SEARCH(DIR_IN,'*',/TEST_DIRECTORY,/MARK_DIRECTORY)
  DIRS = [DIR_IN,DIRS]
  FOR _DIRS=0L,N_ELEMENTS(DIRS)-1L DO BEGIN
    ADIR=DIRS(_DIRS)
    IF ADIR EQ '' THEN CONTINUE
    PRINT, ADIR
    BDIR=_DISK_OUT+STRMID(ADIR,1)
    IF KEYWORD_SET(FOLDER) THEN BEGIN        
      IF ADIR EQ DIR_IN THEN BDIR= REPLACE(ADIR,DIR_IN,_DISK_OUT)+SLASH ELSE BDIR = _DISK_OUT + SLASH + REPLACE(ADIR,DIR_IN,'')
    ENDIF    
    IF FILE_TEST(BDIR,/DIRECTORY) EQ 0 THEN FILE_MKDIR,BDIR
    FILE_UPDATE,ADIR+'*.*', BDIR
  ENDFOR
END; #####################  End of Routine ################################
