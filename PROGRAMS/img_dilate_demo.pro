; $ID:	IMG_DILATE_DEMO.PRO,	2021-04-15-17,	USER-KJWH	$
; 
PRO IMG_DILATE_DEMO

; #########################################################################; 
;+
; THIS IS A DEMO ROUTINE FOR DILATING FEATURES IN AN IMAGE


; HISTORY:
;     JUN 15, 2017 - Written by K.J.W.Hyde, 28 Tarzwell Drive, NMFS, NOAA 02882 (kimberly.hyde@noaa.gov)
;     JUN 16, 2017 - KJWH: Added DO_SUBAREA example 
;-
; #########################################################################  

;************************
  ROUTINE  = 'IMG_DILATE_DEMO'
;************************


; ================>
; SWITCHES CONTROLLING WHICH PROCESSING STEPS TO DO:
  DO_COASTLINE      = 'Y'
  DO_SUBAREA        = 'Y'
  
   SL = PATH_SEP()
   DIR_DEMO = !S.DEMO + ROUTINE + SL & DIR_TEST, DIR_DEMO
 
; **********************************
  IF KEY(DO_COASTLINE) THEN BEGIN
; **********************************
    SWITCHES,DO_COASTLINE,STOPP=STOPP,OVERWRITE=OVERWRITE,VERBOSE=VERBOSE,INIT=INIT,R_FILES=R_FILES,R_DATASETS=R_DATASETS
    IF STOPP THEN STOP
    , 'DO_COASTLINE'
    PRINT,'THIS STEP DILATES A COASTLINE FOR THE NEC'
    
    MAPP = 'NEC'
    COAST = READ_LANDMASK(MAPP,/COASTLINE)
    DIL = IMG_DILATE(COAST,COLOR=1)
    
    W = WINDOW(DIMENSIONS=[1024,512])
    CIM = IMAGE(COAST,LAYOUT=[2,1,1],RGB_TABLE=CPAL_READ('PAL_LANDMASK'),MARGIN=0,/CURRENT)
    DIM = IMAGE(DIL,  LAYOUT=[2,1,2],RGB_TABLE=CPAL_READ('PAL_LANDMASK'),MARGIN=0,/CURRENT)
    TXT = TEXT(0.85,0.05,'BOX=DEFAULT',/NORMAL)
    
    WAIT, 5
    W.CLOSE
    
    BOXES = [1,2,3,5,7,9]
    FOR B=0, N_ELEMENTS(BOXES)-1 DO BEGIN
      DIL = IMG_DILATE(COAST,COLOR=1,BOX=BOXES(B))

      W = WINDOW(DIMENSIONS=[1024,512])
      CIM = IMAGE(COAST,LAYOUT=[2,1,1],RGB_TABLE=CPAL_READ('PAL_LANDMASK'),MARGIN=0,/CURRENT)
      DIM = IMAGE(DIL,  LAYOUT=[2,1,2],RGB_TABLE=CPAL_READ('PAL_LANDMASK'),MARGIN=0,/CURRENT)
      TXT = TEXT(0.85,0.05,'BOX='+NUM2STR(BOXES(B)),/NORMAL)
      
      WAIT, 5
      W.CLOSE
    ENDFOR        
  , 'DO_COASTLINE'
    
  ENDIF ; DO_COASTLINE
    
; **********************************
  IF KEY(DO_SUBAREA) THEN BEGIN
; **********************************
    SWITCHES,DO_SUBAREA,STOPP=STOPP,OVERWRITE=OVERWRITE,VERBOSE=VERBOSE,INIT=INIT,R_FILES=R_FILES,R_DATASETS=R_DATASETS
    IF STOPP THEN STOP
    , 'DO_SUBAREA'
    PRINT,'THIS STEP DILATES A SUBAREA BOUNDARY FOR THE LMES IN THE NEC MAP DOMAIN'

    MAPP = 'NEC'
    BLANK = MAPS_BLANK(MAPP,FILL=0)
    STRUCT = READ_SHPFILE('LMES64', MAPP=MAPP, COLOR=COLORS, OVERWRITE=OVERWRITE, VERBOSE=VERBOSE)
    
    OUTLINE = STRUCT.(0).LMES_64_OUTLINE
    BLANK(OUTLINE) = 1
    BOXES = [1,2,3,5,7,9]
    FOR B=0, N_ELEMENTS(BOXES)-1 DO BEGIN
      DIL = IMG_DILATE(BLANK,COLOR=1,BOX=BOXES(B),SUBS=SUBS)
      LAND = READ_LANDMASK(MAPP)
      LAND(SUBS) = 200
      DIM = IMAGE(LAND,RGB_TABLE=CPAL_READ('PAL_LANDMASK'),MARGIN=0)
      TXT = TEXT(0.85,0.05,'BOX='+NUM2STR(BOXES(B)),/NORMAL)
      WAIT, 5
      DIM.CLOSE
    ENDFOR  
    , 'DO_SUBAREA'
  ENDIF ; DO_SUBAREA
        
; ||||||||||||||||||||||||||||||||||||




END; #####################  END OF ROUTINE ################################
