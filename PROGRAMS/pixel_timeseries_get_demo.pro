; $ID:	PIXEL_TIMESERIES_GET_DEMO.PRO,	2020-06-26-15,	USER-KJWH	$
PRO PIXEL_TIMESERIES_GET_DEMO

	PSERIES_FILE = 'S:\OC-SEA_AQU-LAC-NEC\ts_images\pseries\TS_IMAGES-SEA_AQU-LAC-NEC-CHLOR_A-PSERIES_4120.INT'
	TEMPLATE_FILE = 'S:\OC-SEA_AQU-LAC-NEC\ts_images\iseries\TS_IMAGES-SEA_AQU-LAC-NEC-CHLOR_A-TEMPLATE.SAVE'

	DATA_SUBAREA = READALL('D:\IDL\IMAGES\MASK_SUBAREA-NEC-PXY_1024_1024-GOM_SHRIMP_2AREAS.SAVE')
	DATA_SUBAREA = DATA_SUBAREA.SUBAREA
	SUBAREA_CODES=DATA_SUBAREA.SUBAREA_CODE
	SUBAREA_NAMES=DATA_SUBAREA.SUBAREA_NAME
	PRINT, 'Subarea codes:   ',SUBAREA_CODES
	PRINT, 'Subarea names:   ',SUBAREA_NAMES


;  I tested with 'LATLON_SUBAREA-NEC-SITES.csv' to work with LON LAT, to obtain SUBS
;			DUMMY=BYTARR(PX,PY) & DUMMY(*,*)=1
;			ZWIN,DUMMY
;			CALL_PROCEDURE,'MAP_'+MAP
;			COLOR = MAP_DEG2IMAGE(DUMMY, LONS,LATS, X=X, Y=Y, AROUND=_AROUND,SUBS=SUBS)
;			ZWIN
;


	FOR _CODE=0,N_ELEMENTS(SUBAREA_CODES)-1L DO BEGIN
		ACODE=SUBAREA_CODES(_CODE)
		OK=WHERE(DATA_SUBAREA.IMAGE EQ ACODE,COUNT)
		IF COUNT LT 1 THEN CONTINUE
		SUBS=OK

		;get pixel timeseries for the subs

		TIMER
		pixel_timeseries=PIXEL_TIMESERIES_GET(PSERIES=PSERIES_FILE,TEMPLATE=TEMPLATE_FILE,SUBS=SUBS,JULIAN=JULIAN)
		TIMER,/STOP

STOP
HELP, SUBS
SUBS=SUBS(0:100)

		FOR _SUB=0,N_ELEMENTS(SUBS)-1L DO BEGIN
			TIMESERIES=PIXEL_TIMESERIES(*,_SUB)
			PRINT, 'MIN and MAX for pixel  ',NUM2STR(SUBS(_SUB)),':     ',MINMAX(TIMESERIES,/FIN)
			OK=WHERE(TIMESERIES LT MISSINGS(TIMESERIES),COUNT)
			IF COUNT GE 1 THEN BEGIN
				OK_MAX=WHERE(TIMESERIES[OK] EQ MAX(TIMESERIES[OK]),COUNT)
				PRINT,'MAX for pixel         ',NUM2STR(SUBS(_SUB)),':     ',NUM2STR(MAX(TIMESERIES(OK(OK_MAX))))
				PRINT,'DATE of MAX for pixel ',NUM2STR(SUBS(_SUB)),':     ',NUM2STR(JD_2DATE(JULIAN(OK(OK_MAX))))
			ENDIF

		ENDFOR;FOR _SUB=0,N_ELEMENTS(SUBS)-1L DO BEGIN

	ENDFOR;FOR _CODE=0,N_ELEMENTS(SUBAREA_CODES)-1L DO BEGIN


END
