; $ID:	LL2BIN.PRO,	2020-06-30-17,	USER-KJWH	$
;+NAME/ONE LINE DESCRIPTION OF ROUTINE:
;    BIN2LL COMPUTES THE LATITUDE/LONGITUDE VALUES FOR AN ARRAY OF BIN NUMBERS.
;


PRO LL2BIN, NROWS,LON,LAT,BINS

IF (N_PARAMS() EQ 0) THEN BEGIN
        PRINT, 'BIN2LL, NROWS,BINS,LATITUDE,LONGITUDE'
        PRINT, ' '
        PRINT, 'WHERE NROWS IS THE NUMBER OF RECORDS IN THE BININDEX VDATA'
        PRINT, '      BINS IS THE INPUT ARRAY OF BIN NUMBERS'
        PRINT, '      LATITUDE IS THE OUTPUT ARRAY OF LATITUDE VALUES'
        PRINT, '      LONGITUDE IS THE OUTPUT ARRAY OF LONGITUDE VALUES'
        RETURN
ENDIF;  IF (N_PARAMS() EQ 0) THEN BEGIN


N = N_ELEMENTS(LON)

I=INDGEN(NROWS)
LATBIN=FLOAT((I + 0.5) * (180.0D0 / NROWS) - 90.0)
NUMBIN=LONG(COS(LATBIN *!DPI/180.0) * (2.0*NROWS) +0.5)
BASEBIN=LINDGEN(NROWS) & BASEBIN[0]=1
FOR I=1,NROWS-1 DO BASEBIN[I]=BASEBIN[I-1] + NUMBIN[I-1]
TOTBINS = BASEBIN[NROWS-1] + NUMBIN[NROWS-1] - 1
BASEBIN = [BASEBIN, TOTBINS+1]

BINS = LONARR(N)
FOR I=0L,N-1 DO BEGIN
    IROW = WHERE(LATBIN GE LAT(I)) & IROW = IROW[0]
    IF (IROW EQ -1) THEN IROW = NROWS-1
    ICOL = (LON(I)+180.)/(360./NUMBIN(IROW))
    

    BINS(I) = LONG(BASEBIN(IROW) - 0.5 + ICOL)
ENDFOR

RETURN
END; #####################  END OF ROUTINE ################################
