; $ID:	OPLOT_ANOMALY.PRO,	2020-07-08-15,	USER-KJWH	$

 PRO OPLOT_ANOMALY, X,Y,COLORS=colors
;+
; NAME:
;       OPLOT_ANOMALY
;
; PURPOSE:
;				PLOT POSITIVE AND NEGATIVE ANOMALIES AS A POLYGON-FILLED
;

;
; MODIFICATION HISTORY:
;       Written by:  J.E.O'Reilly, July 15, 2004
;-

ROUTINE_NAME='OPLOT_ANOMALY'

 ABOVE = 0
 BELOW = 0
IF N_ELEMENTS(COLORS) EQ 1 THEN COLORS = [COLORS,COLORS]
IF N_ELEMENTS(COLORS) NE 2 THEN COLORS = [!P.COLOR,!P.COLOR]


X_ABOVE=X[0]
Y_ABOVE=Y[0]

X_BELOW=X[0]
Y_BELOW=Y[0]

XX=SHIFT(X,-1)
YY=SHIFT(Y,-1)


; LLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLL
	FOR N=0L,N_ELEMENTS(X)-2L  DO BEGIN

		X1=X(N)
		X2=XX(N)
		Y1=Y(N)
		Y2=YY(N)

 		I=INTERPOL([X1,X2],[Y1,Y2],0)



		IF N EQ 0 THEN BEGIN
			IF Y1 GE 0 THEN BEGIN
				X_ABOVE=[X_ABOVE,X1,X1]
				Y_ABOVE=[Y_ABOVE,ABOVE,Y1]
			ENDIF
			IF Y1 LE 0 THEN BEGIN
				X_BELOW=[X_BELOW,X1,X1]
				Y_BELOW=[Y_BELOW,BELOW,Y1]
			ENDIF
		ENDIF


		IF I GE X1 AND I LE X2 THEN BEGIN
			X_ABOVE=[X_ABOVE,I]
			Y_ABOVE=[Y_ABOVE,ABOVE]
			X_BELOW=[X_BELOW,I]
			Y_BELOW=[Y_BELOW,BELOW]
		ENDIF

		IF Y2 GE 0 THEN BEGIN
			X_ABOVE=[X_ABOVE,X2]
			Y_ABOVE=[Y_ABOVE,Y2]
			X_BELOW=[X_BELOW,X2]
			Y_BELOW=[Y_BELOW,BELOW]
		ENDIF	ELSE BEGIN
			X_ABOVE=[X_ABOVE,X2]
			Y_ABOVE=[Y_ABOVE,ABOVE]
			X_BELOW=[X_BELOW,X2]
			Y_BELOW=[Y_BELOW,Y2]
		ENDELSE
	ENDFOR


	X_ABOVE= X_ABOVE(1:*) & X_ABOVE= [ X_ABOVE,LAST(X)]
	Y_ABOVE= Y_ABOVE(1:*) & Y_ABOVE= [ Y_ABOVE,0]

	X_BELOW= X_BELOW(1:*) & X_BELOW= [ X_BELOW,LAST(X)]
	Y_BELOW= Y_BELOW(1:*) & Y_BELOW= [ Y_BELOW,0]






	PLOT_EVENT,0,/YAXIS,LINESTYLE=1
	POLYFILL,X_ABOVE,Y_ABOVE,COLOR=COLORS[0],/DATA
	POLYFILL,X_BELOW,Y_BELOW,COLOR=COLORS[1],/DATA




END; #####################  End of Routine ################################



