; $ID:	PP_OPAL_VS_NLAYERS_DEMO.PRO,	2020-06-30-17,	USER-KJWH	$
  
  PRO PP_OPAL_VS_NLAYERS_DEMO, ERROR = error

;+
; NAME:
;   PP_OPAL_VS_NLAYERS_DEMO
;
; PURPOSE:
;   THIS PROGRAM DEMOS THE INFLUENCE OF N_LAYERS ON THE RESULTS FROM PP_OPAL (TO CHECK THAT PP IN EACH LAYER IS PER M^3)
;
; CATEGORY:
;   PP
;
; CALLING SEQUENCE:
;         PP_OPAL_VS_NLAYERS_DEMO
; INPUTS:
;   NONE
; OUTPUTS:
;   PLOTS ON THE SCREEN
;
;
;
; MODIFICATION HISTORY:
; Written DECEMBER 3, 2010 J O'REILLY, 28 Tarzwell Drive, NMFS, NOAA 02882 (jay.oreilly@noaa.gov)
; ;-
; ****************************************************************************************************
  ROUTINE_NAME = 'PP_OPAL_VS_NLAYERS_DEMO'

NLAYERS=[25,50,100,1000,50000,100000]
NLAYERS=[100,1000,100000,1000000]
NLAYERS =REVERSE(NLAYERS)
PSPRINT,/COLOR,FILENAME = ROUTINE_NAME +'.PS'
SET_PMULTI, N_ELEMENTS(NLAYERS)
FOR NTH=0, N_ELEMENTS(NLAYERS)-1 DO BEGIN
  _NLAYERS = NLAYERS[NTH]
  PP= PP_OPAL(CHL_SAT       = 1.0,  SST           = 22, PAR           = 33,  KX = 0.04, /STRUCT,N_LAYERS=_NLAYERS )
  ;ST,PP
  PRINT,'MINMAX:',MINMAX(PP.PROFILE_PP)
  PLINES,2
  PRINT,ROUNDS(PP.PROFILE_PP(0:10),5)
  PLINES,2  
  Z=FINDGEN(N_ELEMENTS(PP.PROFILE_PP))
  PAL_36
  SETCOLOR,33
  FONT_TIMES
  
  TXT= 'N_LAYERS=' + NUM2STR(_NLAYERS,/COMMA)+'!C'+'mean upper 10 layers='+ROUNDS(MEAN(PP.PROFILE_PP(0:10)),5)
  
  PLOT,Z,PP.PROFILE_PP,/NODATA,COLOR=0,TITLE=TXT
  GRIDS,COLOR=0
  OPLOT,Z,PP.PROFILE_PP,COLOR= (22),THICK=2
ENDFOR
PSPRINT
STOP
END; #####################  End of Routine ################################
