; $ID:	LIGHT_EXTINCTION_COEFFICIENT_DEMO.PRO,	2004 08 02 08:20	$

 PRO LIGHT_EXTINCTION_COEFFICIENT_DEMO
;+
; NAME:
;       LIGHT_EXTINCTION_COEFFICIENT_DEMO
;
; PURPOSE:
;				DEMO FOR LIGHT_EXTINCTION_COEFFICIENT PROGRAM
;

;
; MODIFICATION HISTORY:
;       Written by:  J.E.O'Reilly K. Whitman, MARCH 9,2004
;				Modified: July 28, 2004 to include real data and to create a postscript file
;

;-

ROUTINE_NAME='LIGHT_EXTINCTION_COEFFICIENT_DEMO'

PSFILE = ROUTINE_NAME+'.PS'
PSPRINT, FILENAME = PSFILE, /HALF, /COLOR, /TIMES

	!P.MULTI=[0,2,1]
	TITLE = 'DEMO'
 	DEPTH=[0.5,		1,		2,	4,		5,		7.7]
 	LIGHT=[1600,1000,	500,	250,	120,	 30]
 	STRUCT=LIGHT_EXTINCTION_COEFFICIENT(DEPTH=DEPTH,LIGHT=LIGHT, TITLE=TITLE, /SHOW)

	TITLE = 'DEMO_SUBSURFACE_MAX'
  DEPTH=FINDGEN(21)+1
  LIGHT= DEPTH
  I0=2100.0
  LIGHT(0:8) 		= I0*EXP((DEPTH(0:8)*(-0.25)))
  LIGHT(9:12) 	= LIGHT(8)*EXP(FINDGEN(4)*(-0.31))
  LIGHT(13:20) 	= LIGHT(12)*EXP(FINDGEN(8)*(-0.13))
	STRUCT=LIGHT_EXTINCTION_COEFFICIENT(DEPTH=DEPTH,LIGHT=LIGHT, TITLE=TITLE, /SHOW)


	TITLE = '1992-08-28  MNF10  N01'
	LIGHT=[388,322,230,175,135,105,78,59,46,38,31,25,20,17,14,12,10,9,8,7,6,5,5,4,4,4,3,3,3]
 	DEPTH=[2,2.5,3,3.5,4,4.5,5.5,6,6.5,7,7.5,8,8.5,9,9.5,10,10.5,11,11.5,12,12.5,13,13.5,14,14.5,15,15.5,16,16.5]
 	STRUCT=LIGHT_EXTINCTION_COEFFICIENT(DEPTH=DEPTH,LIGHT=LIGHT, TITLE=TITLE, /SHOW)


	TITLE = '1993-08-27  W9311  N01'
	LIGHT=[482,411,288,229,172,131,103,80,58,43,34,27,21,17,14,12,11,9,8,8,7,6,5,5,4,4,4,3,3,3]
	DEPTH=[2,2.5,3,3.5,4,4.5, 5, 5.5,6,6.5,7,7.5,8,8.5,9,9.5,10,10.5,11,11.5,12,12.5,13,13.5,14,14.5,15,15.5,16,16.5]
 	STRUCT=LIGHT_EXTINCTION_COEFFICIENT(DEPTH=DEPTH,LIGHT=LIGHT, TITLE=TITLE, /SHOW)

	TITLE = '1995-06-24  W9507 N10'
	LIGHT = [1350,1040,869,729,571,471,393,333,263,215,175,148,123,102,81.6,66.8,56.7,44.7,38.1,33.3,29.4,25.2,21.7,20.9,18.9,17.0,15.0,13.4,$
		12.8,11.7,10.7,9.6,8.6,7.9,7.4,7.0,6.4,5.8,5.3,4.9,4.5,4.5]
	DEPTH = [1.5, 2, 2.5, 3, 3.5, 4, 4.5, 5, 5.5,6,6.5,7,7.5,8,8.5,9,9.5,10,10.5,11,11.5,12,12.5,13,13.5,14,14.5,15,15.5,16,16.5,17,17.5,18,18.5,19,19.5,20,20.5,21,21.5,22]
	STRUCT=LIGHT_EXTINCTION_COEFFICIENT(DEPTH=DEPTH,LIGHT=LIGHT, TITLE=TITLE, /SHOW)

	TITLE = '1995-06-24  W9507 N10'
	LIGHT = [477.8,150.2,95.6,73.7,60.1,25.9,13.1,6,3.3]
	DEPTH = [1,2,3,4,5,9,14,18,23]
	STRUCT=LIGHT_EXTINCTION_COEFFICIENT(DEPTH=DEPTH,LIGHT=LIGHT, TITLE=TITLE, /SHOW)

	TITLE = '2003-04-02 WF034 F22'
	LIGHT =[786,697,544,467,390,292,217,180,153,129,115,106,93,86,81,79,75,71,65,60,55,48,41,37,34,32,31,28,26,23,20,17,$
					15,13,10,9.5,8.2,7.1,6.4,5.4,5.0,4.6,4.3,3.9,3.5,3.0,2.6,2.2]
	DEPTH=[2,2.5,3,3.5,4,4.5, 5, 5.5,6,6.5,7,7.5,8,8.5,9,9.5,10,10.5,11,11.5,12,12.5,13,13.5,14,14.5,15,15.5,16,16.5,17,$
					18,18.5,19,19.5,20,20.5,21,21.5,22,22.5,23,23.5,24,24.5,25,25.5,26]
;	FLUOR =[1.9,2.1,2.2,2.3,3.4,2.9,4.3,4.8,5.3,4.9,5.8,5.6,5.3,5.9,6.7,6.2,10.3,10.4,10.3,9.7,8.6,9.8,10.5,9.7,10.2,9.1,10.6,11.5,11.1,12.1,10.2,9.1,10.9,11.2,11.3,6.7,9.9,8.4,7.6,6.6,5.9,6.7,7.9,6.2,7.8,9.4,9.1,9.4]
	STRUCT=LIGHT_EXTINCTION_COEFFICIENT(DEPTH=DEPTH,LIGHT=LIGHT, TITLE=TITLE, /SHOW)

; ===> Show the 2nd-order fit ... when the function is extended beyond the data to extimate (extrapolation) the Zeu
	!P.MULTI=[0,1,1]
	TITLE='This is a BAD 2nd-Order Fit Because the profile does not include Zeu!CWhen the measured profile is too shallow there can be an extrapolation problem'
	Z=FINDGEN(1001)*0.1 & Y= POLY(Z,  STRSPLIT(STRUCT.COEFFS_P2,/EXTRACT))
	PLOT,  Y,-Z, /XLOG, YTITLE='Depth (m)', XTITLE='LN(Light)', TITLE=TITLE, XTICK_GET = XTICK_GET, YTICK_GET=YTICK_GET
	OPLOT, ALOG(LIGHT), -DEPTH,PSYM=1,COLOR=6
	PLOTS, [XTICK_GET,XTICK_GET], [-1.0*STRUCT.Zeu_P2,-1.0*STRUCT.Zeu_P2], COLOR=21,THICK=1,LINESTYLE=2
PSPRINT

CD,CURR=CURR
PRINT, 'A postscript plot was made: '+curr+psfile
stop

END; #####################  End of Routine ################################



