; $ID:	MANUSCRIPT_FRONTS_1.PRO,	2020-07-08-15,	USER-KJWH	$

 PRO MANUSCRIPT_FRONTS_1
;+
; NAME:
;       MANUSCRIPT_FRONTS_1
;
; PURPOSE:
;				To create the final figures for the first FRONTS manuscript
;
;	NOTES:
;				Most procedures are copied from other programs
;
; MODIFICATION HISTORY:

;

ROUTINE_NAME='MANUSCRIPT_FRONTS_1'

TIMER

;	===> Load simple color palette
 	PAL_36,r,g,b

; **************************************************
; ***** SWITCHES CONTROLLING PROCESSING STEPS  *****
; **************************************************
;		Switch	Operation
;		0  			Do not do Step
;		1				Do Step (unless output from this step already exists, then skip this step)
; 	2     	Do Step (make output file from step and overwrite output if it already exists)


		DO_LINE_FIGURES               = 1
		DO_COLORBAR_PNGS							= 0
		DO_FRONT_CHL_FIGS_EC					= 0
		DO_FRONT_CHL_FIGS_NEC					= 0
		DO_FRONTS_LOCATION						= 0
		DO_PS_2PNG                    = 0
		DO_IMAGE_COMPOSITES						= 0

	COMPUTER = GET_COMPUTER()

;	*** Define names of input and output files so that they are available to various steps

	DIR_SAVE  = 'D:\PROJECTS\FRONTS\DATA\SAVE\'
	DIR_PLOTS = 'D:\PROJECTS\FRONTS\PLOT\MANUSCRIPT_I\'
	DIR_POSTER = 'D:\PROJECTS\FRONTS\PLOT\OCM08_CLIMATOLOGY_POSTER\'

	DIR_S 		 		= 'S:\'
	DIR_T 		 		= 'T:\'
	DIR_PROJECTS 	= 'T:\'
	DIR_IDL      = 'D:\IDL\'

	IF COMPUTER EQ 'KHYDE-XP' OR COMPUTER EQ 'HALIBUT' THEN BEGIN
		IF COMPUTER EQ 'KHYDE-XP' THEN DIR_C = 'C:\WORK\PROJECTS\FRONTS\' ELSE DIR_C='D:\PROJECTS\FRONTS\'
		DIR_S   	    = DIR_C + 'DATA\'
		DIR_T         = DIR_C + 'DATA\'
		DIR_PROJECTS = 'D:\'
	ENDIF
  IF COMPUTER EQ 'BLUEFIN' THEN DIR_PROJECTS = 'I:\' 
  
	DIR_CFRONTS 	= DIR_T + 'NEC\FRONTS-CHLOR_A-SEAWIFS-MLAC-NEC\stats\'
	DIR_CHLOR  	 	= DIR_S + 'OC-SEAWIFS-MLAC-NEC\stats\'
	DIR_SST      	= DIR_T + 'SST-AT-LAC-NEC\STATS_ALL\'
	DIR_SFRONTS  	= DIR_T + 'NEC\FRONTS-SST-AT-LAC-NEC\stats\'

	DIRE_CFRONTS 	= DIR_T  + 'FRONTS-CHLOR_A-SEA_AQU-LAC-EC\stats\'
	DIRE_CHLOR   	= DIR_S  + 'SEAWIFS-MLAC-EC\stats\'
	DIRE_SST     	= DIR_T  + 'SST-AT-LAC-EC\STATS\'
	DIRE_SFRONTS 	= DIR_T  + 'FRONTS-SST-AT-LAC-EC\STATS\'

	DIR_OUT   		= DIR_PROJECTS + 'PROJECTS\FRONTS\'
	DIR_BROWSE 		= DIR_OUT + 'BROWSE\'
	DIR_RATIO  		= DIR_OUT + 'RATIO\'
	DIR_SAVE      = DIR_OUT + 'DATA\SAVE\'
	DIR_PLOTS  		= DIR_OUT + 'PLOT\'
	DIR_IMAGES    = DIR_PLOTS + 'IMAGES\'
	DIR_INTER			= DIR_PLOTS+ 'INTERMEDIATE_FILES\'
	DIR_TRIM      = DIR_INTER + 'TRIM\'


; *******************************************************
	IF DO_LINE_FIGURES GE 1 THEN BEGIN
; *******************************************************
		OVERWRITE = DO_LINE_FIGURES GE 2

		PAL_36

		NEC_SAVE = DIR_CHLOR + '!DD_19970904_20070131-SEAWIFS-REPRO5-NEC-CHLOR_A-FREQ.SAVE'
	;	L3B_SAVE = DIR_SAVE + '!DD_19970904_20070527-SEAWIFS-REPRO5-L3B9-CHLOR_A-FREQ.SAVE'

		FILES = [NEC_SAVE] ; L3B_SAVE

		FREQ_COLOR  = [6,22] & FREQ_LINESTYLE  = [0,0]  & FREQ_THICK = [8,8]
	  CUM_COLOR   = [6,22] & CUM_LINESTYLE   = [2,2]  & CUM_THICK  = [6,6]
	  PSFILE = DIR_POSTER+'CHLOR_A-FREQ_PLOT.PS'
		PSPRINT, FILENAME=PSFILE,/COLOR,/Full,/ARIAL, /LANDSCAPE

; 	Plot the cumulative frequency of CHLOR_A (see sd_stats_freq_plot.pro)
	 	FOR PTH = 0L, N_ELEMENTS(FILES)-1 DO BEGIN
	 		AFREQ = STRUCT_SD_READ(FILES(PTH),STRUCT=STRUCT)
			OK=WHERE(AFREQ EQ MISSINGS(AFREQ),COUNT)
			IF COUNT GE 1 THEN AFREQ[OK]=0.0
			II_X = STRUCT.IMAGE_X

			BFREQ = DOUBLE(STRUCT.IMAGE)
	    IF STRUCT.MAP EQ 'L3B9' THEN OK = WHERE(II_X GT 0.01 AND II_X LT 189.0,COUNT) $
	      ELSE OK = WHERE(II_X GT 0.02 AND II_X LT 32.0,COUNT)
	    IF COUNT GE 2 THEN  MAX_FREQ = MAX(BFREQ[OK])

			OK = WHERE(BFREQ EQ MAX_FREQ)
			MODE = II_X(OK[0])
	    CUM=cumulate(BFREQ)
	   	MAX_CUM = MAX(CUM)
	    CUM_NORM = CUM/MAX_CUM
	    OK = WHERE(CUM_NORM GE 0.5)
	    _MEDIAN = II_X(OK[0])
	    _LOWER = 0.001
	    _UPPER = 0.999
	    OK = WHERE(CUM_NORM GE _LOWER AND CUM_NORM LT _UPPER)
	    LOWER_RANGE = II_X(FIRST[OK]) & UPPER_RANGE = II_X(LAST[OK])
	    TXT_RANGE = '('+NUM2STR(LOWER_RANGE,FORMAT='(F7.3)')+' , '+NUM2STR(UPPER_RANGE,FORMAT='(F7.3)')+')'
	    PROD_NAME = NICKNAME('CHLOR_A')

			XLOG = 1
			STR_RANGE= STRING(100*(_upper-_lower),FORMAT='(F4.1)')+'%'
			XRANGE=[0.01,100]
			XTICKS=4 & XTICKNAME=['0.01','0.1','1','10','100'] & XTICKV= XTICKNAME
			YTICKNAME=['0.0','0.2','0.4','0.6','0.8','1.0']
			XMARGIN = [5,7]
			XMARGIN = [3,2]
			IF PTH EQ 0L THEN $
	    	PLOT, II_X, CUM_NORM, XRANGE = XRANGE, XLOG=XLOG, $
		      XTICKS=XTICKS,XTICKV=XTICKV,XTICKNAME=XTICKNAME,$
		      XSTYLE=1,XMINOR=1,YSTYLE=1,YTICKS=5,YMINOR=1,$
		      XTHICK=4,YTHICK=4,$
		      XTITLE=UNITS('CHLOR_A'),/NODATA,$
		      CHARSIZE=1.5,XMARGIN=XMARGIN, YMARGIN=YMARGIN, YTITLE='Relative Frequency',YTICKNAME=YTICKNAME

		;	AXIS, YAXIS=0,YMINOR= 1, YTITLE='Relative Frequency',YCHARSIZE=1.5
	  ;  AXIS, YAXIS=1,YMINOR= 1, YTITLE='Cumulative Frequency',YCHARSIZE=1.5

	    ;OPLOT, II_X, BFREQ/MAX_FREQ,COLOR=FREQ_COLOR(PTH),THICK=FREQ_THICK(PTH),LINESTYLE=FREQ_LINESTYLE(PTH)
	    ;OPLOT, II_X, CUM_NORM,COLOR=CUM_COLOR(PTH),THICK=CUM_THICK(PTH),LINESTYLE=CUM_LINESTYLE(PTH)
	    OPLOT, II_X, SMOOTH(BFREQ/MAX_FREQ,20),COLOR=FREQ_COLOR(PTH),THICK=FREQ_THICK(PTH),LINESTYLE=FREQ_LINESTYLE(PTH)
	  ;  OPLOT, II_X, SMOOTH(CUM_NORM,11),COLOR=CUM_COLOR(PTH),THICK=CUM_THICK(PTH),LINESTYLE=CUM_LINESTYLE(PTH)

	;    P=COORD_2PLOT(0.60,0.68)
	;    XYOUTS,P.X,P.Y,'Central '+STR_RANGE+'!C'+TXT_RANGE,CHARSIZE=1.5
	;    P=COORD_2PLOT(0.60,0.54)
	;    XYOUTS,P.X,P.Y,'Median = '+NUM2STR(_median,format='(f7.3)'),CHARSIZE=1.5
	;    P=COORD_2PLOT(0.60,0.48)
	;    XYOUTS,P.X,P.Y,'Mode =   '+NUM2STR(MODE,format='(f7.3)'),CHARSIZE=1.5
	;    P=COORD_2PLOT(0.60,0.42)
	;    XYOUTS,P.X,P.Y,'% Neg =   '+NUM2STR(PNEG,format='(f7.1)'),CHARSIZE=1.5

		ENDFOR
;		LEG_POS = [0.78 ,0.85,0.82,0.9];[0.64,0.105,0.69,0.135]
;		TXT = ['Global','NEC']
;		LEG,pos = LEG_POS, label=TXT,THICK=7,LSIZE=1.45, LINESTYLE=FREQ_LINESTYLE, COLOR=[6,22], FONT='TIMES', LCOLOR=0

		PSPRINT

		PSFILE = DIR_POSTER + 'FIGURES_1_19_09.PS'
		PSPRINT, FILENAME=PSFILE,/COLOR,/Full,/ARIAL, /LANDSCAPE
		!P.MULTI=[0,1,1]
		XMARGIN = [5,5]
		YMARGIN = [2.5,2.5]
		CHARSIZE = 2
		XRANGE = [0,100]
		YRANGE = [0,10]
		XTITLE = 'Cross-Frontal Distance (km)'
		THICK = 15
		COLOR = 22
		SHELF = 'Shelf'
		SLOPE = 'Slope Sea'
		FAXIS = 'Front Axis'
		SWATH = 'Frontal Swath'


	; Peak model cross-frontal section of Chl.
		X1 = FINDGEN(40)
		Y1 = REPLICATE(5,40)
		THETA1 = (FINDGEN(101))*(((!PI*1.5)-!PI)/100)+!PI;FINDGEN(101)*((-!PI/2))/100
		X2 = (FINDGEN(101)*10/100)+40  ; COS(THETA)+1
		Y2 = 4*COS(THETA1)+9
		THETA2 = (FINDGEN(101))*(((!PI*1.5)-!PI)/100)+!PI
		X3 = (FINDGEN(101)*10/100)+50  ; 2*COS(THETA)+4
		Y3 = 7*SIN(THETA2)+9
		X4 = FINDGEN(40)+60
		Y4 = REPLICATE(2,40)
		X = [X1,X2,X3,X4]
		Y = [Y1,Y2,Y3,Y4]
		TITLE = 'Peak Model of Chlorophyll Distribution !CAcross the Shelf-Slope Front'
		YTITLE = UNITS('CHLOROPHYLL')
		PLOT,X,Y,/NODATA,CHARSIZE=CHARSIZE,XRANGE=XRAMGE,YRANGE=YRANGE,XMARGIN=XMARGIN,YMARGIN=YMARGIN,$
			XTITLE=XTITLE,YTITLE=YTITLE, TITLE=TITLE
		OK = WHERE(X GE 38 AND X LE 62)
		XX = [X[OK],REVERSE(X[OK])]
		YY = [Y[OK],REPLICATE(0,N_ELEMENTS(OK))]
		POLYFILL, XX, YY, COLOR = 18
		OPLOT, X, Y, COLOR=COLOR, THICK=THICK
		OPLOT, [50,50],[0,9],COLOR=33,THICK=5
		OPLOT, [38,38],[0,5],COLOR=33,THICK=5
		OPLOT, [62,62],[0,2],COLOR=33,THICK=5
		CHARSIZE=1.75
		XYOUTS, 0.18,0.51,'Shelf',CHARSIZE=CHARSIZE,COLOR=0 ,/NORMAL
		XYOUTS, 0.44,0.83,'Front Axis',CHARSIZE=CHARSIZE,COLOR=0 ,/NORMAL
		XYOUTS, 0.7,0.27,'Slope Sea',CHARSIZE=CHARSIZE,COLOR=0 ,/NORMAL
		XYOUTS2,0.5,0.2,'Frontal Swath', ALIGN=0.5, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1, BACKGROUND=255, GRACE=[0.01,0.01],/NORMAL
		XYOUTS2,0.45,0.14,'0.5d', ALIGN=0.5, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1, BACKGROUND=255, GRACE=[0.01,0.01],/NORMAL
		XYOUTS2,0.55,0.14,'0.5d', ALIGN=0.5, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1, BACKGROUND=255, GRACE=[0.01,0.01],/NORMAL

; Model ("ramp") cross-frontal section of Chl.
		CHARSIZE = 2
		X=[0.0, 38.0, 44.0, 56.0, 62.0, 100.0]
		Y=[6.5, 6.5,  6.5,  2.5,  2.5,  2.5]
		TITLE = 'Ramp Model of Chlorophyll Distribution !CAcross the Shelf-Slope Front'
		YTITLE = UNITS('CHLOROPHYLL')
		PLOT,X,Y,/NODATA,CHARSIZE=CHARSIZE,XRANGE=XRAMGE,YRANGE=YRANGE,XMARGIN=XMARGIN,YMARGIN=YMARGIN,$
			XTITLE=XTITLE,YTITLE=YTITLE, TITLE=TITLE
		OK = WHERE(X GE 38 AND X LE 62)
		XX = [X[OK],REVERSE(X[OK])]
		YY = [Y[OK],REPLICATE(0,N_ELEMENTS(OK))]
		POLYFILL, XX, YY, COLOR = 18
		OPLOT, X, Y, COLOR=COLOR, THICK=THICK
		OPLOT, [50,50],[0,4.5],COLOR=33,THICK=5
		OPLOT, [38,38],[0,6.5],COLOR=33,THICK=5
		OPLOT, [62,62],[0,2.5],COLOR=33,THICK=5
		CHARSIZE=1.75
		XYOUTS, 0.18,0.63,'Shelf',CHARSIZE=CHARSIZE,COLOR=0 ,/NORMAL
		XYOUTS, 0.51,0.45,'Front Axis',CHARSIZE=CHARSIZE,COLOR=0 ,/NORMAL
		XYOUTS, 0.7,0.31,'Slope Sea',CHARSIZE=CHARSIZE,COLOR=0 ,/NORMAL
		XYOUTS2,0.5,0.2,'Frontal Swath', ALIGN=0.5, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1, BACKGROUND=255, GRACE=[0.01,0.01],/NORMAL
		XYOUTS2,0.45,0.14,'0.5d', ALIGN=0.5, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1, BACKGROUND=255, GRACE=[0.01,0.01],/NORMAL
		XYOUTS2,0.55,0.14,'0.5d', ALIGN=0.5, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1, BACKGROUND=255, GRACE=[0.01,0.01],/NORMAL

; Model ("ramp") cross-frontal section of SST.
		CHARSIZE = 2
		X=[0.0, 38.0, 44.0, 56.0, 62.0, 100.0]
		Y=[12.5, 12.5,  12.5,  17.5,  17.5,  17.5]
		YRANGE = [10,20]
		TITLE = 'Ramp Model of SST Distribution !CAcross the Shelf-Slope Front'
		YTITLE = UNITS('SST')
		PLOT,X,Y,/NODATA,CHARSIZE=CHARSIZE,XRANGE=XRAMGE,YRANGE=YRANGE,XMARGIN=XMARGIN,YMARGIN=YMARGIN,$
			XTITLE=XTITLE,YTITLE=YTITLE, TITLE=TITLE
		OK = WHERE(X GE 38 AND X LE 62)
		XX = [X[OK],REVERSE(X[OK])]
		YY = [Y[OK],REPLICATE(10,N_ELEMENTS(OK))]
		POLYFILL, XX, YY, COLOR = 18
		OPLOT, X, Y, COLOR=COLOR, THICK=THICK
		OPLOT, [50,50],[0,14.9],COLOR=33,THICK=5
		OPLOT, [38,38],[0,12.5],COLOR=33,THICK=5
		OPLOT, [62,62],[0,17.5],COLOR=33,THICK=5
		CHARSIZE=1.75
		XYOUTS, 0.18,0.31,'Shelf',CHARSIZE=CHARSIZE,COLOR=0 ,/NORMAL
		XYOUTS, 0.33,0.47,'Front Axis',CHARSIZE=CHARSIZE,COLOR=0 ,/NORMAL
		XYOUTS, 0.7,0.72,'Slope Sea',CHARSIZE=CHARSIZE,COLOR=0 ,/NORMAL
		XYOUTS2,0.5,0.2,'Frontal Swath', ALIGN=0.5, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1, BACKGROUND=255, GRACE=[0.01,0.01],/NORMAL
		XYOUTS2,0.45,0.14,'0.5d', ALIGN=0.5, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1, BACKGROUND=255, GRACE=[0.01,0.01],/NORMAL
		XYOUTS2,0.55,0.14,'0.5d', ALIGN=0.5, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1, BACKGROUND=255, GRACE=[0.01,0.01],/NORMAL

		PSPRINT
		GRACE = [250,250,250,250]
;		IMAGE_TRIM, PSFILE, DIR_OUT=DIR_POSTER, DPI=1200, BACKGROUND=BACKGROUND,GRACE=GRACE, OVERWRITE=_overwrite
STOP

	ENDIF


; *******************************************************
	IF DO_COLORBAR_PNGS GE 1 THEN BEGIN
; *******************************************************
		OVERWRITE = DO_COLORBAR_PNGS GE 2


		PAL='PAL_SW3'
		PAL2 = 'PAL_SW3_BGR'
		BACKGROUND = 255
		GRACE = [0,0,15,50]		; LEFT RIGHT BOTTOM TOP
		PALS  =          [PAL2,PAL,PAL,PAL,PAL,PAL,PAL]
		PRODS =          ['FRONTS_LOCATION','CHLOR_A','SST','GRAD_MAG','GRAD_MAG_RATIO','RATIO','RATIO']
		SPECIAL_SCALES = ['','MEDIUM', '',   '!MONTH',  '!MONTH',        '300',  '2']
		TITLES         = ['',$
											'Chlorophyll (mg m!E-3!N)', $
											'Sea Surface Temperature (!Eo!NC)',$
											'SST Gradient Magnitude (!Eo!NC  km!E-1!N)',$
											'Chlorophyll Gradient Magnitude (ratio)',$
											'Chlorophyll:SST Gradient',$
											'Chl Gradient:SST Gradient']


		FOR NTH = 0L, N_ELEMENTS(PRODS)-1 DO BEGIN
			PROD = PRODS[NTH]
			SPECIAL_SCALE = SPECIAL_SCALES[NTH]
			PSFILE = DIR_PLOTS + 'COLORBAR_HORIZONTAL-'+PROD+'-'+SPECIAL_SCALE+'.PS'
			TITLE = ' '
			CHARSIZE = 1.5
			PSPRINT,FILENAME=PSFILE,/ARIAL,/COLOR,/HALF
			!P.MULTI = [0,1,1]
			GRACE = [15,15,0,0]
			BAR = COLOR_BAR_SCALE(PROD=PROD,POSITION=[0.1, 0.9,0.9, 0.95],CHARSIZE=CHARSIZE,/TOP,TITLE=TITLE,/NO_UNIT,FONT='HELVETICA',SPECIAL_SCALE=SPECIAL_SCALE,PAL=PALS[NTH])
			PSPRINT
			IMAGE_TRIM, PSFILE, DIR_OUT=DIR_IMAGES, DPI=600, BACKGROUND=BACKGROUND,GRACE=GRACE, OVERWRITE=overwrite

			PSFILE = DIR_PLOTS + 'COLORBAR_HORIZONTAL_TITLE-'+PROD+'-'+SPECIAL_SCALE+'.PS'
			TITLE = TITLES[NTH]
			CHARSIZE = 1.5
			GRACE = [15,15,0,15]
			PSPRINT,FILENAME=PSFILE,/ARIAL,/COLOR,/HALF
			!P.MULTI = [0,1,1]
			BAR = COLOR_BAR_SCALE(PROD=PROD,POSITION=[0.1, 0.9,0.9, 0.95],CHARSIZE=CHARSIZE,/TOP,TITLE=TITLE,/NO_UNIT,FONT='HELVETICA',SPECIAL_SCALE=SPECIAL_SCALE,PAL=PALS[NTH])
			PSPRINT
			IMAGE_TRIM, PSFILE, DIR_OUT=DIR_IMAGES, DPI=600, BACKGROUND=BACKGROUND,GRACE=GRACE, OVERWRITE=overwrite

			PSFILE = DIR_PLOTS + 'COLORBAR_VERTICAL-'+PROD+'-'+SPECIAL_SCALE+'.PS'
			TITLE = ' '
			CHARSIZE = 1.5
			PSPRINT,FILENAME=PSFILE,/ARIAL,/COLOR,/HALF
			!P.MULTI = [0,1,1]
			BAR = COLOR_BAR_SCALE(PROD=PROD,POSITION=[0.5, 0.05,0.55, 0.95],CHARSIZE=CHARSIZE,/RIGHT,/VERTICAL,TITLE=TITLE,/NO_UNIT,FONT='HELVETICA',SPECIAL_SCALE=SPECIAL_SCALE,PAL=PALS[NTH])
			PSPRINT
			IMAGE_TRIM, PSFILE, DIR_OUT=DIR_IMAGES, DPI=600, BACKGROUND=BACKGROUND,GRACE=GRACE, OVERWRITE=overwrite
		ENDFOR
	ENDIF ;DO_COLORBAR_PNGS


; *******************************************************
	IF DO_FRONTS_LOCATION GE 1 THEN BEGIN
; *******************************************************
		OVERWRITE = DO_FRONTS_LOCATION GE 2

		MASK = READ_LANDMASK(MAP='NEC',/STRUCT)

		CTARGET = '-SEAWIFS-MLAC-NEC-CHLOR_A-OC4-GRAD_MAG_RATIO-MEAN.SAVE'
		STARGET = '-AT-LAC-NEC-SST-GRAD_MAG-MEAN.SAVE'

;		CDATA = STRUCT_SD_READ(DIR_CFRONTS+ '!SS_19970904162631_20081023185617' + CTARGET, SUBS=SUBC)
;		SDATA = STRUCT_SD_READ(DIR_SFRONTS+ '!SS_20000225021000_20080205071500' + STARGET, SUBS=SUBS)

;		CSTATS = STATS(CDATA(SUBC),/TRANSFORM) & PRINT, 'Chl MEAN = ', CSTATS.MEAN, '     MEDIAN = ', CSTATS.MED
;		SSTATS = STATS(SDATA(SUBS))  					 & PRINT, 'SST MEAN = ', SSTATS.MEAN, '     MEDIAN = ', SSTATS.MED

		CLIMIT = 1.03
		SLIMIT = 0.08

		CCOLOR = 100	  ; CHL ONLY  = GREAN
		SCOLOR = 10			; SST ONLY  = BLUE
		BCOLOR = 200		; CHL & SST = RED

		PERIODS = ['!MONTH']
		PAL_SW3_BGR,R,G,B

		FOR PTH = 0L, N_ELEMENTS(PERIODS)-1 DO BEGIN
			APERIOD = PERIODS(PTH)
			CFILES  = FILE_SEARCH(DIR_CFRONTS + APERIOD + '*' + CTARGET) & FC = PARSE_IT(CFILES)
			SFILES  = FILE_SEARCH(DIR_SFRONTS + APERIOD + '*' + STARGET) & FS = PARSE_IT(SFILES)

			FOR NTH = 0L, N_ELEMENTS(CFILES)-1 DO BEGIN
				OK = WHERE(FS.PERIOD EQ FC[NTH].PERIOD,COUNT)
				IF COUNT NE 1 THEN CONTINUE
				CHL  = STRUCT_SD_READ(CFILES[NTH])
				SST  = STRUCT_SD_READ(SFILES[OK])

				IMAGE = BYTE(CHL) & IMAGE(*,*) = 0

				OKC = WHERE(CHL GE CLIMIT AND CHL NE MISSINGS(CHL),COUNTC) & IF COUNTC GE 1 THEN IMAGE(OKC) = IMAGE(OKC) + 1
				OKS = WHERE(SST GE SLIMIT AND SST NE MISSINGS(SST),COUNTS) & IF COUNTS GE 1 THEN IMAGE(OKS) = IMAGE(OKS) + 2

				_OKC = WHERE(IMAGE EQ 1,COUNTC) & IF COUNTC GE 1 THEN IMAGE(_OKC) = CCOLOR
				_OKS = WHERE(IMAGE EQ 2,COUNTS) & IF COUNTS GE 1 THEN IMAGE(_OKS) = SCOLOR
				_OKB = WHERE(IMAGE EQ 3,COUNTB) & IF COUNTB GE 1 THEN IMAGE(_OKB) = BCOLOR
				_OK0 = WHERE(IMAGE EQ 0,COUNT0) & IF COUNT0 GE 1 THEN IMAGE(_OK0) = 254

				IMAGE(MASK.LAND)  = 252
				IMAGE(MASK.COAST) = 0

				IMAGE = MAP_ADD_TXT(IMAGE,0.05,0.85, MONTH_NAMES(FC[NTH].MONTH_START,/SHORT),FONT='HELVETICA',COLOR=0,charsize=10,CHARTHICK=3)
			;	IMAGE = SD_ADD_COLORBAR(IMAGE,MAP='NEC',PX=1024,PY=1024,PROD='FRONTS_LOCATION',PAL='PAL_SW3_BGR')

				PNGFILE = DIR_IMAGES + FC[NTH].PERIOD + '-NEC-CHLOR_A-GRAD_MAG_RATIO-SST-GRAD_MAG-LOCATIONS.PNG'
				WRITE_PNG, PNGFILE, IMAGE,R,G,B

			ENDFOR
			PNGS = FILE_SEARCH(DIR_IMAGES + APERIOD + '_*-NEC-CHLOR_A-GRAD_MAG_RATIO-SST-GRAD_MAG-LOCATIONS.PNG')
			PNGFILE = DIR_IMAGES+'!MONTH-NEC-CHLOR_A-GRAD_MAG_RATIO-SST-GRAD_MAG-LOCATIONS-1_12.PNG'
			IMAGE_WELD_PAGE, FILES=PNGS, ROWS=1,COLS=12,PNGFILE=pngfile,SPACE=20,PX=1024,PY=1024,BACKGROUND=255,/NOTRIM,PAL='PAL_SW3_BGR'
			PNGFILE = DIR_IMAGES+'!MONTH-NEC-CHLOR_A-GRAD_MAG_RATIO-SST-GRAD_MAG-LOCATIONS-3_4.PNG'
			IMAGE_WELD_PAGE, FILES=PNGS, ROWS=3,COLS=4,PNGFILE=pngfile,SPACE=20,PX=1024,PY=1024,BACKGROUND=255,/NOTRIM,PAL='PAL_SW3_BGR'
		ENDFOR

STOP
	ENDIF	; DO_FRONTS_LOCATION



; *******************************************************
	IF DO_FRONT_CHL_FIGS_NEC GE 1 THEN BEGIN
; *******************************************************
		OVERWRITE = DO_FRONT_CHL_FIGS_NEC GE 2


		PERIODS = ['!Y_','!YEAR','!ANNUAL','!MONTH_']
		PERIODS = '!MONTH_'
		CFILE = DIR_CFRONTS+ '!ANNUAL-SEAWIFS-MLAC-NEC-CHLOR_A-OC4-GRAD_MAG_RATIO-MEAN.SAVE'
		SFILE = DIR_SFRONTS+ '!ANNUAL-AT-NEC-SST-4UM-GRAD_MAG-MEAN.SAVE'
		CSAVE = DIR_CFRONTS+ '!ANNUAL-SEAWIFS-MLAC-NEC-CHLOR_A-OC4-GRAD_MAG_RATIO-MEAN-NORMALIZED.SAVE'
		SSAVE = DIR_SFRONTS+ '!ANNUAL-AT-NEC-SST-4UM-GRAD_MAG-MEAN-NORMALIZED.SAVE'

		CHLMED = STRUCT_SD_READ(CFILE,STRUCT=STRUCTC,SUBS=SUBC) & CMED = CHLMED
		SSTMED = STRUCT_SD_READ(SFILE,STRUCT=STRUCTS,SUBS=SUBS) & SMED = SSTMED
		OKC = WHERE(CHLMED GT PERCENTILE(CHLMED,PERCENT=1.0) AND CHLMED LT PERCENTILE(CHLMED,PERCENT=99.0))
		OKS = WHERE(SSTMED GT PERCENTILE(SSTMED,PERCENT=1.0) AND SSTMED LT PERCENTILE(SSTMED,PERCENT=99.0))
	  CMED(*,*) = MEDIAN(CHLMED(OKC))
		SMED(*,*) = MEDIAN(SSTMED(OKS))
		STRUCT_SD_WRITE,CSAVE,PROD='GRAD_MAG_RATIO', IMAGE=CMED, MISSING_CODE=missing_codes,INFILE=CFILE
		STRUCT_SD_WRITE,SSAVE,PROD='GRAD_MAG', IMAGE=SMED, MISSING_CODE=missing_codes,INFILE=SFILE


		FOR PTH = 0L, N_ELEMENTS(PERIODS)-1 DO BEGIN
			APERIOD = PERIODS(PTH)
			FFILES = FILE_SEARCH(DIR_CFRONTS+APERIOD+'*-SEAWIFS-MLAC-NEC-CHLOR_A-OC4-GRAD_MAG_RATIO-MEAN.SAVE')
			CFILES = FILE_SEARCH(DIR_CHLOR  +APERIOD+'*-SEAWIFS-REPRO5-MLAC-NEC-CHLOR_A-OC4-MEAN.SAVE')
			SFILES = FILE_SEARCH(DIR_SFRONTS+APERIOD+'*-AT-NEC-SST-4UM-GRAD_MAG-MEAN.SAVE')

			FA_SST = PARSE_IT(SFILES,/ALL)
			PSFILE = DIR_PLOTS + APERIOD + '-NEC-CHLOR_A-SST_GRAD_MAG-HIST2D.PS'
			PSPRINT,FILENAME=PSFILE,/COLOR,/TIMES,/HALF

			FOR FTH = 0L, N_ELEMENTS(FFILES)-1 DO BEGIN
				FA_F   = PARSE_IT(FFILES(FTH),/ALL)
				FA_C   = PARSE_IT(CFILES(FTH),/ALL)
				OK_SST = WHERE(FA_SST.PERIOD EQ FA_F.PERIOD,COUNT_SST)
				IF COUNT_SST EQ 1 THEN FA_S = FA_SST(OK_SST) ELSE FA_S= STRUCT_2MISSINGS(FA_SST[0])

				IF FA_F.PERIOD NE FA_C.PERIOD THEN CONTINUE
;				FDATA  = STRUCT_SD_READ(FA_F.FULLNAME,STRUCT=FSTRUCT)
;				CDATA  = STRUCT_SD_READ(FA_C.FULLNAME,STRUCT=CSTRUCT)
;				STRUCT_SD_2PNG, [FA_F.FULLNAME,FA_C.FULLNAME],DIR_OUT=DIR_BROWSE,$
;				    								/ADD_COLORBAR, /ADDDATE,/ADD_PROD,$
;	                   				/ADD_LAND, /ADD_COAST, BACKGROUND=ABACKGROUND,$
;	                  				LAND_COLOR=252,FLAG_COLOR=AFLAG_COLOR,OUTSCAN_COLOR=aoutscan_color,$
;	                  				ALGFAIL_COLOR=AALGFAIL_COLOR,HI_LO_COLOR=AHI_LO_COLOR,PAL=PAL,FLAGS=_FLAGS,SOLO=SOLO,$
;	                  				OVERWRITE=overwrite,/QUIET ,ADD_EXTRA=ADD_EXTRA
;
;				IF FA_S.FULLNAME NE '' THEN $
;				STRUCT_SD_2PNG, FA_S.FULLNAME,DIR_OUT=DIR_BROWSE,$
;				    								/ADD_COLORBAR, /ADDDATE,/ADD_PROD,$
;	                   				/ADD_LAND, /ADD_COAST, BACKGROUND=ABACKGROUND,$
;	                  				LAND_COLOR=252,FLAG_COLOR=AFLAG_COLOR,OUTSCAN_COLOR=aoutscan_color,$
;	                  				ALGFAIL_COLOR=AALGFAIL_COLOR,HI_LO_COLOR=AHI_LO_COLOR,PAL=PAL,FLAGS=_FLAGS,SOLO=SOLO,$
;	                  				OVERWRITE=overwrite,/QUIET ,ADD_EXTRA=ADD_EXTRA

;				IF COUNT_SST EQ 1 THEN SDATA  = STRUCT_SD_READ(FA_S.FULLNAME,STURCT=SSTRUCT)
;
				CRATIO_SAVEFILE = DIR_RATIO + FA_F.PERIOD + '-' + FA_F.SENSOR + '-' + FA_F.MAP + '-CHLOR_A-GRAD_MAG_RATIO-NORM_RATIO.SAVE'
;	      RATIO_SAVE_MAKE,DIR_OUT=DIR_RATIO,SAVEFILE=CRATIO_SAVEFILE,FILEA=FFILES(FTH),FILEB=CSAVE,OVERWRITE=OVERWRITE
;
;				USE_PROD = 'RATIO'
;				SPECIAL_SCALE = 'VS'
;				TITLE = 'Normalized Chlorophyll Gradient'
;				IF FILE_TEST(CRATIO_SAVEFILE) EQ 1 THEN $
;				STRUCT_SD_2PNG, CRATIO_SAVEFILE,DIR_OUT=DIR_BROWSE,USE_PROD=USE_PROD,$
;				    								/ADD_COLORBAR, /ADDDATE,/ADD_PROD,SPECIAL_SCALE=SPECIAL_SCALE,$
;	                   				/ADD_LAND, /ADD_COAST, BACKGROUND=ABACKGROUND,$
;	                  				LAND_COLOR=252,FLAG_COLOR=AFLAG_COLOR,OUTSCAN_COLOR=aoutscan_color,$
;	                  				ALGFAIL_COLOR=AALGFAIL_COLOR,HI_LO_COLOR=AHI_LO_COLOR,PAL=PAL,FLAGS=_FLAGS,SOLO=SOLO,$
;	                  				OVERWRITE=overwrite,/QUIET ,ADD_EXTRA=ADD_EXTRA,COLORBAR_TITLE=TITLE
;
				SRATIO_SAVEFILE = DIR_RATIO + FA_F.PERIOD + '-' + FA_F.SENSOR + '-' + FA_F.MAP + '-SST-GRAD_MAG-NORM_RATIO.SAVE'
;	      RATIO_SAVE_MAKE,DIR_OUT=DIR_RATIO,SAVEFILE=SRATIO_SAVEFILE,FILEA=SFILES(FTH),FILEB=SSAVE,OVERWRITE=OVERWRITE
;
;				USE_PROD = 'RATIO'
;				SPECIAL_SCALE = '10'
;				TITLE = 'Normalized SST Gradient'
;				IF FILE_TEST(SRATIO_SAVEFILE) EQ 1 THEN $
;				STRUCT_SD_2PNG, SRATIO_SAVEFILE,DIR_OUT=DIR_BROWSE,USE_PROD=USE_PROD,$
;				    								/ADD_COLORBAR, /ADDDATE,/ADD_PROD,SPECIAL_SCALE=SPECIAL_SCALE,$
;	                   				/ADD_LAND, /ADD_COAST, BACKGROUND=ABACKGROUND,$
;	                  				LAND_COLOR=252,FLAG_COLOR=AFLAG_COLOR,OUTSCAN_COLOR=aoutscan_color,$
;	                  				ALGFAIL_COLOR=AALGFAIL_COLOR,HI_LO_COLOR=AHI_LO_COLOR,PAL=PAL,FLAGS=_FLAGS,SOLO=SOLO,$
;	                  				OVERWRITE=overwrite,/QUIET ,ADD_EXTRA=ADD_EXTRA,COLORBAR_TITLE=TITLE
;


;				RATIO_SAVEFILE = DIR_RATIO + FA_F.PERIOD + '-' + FA_F.SENSOR + '-' + FA_F.MAP + '-CHLOR_A-GRAD_MAG_RATIO-RATIO.SAVE'
;	      RATIO_SAVE_MAKE,DIR_OUT=DIR_RATIO,SAVEFILE=RATIO_SAVEFILE,FILEA=CFILES(FTH),FILEB=FFILES(FTH),OVERWRITE=OVERWRITE
;
;				USE_PROD = 'RATIO'
;				SPECIAL_SCALE = 'LIN7'
;				TITLE = 'Chlorophyll (concentration:gradient)'
;				IF FILE_TEST(RATIO_SAVEFILE) EQ 1 THEN $
;				STRUCT_SD_2PNG, RATIO_SAVEFILE,DIR_OUT=DIR_BROWSE,USE_PROD=USE_PROD,$
;				    								/ADD_COLORBAR, /ADDDATE,/ADD_PROD,SPECIAL_SCALE=SPECIAL_SCALE,$
;	                   				/ADD_LAND, /ADD_COAST, BACKGROUND=ABACKGROUND,$
;	                  				LAND_COLOR=252,FLAG_COLOR=AFLAG_COLOR,OUTSCAN_COLOR=aoutscan_color,$
;	                  				ALGFAIL_COLOR=AALGFAIL_COLOR,HI_LO_COLOR=AHI_LO_COLOR,PAL=PAL,FLAGS=_FLAGS,SOLO=SOLO,$
;	                  				OVERWRITE=overwrite,/QUIET ,ADD_EXTRA=ADD_EXTRA,COLORBAR_TITLE=TITLE
;
;				RATIO_SAVEFILE = DIR_RATIO + FA_F.PERIOD + '-' + FA_F.SENSOR + '-' + FA_F.MAP + '-CHLOR_A-GRAD_MAG-RATIO.SAVE'
;				IF COUNT_SST EQ 1 AND FA_C.PERIOD EQ FA_S.PERIOD THEN RATIO_SAVE_MAKE,DIR_OUT=DIR_RATIO,SAVEFILE=RATIO_SAVEFILE,FILEA=FA_C.FULLNAME,FILEB=FA_S.FULLNAME,OVERWRITE=OVERWRITE,/LOGA
;
;				USE_PROD = 'RATIO'
;				SPECIAL_SCALE = '300'
;				TITLE = 'Chlorophyll:SST Gradient'
;				IF FILE_TEST(RATIO_SAVEFILE) EQ 1 THEN $
;				STRUCT_SD_2PNG, RATIO_SAVEFILE,DIR_OUT=DIR_BROWSE,USE_PROD=USE_PROD,$
;				    								/ADD_COLORBAR, /ADDDATE,/ADD_PROD,SPECIAL_SCALE=SPECIAL_SCALE,$
;	                   				/ADD_LAND, /ADD_COAST, BACKGROUND=ABACKGROUND,$
;	                  				LAND_COLOR=252,FLAG_COLOR=AFLAG_COLOR,OUTSCAN_COLOR=aoutscan_color,$
;	                  				ALGFAIL_COLOR=AALGFAIL_COLOR,HI_LO_COLOR=AHI_LO_COLOR,PAL=PAL,FLAGS=_FLAGS,SOLO=SOLO,$
;	                  				OVERWRITE=overwrite,/QUIET ,ADD_EXTRA=ADD_EXTRA,COLORBAR_TITLE=TITLE

				RATIO_SAVEFILE = DIR_RATIO + FA_F.PERIOD + '-' + FA_F.SENSOR + '-' + FA_F.MAP + '-CHLOR_A-GRAD_MAG_RATIO-SST-GRAD_MAG-NORM_RATIO.SAVE'
				IF COUNT_SST EQ 1 AND FA_F.PERIOD EQ FA_S.PERIOD THEN RATIO_SAVE_MAKE,DIR_OUT=DIR_RATIO,SAVEFILE=RATIO_SAVEFILE,FILEA=SRATIO_SAVEFILE,FILEB=CRATIO_SAVEFILE,OVERWRITE=OVERWRITE,/LOGA

				USE_PROD = 'RATIO'
				SPECIAL_SCALE = '2'
				TITLE = 'SST Gradient:Chlorophyll Gradient'
				IF FILE_TEST(RATIO_SAVEFILE) EQ 1 THEN $
				STRUCT_SD_2PNG, RATIO_SAVEFILE,DIR_OUT=DIR_BROWSE,USE_PROD=USE_PROD,$
				    								/ADD_COLORBAR, /ADDDATE,/ADD_PROD,SPECIAL_SCALE=SPECIAL_SCALE,$
	                   				/ADD_LAND, /ADD_COAST, BACKGROUND=ABACKGROUND,$
	                  				LAND_COLOR=252,FLAG_COLOR=AFLAG_COLOR,OUTSCAN_COLOR=aoutscan_color,$
	                  				ALGFAIL_COLOR=AALGFAIL_COLOR,HI_LO_COLOR=AHI_LO_COLOR,PAL=PAL,FLAGS=_FLAGS,SOLO=SOLO,$
	                  				OVERWRITE=overwrite,/QUIET ,ADD_EXTRA=ADD_EXTRA,COLORBAR_TITLE=TITLE



				ALG_A = 'Chlorophyll'
				ALG_B = 'Gradient Magnitude'
				ALC_C = 'Gradient Magnitude'
				APROD = FA_C.PROD
				BPROD = FA_F.MATH
				CPROD = FA_S.MATH
				PERIOD_A = FA_C.PERIOD
				PERIOD_B = FA_F.PERIOD
				PERIOD_C = FA_S.PERIOD
				YSCALE = SD_SCALES([1,250],PROD=APROD,/BIN2DATA)
				XSCALE = SD_SCALES([1,250],PROD=BPROD,/BIN2DATA)
				XSCALE2 = SD_SCALES([1,250],PROD=CPROD,/BIN2DATA)

 				CASE STRUPCASE(FA_C.PERIOD_CODE) OF
					'!ANNUAL': TITLE = FA_C.YEAR_START + ' - ' + FA_C.YEAR_END
					'!M':      TITLE = MONTH_NAMES(FA_C.MONTH_START) + ' ' + FA_C.YEAR_START
					'!MONTH':  TITLE = MONTH_NAMES(FA_C.MONTH_START)
					'!Y':      TITLE = FA_C.YEAR_START
					'!YEAR':   TITLE = FA_C.YEAR_START + ' - ' + FA_C.YEAR_END
				ENDCASE

				CDATA = STRUCT_SD_READ(CRATIO_SAVEFILE)
				SDATA = STRUCT_SD_READ(SRATIO_SAVEFILE)
				OK = WHERE(CDATA NE MISSINGS(CDATA) AND SDATA NE MISSINGS(SDATA))
				YY = CDATA[OK]
				XX = SDATA[OK]

				XLOG = 0
				YLOG = 0

				YRANGE = [1,2]
				XRANGE = [0,50]
				YTITLE = 'Normalized Chl Gradient'
				XTITLE = 'Normalized SST Gradient'
				STATS_PARAMS = [2,3,4,8]

				BINX=(XRANGE[1]-XRANGE[0])/100.
				BINY=(YRANGE[1]-YRANGE[0])/100.
				!Y.OMARGIN=[2,2]
				!X.OMARGIN=[8,6]
				XMARGIN = [1,1]
				YMARGIN = [1,1]


;				!P.MULTI=[0,0,1]
;				PSFILE = DIR_PLOTS + FA_F.PERIOD + '-' + FA_F.SENSOR + '-' + FA_F.MAP + '-CHLOR_A-GRAD_MAG_RATIO-SST-GRAD_MAG-NORM_RATIO-HIST2D.PS'
;				PSPRINT,FILENAME=PSFILE,/COLOR,/TIMES,/HALF

				PLOT_HIST2D, XX, YY, IMAGE=HIST_IMAGE, PAL=_PAL, MODEL='RMA', FAST=1, CHARSIZE=1.5,$
		          BIN_X=BINX, MIN_X=XRANGE[0], MAX_X=XRANGE[1], $
		          BIN_Y=BINY, MIN_Y=YRANGE[0], MAX_Y=YRANGE[1], $
							XLOG=XLOG, YLOG=YLOG,STATS_PARAMS=STATS_PARAMS,$
		          PX=PX, XTITLE=XTITLE, XLABEL=XLABEL, XTHICK=3, XMARGIN=XMARGIN, TITLE=TITLE, $
		          PY=PY, YTITLE=YTITLE, YLABEL=YLABEL, YTHICK=3, YMARGIN=YMARGIN, $
		          LAB_TXT=LABEL, LAB_CHARSIZE=5, STATS_CHARSIZE=1.25, ISOTROPIC=ISOTROPIC,$
		          BKG_COLOR=255, ZERO_COLOR=254, MAX_COLOR=250,$
		          REG_COLOR=0,  REG_THICK=5, $
		          LOG_FREQ=1, POSITION=POSITION, _EXTRA=_EXTRA, /PERCENT

;				PSPRINT

;				IF FA_S.FULLNAME EQ '' OR FA_F.PERIOD NE FA_S.PERIOD THEN CONTINUE
;				VC = VALID_DATA(SDATA,PROD=CPROD,SENSOR=FA_S.SENSOR,SUBS=SUBC)
;				IF MIN(SUBB) GE 0 THEN BIMAGE2(SUBB) = BIMAGE2(SUBB) + 1 ELSE CONTINUE
;				IF MIN(SUBC) GE 0 THEN BIMAGE2(SUBC) = BIMAGE2(SUBC) + 1 ELSE CONTINUE
;				OK = WHERE(BIMAGE2 EQ 2,COUNT) & IF COUNT EQ 0 THEN CONTINUE
;				YY2 = FDATA[OK]
;				XX2 = SDATA[OK]
;
;				XLOG = 0
;				YLOG = 0
;				YRANGE = [1,2]
;				XRANGE = [0,1]
;				YTITLE = 'Chlorophyll Gradient (mg m!E-3!N)'
;				XTITLE = 'SST Gradient Magnitude (!Eo!NC km!E-1!N)'
;				BINX=(XRANGE[1]-XRANGE[0])/100.
;				BINY=(YRANGE[1]-YRANGE[0])/100.
;				PARAMS=[2,3,4,8]
;				STATS_POS=[0.75,0.95]
;
;				PLOT_HIST2D, XX2, YY2, IMAGE=HIST_IMAGE, PAL=_PAL, MODEL='RMA', FAST=1, CHARSIZE=1.5,$
;		          BIN_X=BINX, MIN_X=XRANGE[0], MAX_X=XRANGE[1], $
;		          BIN_Y=BINY, MIN_Y=YRANGE[0], MAX_Y=YRANGE[1], $
;							XLOG=XLOG, YLOG=YLOG,STATS_PARAMS=STATS_PARAMS,$
;		          PX=PX, XTITLE=XTITLE, XLABEL=XLABEL, XTHICK=3, XMARGIN=XMARGIN, TITLE=TITLE, $
;		          PY=PY, YTITLE=YTITLE, YLABEL=YLABEL, YTHICK=3, YMARGIN=YMARGIN, $
;		          LAB_TXT=LABEL, LAB_CHARSIZE=5, STATS_CHARSIZE=1.25, ISOTROPIC=ISOTROPIC,$
;		          BKG_COLOR=255, ZERO_COLOR=254, MAX_COLOR=250,$
;		          REG_COLOR=0,  REG_THICK=5, $
;		          LOG_FREQ=1, POSITION=POSITION, _EXTRA=_EXTRA, /PERCENT
;
;				PSPRINT
;
;				IF FA_S.FULLNAME EQ '' OR FA_C.PERIOD NE FA_S.PERIOD THEN CONTINUE
;				VC = VALID_DATA(SDATA,PROD=CPROD,SENSOR=FA_S.SENSOR,SUBS=SUBC)
;				IF MIN(SUBA) GE 0 THEN BIMAGE2(SUBA) = BIMAGE2(SUBA) + 1 ELSE CONTINUE
;				IF MIN(SUBC) GE 0 THEN BIMAGE2(SUBC) = BIMAGE2(SUBC) + 1 ELSE CONTINUE
;				OK = WHERE(BIMAGE2 EQ 2,COUNT) & IF COUNT EQ 0 THEN CONTINUE
;				YY2 = CDATA[OK]
;				XX2 = SDATA[OK]
;
;				XLOG = 0
;				YLOG = 1
;				YRANGE = ALOG10([1.,100])
;				XRANGE = [0,1]
;				YTITLE = 'Chlorophyll (mg m!E-3!N)'
;				XTITLE = 'SST Gradient Magnitude (!Eo!NC km!E-1!N)'
;				BINX=(XRANGE[1]-XRANGE[0])/100.
;				BINY=(YRANGE[1]-YRANGE[0])/100.
;				PARAMS=[2,3,4,8]
;				STATS_POS=[0.75,0.95]
;
;				!P.MULTI=[0,0,1]
;				PSFILE = DIR_PLOTS + FA_F.PERIOD + '-' + FA_F.SENSOR + '-' + FA_F.MAP + '-CHLOR_A-SST_GRAD_MAG-HIST2D.PS'
;				PSPRINT,FILENAME=PSFILE,/COLOR,/TIMES,/HALF
;
;				PLOT_HIST2D, XX2, ALOG10(YY2), IMAGE=HIST_IMAGE, PAL=_PAL, MODEL='RMA', FAST=1, CHARSIZE=1.5,$
;		          BIN_X=BINX, MIN_X=XRANGE[0], MAX_X=XRANGE[1], $
;		          BIN_Y=BINY, MIN_Y=YRANGE[0], MAX_Y=YRANGE[1], $
;							ALOGX=XLOG,ALOGY=YLOG,/ONE_NONE,PARAMS=PARAMS,STATS_POS=STATS_POS,YTICKS=2,$
;		          PX=PX, XTITLE=XTITLE, XLABEL=XLABEL, XTHICK=3, XMARGIN=XMARGIN, TITLE=TITLE, $
;		          PY=PY, YTITLE=YTITLE, YLABEL=YLABEL, YTHICK=3, YMARGIN=YMARGIN, $
;		          LAB_TXT=LABEL, LAB_CHARSIZE=5, STATS_CHARSIZE=1.25, ISOTROPIC=ISOTROPIC,$
;		          BKG_COLOR=255, ZERO_COLOR=254, MAX_COLOR=250,$
;		          REG_COLOR=0,  REG_THICK=5,$
;		          LOG_FREQ=1, POSITION=POSITION, _EXTRA=_EXTRA, /PERCENT,/REGRESS_NONE, /STATS_NON
;
;				PSPRINT

			ENDFOR

			stop
		ENDFOR

	ENDIF

; *******************************************************
	IF DO_FRONT_CHL_FIGS_EC GE 1 THEN BEGIN
; *******************************************************
		OVERWRITE = DO_FRONT_CHL_FIGS_EC GE 2


		PERIODS = ['!Y_','!YEAR','!ANNUAL','!MONTH_']
		PERIODS = '!MONTH_'

		FOR PTH = 0L, N_ELEMENTS(PERIODS)-1 DO BEGIN
			APERIOD = PERIODS(PTH)
			CFILES = FILE_SEARCH(DIRE_FRONTS +APERIOD+'*-SEA_AQU-LAC-EC-CHLOR_A-MF3_1D_5PT_E0_693-GAUSS_5_SIG_0_6-SOBEL-GRAD_MAG_RATIO-MEAN.SAVE')
			SFILES = FILE_SEARCH(DIRE_SFRONTS+APERIOD+'*-MODIS-LAC-EC-SST-4UM-GRAD_MAG-MEAN.SAVE')

			FA_SST = PARSE_IT(SFILES,/ALL)
			PSFILE = DIR_PLOTS + APERIOD + '-EC-CHLOR_A_GRAD_MAG_RATIO-SST_GRAD_MAG-HIST2D.PS'
			PSPRINT,FILENAME=PSFILE,/COLOR,/TIMES,/HALF
			!P.MULTI=[0,1,1]

			FOR FTH = 0L, N_ELEMENTS(CFILES)-1 DO BEGIN
				FA_C   = PARSE_IT(CFILES(FTH),/ALL)
				OK_SST = WHERE(FA_SST.PERIOD EQ FA_C.PERIOD,COUNT_SST)
				IF COUNT_SST EQ 1 THEN FA_S = FA_SST(OK_SST) ELSE FA_S= STRUCT_2MISSINGS(FA_SST[0])

				IF FA_C.PERIOD NE FA_S.PERIOD THEN CONTINUE
				CDATA  = STRUCT_SD_READ(FA_C.FULLNAME,STRUCT=FSTRUCT)
				IF COUNT_SST EQ 1 THEN SDATA  = STRUCT_SD_READ(FA_S.FULLNAME,STURCT=SSTRUCT)

				RATIO_SAVEFILE = DIR_RATIO + FA_C.PERIOD + '-' + FA_C.SENSOR + '-' + FA_C.MAP + '-CHLOR_A-GRAD_MAG_RATIO-SST-GRAD_MAG-RATIO.SAVE'
				IF COUNT_SST EQ 1 AND FA_C.PERIOD EQ FA_S.PERIOD THEN RATIO_SAVE_MAKE,DIR_OUT=DIR_RATIO,SAVEFILE=RATIO_SAVEFILE,FILEA=FA_C.FULLNAME,FILEB=FA_S.FULLNAME,OVERWRITE=OVERWRITE,/LOGA

				USE_PROD = 'RATIO'
				SPECIAL_SCALE = '2'
				TITLE = 'Chlorophyll Gradient:SST Gradient'
				IF FILE_TEST(RATIO_SAVEFILE) EQ 1 THEN $
				STRUCT_SD_2PNG, RATIO_SAVEFILE,DIR_OUT=DIR_BROWSE,USE_PROD=USE_PROD,$
				    								/ADD_COLORBAR, /ADDDATE,/ADD_PROD,SPECIAL_SCALE=SPECIAL_SCALE,$
	                   				/ADD_LAND, /ADD_COAST, BACKGROUND=ABACKGROUND,$
	                  				LAND_COLOR=252,FLAG_COLOR=AFLAG_COLOR,OUTSCAN_COLOR=aoutscan_color,$
	                  				ALGFAIL_COLOR=AALGFAIL_COLOR,HI_LO_COLOR=AHI_LO_COLOR,PAL=PAL,FLAGS=_FLAGS,SOLO=SOLO,$
	                  				OVERWRITE=overwrite,/QUIET ,ADD_EXTRA=ADD_EXTRA,COLORBAR_TITLE=TITLE

				ALG_X = 'SST Gradient Magnitude'
				ALC_Y = 'Chlorophyll Gradient Magnitude'
				XPROD = FA_S.MATH
				GPROD = FA_C.MATH
				PERIOD_X = FA_S.PERIOD
				PERIOD_Y = FA_C.PERIOD
				XSCALE = SD_SCALES([1,250],PROD=XPROD,/BIN2DATA)
				YSCALE = SD_SCALES([1,250],PROD=YPROD,/BIN2DATA)

 				CASE STRUPCASE(FA_C.PERIOD_CODE) OF
					'!ANNUAL': TITLE = FA_C.YEAR_START + ' - ' + FA_C.YEAR_END
					'!M':      TITLE = MONTH_NAMES(FA_C.MONTH_START) + ' ' + FA_C.YEAR_START
					'!MONTH':  TITLE = MONTH_NAMES(FA_C.MONTH_START)
					'!Y':      TITLE = FA_C.YEAR_START
					'!YEAR':   TITLE = FA_C.YEAR_START + ' - ' + FA_C.YEAR_END
				ENDCASE

				XLOG = 0
				YLOG = 0
;
				XRANGE = [0,0.5]
				YRANGE = [1,1.5]
				YTITLE = 'Chlorophyll Gradient (ratio)'
				XTITLE = 'SST Gradient Magnitude (!Eo!NC km!E-1!N)'
				STATS_PARAMS = [2,3,4,8]

				BINX=(XRANGE[1]-XRANGE[0])/100.
				BINY=(YRANGE[1]-YRANGE[0])/100.
				!Y.OMARGIN=[2,2]
				!X.OMARGIN=[8,6]
				XMARGIN = [1,1]
				YMARGIN = [1,1]

				IF FA_S.FULLNAME EQ '' OR FA_C.PERIOD NE FA_S.PERIOD THEN CONTINUE
				OK = WHERE(CDATA NE MISSINGS(CDATA) AND SDATA NE MISSINGS(SDATA),COUNT)
				BIMAGE = BYTE(CDATA) & BIMAGE(*,*) = 0 & BIMAGE2 = BIMAGE
				IF COUNT GE 1 THEN BIMAGE2[OK] = 2 ELSE CONTINUE
				XX = SDATA[OK]
				YY = CDATA[OK]

;				!P.MULTI=[0,0,1]
				PSFILE = DIR_PLOTS + FA_C.PERIOD + '-' + FA_C.SENSOR + '-' + FA_C.MAP + '-CHLOR_A_GRAD_MAG_RATIO-SST_GRAD_MAG-HIST2D.PS'
;				PSPRINT,FILENAME=PSFILE,/COLOR,/TIMES,/HALF

				PLOT_HIST2D, XX, YY, IMAGE=HIST_IMAGE, PAL=_PAL, MODEL='RMA', FAST=1, CHARSIZE=1.5,$
		          BIN_X=BINX, MIN_X=XRANGE[0], MAX_X=XRANGE[1], $
		          BIN_Y=BINY, MIN_Y=YRANGE[0], MAX_Y=YRANGE[1], $
							ALOGX=XLOG,ALOGY=YLOG,/ONE_NONE,PARAMS=PARAMS,STATS_POS=STATS_POS,YTICKS=2,$
		          PX=PX, XTITLE=XTITLE, XLABEL=XLABEL, XTHICK=3, XMARGIN=XMARGIN, TITLE=TITLE, $
		          PY=PY, YTITLE=YTITLE, YLABEL=YLABEL, YTHICK=3, YMARGIN=YMARGIN, $
		          LAB_TXT=LABEL, LAB_CHARSIZE=5, STATS_CHARSIZE=1.25, ISOTROPIC=ISOTROPIC,$
		          BKG_COLOR=255, ZERO_COLOR=254, MAX_COLOR=250,$
		          REG_COLOR=0,  REG_THICK=5,STATS_PARAMS=STATS_PARAMS,$
		          LOG_FREQ=1, POSITION=POSITION, _EXTRA=_EXTRA, /PERCENT,/REGRESS_NONE

;				PSPRINT

			ENDFOR
			PSPRINT
			STOP
		ENDFOR



STOP

	ENDIF ; DO_FRONT_CHL_FIGS

; *******************************************************
	IF DO_PS_2PNG GE 1 THEN BEGIN
; *******************************************************
		OVERWRITE = DO_PS_2PNG GE 2
MAKE_PS2PNGS:
	;	PSFILES = FILE_SEARCH(DIR_POSTER + 'Figure*.PS')
		PSFILES = FILE_SEARCH(DIR_POSTER + '!ANNUAL*.PS')
	;	PSFILES = DIR_PLOTS + 'Figure_17-!MONTH-AT-NEC-SST-4UM-GRAD_MAG-MEAN-COMPOSITE-1_12.PS'
	;	PSFILES = DIR_PLOTS + 'Figure_18-!Y-AT-NEC-SST-4UM-GRAD_MAG-MEAN-COMPOSITE-1_6.PS'
		GRACE = [10,10,10,10]
		BACKGROUND=215
		FOR _P = 0L, N_ELEMENTS(PSFILES)-1 DO BEGIN
			PSFILE = PSFILES(_P)
			IMAGE_TRIM, PSFILE, DIR_OUT=DIR_POSTER, DPI=600, BACKGROUND=215,GRACE=[10,10,10,10], OVERWRITE=overwrite
		ENDFOR
STOP
	ENDIF ;DO_PS_2PNG


; *******************************************************
	IF DO_IMAGE_COMPOSITES GE 1 THEN BEGIN
; *******************************************************
		OVERWRITE = DO_IMAGE_COMPOSITES GE 2

		BACKGROUND = 255
		SPACE = 20
		PX = 1024
		PY = 1024
		!P.FONT = 0
		FIGSIZE = 1.5
		PAL = 'PAL_SW3'

; *****  IN ORDER TO GET THE LAT/LON LINES IN THE CORRECT POSITION, A ZWIN CALL MUST BE USED (SEE MAP_GRID_DEMO) *****

		DO_MONTHLY  = 0
		DO_YEARLY   = 0
		DO_FIG_1		= 0
		DO_FIG_2		= 0
		DO_FIG_3		= 0
		DO_FIG_4		= 0
		DO_FIG_5		= 0
		DO_FIG_6		= 0
		DO_FIG_7_NEC	= 0		;		Annual CHLOR_A NEC GRAD MAG
		DO_FIG_7_EC		= 0		;		Annual CHLOR_A EC GRAD MAG
		DO_FIG_8_NEC	= 1		; 	Annual SST NEC GRAD MAG
		DO_FIG_8_EC		= 0		; 	Annual SST EC GRAD MAG
		DO_FIG_9		= 0			;		NEC Bathy with lat/lon
		DO_FIG_10		= 0
		DO_FIG_11		= 0
		DO_FIG_12		= 0
		DO_FIG_13		= 0
		DO_FIG_14		= 0
		DO_FIG_15		= 0
		DO_FIG_16		= 0
		DO_FIG_17		= 0
		DO_FIG_18		= 0
		DO_FIG_19		= 0
		DO_FIG_20		= 0


		IF DO_FIG_2 GE 1 THEN BEGIN
			SAVEFILE = DIR_SST    + '!Y_2006-AT-NEC-SST-4UM-MEAN.SAVE'
			PNGFILE  = DIR_INTER  + '!Y_2006-AT-NEC-SST-4UM-MEAN.PNG'
			PSFILE 	 = DIR_POSTER + '!Y_2006-AT-NEC-SST-4UM-MEAN.PS'
			SPECIAL_SCALE=''
			STRUCT_SD_2PNG,SAVEFILE,DIR_OUT=DIR_INTER,/ADD_LAND,/ADD_COAST,MISS_COLOR=0,/OVERWRITE, /ADD_BATHY,SPECIAL_SCALE=SPECIAL_SCALE

			IMAGE = READ_PNG(PNGFILE,R,G,B)
			SLIDEW, IMAGE

	   	OLDDEVICE= !D.NAME
			MAP_NEC
			PS_IMAGE, FILES=PNGFILE,DIR_OUT=DIR_POSTER, /COLOR,FULL=full,/NO_CLOSE,SCALE=2,XOFFSET=2,YOFFSET=3
			!P.FONT = 0
			LATS = [32,36,40,44,48]          & LATNAMES = STRTRIM(LATS, 2)
			LONS = [-80,-76,-72,-68,-64,-60] & LONNAMES = STRTRIM(LONS, 2)
			MAP_GRID, LABEL=1, LATS=LATS, LATNAMES=LATNAMES, LONS=LONS, LONNAMES=LONNAMES, GLINESTYLE=0,/BOX_AXES, CHARSIZE=0.9

			XYOUTS2,0.45,0.38,'SSF', ALIGN=0.5, CHARSIZE=0.75, COLOR=0, CHARTHICK=1.5, BACKGROUND=255, GRACE=[0.08,0.7],/NORMAL
			USERSYM, [0.0,1.0,0.25,0.0],[1.0,0.75,0,1.0], /FILL
			PLOTS,0.395, 0.455,COLOR=0,SYMSIZE=1.75,PSYM=8,/NORMAL
			PLOTS,[0.445,0.405],[0.4255,0.4655],COLOR=0,THICK=5,/NORMAL

			TITLE = UNITS('SST')
			CHARSIZE = 0.75
			LEG=COLOR_BAR_SCALE(PROD='SST',POSITION=[0.03, 0.96,0.55, 0.98],CHARSIZE=0.75,/BOTTOM,TITLE=TITLE,/NO_UNIT,FONT='HELVETICA',SPECIAL_SCALE=SPECIAL_SCALE,PAL='PAL_SW3')

			DEVICE,/CLOSE
			SET_PLOT,OLDDEVICE
			GRACE = [100,100,100,100]
			BACKGROUND=215
			IMAGE_TRIM, PSFILE, DIR_OUT=DIR_POSTER, DPI=600, BACKGROUND=BACKGROUND,GRACE=GRACE, /OVERWRITE
		STOP
		ENDIF

		IF DO_FIG_3 GE 1 THEN BEGIN
	;		Figure 3 - !M_200209 Chlor_a
			SAVEFILE = DIR_SAVE + '!M_200209-SEAWIFS-REPRO5-NEC-CHLOR_A-OC4-MEAN.SAVE'
			PNGFILE  = DIR_OUT  + '!M_200209-SEAWIFS-REPRO5-NEC-CHLOR_A-OC4-MEAN.PNG'
			PSFILE 	 = DIR_MANU + '!M_200209-SEAWIFS-REPRO5-NEC-CHLOR_A-OC4-MEAN.ps'
			SPECIAL_SCALE=''
			STRUCT_SD_2PNG,SAVEFILE,DIR_OUT=DIR_OUT,/ADD_LAND,/ADD_COAST,MISS_COLOR=0,/OVERWRITE, /ADD_BATHY,SPECIAL_SCALE=SPECIAL_SCALE

			IMAGE = READ_PNG(PNGFILE,R,G,B)
			SLIDEW, IMAGE

	   	OLDDEVICE= !D.NAME
			MAP_NEC
			PS_IMAGE, FILES=PNGFILE,DIR_OUT=DIR_MANU, /COLOR,FULL=full,/NO_CLOSE,SCALE=2,XOFFSET=2,YOFFSET=3
			!P.FONT = 0
			LATS = [32,36,40,44,48]          & LATNAMES = STRTRIM(LATS, 2)
			LONS = [-80,-76,-72,-68,-64,-60] & LONNAMES = STRTRIM(LONS, 2)
			MAP_GRID, LABEL=1, LATS=LATS, LATNAMES=LATNAMES, LONS=LONS, LONNAMES=LONNAMES, GLINESTYLE=0,/BOX_AXES, CHARSIZE=0.9
			XYOUTS2,0.51,0.46,'SSF', ALIGN=0.5, CHARSIZE=0.75, COLOR=0, CHARTHICK=1.5, BACKGROUND=255, GRACE=[0.08,0.7],/NORMAL

			USERSYM, [0.0,1.0,0.25,0.0],[1.0,0.75,0,1.0], /FILL
			PLOTS,0.415, 0.515,COLOR=0,SYMSIZE=1.75,PSYM=8,/NORMAL
			PLOTS,[0.465,0.425],[0.4855,0.5255],COLOR=0,THICK=5,/NORMAL

			TITLE = 'Chlorophyll !8a!7 (mg m!E-3!N)'
			CHARSIZE = 0.75
			LEG=COLOR_BAR_SCALE(PROD='CHLOR_A',POSITION=[0.03, 0.96,0.55, 0.98],CHARSIZE=0.75,/BOTTOM,TITLE=TITLE,/NO_UNIT,FONT='HELVETICA',SPECIAL_SCALE=SPECIAL_SCALE,PAL='PAL_SW3')

			DEVICE,/CLOSE
			SET_PLOT,OLDDEVICE
			GRACE = [100,100,100,100]
			BACKGROUND=215
	;		IMAGE_TRIM, PSFILE, DIR_OUT=DIR_MANU, DPI=600, BACKGROUND=BACKGROUND,GRACE=GRACE, /OVERWRITE
		ENDIF

		IF DO_FIG_5 GE 1 THEN BEGIN
	;		Figure 5 - !M_200104 Chlor_a
			SAVEFILE = DIR_SAVE + '!M_200104-SEAWIFS-REPRO5-NEC-CHLOR_A-MEAN.SAVE'
			PNGFILE  = DIR_OUT  + '!M_200104-SEAWIFS-REPRO5-NEC-CHLOR_A-MEAN.PNG'
			PSFILE 	 = DIR_MANU + '!M_200104-SEAWIFS-REPRO5-NEC-CHLOR_A-MEAN.PS'
			SPECIAL_SCALE = ''
			STRUCT_SD_2PNG,SAVEFILE,DIR_OUT=DIR_OUT,/ADD_LAND,/ADD_COAST,MISS_COLOR=0,/OVERWRITE, /ADD_BATHY,SPECIAL_SCALE=SPECIAL_SCALE
			IMAGE = READ_PNG(PNGFILE,R,G,B)
			SLIDEW, IMAGE

			OLDDEVICE= !D.NAME
			MAP_NEC
			PS_IMAGE, FILES=PNGFILE,DIR_OUT=DIR_MANU, /COLOR,FULL=full,/NO_CLOSE,SCALE=2,XOFFSET=2,YOFFSET=3
			!P.FONT = 0
			LATS = [32,36,40,44,48]          & LATNAMES = STRTRIM(LATS, 2)
			LONS = [-80,-76,-72,-68,-64,-60] & LONNAMES = STRTRIM(LONS, 2)
			MAP_GRID, LABEL=1, LATS=LATS, LATNAMES=LATNAMES, LONS=LONS, LONNAMES=LONNAMES, GLINESTYLE=0,/BOX_AXES, CHARSIZE=0.9

			XYOUTS2,0.51,0.46,'SSF', ALIGN=0.5, CHARSIZE=0.75, COLOR=0, CHARTHICK=1.5, BACKGROUND=255, GRACE=[0.08,0.7],/NORMAL
			USERSYM, [0.0,1.0,0.25,0.0],[1.0,0.75,0,1.0], /FILL
			PLOTS,0.415, 0.515,COLOR=0,SYMSIZE=1.75,PSYM=8,/NORMAL
			PLOTS,[0.465,0.425],[0.4855,0.5255],COLOR=0,THICK=5,/NORMAL

			TITLE = 'Chlorophyll !8a!7 (mg m!E-3!N)'
			CHARSIZE = 0.75
			LEG=COLOR_BAR_SCALE(PROD='CHLOR_A',POSITION=[0.03, 0.96,0.55, 0.98],CHARSIZE=0.75,/BOTTOM,TITLE=TITLE,/NO_UNIT,FONT='HELVETICA',SPECIAL_SCALE=SPECIAL_SCALE,PAL='PAL_SW3')

			DEVICE,/CLOSE
			SET_PLOT,OLDDEVICE
	;		IMAGE_TRIM, PSFILE, DIR_OUT=DIR_MANU, DPI=600, BACKGROUND=BACKGROUND,GRACE=GRACE, /OVERWRITE
		ENDIF

		IF DO_FIG_7_NEC GE 1 THEN BEGIN
	;		Annual CHLOR_A NEC GRAD MAG
			PAL_SW3,R,G,B
			SAVEFILE = DIR_CFRONTS+ '!ANNUAL-SEAWIFS-MLAC-NEC-CHLOR_A-OC4-GRAD_MAG_RATIO-MEAN.SAVE'
			PNGFILE  = DIR_INTER  + '!ANNUAL-SEAWIFS-MLAC-NEC-CHLOR_A-OC4-GRAD_MAG_RATIO-MEAN.PNG'
			PSFILE 	 = DIR_POSTER + '!ANNUAL-SEAWIFS-MLAC-NEC-CHLOR_A-OC4-GRAD_MAG_RATIO-MEAN.PS'
			SPECIAL_SCALE = '!ANNUAL'
			STRUCT_SD_2PNG,SAVEFILE,DIR_OUT=DIR_INTER,/ADD_LAND,/ADD_COAST,MISS_COLOR=0,/OVERWRITE, /ADD_BATHY,SPECIAL_SCALE=SPECIAL_SCALE
			IMAGE = READ_PNG(PNGFILE,R,G,B)
			ZWIN, IMAGE

			OLDDEVICE= !D.NAME
			MAP_NEC
			PS_IMAGE, FILES=PNGFILE,DIR_OUT=DIR_POSTER, /COLOR,FULL=full,/NO_CLOSE,SCALE=2,XOFFSET=2,YOFFSET=3
			!P.FONT = 0
			LATS = [32,36,40,44,48]          & LATNAMES = STRTRIM(LATS, 2)
			LONS = [-80,-76,-72,-68,-64,-60] & LONNAMES = STRTRIM(LONS, 2)
		;	MAP_GRID, LABEL=1, LATS=LATS, LATNAMES=LATNAMES, LONS=LONS, LONNAMES=LONNAMES, GLINESTYLE=0,/BOX_AXES, CHARSIZE=0.9

			CHARSIZE = 0.85
			CHARTHICK = 2
			XYOUTS,0.30, 0.40,'Shelf Slope !C     Front', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=255, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA-ITALIC'
	   	XYOUTS,0.15, 0.1, 'Gulf Stream', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=255, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
  	 	XYOUTS,0.62, 0.64,'Georges !C   Bank', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=255, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
  		XYOUTS,0.42, 0.53,'Nantucket !C   Shoals', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=255, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'

			TITLE = 'Chlorophyll Gradient !C(ratio)'
			LEG=COLOR_BAR_SCALE(PROD='GRAD_MAG_RATIO',POSITION=[0.03, 0.96,0.55, 0.98],CHARSIZE=0.75,/BOTTOM,TITLE=TITLE,/NO_UNIT,FONT='HELVETICA',SPECIAL_SCALE=SPECIAL_SCALE,PAL='PAL_SW3')

			DEVICE,/CLOSE
			SET_PLOT,OLDDEVICE
			IMAGE_TRIM, PSFILE, DIR_OUT=DIR_POSTER, DPI=600, BACKGROUND=215,GRACE=GRACE, /OVERWRITE
		ENDIF
		IF DO_FIG_7_EC GE 1 THEN BEGIN
	;		Annual CHLOR_A EC GRAD MAG
			PAL_SW3,R,G,B
			SAVEFILE = DIRE_FRONTS + '!ANNUAL-SEA_AQU-LAC-EC-CHLOR_A-MF3_1D_5PT_E0_693-GAUSS_5_SIG_0_6-SOBEL-GRAD_MAG_RATIO-MEAN.SAVE'
			PNGFILE  = DIR_INTER  + '!ANNUAL-SEA_AQU-LAC-EC-CHLOR_A-MF3_1D_5PT_E0_693-GAUSS_5_SIG_0_6-SOBEL-GRAD_MAG_RATIO-MEAN.PNG'
			PSFILE 	 = DIR_POSTER + '!ANNUAL-SEA_AQU-LAC-EC-CHLOR_A-MF3_1D_5PT_E0_693-GAUSS_5_SIG_0_6-SOBEL-GRAD_MAG_RATIO-MEAN.PS'
			SPECIAL_SCALE = '!ANNUAL'
			STRUCT_SD_2PNG,SAVEFILE,DIR_OUT=DIR_INTER,/ADD_LAND,/ADD_COAST,MISS_COLOR=0,/OVERWRITE, /ADD_BATHY,SPECIAL_SCALE=SPECIAL_SCALE
			IMAGE = READ_PNG(PNGFILE,R,G,B)
		;	SLIDEW, IMAGE

			OLDDEVICE= !D.NAME
		;	MAP_EC
			PS_IMAGE, FILES=PNGFILE,DIR_OUT=DIR_POSTER, /COLOR,FULL=full,/NO_CLOSE,SCALE=2,XOFFSET=2,YOFFSET=3
			!P.FONT = 0
			LATS = [32,36,40,44,48]          & LATNAMES = STRTRIM(LATS, 2)
			LONS = [-80,-76,-72,-68,-64,-60] & LONNAMES = STRTRIM(LONS, 2)
		;	MAP_GRID, LABEL=1, LATS=LATS, LATNAMES=LATNAMES, LONS=LONS, LONNAMES=LONNAMES, GLINESTYLE=0,/BOX_AXES, CHARSIZE=0.9

			CHARSIZE = 0.85
			CHARTHICK = 2
			XYOUTS,0.35, 0.65,'Shelf Slope !C     Front', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=255, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA-ITALIC'
	   	XYOUTS,0.33, 0.5, 'Gulf Stream', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=255, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
  	 	XYOUTS,0.59, 0.8,'Georges !C   Bank', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=255, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
  	;	XYOUTS,0.42, 0.53,'Nantucket !C   Shoals', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=255, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'

			TITLE = 'Chlorophyll Gradient !C(ratio)'
			LEG=COLOR_BAR_SCALE(PROD='GRAD_MAG_RATIO',POSITION=[0.03, 0.96,0.55, 0.98],CHARSIZE=0.75,/BOTTOM,TITLE=TITLE,/NO_UNIT,FONT='HELVETICA',SPECIAL_SCALE=SPECIAL_SCALE,PAL='PAL_SW3')

			DEVICE,/CLOSE
			SET_PLOT,OLDDEVICE
			IMAGE_TRIM, PSFILE, DIR_OUT=DIR_POSTER, DPI=600, BACKGROUND=215,GRACE=GRACE, /OVERWRITE
		ENDIF

		IF DO_FIG_8_NEC GE 1 THEN BEGIN
	;		Figure 8 - Annual SST NEC GRAD MAG
			SAVEFILE = DIR_SFRONTS + '!ANNUAL-AT-NEC-SST-4UM-GRAD_MAG-MEAN.SAVE'
			PNGFILE  = DIR_INTER   + '!ANNUAL-AT-NEC-SST-4UM-GRAD_MAG-MEAN.PNG'
			PSFILE 	 = DIR_POSTER  + '!ANNUAL-AT-NEC-SST-4UM-GRAD_MAG-MEAN.PS'
			SPECIAL_SCALE = '!MONTH'
			STRUCT_SD_2PNG,SAVEFILE,DIR_OUT=DIR_INTER,/ADD_LAND,/ADD_COAST,MISS_COLOR=0,/OVERWRITE,SPECIAL_SCALE=SPECIAL_SCALE
			IMAGE = READ_PNG(PNGFILE,R,G,B)
			ZWIN, IMAGE

			OLDDEVICE= !D.NAME
			MAP_NEC
			PS_IMAGE, FILES=PNGFILE,DIR_OUT=DIR_POSTER, /COLOR,FULL=full,/NO_CLOSE,SCALE=2,XOFFSET=2,YOFFSET=3
			!P.FONT = 0
			LATS = [32,36,40,44,48]          & LATNAMES = STRTRIM(LATS, 2)
			LONS = [-80,-76,-72,-68,-64,-60] & LONNAMES = STRTRIM(LONS, 2)
	;		MAP_GRID, LABEL=1, LATS=LATS, LATNAMES=LATNAMES, LONS=LONS, LONNAMES=LONNAMES, GLINESTYLE=0,/BOX_AXES, CHARSIZE=0.9

			CHARSIZE = 0.85
			CHARTHICK=2
			XYOUTS,0.35, 0.45,'Shelf Slope !C     Front', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA-ITALIC'
	    XYOUTS,0.15, 0.1, 'Gulf Stream', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
	    XYOUTS,0.62, 0.64,'Georges !C   Bank', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
	 ;  XYOUTS,0.42, 0.53,'Nantucket !C   Shoals', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'


			TITLE = '!Eo!NC  km!E-1!N'
			LEG=COLOR_BAR_SCALE(PROD='GRAD_MAG',POSITION=[0.03, 0.96,0.55, 0.98],CHARSIZE=0.75,/BOTTOM,TITLE=TITLE,/NO_UNIT,FONT='HELVETICA',SPECIAL_SCALE=SPECIAL_SCALE,PAL='PAL_SW3')
			DEVICE,/CLOSE
			SET_PLOT,OLDDEVICE
			IMAGE_TRIM, PSFILE, DIR_OUT=DIR_POSTER, DPI=600, BACKGROUND=215,GRACE=GRACE, /OVERWRITE

		ENDIF
		IF DO_FIG_8_EC GE 1 THEN BEGIN
	;		Figure 8 - Annual SST NEC GRAD MAG
			SAVEFILE = DIRE_SFRONTS + '!ANNUAL-MODIS-LAC-EC-SST-4UM-GRAD_MAG-MEAN.SAVE'
			PNGFILE  = DIR_INTER   + '!ANNUAL-MODIS-LAC-EC-SST-4UM-GRAD_MAG-MEAN.PNG'
			PSFILE 	 = DIR_POSTER  + '!ANNUAL-MODIS-LAC-EC-SST-4UM-GRAD_MAG-MEAN.PS'
			SPECIAL_SCALE = '!MONTH'
			STRUCT_SD_2PNG,SAVEFILE,DIR_OUT=DIR_INTER,/ADD_LAND,/ADD_COAST,MISS_COLOR=0,/OVERWRITE,SPECIAL_SCALE=SPECIAL_SCALE
			IMAGE = READ_PNG(PNGFILE,R,G,B)
	;		SLIDEW, IMAGE

			OLDDEVICE= !D.NAME
	;		MAP_NEC
			PS_IMAGE, FILES=PNGFILE,DIR_OUT=DIR_POSTER, /COLOR,FULL=full,/NO_CLOSE,SCALE=2,XOFFSET=2,YOFFSET=3
			!P.FONT = 0
			LATS = [32,36,40,44,48]          & LATNAMES = STRTRIM(LATS, 2)
			LONS = [-80,-76,-72,-68,-64,-60] & LONNAMES = STRTRIM(LONS, 2)
	;		MAP_GRID, LABEL=1, LATS=LATS, LATNAMES=LATNAMES, LONS=LONS, LONNAMES=LONNAMES, GLINESTYLE=0,/BOX_AXES, CHARSIZE=0.9

			CHARSIZE = 0.85
			CHARTHICK=2
			XYOUTS,0.4, 0.7,'Shelf Slope !C     Front', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA-ITALIC'
	   	XYOUTS,0.35, 0.55, 'Gulf Stream', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
  	; 	XYOUTS,0.59, 0.8,'Georges !C   Bank', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=255, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'


			TITLE = '!Eo!NC  km!E-1!N'
			LEG=COLOR_BAR_SCALE(PROD='GRAD_MAG',POSITION=[0.03, 0.96,0.55, 0.98],CHARSIZE=0.75,/BOTTOM,TITLE=TITLE,/NO_UNIT,FONT='HELVETICA',SPECIAL_SCALE=SPECIAL_SCALE,PAL='PAL_SW3')
			DEVICE,/CLOSE
			SET_PLOT,OLDDEVICE
			IMAGE_TRIM, PSFILE, DIR_OUT=DIR_POSTER, DPI=600, BACKGROUND=215,GRACE=GRACE, /OVERWRITE

		ENDIF

		IF DO_FIG_9 GE 1 THEN BEGIN
	;		Figure 9 - Bathy
			SAVEFILE = DIR_IDL    + 'DATA\SRTM30-NEC-PXY_1024_1024-BATHY-SMOOTH_5.SAVE'
			PNGFILE  = DIR_INTER  + 'SRTM30-NEC-PXY_1024_1024-BATHY-SMOOTH_5.PNG'
			PSFILE 	 = DIR_POSTER + 'SRTM30-NEC-PXY_1024_1024-BATHY-SMOOTH_5.PS'
			PAL = 'PAL_BATHY'
			STRUCT_SD_2PNG,SAVEFILE,DIR_OUT=DIR_INTER,/ADD_LAND,/ADD_COAST,MISS_COLOR=0,/OVERWRITE,/ADD_BATHY,SPECIAL_SCALE=SPECIAL_SCALE,PAL='PAL_BATHY'

			OLDDEVICE= !D.NAME
			MAP_NEC
			PS_IMAGE, FILES=PNGFILE,DIR_OUT=DIR_POSTER, /COLOR,FULL=full,/NO_CLOSE,SCALE=2,XOFFSET=2,YOFFSET=3
			!P.FONT = 0
			LATS = [32,36,40,44,48]          & LATNAMES = STRTRIM(LATS, 2)
			LONS = [-80,-76,-72,-68,-64,-60] & LONNAMES = STRTRIM(LONS, 2)
			MAP_GRID, LABEL=1, LATS=LATS, LATNAMES=LATNAMES, LONS=LONS, LONNAMES=LONNAMES, GLINESTYLE=0,/BOX_AXES, CHARSIZE=0.9

			TITLE = 'Depth (m)'
			CHARSIZE = 0.75
			LEG=COLOR_BAR_SCALE(PROD='BATHY',POSITION=[0.02, 0.96,0.54, 0.98],CHARSIZE=0.75,/BOTTOM,TITLE=TITLE,/NO_UNIT,FONT='HELVETICA',SPECIAL_SCALE=SPECIAL_SCALE,PAL='PAL_BATHY')
			CHARSIZE=0.7
			XYOUTS,0.12, 0.2,'Mid-Atlantic Bight', ORIENTATION=60, ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1,/NORMAL,FONT='HELVETICA-ITALIC'
			XYOUTS,0.5, 0.76,'Gulf of !CMaine', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1,/NORMAL,FONT='HELVETICA'
			XYOUTS,0.6, 0.62,'Georges !C   Bank', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1,/NORMAL,FONT='HELVETICA'
			XYOUTS,0.4, 0.55,'Nantucket !C   Shoals', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1,/NORMAL,FONT='HELVETICA'

			DEVICE,/CLOSE
			SET_PLOT,OLDDEVICE
	;		IMAGE_TRIM, PSFILE, DIR_OUT=DIR_POSTER, DPI=600, BACKGROUND=BACKGROUND,GRACE=GRACE, /OVERWRITE
		ENDIF

		IF DO_FIG_10 GE 1 THEN BEGIN
;		Figure 10 SST and CHL front examples (composite)
			SPECIAL_SCALES = ['','HIGH','MEDIUM','']
			PRODS          = ['SST','GRAD_MAG','CHLOR_A','GRAD_MAG_RATIO']
			TITLES         = [UNITS('SST'),'Gradient Magnitude (!Eo!NC  km!E-1!N)',UNITS('CHLOR_A'),'Gradient Magnitude (ratio)']


			SAVEFILES = DIR_SAVE + ['!T_200105030701-AVHRR-N16-S3-CW_CD-NEC-SST.SAVE',$
															'!T_200105030701-AVHRR-N16-S3-CW_CD-NEC-SST-GAUSS_5_SIG_0_6-SOBEL-GRAD_MAG.SAVE',$
															'!S_20001014170917-SEAWIFS-OV2-MLAC-REPRO5-NEC-CHLOR_A.save',$
															'!S_20001014170917-SEAWIFS-OV2-MLAC-REPRO5-NEC-CHLOR_A-MF3_1D_5PT_E0_693-SOBEL-GRAD_MAG_RATIO.SAVE']

			PNGFILES  = DIR_INTER +  ['!T_200105030701-AVHRR-N16-S3-CW_CD-NEC-SST.PNG',$
															'!T_200105030701-AVHRR-N16-S3-CW_CD-NEC-SST-GAUSS_5_SIG_0_6-SOBEL-GRAD_MAG.PNG',$
															'!S_20001014170917-SEAWIFS-OV2-MLAC-REPRO5-NEC-CHLOR_A.PNG',$
															'!S_20001014170917-SEAWIFS-OV2-MLAC-REPRO5-NEC-CHLOR_A-MF3_1D_5PT_E0_693-SOBEL-GRAD_MAG_RATIO.PNG']

			TRIMFILES = DIR_TRIM + ['!T_200105030701-AVHRR-N16-S3-CW_CD-NEC-SST-PS_1-trim.PNG',$
															'!T_200105030701-AVHRR-N16-S3-CW_CD-NEC-SST-GAUSS_5_SIG_0_6-SOBEL-GRAD_MAG-PS_1-trim.PNG',$
															'!S_20001014170917-SEAWIFS-OV2-MLAC-REPRO5-NEC-CHLOR_A-PS_1-trim.PNG',$
															'!S_20001014170917-SEAWIFS-OV2-MLAC-REPRO5-NEC-CHLOR_A-MF3_1D_5PT_E0_693-SOBEL-GRAD_MAG_RATIO-PS_1-trim.PNG']

			TRUEFILES = DIR_TRIM + ['!T_200105030701-AVHRR-N16-S3-CW_CD-NEC-SST-TRUE.PNG',$
															'!T_200105030701-AVHRR-N16-S3-CW_CD-NEC-SST-GAUSS_5_SIG_0_6-SOBEL-GRAD_MAG-TRUE.PNG',$
															'!S_20001014170917-SEAWIFS-OV2-MLAC-REPRO5-NEC-CHLOR_A-TRUE.PNG',$
															'!S_20001014170917-SEAWIFS-OV2-MLAC-REPRO5-NEC-CHLOR_A-MF3_1D_5PT_E0_693-SOBEL-GRAD_MAG_RATIO-TRUE.PNG']

			PSFILES   = DIR_INTER +  ['!T_200105030701-AVHRR-N16-S3-CW_CD-NEC-SST.ps',$
															'!T_200105030701-AVHRR-N16-S3-CW_CD-NEC-SST-GAUSS_5_SIG_0_6-SOBEL-GRAD_MAG.ps',$
															'!S_20001014170917-SEAWIFS-OV2-MLAC-REPRO5-NEC-CHLOR_A.ps',$
															'!S_20001014170917-SEAWIFS-OV2-MLAC-REPRO5-NEC-CHLOR_A-MF3_1D_5PT_E0_693-SOBEL-GRAD_MAG_RATIO.ps']

			FOR NTH=0L, N_ELEMENTS(SAVEFILES)-1 DO BEGIN
				STRUCT_SD_2PNG,SAVEFILES[NTH],DIR_OUT=DIR_INTER,/ADD_LAND,/ADD_COAST,/OVERWRITE,SPECIAL_SCALE=SPECIAL_SCALES[NTH]
				OLDDEVICE= !D.NAME
		;		MAP_NEC
				PS_IMAGE, FILES=PNGFILES[NTH],DIR_OUT=DIR_INTER, /COLOR,FULL=full,/NO_CLOSE,SCALE=2,XOFFSET=2,YOFFSET=3
				!P.FONT = 0
		;		LATS = [32,36,40,44,48]          & LATNAMES = STRTRIM(LATS, 2)
		;		LONS = [-80,-76,-72,-68,-64,-60] & LONNAMES = STRTRIM(LONS, 2)
		;		MAP_GRID, LABEL=1, LATS=LATS, LATNAMES=LATNAMES, LONS=LONS, LONNAMES=LONNAMES, GLINESTYLE=0,CHARSIZE=0.5,/BOX_AXES
				TITLE = TITLES[NTH]
				CHARSIZE = 0.75
				LEG=COLOR_BAR_SCALE(PROD=PRODS[NTH],POSITION=[0.03, 0.96,0.55, 0.98],CHARSIZE=0.75,/BOTTOM,TITLE=TITLE,/NO_UNIT,FONT='HELVETICA',SPECIAL_SCALE=SPECIAL_SCALES[NTH],PAL='PAL_SW3')
				DEVICE,/CLOSE
				SET_PLOT,OLDDEVICE
				IMAGE_TRIM, PSFILES[NTH], DIR_OUT=DIR_INTER, DPI=600, BACKGROUND=215,GRACE=GRACE, /OVERWRITE
				IMAGE = READ_PNG(TRIMFILES[NTH],R,G,B)
				TRUE = IMAGE_2TRUE(IMAGE,R,G,B)
				WRITE_PNG,TRUEFILES[NTH] ,TRUE,R,G,B
			ENDFOR
			GRACE = [50,50,50,50]
			BACKGROUND=215

			PNGFILE   = DIR_POSTER +   'TRIM/Figure_10-!D-CHL-SST-FRONTS-COMPOSITE.PNG'
			ROWS = 2
			COLS = 2
			IMAGE_WELD_PAGE,FILES=TRUEFILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=pngfile,SPACE=40,PX=px,py=py,BACKGROUND=255,/NOTRIM

		ENDIF

		IF DO_YEARLY GE 1 THEN BEGIN
;			YEARLY COMPOSITES
			BLANK = DIR_IDL + 'IMAGES\BLANK_1024.PNG'
			TRUE  = DIR_IDL+'IMAGES\BLANK_1024_BY_1024_TRUE.PNG'
			IMAGE = READ_PNG(BLANK)
			WRITE_PNG,TRUE, IMAGE_2TRUE(IMAGE,R,G,B)

			PNGFILES = [DIR_INTER + 'Figure_chl-!Y-SEAWIFS-REPRO5-NEC-CHLOR_A-OC4-MEAN-COMPOSITE_1_10.PNG',$
 									DIR_INTER + 'Figure_chl_grad-!Y-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_MAG_RATIO-MEAN-COMPOSITE_1_10.PNG',$
									DIR_INTER + 'Figure_sst-!Y-AT-NEC-SST-4UM-MEAN-COMPOSITE_1_7.PNG',$
									DIR_INTER + 'Figure_sst_grad-!Y-AT-NEC-SST-4UM-MEAN-COMPOSITE_1_7.PNG',$

									DIR_INTER + 'Figure_chl-!Y-SEAWIFS-REPRO5-EC-CHLOR_A-OC4-MEAN-COMPOSITE_1_10.PNG',$
 									DIR_INTER + 'Figure_chl_grad-!Y-SEAWIFS-REPRO5-EC-CHLOR_A-GRAD_MAG_RATIO-MEAN-COMPOSITE_1_10.PNG',$
									DIR_INTER + 'Figure_sst-!Y-AT-EC-SST-4UM-MEAN-COMPOSITE_1_7.PNG',$
									DIR_INTER + 'Figure_sst_grad-!Y-AT-EC-SST-4UM-MEAN-COMPOSITE_1_7.PNG']

			PNGFILE2 = [DIR_INTER + 'Figure_chl-!Y-SEAWIFS-REPRO5-NEC-CHLOR_A-OC4-MEAN-COMPOSITE_2_5.PNG',$
 									DIR_INTER + 'Figure_chl_grad-!Y-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_MAG_RATIO-MEAN-COMPOSITE_2_5.PNG',$
									DIR_INTER + 'Figure_sst-!Y-AT-NEC-SST-4UM-MEAN-COMPOSITE_2_4.PNG',$
									DIR_INTER + 'Figure_sst_grad-!Y-AT-NEC-SST-4UM-MEAN-COMPOSITE_2_4.PNG',$

									DIR_INTER + 'Figure_chl-!Y-SEAWIFS-REPRO5-EC-CHLOR_A-OC4-MEAN-COMPOSITE_2_5.PNG',$
 									DIR_INTER + 'Figure_chl_grad-!Y-SEAWIFS-REPRO5-EC-CHLOR_A-GRAD_MAG_RATIO-MEAN-COMPOSITE_2_5.PNG',$
									DIR_INTER + 'Figure_sst-!Y-AT-EC-SST-4UM-MEAN-COMPOSITE_2_4.PNG',$
									DIR_INTER + 'Figure_sst_grad-!Y-AT-EC-SST-4UM-MEAN-COMPOSITE_2_4.PNG']

			PRODS = ['CHLOR_A-OC4','GRAD_MAG_RATIO','SST-4UM','GRAD_MAG','CHLOR_A-OC4','GRAD_MAG_RATIO','SST-4UM','GRAD_MAG']
			DIRS  = [DIR_CHLOR,DIR_CFRONTS,DIR_SST,DIR_SFRONTS,DIRE_CHLOR,DIRE_CFRONTS,DIRE_SST,DIRE_SFRONTS]
			SPECIAL_SCALES = ['MEDIUM','!MONTH','','!MONTH','MEDIUM','!MONTH','','!MONTH']
			STAT  = ['MEAN','MEAN','MEAN','MEAN','MEAN','MEAN','MEAN','MEAN']
			MAPS  = ['NEC','NEC','NEC','NEC','EC','EC','EC','EC']
			MAKE_PNGS = [0,0,0,0,1,1,1,1]

			ROWS = [1,2]
			COLS = [10,5]
			BACKGROUND=255
			SPACE=20

			FOR PTH =0L, N_ELEMENTS(PRODS)-1 DO BEGIN
				IF MAKE_PNGS(PTH) EQ 0 THEN CONTINUE
				APROD = PRODS(PTH)
				FILES =FILE_SEARCH(DIRS(PTH)+'!Y_*-' +MAPS(PTH)+ '-*' +APROD+'-'+STAT(PTH)+'.SAVE')
				USE_PROD = APROD
				IF APROD EQ 'CHLOR_A-GRAD_MAG_RATIO' OR APROD EQ 'CHLOR_A-GRAD_MAG' THEN USE_PROD = 'RATIO'
				IF APROD EQ 'CHLOR_A-OC4' THEN USE_PROD = 'CHLOR_A'
				IF APROD EQ 'SST-4UM' THEN USE_PROD = 'SST'
				IF FILES[0] EQ '' THEN CONTINUE
				STRUCT_SD_2PNG,FILES,DIR_OUT=DIR_INTER,USE_PROD=USE_PROD,/ADD_LAND,/ADD_COAST,MISS_COLOR=0,/OVERWRITE,/ADD_BATHY,SPECIAL_SCALE=SPECIAL_SCALES(PTH)
				PNGS  = FILE_SEARCH(DIR_INTER+'!Y_*-' +MAPS(PTH)+ '-*' +APROD+'-'+STAT(PTH)+'.PNG')
				IF APROD EQ 'SST-4UM' OR APROD EQ 'GRAD_MAG' THEN PNGS = [BLANK,BLANK,BLANK,PNGS]
				IMAGE_WELD_PAGE,FILES=PNGS,ROWS=ROWS[0],COLS=COLS[0],PAL=PAL,PNGFILE=PNGFILES(PTH),SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM
				IMAGE_WELD_PAGE,FILES=PNGS,ROWS=ROWS[1],COLS=COLS[1],PAL=PAL,PNGFILE=PNGFILE2(PTH),SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM
			ENDFOR


			PSFILES  = [DIR_POSTER + 'Figure_chl-!Y-SEAWIFS-REPRO5-NEC-CHLOR_A-OC4-MEAN-COMPOSITE_1_10.PS',$
									DIR_POSTER + 'Figure_chl_grad-!Y-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_MAG_RATIO-MEAN-COMPOSITE_1_10.PS',$
									DIR_POSTER + 'Figure_sst-!Y-AT-NEC-SST-4UM-MEAN-COMPOSITE_1_7.PS',$
									DIR_POSTER + 'Figure_sst_grad-!Y-AT-NEC-SST-4UM-MEAN-COMPOSITE_1_7.PS',$

									DIR_POSTER + 'Figure_chl-!Y-SEAWIFS-REPRO5-EC-CHLOR_A-OC4-MEAN-COMPOSITE_1_10.PS',$
									DIR_POSTER + 'Figure_chl_grad-!Y-SEAWIFS-REPRO5-EC-CHLOR_A-GRAD_MAG_RATIO-MEAN-COMPOSITE_1_10.PS',$
									DIR_POSTER + 'Figure_sst-!Y-AT-EC-SST-4UM-MEAN-COMPOSITE_1_7.PS',$
									DIR_POSTER + 'Figure_sst_grad-!Y-AT-EC-SST-4UM-MEAN-COMPOSITE_1_7.PS']

			PSFILE2  = [DIR_POSTER + 'Figure_chl-!Y-SEAWIFS-REPRO5-NEC-CHLOR_A-OC4-MEAN-COMPOSITE_2_5.PS',$
									DIR_POSTER + 'Figure_chl_grad-!Y-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_MAG_RATIO-MEAN-COMPOSITE_2_5.PS',$
									DIR_POSTER + 'Figure_sst-!Y-AT-NEC-SST-4UM-MEAN-COMPOSITE_2_4.PS',$
									DIR_POSTER + 'Figure_sst_grad-!Y-AT-NEC-SST-4UM-MEAN-COMPOSITE_2_4.PS',$

									DIR_POSTER + 'Figure_chl-!Y-SEAWIFS-REPRO5-EC-CHLOR_A-OC4-MEAN-COMPOSITE_2_5.PS',$
									DIR_POSTER + 'Figure_chl_grad-!Y-SEAWIFS-REPRO5-EC-CHLOR_A-GRAD_MAG_RATIO-MEAN-COMPOSITE_2_5.PS',$
									DIR_POSTER + 'Figure_sst-!Y-AT-EC-SST-4UM-MEAN-COMPOSITE_2_4.PS',$
									DIR_POSTER + 'Figure_sst_grad-!Y-AT-EC-SST-4UM-MEAN-COMPOSITE_2_4.PS']

			OK = WHERE(FILE_TEST(PNGFILES) EQ 1)
			PNGFILES = PNGFILES[OK] & PSFILES = PSFILES[OK] & PRODS1 = PRODS[OK] & SPECIAL_SCALE1 = SPECIAL_SCALES[OK]

			OK = WHERE(FILE_TEST(PNGFILE2) EQ 1)
			PNGFILE2 = PNGFILE2[OK] & PSFILE2 = PSFILE2[OK] & PRODS2 = PRODS[OK] & SPECIAL_SCALE2 = SPECIAL_SCALES[OK]

			FOR NTH = 0L, N_ELEMENTS(PNGFILES)-1 DO BEGIN
				PNGFILE = PNGFILES[NTH]
				PSFILE  = PSFILES[NTH]
				SPECIAL_SCALE = SPECIAL_SCALE1[NTH]
				APROD = PRODS1[NTH]
				IF APROD EQ 'SST-4UM' OR APROD EQ 'GRAD_MAG' THEN SST_YEARS = 1 ELSE SST_YEARS = 0
				MAP = 'NEC'

		   	OLDDEVICE= !D.NAME
		   	_XOFFSET = 12.
		  	_YOFFSET = 27.5
		    _SCALE   = 0.295
				PS_IMAGE, FILES=PNGFILE,DIR_OUT=DIR_POSTER, /COLOR,FULL=full,/NO_CLOSE,SCALE=_SCALE,XOFFSET=_XOFFSET,YOFFSET=_YOFFSET,/LANDSCAPE,PAL=PAL
				!P.FONT = 0
				X = 0.019
				Y = 0.84
				IX = 0.101
				IY = -0.25
				CHARSIZE 	= 2.95
				COLOR     = 0
				CHARTHICK = 1
				ALIGN     = 0.5
				X = 0.019
				Y = 0.84
				IX = 0.1005
				IF SST_YEARS EQ 1 THEN BEGIN
					XYOUTS,X+3*IX,Y,'2001', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
					XYOUTS,X+4*IX,Y,'2002', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
					XYOUTS,X+5*IX,Y,'2003', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
					XYOUTS,X+6*IX,Y,'2004', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
					XYOUTS,X+7*IX,Y,'2005', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
					XYOUTS,X+8*IX,Y,'2006', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
					XYOUTS,X+9*IX,Y,'2007', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
				ENDIF ELSE BEGIN
					XYOUTS,X+0*IX,Y,'1998', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
					XYOUTS,X+1*IX,Y,'1999', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
					XYOUTS,X+2*IX,Y,'2000', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
					XYOUTS,X+3*IX,Y,'2001', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
					XYOUTS,X+4*IX,Y,'2002', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
					XYOUTS,X+5*IX,Y,'2003', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
					XYOUTS,X+6*IX,Y,'2004', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
					XYOUTS,X+7*IX,Y,'2005', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
					XYOUTS,X+8*IX,Y,'2006', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
					XYOUTS,X+9*IX,Y,'2007', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
				ENDELSE

				IF APROD EQ 'GRAD_MAG' THEN TITLE = '!Eo!NC  km!E-1!N'
				IF APROD EQ 'GRAD_DIR' THEN TITLE = 'Gradient Direction'
				IF APROD EQ 'GRAD_MAG_RATIO' THEN TITLE = 'Chlorophyll Gradient Magnitude (ratio)'
				IF APROD EQ 'CHLOR_A'  THEN TITLE = UNITS('CHLOROPHYLL')
				IF APROD EQ 'SST'      THEN TITLE = UNITS('SST')
				CHARSIZE = 0.75
		;		LEG=COLOR_BAR_SCALE(PROD=APROD,POSITION=POSITION,PAL='PAL_SW3',CHARSIZE=3,/BOTTOM,TITLE=TITLE,/NO_UNIT, SPECIAL_SCALE=SPECIAL_SCALE,FONT='HELVETICA')
				DEVICE,/CLOSE
				SET_PLOT,OLDDEVICE
				IMAGE_TRIM, PSFILE, DIR_OUT=DIR_POSTER, DPI=600, BACKGROUND=215,GRACE=[0,0,0,0],/OVERWRITE
		  ENDFOR

		  FOR NTH = 0L, N_ELEMENTS(PNGFILE2)-1 DO BEGIN
				PNGFILE = PNGFILE2[NTH]
				PSFILE  = PSFILE2[NTH]
				SPECIAL_SCALE = SPECIAL_SCALE2[NTH]
				APROD = PRODS2[NTH]
				IF APROD EQ 'SST-4UM' OR APROD EQ 'GRAD_MAG' THEN SST_YEARS = 1 ELSE SST_YEARS = 0

				_XOFFSET = 5
		  	_YOFFSET = 27.5
		    _SCALE   = 0.5
		    PS_IMAGE, FILES=PNGFILE,DIR_OUT=DIR_POSTER, /COLOR,FULL=full,/NO_CLOSE,SCALE=_SCALE,XOFFSET=_XOFFSET,YOFFSET=_YOFFSET,/LANDSCAPE,PAL=PAL

				CHARSIZE 	= 2.75
				COLOR     = 0
				CHARTHICK = 1
				ALIGN     = 0.5
				X = 0.0325
				Y = 0.915
				IX = 0.2015
				IY = -0.49
				IF SST_YEARS EQ 1 THEN BEGIN
					XYOUTS,X+3*IX,Y,'2001', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
					XYOUTS,X+4*IX,Y,'2002', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
					XYOUTS,X,     Y+IY,'2003', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
					XYOUTS,X+IX,  Y+IY,'2004', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
					XYOUTS,X+2*IX,Y+IY,'2005', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
					XYOUTS,X+3*IX,Y+IY,'2006', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
					XYOUTS,X+4*IX,Y+IY,'2007', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
				ENDIF ELSE BEGIN
					XYOUTS,X,     Y,'1998', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
					XYOUTS,X+IX,  Y,'1999', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
					XYOUTS,X+2*IX,Y,'2000', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
					XYOUTS,X+3*IX,Y,'2001', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
					XYOUTS,X+4*IX,Y,'2002', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
					XYOUTS,X,     Y+IY,'2003', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
					XYOUTS,X+IX,  Y+IY,'2004', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
					XYOUTS,X+2*IX,Y+IY,'2005', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
					XYOUTS,X+3*IX,Y+IY,'2006', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
					XYOUTS,X+4*IX,Y+IY,'2007', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
				ENDELSE

				IF APROD EQ 'GRAD_MAG' THEN TITLE = '!Eo!NC  km!E-1!N'
				IF APROD EQ 'GRAD_DIR' THEN TITLE = 'Gradient Direction'
				IF APROD EQ 'GRAD_MAG_RATIO' THEN TITLE = 'Chlorophyll Gradient Magnitude (ratio)'
				IF APROD EQ 'CHLOR_A'  THEN TITLE = UNITS('CHLOROPHYLL')
				IF APROD EQ 'SST'      THEN TITLE = UNITS('SST')

				CHARSIZE = 0.75
		;		LEG=COLOR_BAR_SCALE(PROD=APROD,POSITION=POSITION,PAL='PAL_SW3',CHARSIZE=3,/BOTTOM,TITLE=TITLE,/NO_UNIT, SPECIAL_SCALE=SPECIAL_SCALE,FONT='HELVETICA')
				DEVICE,/CLOSE
				SET_PLOT,OLDDEVICE
				IMAGE_TRIM, PSFILE, DIR_OUT=DIR_POSTER, DPI=600, BACKGROUND=215,GRACE=[0,0,0,0],/OVERWRITE
			ENDFOR
		ENDIF

;		MONTHLY COMPOSITES
		IF DO_MONTHLY GE 1 THEN BEGIN

			PRODS = ['GRAD_MAG','GRAD_MAG_RATIO','CHLOR_A-OC4','SST-4UM',$
							 'GRAD_MAG','GRAD_MAG_RATIO','CHLOR_A-OC4','SST-4UM']
			MAPS  = ['NEC','NEC','NEC','NEC','EC','EC','EC','EC']
			DIRS  = [DIR_SFRONTS,  DIR_CFRONTS,  DIR_CHLOR,  DIR_SST, $
			         DIRE_SFRONTS, DIRE_CFRONTS, DIRE_CHLOR, DIRE_SST]
			STAT  = ['MEAN','MEAN','MEAN','MEAN','MEAN','MEAN','MEAN','MEAN']
			SPECIAL_SCALES = ['!MONTH','!MONTH','MEDIUM' ,'''!MONTH','!MONTH','MEDIUM' ,'']
			MAKE_PNGS = [0,0,0,0,0,0,0,0]
			MAKE_PNGS = [0,0,1,1,0,0,0,0]
			PNGFILES = [DIR_IMAGES + 'Figure_sst_grad-!MONTH-AT-NEC-SST-4UM-GRAD_MAG_RATIO-MEAN-COMPOSITE_1_12.PNG',$
									DIR_IMAGES + 'Figure_chl_grad-!MONTH-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_MAG-MEAN-COMPOSITE_1_12.PNG',$
									DIR_IMAGES + 'Figure_chl-!MONTH-SEAWIFS-REPRO5-NEC-CHLOR_A-OC4-MEAN-COMPOSITE_1_12.PNG',$
									DIR_IMAGES + 'Figure_sst-!MONTH-AT-NEC-SST-4UM-MEAN-COMPOSITE_1_12.PNG',$

									DIR_IMAGES + 'Figure_sst_grad-!MONTH-AT-EC-SST-4UM-GRAD_MAG_RATIO-MEAN-COMPOSITE_1_12.PNG',$
									DIR_IMAGES + 'Figure_chl_grad-!MONTH-SEAWIFS-REPRO5-EC-CHLOR_A-GRAD_MAG-MEAN-COMPOSITE_1_12.PNG',$
									DIR_IMAGES + 'Figure_chl-!MONTH-SEAWIFS-REPRO5-EC-CHLOR_A-OC4-MEAN-COMPOSITE_1_12.PNG',$
									DIR_IMAGES + 'Figure_sst-!MONTH-AT-EC-SST-4UM-MEAN-COMPOSITE_1_12.PNG']

			PNGFILE2 = [DIR_IMAGES + 'Figure_sst_grad-!MONTH-AT-NEC-SST-4UM-GRAD_MAG_RATIO-MEAN-COMPOSITE_4_3.PNG',$
         					DIR_IMAGES + 'Figure_chl_grad-!MONTH-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_MAG-MEAN-COMPOSITE_4_3.PNG',$
									DIR_IMAGES + 'Figure_chl-!MONTH-SEAWIFS-REPRO5-NEC-CHLOR_A-OC4-MEAN-COMPOSITE_4_3.PNG',$
									DIR_IMAGES + 'Figure_sst-!MONTH-AT-NEC-SST-4UM-MEAN-COMPOSITE_4_3.PNG',$

									DIR_IMAGES + 'Figure_sst_grad-!MONTH-AT-EC-SST-4UM-GRAD_MAG_RATIO-MEAN-COMPOSITE_4_3.PNG',$
									DIR_IMAGES + 'Figure_chl_grad-!MONTH-SEAWIFS-REPRO5-EC-CHLOR_A-GRAD_MAG-MEAN-COMPOSITE_4_3.PNG',$
									DIR_IMAGES + 'Figure_chl-!MONTH-SEAWIFS-REPRO5-EC-CHLOR_A-OC4-MEAN-COMPOSITE_4_3.PNG',$
									DIR_IMAGES + 'Figure_sst-!MONTH-AT-EC-SST-4UM-MEAN-COMPOSITE_4_3.PNG']

			ROWS = 1
			COLS = 12
			ROW2 = 3
			COL2 = 4
			BACKGROUND=255
			SPACE=20

			FOR PTH =0L, N_ELEMENTS(PRODS)-1 DO BEGIN
				IF MAKE_PNGS(PTH) EQ 0 THEN CONTINUE
				APROD = PRODS(PTH)
				FILES =FILE_SEARCH(DIRS(PTH)+'!MONTH_*-'+MAPS(PTH) + '-*' + APROD+'-'+STAT(PTH)+'.SAVE')
				USE_PROD = APROD
				IF APROD EQ 'CHLOR_A-GRAD_MAG_RATIO' OR APROD EQ 'CHLOR_A-GRAD_MAG' OR APROD EQ 'CHLOR_A-GRAD_MAG_RATIO-SST-GRAD_MAG' THEN USE_PROD = 'RATIO'
				IF APROD EQ 'CHLOR_A-OC4' THEN USE_PROD = 'CHLOR_A'
				IF APROD EQ 'SST-4UM' THEN USE_PROD = 'SST'
				IF FILES[0] EQ '' THEN CONTINUE
;				STRUCT_SD_2PNG,FILES,DIR_OUT=DIR_IMAGES,USE_PROD=USE_PROD,/ADD_LAND,/ADD_COAST,MISS_COLOR=0,/OVERWRITE,/ADD_BATHY,SPECIAL_SCALE=SPECIAL_SCALES(PTH)
				PNGS  = FILE_SEARCH(DIR_IMAGES+'!MONTH_*-'+MAPS(PTH) + '-*'+APROD+'-'+STAT(PTH)+'.PNG')
				FOR _P = 0L, N_ELEMENTS(PNGS)-1 DO BEGIN
					FP = PARSE_IT(PNGS(_P))
					IMAGE = READ_PNG(PNGS(_P),R,G,B)
					IMAGE = MAP_ADD_TXT(IMAGE,0.05,0.85, MONTH_NAMES(FP.MONTH_START,/SHORT),FONT='HELVETICA',COLOR=0,charsize=10,CHARTHICK=3)
					PNGFILE = REPLACE(PNGS(_P),'.PNG','-LABEL.PNG')
					WRITE_PNG, PNGFILE, IMAGE,R,G,B
				ENDFOR
				PNGS  = FILE_SEARCH(DIR_IMAGES+'!MONTH_*-'+MAPS(PTH) + '-*'+APROD+'-'+STAT(PTH)+'-LABEL.PNG')
				IMAGE_WELD_PAGE,FILES=PNGS,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=PNGFILES(PTH),SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM
				IMAGE_WELD_PAGE,FILES=PNGS,ROWS=ROW2,COLS=COL2,PAL=PAL,PNGFILE=PNGFILE2(PTH),SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM
			ENDFOR
STOP
STOP
STOP
			PSFILES  = [DIR_PLOTS + 'Figure_sst_grad-!MONTH-AT-NEC-SST-4UM-GRAD_MAG_RATIO-MEAN-COMPOSITE_1_12.PS',$
									DIR_PLOTS + 'Figure_chl_grad-!MONTH-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_MAG-MEAN-COMPOSITE_1_12.PS',$
									DIR_PLOTS + 'Figure_chl-!MONTH-SEAWIFS-REPRO5-NEC-CHLOR_A-OC4-MEAN-COMPOSITE_1_12.PS',$
									DIR_PLOTS + 'Figure_sst-!MONTH-AT-NEC-SST-4UM-MEAN-COMPOSITE_1_12.PS',$

									DIR_PLOTS + 'Figure_sst_grad-!MONTH-AT-EC-SST-4UM-GRAD_MAG_RATIO-MEAN-COMPOSITE_1_12.PS',$
									DIR_PLOTS + 'Figure_chl_grad-!MONTH-SEAWIFS-REPRO5-EC-CHLOR_A-GRAD_MAG-MEAN-COMPOSITE_1_12.PS',$
									DIR_PLOTS + 'Figure_chl-!MONTH-SEAWIFS-REPRO5-EC-CHLOR_A-OC4-MEAN-COMPOSITE_1_12.PS',$
									DIR_PLOTS + 'Figure_sst-!MONTH-AT-EC-SST-4UM-MEAN-COMPOSITE_1_12.PS']

			PSFILE2  = [DIR_PLOTS + 'Figure_sst_grad-!MONTH-AT-NEC-SST-4UM-GRAD_MAG_RATIO-MEAN-COMPOSITE_4_3.PS',$
									DIR_PLOTS + 'Figure_chl_grad-!MONTH-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_MAG-MEAN-COMPOSITE_4_3.PS',$
									DIR_PLOTS + 'Figure_chl-!MONTH-SEAWIFS-REPRO5-NEC-CHLOR_A-OC4-MEAN-COMPOSITE_4_3.PS',$
									DIR_PLOTS + 'Figure_sst-!MONTH-AT-NEC-SST-4UM-MEAN-COMPOSITE_4_3.PS',$

									DIR_PLOTS + 'Figure_sst_grad-!MONTH-AT-EC-SST-4UM-GRAD_MAG_RATIO-MEAN-COMPOSITE_4_3.PS',$
									DIR_PLOTS + 'Figure_chl_grad-!MONTH-SEAWIFS-REPRO5-EC-CHLOR_A-GRAD_MAG-MEAN-COMPOSITE_4_3.PS',$
									DIR_PLOTS + 'Figure_chl-!MONTH-SEAWIFS-REPRO5-EC-CHLOR_A-OC4-MEAN-COMPOSITE_4_3.PS',$
									DIR_PLOTS + 'Figure_sst-!MONTH-AT-EC-SST-4UM-MEAN-COMPOSITE_4_3.PS']

			OK = WHERE(FILE_TEST(PNGFILES) EQ 1, COUNT)
			IF COUNT GE 1 THEN BEGIN & PNGFILES = PNGFILES[OK] & PSFILES = PSFILES[OK] & PRODS1 = PRODS[OK] & SPECIAL_SCALES1=SPECIAL_SCALES[OK] & ENDIF ELSE GOTO, SKIP_PNGFILE1

			FOR NTH = 0L, N_ELEMENTS(PNGFILES)-1 DO BEGIN
				PNGFILE = PNGFILES[NTH]
				PSFILE  = PSFILES[NTH]
				SPECIAL_SCALE = SPECIAL_SCALES1[NTH]
				APROD = PRODS1[NTH]
				MAP = 'NEC'
		   	OLDDEVICE= !D.NAME
				_XOFFSET = 10.
		  	_YOFFSET = 28.
		    _SCALE   = 0.25

				PS_IMAGE, FILES=PNGFILE,DIR_OUT=DIR_PLOTS, /COLOR,FULL=full,/NO_CLOSE,SCALE=_SCALE,XOFFSET=_XOFFSET,YOFFSET=_YOFFSET,/LANDSCAPE,PAL=PAL
				!P.FONT = 0
				ALIGN     = 0.5
			 	X = 0.010
			 	Y = 0.85
			 	IX = 0.0838
				POSITION = [0.925, 0.05,0.93, 0.95]
				CHARSIZE  = 2.75
				COLOR     = 0
				CHARTHICK = 1
				ALIGN     = 0.5
				XYOUTS,X+0*IX,Y, 'Jan', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
				XYOUTS,X+1*IX,Y, 'Feb', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
				XYOUTS,X+2*IX,Y, 'Mar', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
				XYOUTS,X+3*IX,Y, 'Apr', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
				XYOUTS,X+4*IX,Y, 'May', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
				XYOUTS,X+5*IX,Y, 'Jun', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
				XYOUTS,X+6*IX,Y, 'Jul', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
				XYOUTS,X+7*IX,Y, 'Aug', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
				XYOUTS,X+8*IX,Y, 'Sep', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
				XYOUTS,X+9*IX,Y, 'Oct', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
				XYOUTS,X+10*IX,Y,'Nov', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
				XYOUTS,X+11*IX,Y,'Dec', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL

				IF APROD EQ 'GRAD_MAG' THEN TITLE = '!Eo!NC  km!E-1!N'
				IF APROD EQ 'GRAD_DIR' THEN TITLE = 'Gradient Direction'
				IF APROD EQ 'GRAD_MAG_RATIO' THEN TITLE = 'Chlorophyll Gradient Magnitude (ratio)'
				IF APROD EQ 'CHLOR_A'  THEN TITLE = UNITS('CHLOROPHYLL')
				IF APROD EQ 'SST'      THEN TITLE = UNITS('SST')
				IF APROD EQ 'CHLOR_A-GRAD_MAG_RATIO' OR APROD EQ 'CHLOR_A-GRAD_MAG' OR APROD EQ 'CHLOR_A-GRAD_MAG_RATIO-SST-GRAD_MAG' THEN TITLE = 'RATIO'

				CHARSIZE = 0.75
		;		LEG=COLOR_BAR_SCALE(PROD=APROD,POSITION=POSITION,PAL='PAL_SW3',CHARSIZE=3,/BOTTOM,TITLE=TITLE,/NO_UNIT, SPECIAL_SCALE=SPECIAL_SCALE,FONT='HELVETICA')
				DEVICE,/CLOSE
				SET_PLOT,OLDDEVICE
;				IMAGE_TRIM, PSFILE, DIR_OUT=DIR_PLOTS, DPI=600, BACKGROUND=215,GRACE=[0,0,0,0],/OVERWRITE
		  ENDFOR
		  SKIP_PNGFILE1:
		  OK = WHERE(FILE_TEST(PNGFILE2) EQ 1, COUNT)
			IF COUNT GE 1 THEN BEGIN & PNGFILE2 = PNGFILE2[OK] & PSFILE2 = PSFILE2[OK] & PRODS2 = PRODS[OK] & SPECIAL_SCALES2=SPECIAL_SCALES[OK] & ENDIF ELSE GOTO, SKIP_PNGFILE2
		  FOR NTH = 0L, N_ELEMENTS(PNGFILE2)-1 DO BEGIN
				PNGFILE = PNGFILE2[NTH]
				PSFILE  = PSFILE2[NTH]
				SPECIAL_SCALE = SPECIAL_SCALES2[NTH]
				APROD = PRODS2[NTH]

		   	OLDDEVICE= !D.NAME
				_XOFFSET = 2
	  	  _YOFFSET = 26.5
	      _SCALE = 0.67
				PS_IMAGE, FILES=PNGFILE,DIR_OUT=DIR_PLOTS, /COLOR,FULL=full,/NO_CLOSE,SCALE=_SCALE,XOFFSET=_XOFFSET,YOFFSET=_YOFFSET,/LANDSCAPE,PAL=PAL
				!P.FONT = 0
				ALIGN     = 0.5

				X = 0.035
				Y = 0.96
				IX = 0.25
				IY = -0.335

				CHARSIZE  = 2.75
				COLOR     = 0
				CHARTHICK = 1
				ALIGN     = 0.5
				XYOUTS,X,Y,'Jan', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
				XYOUTS,X+IX,Y,'Feb', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
				XYOUTS,X+2*IX,Y,'Mar', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
				XYOUTS,X+3*IX,Y,'Apr', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
				XYOUTS,X,Y+IY,'May', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
				XYOUTS,X+IX,Y+IY,'Jun', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
				XYOUTS,X+2*IX,Y+IY,'Jul', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
				XYOUTS,X+3*IX,Y+IY,'Aug', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
				XYOUTS,X,Y+2*IY,'Sep', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
				XYOUTS,X+IX,Y+2*IY,'Oct', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
				XYOUTS,X+2*IX,Y+2*IY,'Nov', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
				XYOUTS,X+3*IX,Y+2*IY,'Dec', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL

				IF APROD EQ 'GRAD_MAG' THEN TITLE = '!Eo!NC  km!E-1!N'
				IF APROD EQ 'GRAD_DIR' THEN TITLE = 'Gradient Direction'
				IF APROD EQ 'GRAD_MAG_RATIO' THEN TITLE = 'Chlorophyll Gradient Magnitude (ratio)'
				IF APROD EQ 'CHLOR_A'  THEN TITLE = UNITS('CHLOROPHYLL')
				IF APROD EQ 'SST'      THEN TITLE = UNITS('SST')
				IF APROD EQ 'CHLOR_A-GRAD_MAG_RATIO' OR APROD EQ 'CHLOR_A-GRAD_MAG' OR APROD EQ 'CHLOR_A-GRAD_MAG_RATIO-SST-GRAD_MAG' THEN TITLE = 'RATIO'
				IF APROD EQ 'CHLOR_A-GRAD_MAG_RATIO' OR APROD EQ 'CHLOR_A-GRAD_MAG' OR APROD EQ 'CHLOR_A-GRAD_MAG_RATIO-SST-GRAD_MAG' THEN APROD = 'RATIO'

				CHARSIZE = 0.5
				POSITION = [0.05, 0.01,0.95, 0.02]
;				LEG=COLOR_BAR_SCALE(PROD=APROD,POSITION=POSITION,PAL='PAL_SW3',CHARSIZE=3,/BOTTOM,TITLE=TITLE,/NO_UNIT, SPECIAL_SCALE=SPECIAL_SCALE,FONT='HELVETICA')
				DEVICE,/CLOSE
				SET_PLOT,OLDDEVICE
	;			IMAGE_TRIM, PSFILE, DIR_OUT=DIR_PLOTS, DPI=600, BACKGROUND=215,GRACE=[50,50,50,50],/OVERWRITE
		  ENDFOR
		  SKIP_PNGFILE2:
    ENDIF


		STOP

;;;;;
;		Figure 17 - NEC SST GRAD_MAG Monthly composite figure
		FILES = FILE_SEARCH(DIR_SAVE + '!MONTH_*-AT-NEC-SST-4UM-GRAD_MAG-MEAN.SAVE')
		SPECIAL_SCALE='LOW_1'
	;	STRUCT_SD_2PNG,FILES,DIR_OUT=DIR_OUT,/ADD_LAND,/ADD_COAST,MISS_COLOR=0,/OVERWRITE,SPECIAL_SCALE=SPECIAL_SCALE
		FILES = FILE_SEARCH(DIR_OUT+'!MONTH_*-AT-NEC-SST-4UM-GRAD_MAG-MEAN.PNG')
		ROWS = 4
		COLS = 4
		PNGFILE = DIR_OUT + 'Figure_17-!MONTH-AT-NEC-SST-4UM-GRAD_MAG-MEAN-COMPOSITE.PNG'
	;	IMAGE_WELD_PAGE,FILES=FILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=pngfile,SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM
		ROWS = 1
		COLS = 12
		PNGFILE = DIR_OUT + 'Figure_17-!MONTH-AT-NEC-SST-4UM-GRAD_MAG-MEAN-COMPOSITE-1_12.PNG'
	;	IMAGE_WELD_PAGE,FILES=FILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=pngfile,SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM
;;;;;
;;;;;
;;;;;;		Figure 19 - NEC CHL GRAD_MAG_RATIO Monthly composite figure
;;;;;		FILES = FILE_SEARCH(DIR_SAVE + '!MONTH_*-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_MAG_RATIO-MEAN.SAVE')
;;;;;		SPECIAL_SCALE='LOW_1'
;;;;;	;	STRUCT_SD_2PNG,FILES,DIR_OUT=DIR_OUT,/ADD_LAND,/ADD_COAST,MISS_COLOR=0,/OVERWRITE,SPECIAL_SCALE=SPECIAL_SCALE
;;;;;		FILES = FILE_SEARCH(DIR_OUT+'!MONTH_*-SEAWIFS-REPRO5-NEC-*CHLOR_A-GRAD_MAG_RATIO-MEAN.PNG')
;;;;;		ROWS = 4
;;;;;		COLS = 4
;;;;;		PNGFILE = DIR_OUT + 'Figure_19-!MONTH-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_MAG_RATIO-MEAN-COMPOSITE.PNG'
;;;;;;		IMAGE_WELD_PAGE,FILES=FILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=pngfile,SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM
;;;;;		ROWS = 1
;;;;;		COLS = 12
;;;;;		PNGFILE = DIR_OUT + 'Figure_19-!MONTH-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_MAG_RATIO-MEAN-COMPOSITE-1_12.PNG'
;;;;;;		IMAGE_WELD_PAGE,FILES=FILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=pngfile,SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM
;;;;;
;;;;;
;;;;;;		Figure 20 - NEC CHL GRAD_DIR Monthly composite figure
;;;;;		FILES = FILE_SEARCH(DIR_SAVE + '!MONTH_*-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_DIR-MEAN.SAVE')
;;;;;		SPECIAL_SCALE=''
;;;;;;		STRUCT_SD_2PNG,FILES,DIR_OUT=DIR_OUT,/ADD_LAND,/ADD_COAST,MISS_COLOR=0,/OVERWRITE,SPECIAL_SCALE=SPECIAL_SCALE
;;;;;		FILES = FILE_SEARCH(DIR_OUT+'!MONTH_*-SEAWIFS-REPRO5-NEC-*CHLOR_A-GRAD_DIR-MEAN.PNG')
;;;;;		ROWS = 4
;;;;;		COLS = 4
;;;;;		PNGFILE = DIR_OUT + 'Figure_20-!MONTH-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_DIR-MEAN-COMPOSITE.PNG'
;;;;;;		IMAGE_WELD_PAGE,FILES=FILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=pngfile,SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM
;;;;;		ROWS = 1
;;;;;		COLS = 12
;;;;;		PNGFILE = DIR_OUT + 'Figure_20-!MONTH-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_DIR-MEAN-COMPOSITE-1_12.PNG'
;;;;;;		IMAGE_WELD_PAGE,FILES=FILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=pngfile,SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM
;;;;;
;;;;;
;;;;;;		Figure chl - NEC CHL Monthly composite figure
;;;;;		FILES = FILE_SEARCH(DIR_SAVE + '!MONTH_*-SEAWIFS-REPRO5-NEC-CHLOR_A-OC4-MEAN.SAVE')
;;;;;		SPECIAL_SCALE=''
;;;;;;		STRUCT_SD_2PNG,FILES,DIR_OUT=DIR_OUT,/ADD_LAND,/ADD_COAST,MISS_COLOR=0,/OVERWRITE,SPECIAL_SCALE=SPECIAL_SCALE
;;;;;		FILES = FILE_SEARCH(DIR_OUT+'!MONTH_*-SEAWIFS-REPRO5-NEC-CHLOR_A-OC4-MEAN.PNG')
;;;;;		ROWS = 4
;;;;;		COLS = 4
;;;;;		PNGFILE = DIR_OUT + 'Figure_chl-!MONTH-SEAWIFS-REPRO5-NEC-CHLOR_A-OC4-MEAN-COMPOSITE.PNG'
;;;;;;		IMAGE_WELD_PAGE,FILES=FILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=pngfile,SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM
;;;;;		ROWS = 1
;;;;;		COLS = 12
;;;;;		PNGFILE = DIR_OUT + 'Figure_chl-!MONTH-SEAWIFS-REPRO5-NEC-CHLOR_A-OC4-MEAN-COMPOSITE-1_12.PNG'
;;;;;;		IMAGE_WELD_PAGE,FILES=FILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=pngfile,SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM
;;;;;
;;;;;;		Figure sst - NEC SST Monthly composite figure
;;;;;		FILES = FILE_SEARCH(DIR_SAVE + '!MONTH_*-AT-NEC-SST-4UM-MEAN.SAVE')
;;;;;		SPECIAL_SCALE=''
;;;;;;		STRUCT_SD_2PNG,FILES,DIR_OUT=DIR_OUT,/ADD_LAND,/ADD_COAST,MISS_COLOR=0,/OVERWRITE,SPECIAL_SCALE=SPECIAL_SCALE
;;;;;		FILES = FILE_SEARCH(DIR_OUT+'!MONTH_*-AT-NEC-SST-4UM-MEAN.PNG')
;;;;;		ROWS = 4
;;;;;		COLS = 4
;;;;;		PNGFILE = DIR_OUT + 'Figure_sst-!MONTH-AT-NEC-SST-4UM-MEAN-COMPOSITE.PNG'
;;;;;;		IMAGE_WELD_PAGE,FILES=FILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=pngfile,SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM
;;;;;		ROWS = 1
;;;;;		COLS = 12
;;;;;		PNGFILE = DIR_OUT + 'Figure_sst-!MONTH-AT-NEC-SST-4UM-MEAN-COMPOSITE-1_12.PNG'
;;;;;;		IMAGE_WELD_PAGE,FILES=FILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=pngfile,SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM
;;;;;

;		MONTHLY COMPOSITES
		PNGFILES = [DIR_OUT + 'Figure_13-!MONTH-AT-EQ_NWA-SST-GRAD_MAG-MEAN-COMPOSITE.PNG',$
								DIR_OUT + 'Figure_13-!MONTH-N4AT-EQ_NWA-SST-GRAD_MAG-MEAN-COMPOSITE.PNG',$
								DIR_OUT + 'Figure_14-!MONTH-AT-EQ_NWA-SST-GRAD_DIR-MEAN-COMPOSITE.PNG',$
								DIR_OUT + 'Figure_14-!MONTH-N4AT-EQ_NWA-SST-GRAD_DIR-MEAN-COMPOSITE.PNG',$
								DIR_OUT + 'Figure_17-!MONTH-AT-NEC-SST-4UM-GRAD_MAG-MEAN-COMPOSITE.PNG',$
								DIR_OUT + 'Figure_19-!MONTH-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_MAG_RATIO-MEAN-COMPOSITE.PNG',$
								DIR_OUT + 'Figure_20-!MONTH-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_DIR-MEAN-COMPOSITE.PNG',$
								DIR_OUT + 'Figure_chl-!MONTH-SEAWIFS-REPRO5-NEC-CHLOR_A-OC4-MEAN-COMPOSITE.PNG',$
								DIR_OUT + 'Figure_sst-!MONTH-AT-NEC-SST-4UM-MEAN-COMPOSITE.PNG']
		PSFILES  = [DIR_MANU + 'Figure_13-!MONTH-AT-EQ_NWA-SST-GRAD_MAG-MEAN-COMPOSITE.PS',$
								DIR_MANU + 'Figure_13-!MONTH-N4AT-EQ_NWA-SST-GRAD_MAG-MEAN-COMPOSITE.PS',$
								DIR_MANU + 'Figure_14-!MONTH-AT-EQ_NWA-SST-GRAD_DIR-MEAN-COMPOSITE.PS',$
								DIR_MANU + 'Figure_14-!MONTH-N4AT-EQ_NWA-SST-GRAD_DIR-MEAN-COMPOSITE.PS',$
								DIR_MANU + 'Figure_17-!MONTH-AT-NEC-SST-4UM-GRAD_MAG-MEAN-COMPOSITE.PS',$
								DIR_MANU + 'Figure_19-!MONTH-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_MAG_RATIO-MEAN-COMPOSITE.PS',$
								DIR_MANU + 'Figure_20-!MONTH-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_DIR-MEAN-COMPOSITE.PS',$
								DIR_MANU + 'Figure_chl-!MONTH-SEAWIFS-REPRO5-NEC-CHLOR_A-OC4-MEAN-COMPOSITE.PS',$
								DIR_MANU + 'Figure_sst-!MONTH-AT-NEC-SST-4UM-MEAN-COMPOSITE.PS']
		SPECIAL_SCALES = ['LOW',     'LOW',     '',        '',        'LOW_1',     'LOW_1',         '',        '',       '']
		PRODS          = ['GRAD_MAG','GRAD_MAG','GRAD_DIR','GRAD_DIR','GRAD_MAG','GRAD_MAG_RATIO','GRAD_DIR','CHLOR_A','SST']
		MAPS           = ['EQ_NWA',  'EQ_NWA',  'EQ_NWA',  'EQ_NWA',  'NEC',     'NEC',           'NEC',     'NEC',    'NEC']
		FOR NTH = 0L, N_ELEMENTS(PNGFILES)-1 DO BEGIN
			PNGFILE = PNGFILES[NTH]
			PSFILE  = PSFILES[NTH]
			SPECIAL_SCALE = SPECIAL_SCALES[NTH]
			APROD = PRODS[NTH]
			MAP = MAPS[NTH]
			IF APROD EQ 'GRAD_MAG' THEN TITLE = '!Eo!NC  km!E-1!N'
			IF APROD EQ 'GRAD_DIR' THEN TITLE = 'Gradient Direction'
			IF APROD EQ 'GRAD_MAG_RATIO' THEN TITLE = 'Chlorophyll Gradient Magnitude (ratio)'
			IF APROD EQ 'CHLOR_A'  THEN TITLE = UNITS('CHLOROPHYLL')
			IF APROD EQ 'SST'      THEN TITLE = UNITS('SST')

			IMAGE = READ_PNG(PNGFILE,R,G,B)
			SZ=SIZE(IMAGE,/STRUCT)
			TRUE_COLOR  = SZ.N_DIMENSIONS EQ 3
	  	PX_IMAGE = 1.0*SZ.DIMENSIONS(0+TRUE_COLOR)
	  	PY_IMAGE = 1.0*SZ.DIMENSIONS(1+TRUE_COLOR)
	;  	===> Postscript (idl) has 1000/cm resolution
	;  	A 2400 pixel wide PCX or PNG file printed at 300dpi  will be 8 inches wide or 2.54cm*8
	   	XSIZE = DOUBLE(2.54*(PX_IMAGE/300.))
	   	YSIZE = DOUBLE(2.54*(PY_IMAGE/300.))
	;		===> Dimensions of postscript page
	 		HEIGHT = 20.5  &   WIDTH = 26.9  ; MAX SIZE
			IF MAP EQ 'NEC' THEN XOFFSET = -3   & IF MAP EQ 'EQ_NWA' THEN XOFFSET = -2.5
	  	IF MAP EQ 'NEC' THEN YOFFSET = 26.5 & IF MAP EQ 'EQ_NWA' THEN YOFFSET = 28.5
	    IF MAP EQ 'NEC' THEN SCALE = 0.67   & IF MAP EQ 'EQ_NWA' THEN SCALE = 0.75

	;		===> Set up the postscript device
	    OLDDEVICE= !D.NAME  ; Get present graphics device
	    olddevice= !d.name  ; Get present graphics device
	  	!P.FONT = 0
	    SET_PLOT,'ps'
	    DEVICE,FILENAME=psfile
			DEVICE,/COLOR
	 		CALL_PROCEDURE,PAL,R,G,B
	 		TVLCT,R,G,B
	 		COLOR=1
			DEVICE,BITS_PER_PIXEL=8
			DEVICE,/HELVETICA
			DEVICE,/LANDSCAPE
	    DEVICE, XOFFSET=xoffset, YOFFSET=yoffset, XSIZE=xsize, YSIZE=ysize, SCALE_FACTOR=scale
	    TV,IMAGE, TRUE=TRUE_COLOR

			X = 0.035
			Y = 0.96
			IF MAP EQ 'NEC' THEN IX = 0.25  & IF MAP EQ 'EQ_NWA' THEN IX = 0.25
			IF MAP EQ 'NEC' THEN IY = -0.25 & IF MAP EQ 'EQ_NWA' THEN IY = -0.225
			IF MAP EQ 'NEC' THEN POSITION = [0.05, 0.23,0.95, 0.245]
			IF MAP EQ 'EQ_NWA' THEN POSITION = [0.05, 0.29,0.95, 0.31]
			CHARSIZE  = 2.75
			COLOR     = 0
			CHARTHICK = 1
			ALIGN     = 0.5
			XYOUTS,X,Y,'Jan', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
			XYOUTS,X+IX,Y,'Feb', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
			XYOUTS,X+2*IX,Y,'Mar', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
			XYOUTS,X+3*IX,Y,'Apr', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
			XYOUTS,X,Y+IY,'May', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
			XYOUTS,X+IX,Y+IY,'Jun', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
			XYOUTS,X+2*IX,Y+IY,'Jul', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
			XYOUTS,X+3*IX,Y+IY,'Aug', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
			XYOUTS,X,Y+2*IY,'Sep', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
			XYOUTS,X+IX,Y+2*IY,'Oct', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
			XYOUTS,X+2*IX,Y+2*IY,'Nov', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
			XYOUTS,X+3*IX,Y+2*IY,'Dec', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL

			IF APROD EQ 'GRAD_DIR' THEN BEGIN
				CHARSIZE = 2.5
				LABELS_COMPASS=['N','E','S','W']
				IF MAP EQ 'NEC' 	 THEN BEGIN
					POLY_X = [0.89,0.89,1.05,1.05,0.89] & POLY_Y = [0.25,0.345,0.345,0.25,0.25]
					CIR_POS = [0.92,0.265,0.98,0.325]
					XYOUTS,0.75,0.22,TITLE,CHARSIZE=CHARSIZE,/NORMAL,FONT='HELVETICA'
				ENDIF
				IF MAP EQ 'EQ_NWA' THEN BEGIN
					POLY_X = [0.91,0.91,1.0,1.0,0.91] & POLY_Y = [0.325,0.435,0.435,0.325,0.325]
					CIR_POS = [0.93,0.345,1.0,0.415]
					XYOUTS,0.77,0.285,TITLE,CHARSIZE=CHARSIZE,/NORMAL,FONT='HELVETICA'
				ENDIF
				POLYFILL,POLY_X ,POLY_Y,COLOR=255,/NORMAL
				COLOR_CIRCLE ,LABELS_COMPASS,CHARSIZE=30,POSITION=CIR_POS,FONT='HELVETICA'
			ENDIF ELSE $
			LEG=COLOR_BAR_SCALE(PROD=APROD,POSITION=POSITION,PAL='PAL_SW3',CHARSIZE=3,/BOTTOM,TITLE=TITLE,/NO_UNIT, SPECIAL_SCALE=SPECIAL_SCALE,FONT='HELVETICA')
	    DEVICE,/CLOSE
	    SET_PLOT,olddevice
    ENDFOR

		PNGFILES = [DIR_OUT + 'Figure_13-!MONTH-AT-EQ_NWA-SST-GRAD_MAG-MEAN-COMPOSITE-1_12.PNG',$
								DIR_OUT + 'Figure_13-!MONTH-N4AT-EQ_NWA-SST-GRAD_MAG-MEAN-COMPOSITE-1_12.PNG',$
								DIR_OUT + 'Figure_14-!MONTH-AT-EQ_NWA-SST-GRAD_DIR-MEAN-COMPOSITE-1_12.PNG',$
								DIR_OUT + 'Figure_14-!MONTH-N4AT-EQ_NWA-SST-GRAD_DIR-MEAN-COMPOSITE-1_12.PNG',$
								DIR_OUT + 'Figure_17-!MONTH-AT-NEC-SST-4UM-GRAD_MAG-MEAN-COMPOSITE-1_12.PNG',$
								DIR_OUT + 'Figure_19-!MONTH-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_MAG_RATIO-MEAN-COMPOSITE-1_12.PNG',$
								DIR_OUT + 'Figure_20-!MONTH-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_DIR-MEAN-COMPOSITE-1_12.PNG',$
								DIR_OUT + 'Figure_chl-!MONTH-SEAWIFS-REPRO5-NEC-CHLOR_A-OC4-MEAN-COMPOSITE-1_12.PNG',$
								DIR_OUT + 'Figure_sst-!MONTH-AT-NEC-SST-4UM-MEAN-COMPOSITE-1_12.PNG']
		PSFILES  = [DIR_MANU + 'Figure_13-!MONTH-AT-EQ_NWA-SST-GRAD_MAG-MEAN-COMPOSITE-1_12.PS',$
								DIR_MANU + 'Figure_13-!MONTH-N4AT-EQ_NWA-SST-GRAD_MAG-MEAN-COMPOSITE-1_12.PS',$
								DIR_MANU + 'Figure_14-!MONTH-AT-EQ_NWA-SST-GRAD_DIR-MEAN-COMPOSITE-1_12.PS',$
								DIR_MANU + 'Figure_14-!MONTH-N4AT-EQ_NWA-SST-GRAD_DIR-MEAN-COMPOSITE-1_12.PS',$
								DIR_MANU + 'Figure_17-!MONTH-AT-NEC-SST-4UM-GRAD_MAG-MEAN-COMPOSITE-1_12.PS',$
								DIR_MANU + 'Figure_19-!MONTH-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_MAG_RATIO-MEAN-COMPOSITE-1_12.PS',$
								DIR_MANU + 'Figure_20-!MONTH-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_DIR-MEAN-COMPOSITE-1_12.PS',$
								DIR_MANU + 'Figure_chl-!MONTH-SEAWIFS-REPRO5-NEC-CHLOR_A-OC4-MEAN-COMPOSITE-1_12.PS',$
								DIR_MANU + 'Figure_sst-!MONTH-AT-NEC-SST-4UM-MEAN-COMPOSITE-1_12.PS']
		SPECIAL_SCALES = ['LOW','LOW','','','LOW','LOW_1','','','']
		PRODS = ['GRAD_MAG','GRAD_MAG','GRAD_DIR','GRAD_DIR','GRAD_MAG','GRAD_MAG_RATIO','GRAD_DIR','CHLOR_A','SST']
		MAPS = ['EQ_NWA','EQ_NWA','EQ_NWA','EQ_NWA','NEC','NEC','NEC','NEC','NEC']
		FOR NTH = 0L, N_ELEMENTS(PNGFILES)-1 DO BEGIN
			PNGFILE = PNGFILES[NTH]
			PSFILE  = PSFILES[NTH]
			SPECIAL_SCALE = SPECIAL_SCALES[NTH]
			APROD = PRODS[NTH]
			MAP = MAPS[NTH]
			IF APROD EQ 'GRAD_MAG' THEN TITLE = '!Eo!NC  km!E-1!N'
			IF APROD EQ 'GRAD_DIR' THEN TITLE = 'Gradient Direction'
			IF APROD EQ 'GRAD_MAG_RATIO' THEN TITLE = 'Chlorophyll Gradient Magnitude (ratio)'
			IF APROD EQ 'CHLOR_A'  THEN TITLE = UNITS('CHLOROPHYLL')
			IF APROD EQ 'SST'      THEN TITLE = UNITS('SST')

			IMAGE = READ_PNG(PNGFILE,R,G,B)
			SZ=SIZE(IMAGE,/STRUCT)
			TRUE_COLOR  = SZ.N_DIMENSIONS EQ 3
	  	PX_IMAGE = 1.0*SZ.DIMENSIONS(0+TRUE_COLOR)
	  	PY_IMAGE = 1.0*SZ.DIMENSIONS(1+TRUE_COLOR)
	;  	===> Postscript (idl) has 1000/cm resolution
	;  	A 2400 pixel wide PCX or PNG file printed at 300dpi  will be 8 inches wide or 2.54cm*8
	   	XSIZE = DOUBLE(2.54*(PX_IMAGE/300.))
	   	YSIZE = DOUBLE(2.54*(PY_IMAGE/300.))
	;		===> Dimensions of postscript page
	 		HEIGHT = 20.5  &   WIDTH = 26.9  ; MAX SIZE
			IF MAP EQ 'NEC' THEN XOFFSET = 10   & IF MAP EQ 'EQ_NWA' THEN XOFFSET = 5
	  	IF MAP EQ 'NEC' THEN YOFFSET = 27.5 & IF MAP EQ 'EQ_NWA' THEN YOFFSET = 29.5
	    IF MAP EQ 'NEC' THEN SCALE = 0.245   & IF MAP EQ 'EQ_NWA' THEN SCALE = 0.265

	;		===> Set up the postscript device
	    OLDDEVICE= !D.NAME  ; Get present graphics device
	    olddevice= !d.name  ; Get present graphics device
	  	!P.FONT = 0
	    SET_PLOT,'ps'
	    DEVICE,FILENAME=psfile
			DEVICE,/COLOR
	 		CALL_PROCEDURE,PAL,R,G,B
	 		TVLCT,R,G,B
	 		COLOR=1
			DEVICE,BITS_PER_PIXEL=8
			DEVICE,/HELVETICA
			DEVICE,/LANDSCAPE
	    DEVICE, XOFFSET=xoffset, YOFFSET=yoffset, XSIZE=xsize, YSIZE=ysize, SCALE_FACTOR=scale
	    TV,IMAGE, TRUE=TRUE_COLOR

			IF MAP EQ 'NEC' 	 THEN BEGIN & X = 0.010 & Y = 0.85 & IX = 0.0838 & ENDIF
			IF MAP EQ 'EQ_NWA' THEN BEGIN & X = 0.007 & Y = 0.85 & IX = 0.08 & ENDIF
			IF MAP EQ 'NEC' THEN POSITION = [0.925, 0.05,0.93, 0.95]
			IF MAP EQ 'EQ_NWA' THEN POSITION = [0.94, 0.05,0.95, 0.95]
			CHARSIZE  = 2.75
			COLOR     = 0
			CHARTHICK = 1
			ALIGN     = 0.5
			XYOUTS,X+0*IX,Y, 'Jan', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
			XYOUTS,X+1*IX,Y, 'Feb', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
			XYOUTS,X+2*IX,Y, 'Mar', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
			XYOUTS,X+3*IX,Y, 'Apr', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
			XYOUTS,X+4*IX,Y, 'May', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
			XYOUTS,X+5*IX,Y, 'Jun', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
			XYOUTS,X+6*IX,Y, 'Jul', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
			XYOUTS,X+7*IX,Y, 'Aug', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
			XYOUTS,X+8*IX,Y, 'Sep', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
			XYOUTS,X+9*IX,Y, 'Oct', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
			XYOUTS,X+10*IX,Y,'Nov', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL
			XYOUTS,X+11*IX,Y,'Dec', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL

			IF APROD EQ 'GRAD_DIR' THEN BEGIN
				CHARSIZE = 2.5
				LABELS_COMPASS=['N','E','S','W']
				IF MAP EQ 'NEC' 	 THEN BEGIN
					POLY_X = [0.89,0.89,1.05,1.05,0.89] & POLY_Y = [0.25,0.345,0.345,0.25,0.25]
					CIR_POS = [0.92,0.265,0.98,0.325]
					XYOUTS,0.75,0.22,TITLE,CHARSIZE=CHARSIZE,/NORMAL,FONT='HELVETICA'
				ENDIF
				IF MAP EQ 'EQ_NWA' THEN BEGIN
					POLY_X = [0.91,0.91,1.0,1.0,0.91] & POLY_Y = [0.325,0.435,0.435,0.325,0.325]
					CIR_POS = [0.93,0.345,1.0,0.415]
					XYOUTS,0.77,0.285,TITLE,CHARSIZE=CHARSIZE,/NORMAL,FONT='HELVETICA'
				ENDIF
				POLYFILL,POLY_X ,POLY_Y,COLOR=255,/NORMAL
				COLOR_CIRCLE ,LABELS_COMPASS,CHARSIZE=30,POSITION=CIR_POS,FONT='HELVETICA'
			ENDIF ELSE $
	;		LEG=COLOR_BAR_SCALE(PROD=APROD,POSITION=POSITION,PAL='PAL_SW3',CHARSIZE=3,/RIGHT,/VERTICAL,TITLE=' ',/NO_UNIT, SPECIAL_SCALE=SPECIAL_SCALE,FONT='HELVETICA')
	    DEVICE,/CLOSE
	    SET_PLOT,olddevice
    ENDFOR


;		Figure 21 GRAD_MAG CHL Annual composite figure
		FILES = FILE_SEARCH(DIR_SAVE + '!Y_*-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_MAG_RATIO-MEAN.SAVE')
;		STRUCT_SD_2PNG,FILES,DIR_OUT=DIR_OUT,/ADD_LAND,/ADD_COAST,MISS_COLOR=0,/OVERWRITE,SPECIAL_SCALE='LOW_1'
		FILES = FILE_SEARCH(DIR_OUT+'!Y_*-SEAWIFS-REPRO5-NEC-*CHLOR_A-GRAD_MAG_RATIO-MEAN.PNG')
		ROWS = 4
		COLS = 3
		PNGFILE = DIR_OUT  + 'Figure_21-!Y-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_MAG_RATIO-MEAN-COMPOSITE.PNG'
;		IMAGE_WELD_PAGE,FILES=FILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=pngfile,SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM
		ROWS = 1
		COLS = N_ELEMENTS(FILES)
		PNGFILE = DIR_OUT  + 'Figure_21-!Y-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_MAG_RATIO-MEAN-COMPOSITE-1_9.PNG'
;		IMAGE_WELD_PAGE,FILES=FILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=pngfile,SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM


;		Figure 22 GRAD_DIR CHL Annual composite figure
		FILES = FILE_SEARCH(DIR_SAVE + '!Y_*-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_DIR-MEAN.SAVE')
;		STRUCT_SD_2PNG,FILES,DIR_OUT=DIR_OUT,/ADD_LAND,/ADD_COAST,MISS_COLOR=0,/OVERWRITE,SPECIAL_SCALE=''
		FILES = FILE_SEARCH(DIR_OUT+'!Y_*-SEAWIFS-REPRO5-NEC-*CHLOR_A-GRAD_DIR-MEAN.PNG')
		ROWS = 4
		COLS = 3
		PNGFILE = DIR_OUT  + 'Figure_22-!Y-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_DIR-MEAN-COMPOSITE.PNG'
;		IMAGE_WELD_PAGE,FILES=FILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=pngfile,SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM
		ROWS = 1
		COLS = N_ELEMENTS(FILES)
		PNGFILE = DIR_OUT  + 'Figure_22-!Y-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_DIR-MEAN-COMPOSITE-1_9.PNG'
;		IMAGE_WELD_PAGE,FILES=FILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=pngfile,SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM


;		Figure chl Annual composite figure
		FILES = FILE_SEARCH(DIR_SAVE + '!Y_*-SEAWIFS-REPRO5-NEC-CHLOR_A-OC4-MEAN.SAVE')
;		STRUCT_SD_2PNG,FILES,DIR_OUT=DIR_OUT,/ADD_LAND,/ADD_COAST,MISS_COLOR=0,/OVERWRITE,SPECIAL_SCALE=''
		FILES = FILE_SEARCH(DIR_OUT+'!Y_*-SEAWIFS-REPRO5-NEC-CHLOR_A-OC4-MEAN.PNG')
		ROWS = 4
		COLS = 3
		PNGFILE = DIR_OUT  + 'Figure_chl-!Y-SEAWIFS-REPRO5-NEC-CHLOR_A-OC4-MEAN-COMPOSITE.PNG'
;		IMAGE_WELD_PAGE,FILES=FILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=pngfile,SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM
		ROWS = 1
		COLS = N_ELEMENTS(FILES)
		PNGFILE = DIR_OUT  + 'Figure_chl-!Y-SEAWIFS-REPRO5-NEC-CHLOR_A-OC4-MEAN-COMPOSITE-1_9.PNG'
;		IMAGE_WELD_PAGE,FILES=FILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=pngfile,SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM


;;;;;;;		YEARLY COMPOSITES
;;;;;;		PNGFILES = [DIR_OUT + 'Figure_21-!Y-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_MAG_RATIO-MEAN-COMPOSITE.PNG',$
;;;;;;								DIR_OUT + 'Figure_22-!Y-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_DIR-MEAN-COMPOSITE.PNG',$
;;;;;;								DIR_OUT + 'Figure_chl-!Y-SEAWIFS-REPRO5-NEC-CHLOR_A-OC4-MEAN-COMPOSITE.PNG']
;;;;;;		PSFILES  = [DIR_MANU + 'Figure_21-!Y-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_MAG_RATIO-MEAN-COMPOSITE.PS',$
;;;;;;								DIR_MANU + 'Figure_22-!Y-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_DIR_RATIO-MEAN-COMPOSITE.PS',$
;;;;;;								DIR_MANU + 'Figure_chl-!Y-SEAWIFS-REPRO5-NEC-CHLOR_A-OC4-MEAN-COMPOSITE.PS']
;;;;;;		SPECIAL_SCALES = ['LOW_1','','']
;;;;;;		PRODS = ['GRAD_MAG_RATIO','GRAD_DIR','CHLOR_A']
;;;;;;		MAPS = ['NEC','NEC','NEC']
;;;;;;		FOR NTH = 0L, N_ELEMENTS(PNGFILES)-1 DO BEGIN
;;;;;;			PNGFILE = PNGFILES[NTH]
;;;;;;			PSFILE  = PSFILES[NTH]
;;;;;;			SPECIAL_SCALE = SPECIAL_SCALES[NTH]
;;;;;;			APROD = PRODS[NTH]
;;;;;;			MAP = MAPS[NTH]
;;;;;;			IF APROD EQ 'GRAD_MAG' THEN TITLE = '!Eo!NC  km!E-1!N'
;;;;;;			IF APROD EQ 'GRAD_DIR' THEN TITLE = 'Gradient Direction'
;;;;;;			IF APROD EQ 'GRAD_MAG_RATIO' THEN TITLE = 'Chlorophyll Gradient Magnitude (ratio)'
;;;;;;			IF APROD EQ 'CHLOR_A'  THEN TITLE = UNITS('CHLOROPHYLL')
;;;;;;			IF APROD EQ 'SST'      THEN TITLE = UNITS('SST')
;;;;;;
;;;;;;			IMAGE = READ_PNG(PNGFILE,R,G,B)
;;;;;;			SZ=SIZE(IMAGE,/STRUCT)
;;;;;;			TRUE_COLOR  = SZ.N_DIMENSIONS EQ 3
;;;;;;	  	PX_IMAGE = 1.0*SZ.DIMENSIONS(0+TRUE_COLOR)
;;;;;;	  	PY_IMAGE = 1.0*SZ.DIMENSIONS(1+TRUE_COLOR)
;;;;;;	;  	===> Postscript (idl) has 1000/cm resolution
;;;;;;	;  	A 2400 pixel wide PCX or PNG file printed at 300dpi  will be 8 inches wide or 2.54cm*8
;;;;;;	   	XSIZE = DOUBLE(2.54*(PX_IMAGE/300.))
;;;;;;	   	YSIZE = DOUBLE(2.54*(PY_IMAGE/300.))
;;;;;;	;		===> Dimensions of postscript page (LANDSCAPE)
;;;;;;	 		HEIGHT = 20.5  &   WIDTH = 26.9  ; MAX SIZE
;;;;;;			XOFFSET = -1
;;;;;;	  	YOFFSET = 26.5
;;;;;;	    SCALE = 0.67
;;;;;;	;		===> Dimensions of postscript page (PORTRAIT)
;;;;;;	 		HEIGHT = 26.9  &   WIDTH = 20.5  ; MAX SIZE
;;;;;;			XOFFSET = 1
;;;;;;	  	YOFFSET = -1
;;;;;;	    SCALE = 0.67
;;;;;;
;;;;;;	;		===> Set up the postscript device
;;;;;;	    OLDDEVICE= !D.NAME  ; Get present graphics device
;;;;;;	  	!P.FONT = 0
;;;;;;	    SET_PLOT,'ps'
;;;;;;	    DEVICE,FILENAME=psfile
;;;;;;			DEVICE, /PORTRAIT
;;;;;;			DEVICE,/COLOR
;;;;;;	 		CALL_PROCEDURE,PAL,R,G,B
;;;;;;	 		TVLCT,R,G,B
;;;;;;	 		COLOR=1
;;;;;;			DEVICE,BITS_PER_PIXEL=8
;;;;;;			DEVICE,/HELVETICA
;;;;;;	    DEVICE, XOFFSET=xoffset, YOFFSET=yoffset, XSIZE=xsize, YSIZE=ysize, SCALE_FACTOR=scale
;;;;;;	    TV,IMAGE, TRUE=TRUE_COLOR
;;;;;;
;;;;;;			X = 0.06
;;;;;;			Y = 0.97
;;;;;;			IX = 0.335
;;;;;;			IY = -0.25
;;;;;;			CHARSIZE 	= 2.75
;;;;;;			COLOR     = 0
;;;;;;			CHARTHICK = 1
;;;;;;			ALIGN     = 0.5
;;;;;;			XYOUTS,X,Y,'1998', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
;;;;;;			XYOUTS,X+IX,Y,'1999', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
;;;;;;			XYOUTS,X+2*IX,Y,'2000', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
;;;;;;			XYOUTS,X,Y+IY,'2001', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
;;;;;;			XYOUTS,X+IX,Y+IY,'2002', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
;;;;;;			XYOUTS,X+2*IX,Y+IY,'2003', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
;;;;;;			XYOUTS,X,Y+2*IY,'2004', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
;;;;;;			XYOUTS,X+IX,Y+2*IY,'2005', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
;;;;;;			XYOUTS,X+2*IX,Y+2*IY,'2006', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
;;;;;;
;;;;;;			IF APROD EQ 'GRAD_DIR' THEN BEGIN
;;;;;;				CHARSIZE = 2.5
;;;;;;				LABELS_COMPASS=['N','E','S','W']
;;;;;;				IF MAP EQ 'NEC' 	 THEN BEGIN
;;;;;;					POLY_X = [0.87,0.87,1.01,1.01,0.87] & POLY_Y = [0.25,0.345,0.345,0.25,0.25]
;;;;;;					CIR_POS = [0.91,0.265,0.975,0.325]
;;;;;;					XYOUTS,0.675,0.225,TITLE,CHARSIZE=CHARSIZE,/NORMAL,FONT='HELVETICA'
;;;;;;				ENDIF
;;;;;;				IF MAP EQ 'EQ_NWA' THEN BEGIN
;;;;;;					POLY_X = [0.91,0.91,1.0,1.0,0.91] & POLY_Y = [0.325,0.435,0.435,0.325,0.325]
;;;;;;					CIR_POS = [0.93,0.345,1.0,0.415]
;;;;;;					XYOUTS,0.8,0.3,TITLE,CHARSIZE=CHARSIZE,/NORMAL,FONT='HELVETICA'
;;;;;;				ENDIF
;;;;;;				POLYFILL,POLY_X ,POLY_Y,COLOR=255,/NORMAL
;;;;;;				COLOR_CIRCLE ,LABELS_COMPASS,CHARSIZE=30,POSITION=CIR_POS,FONT='HELVETICA'
;;;;;;			ENDIF ELSE $
;;;;;;		;	LEG=COLOR_BAR_SCALE(PROD=APROD,POSITION=POSITION,PAL='PAL_SW3',CHARSIZE=3,/BOTTOM,TITLE=TITLE,/NO_UNIT, SPECIAL_SCALE=SPECIAL_SCALE,FONT='HELVETICA')
;;;;;;	    DEVICE,/CLOSE
;;;;;;	    SET_PLOT,olddevice
;;;;;;		ENDFOR
;;;;;;
;;;;;;		PNGFILES = [DIR_OUT + 'Figure_21-!Y-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_MAG_RATIO-MEAN-COMPOSITE-1_9.PNG',$
;;;;;;								DIR_OUT + 'Figure_22-!Y-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_DIR-MEAN-COMPOSITE-1_9.PNG',$
;;;;;;								DIR_OUT + 'Figure_chl-!Y-SEAWIFS-REPRO5-NEC-CHLOR_A-OC4-MEAN-COMPOSITE-1_9.PNG']
;;;;;;		PSFILES  = [DIR_MANU + 'Figure_21-!Y-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_MAG_RATIO-MEAN-COMPOSITE-1_9.PS',$
;;;;;;								DIR_MANU + 'Figure_22-!Y-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_DIR_RATIO-MEAN-COMPOSITE-1_9.PS',$
;;;;;;								DIR_MANU + 'Figure_chl-!Y-SEAWIFS-REPRO5-NEC-CHLOR_A-OC4-MEAN-COMPOSITE-1_9.PS']
;;;;;;		SPECIAL_SCALES = ['LOW_1','','']
;;;;;;		PRODS = ['GRAD_MAG_RATIO','GRAD_DIR','CHLOR_A']
;;;;;;		MAPS = ['NEC','NEC','NEC']
;;;;;;		FOR NTH = 0L, N_ELEMENTS(PNGFILES)-1 DO BEGIN
;;;;;;			PNGFILE = PNGFILES[NTH]
;;;;;;			PSFILE  = PSFILES[NTH]
;;;;;;			SPECIAL_SCALE = SPECIAL_SCALES[NTH]
;;;;;;			APROD = PRODS[NTH]
;;;;;;			MAP = MAPS[NTH]
;;;;;;			IF APROD EQ 'GRAD_MAG' THEN TITLE = '!Eo!NC  km!E-1!N'
;;;;;;			IF APROD EQ 'GRAD_DIR' THEN TITLE = 'Gradient Direction'
;;;;;;			IF APROD EQ 'GRAD_MAG_RATIO' THEN TITLE = 'Chlorophyll Gradient Magnitude (ratio)'
;;;;;;			IF APROD EQ 'CHLOR_A'  THEN TITLE = UNITS('CHLOROPHYLL')
;;;;;;			IF APROD EQ 'SST'      THEN TITLE = UNITS('SST')
;;;;;;
;;;;;;			IMAGE = READ_PNG(PNGFILE,R,G,B)
;;;;;;			SZ=SIZE(IMAGE,/STRUCT)
;;;;;;			TRUE_COLOR  = SZ.N_DIMENSIONS EQ 3
;;;;;;	  	PX_IMAGE = 1.0*SZ.DIMENSIONS(0+TRUE_COLOR)
;;;;;;	  	PY_IMAGE = 1.0*SZ.DIMENSIONS(1+TRUE_COLOR)
;;;;;;	;  	===> Postscript (idl) has 1000/cm resolution
;;;;;;	;  	A 2400 pixel wide PCX or PNG file printed at 300dpi  will be 8 inches wide or 2.54cm*8
;;;;;;	   	XSIZE = DOUBLE(2.54*(PX_IMAGE/300.))
;;;;;;	   	YSIZE = DOUBLE(2.54*(PY_IMAGE/300.))
;;;;;;	;		===> Dimensions of postscript page (LANDSCAPE)
;;;;;;	 		HEIGHT = 20.5  &   WIDTH = 26.9  ; MAX SIZE
;;;;;;			XOFFSET = -3
;;;;;;	  	YOFFSET = 26.5
;;;;;;	    SCALE = 0.67
;;;;;;	;		===> Dimensions of postscript page (PORTRAIT)
;;;;;;;	 		HEIGHT = 26.9  &   WIDTH = 20.5  ; MAX SIZE
;;;;;;;			XOFFSET = 1
;;;;;;;	  	YOFFSET = 15
;;;;;;;	    SCALE = 0.24
;;;;;;
;;;;;;			IF MAP EQ 'NEC' THEN XOFFSET = 10   & IF MAP EQ 'EQ_NWA' THEN XOFFSET = 5
;;;;;;	  	IF MAP EQ 'NEC' THEN YOFFSET = 27.5 & IF MAP EQ 'EQ_NWA' THEN YOFFSET = 29.5
;;;;;;	    IF MAP EQ 'NEC' THEN SCALE = 0.33   & IF MAP EQ 'EQ_NWA' THEN SCALE = 0.265
;;;;;;
;;;;;;	;		===> Set up the postscript device
;;;;;;	    OLDDEVICE= !D.NAME  ; Get present graphics device
;;;;;;	  	!P.FONT = 0
;;;;;;	    SET_PLOT,'ps'
;;;;;;	    DEVICE,FILENAME=psfile
;;;;;;			DEVICE, /LANDSCAPE
;;;;;;			DEVICE,/COLOR
;;;;;;	 		CALL_PROCEDURE,PAL,R,G,B
;;;;;;	 		TVLCT,R,G,B
;;;;;;	 		COLOR=1
;;;;;;			DEVICE,BITS_PER_PIXEL=8
;;;;;;			DEVICE,/HELVETICA
;;;;;;	    DEVICE, XOFFSET=xoffset, YOFFSET=yoffset, XSIZE=xsize, YSIZE=ysize, SCALE_FACTOR=scale
;;;;;;	    TV,IMAGE, TRUE=TRUE_COLOR
;;;;;;
;;;;;;			X = 0.017
;;;;;;			Y = 0.85
;;;;;;			IX = 0.1115
;;;;;;			CHARSIZE 	= 2.75
;;;;;;			COLOR     = 0
;;;;;;			CHARTHICK = 1
;;;;;;			ALIGN     = 0.5
;;;;;;			XYOUTS,X+0*IX,Y,'1998', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
;;;;;;			XYOUTS,X+1*IX,Y,'1999', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
;;;;;;			XYOUTS,X+2*IX,Y,'2000', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
;;;;;;			XYOUTS,X+3*IX,Y,'2001', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
;;;;;;			XYOUTS,X+4*IX,Y,'2002', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
;;;;;;			XYOUTS,X+5*IX,Y,'2003', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
;;;;;;			XYOUTS,X+6*IX,Y,'2004', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
;;;;;;			XYOUTS,X+7*IX,Y,'2005', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
;;;;;;			XYOUTS,X+8*IX,Y,'2006', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
;;;;;;
;;;;;;;			IF APROD EQ 'GRAD_DIR' THEN BEGIN
;;;;;;;				CHARSIZE = 2.5
;;;;;;;				LABELS_COMPASS=['N','E','S','W']
;;;;;;;				IF MAP EQ 'NEC' 	 THEN BEGIN
;;;;;;;					POLY_X = [0.87,0.87,1.01,1.01,0.87] & POLY_Y = [0.25,0.345,0.345,0.25,0.25]
;;;;;;;					CIR_POS = [0.91,0.265,0.975,0.325]
;;;;;;;					XYOUTS,0.675,0.225,TITLE,CHARSIZE=CHARSIZE,/NORMAL,FONT='HELVETICA'
;;;;;;;				ENDIF
;;;;;;;				IF MAP EQ 'EQ_NWA' THEN BEGIN
;;;;;;;					POLY_X = [0.91,0.91,1.0,1.0,0.91] & POLY_Y = [0.325,0.435,0.435,0.325,0.325]
;;;;;;;					CIR_POS = [0.93,0.345,1.0,0.415]
;;;;;;;					XYOUTS,0.8,0.3,TITLE,CHARSIZE=CHARSIZE,/NORMAL,FONT='HELVETICA'
;;;;;;;				ENDIF
;;;;;;;				POLYFILL,POLY_X ,POLY_Y,COLOR=255,/NORMAL
;;;;;;;				COLOR_CIRCLE ,LABELS_COMPASS,CHARSIZE=30,POSITION=CIR_POS,FONT='HELVETICA'
;;;;;;;			ENDIF ELSE $
;;;;;;;			LEG=COLOR_BAR_SCALE(PROD=APROD,POSITION=POSITION,PAL='PAL_SW3',CHARSIZE=3,/BOTTOM,TITLE=TITLE,/NO_UNIT, SPECIAL_SCALE=SPECIAL_SCALE,FONT='HELVETICA')
;;;;;;	    DEVICE,/CLOSE
;;;;;;	    SET_PLOT,olddevice
;;;;;;		ENDFOR


;		Figure 18 GRAD_MAG SST Annual composite figure
		FILES = FILE_SEARCH(DIR_SAVE + '!Y_*-AT-NEC-SST-4UM-GRAD_MAG-MEAN.SAVE')
;		STRUCT_SD_2PNG,FILES,DIR_OUT=DIR_OUT,/ADD_LAND,/ADD_COAST,MISS_COLOR=0,/OVERWRITE,SPECIAL_SCALE='LOW_1'
		FILES = FILE_SEARCH(DIR_OUT+'!Y_*-AT-NEC-SST-4UM-GRAD_MAG-MEAN.PNG')
		ROWS = 3
		COLS = 3
		PNGFILE = DIR_OUT  + 'Figure_18-!Y-AT-NEC-SST-4UM-GRAD_MAG-MEAN-COMPOSITE.PNG'
		IMAGE_WELD_PAGE,FILES=FILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=pngfile,SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM
		ROWS = 1
		COLS = N_ELEMENTS(FILES)
		PNGFILE = DIR_OUT  + 'Figure_18-!Y-AT-NEC-SST-4UM-GRAD_MAG-MEAN-COMPOSITE-1_6.PNG'
		IMAGE_WELD_PAGE,FILES=FILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=pngfile,SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM


;		Figure 18b GRAD_DIR SST Annual composite figure
		FILES = FILE_SEARCH(DIR_SAVE + '!Y_*-AT-NEC-SST-4UM-GRAD_DIR-MEAN.SAVE')
;		STRUCT_SD_2PNG,FILES,DIR_OUT=DIR_OUT,/ADD_LAND,/ADD_COAST,MISS_COLOR=0,/OVERWRITE,SPECIAL_SCALE=''
		FILES = FILE_SEARCH(DIR_OUT+'!Y_*-AT-NEC-SST-4UM-GRAD_DIR-MEAN.PNG')
		ROWS = 3
		COLS = 3
		PNGFILE = DIR_OUT  + 'Figure_18b-!Y-AT-NEC-SST-4UM-GRAD_DIR-MEAN-COMPOSITE.PNG'
;		IMAGE_WELD_PAGE,FILES=FILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=pngfile,SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM
		ROWS = 1
		COLS = N_ELEMENTS(FILES)
		PNGFILE = DIR_OUT  + 'Figure_18b-!Y-AT-NEC-SST-4UM-GRAD_DIR-MEAN-COMPOSITE-1_6.PNG'
;		IMAGE_WELD_PAGE,FILES=FILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=pngfile,SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM


;		Figure sst Annual composite figure
		FILES = FILE_SEARCH(DIR_SAVE + '!Y_*-AT-NEC-SST-4UM-MEAN.SAVE')
;		STRUCT_SD_2PNG,FILES,DIR_OUT=DIR_OUT,/ADD_LAND,/ADD_COAST,MISS_COLOR=0,/OVERWRITE,SPECIAL_SCALE=''
		FILES = FILE_SEARCH(DIR_OUT+'!Y_*-AT-NEC-SST-4UM-MEAN.PNG')
		ROWS = 3
		COLS = 3
		PNGFILE = DIR_OUT  + 'Figure_sst-!Y-AT-NEC-SST-4UM-MEAN-COMPOSITE.PNG'
;		IMAGE_WELD_PAGE,FILES=FILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=pngfile,SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM
		ROWS = 1
		COLS = N_ELEMENTS(FILES)
		PNGFILE = DIR_OUT  + 'Figure_sst-!Y-AT-NEC-SST-4UM-MEAN-COMPOSITE-1_6.PNG'
;		IMAGE_WELD_PAGE,FILES=FILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=pngfile,SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM


;		YEARLY COMPOSITES
		PNGFILES = [DIR_OUT + 'Figure_18-!Y-AT-NEC-SST-4UM-GRAD_MAG-MEAN-COMPOSITE.PNG',$
								DIR_OUT + 'Figure_18b-!Y-AT-NEC-SST-4UM-GRAD_DIR-MEAN-COMPOSITE.PNG',$
								DIR_OUT + 'Figure_sst-!Y-AT-NEC-SST-4UM-MEAN-COMPOSITE.PNG']
		PSFILES  = [DIR_MANU + 'Figure_18-!Y-AT-NEC-SST-4UM-GRAD_MAG-MEAN-COMPOSITE.PS',$
								DIR_MANU + 'Figure_18b-!Y-AT-NEC-SST-4UM-GRAD_DIR-MEAN-COMPOSITE.PS',$
								DIR_MANU + 'Figure_sst-!Y-AT-NEC-SST-4UM-MEAN-COMPOSITE.PS']
		SPECIAL_SCALES = ['LOW_1','','']
		PRODS = ['GRAD_MAG','GRAD_DIR','SST']
		MAPS = ['NEC','NEC','NEC']
		FOR NTH = 0L, N_ELEMENTS(PNGFILES)-1 DO BEGIN
			PNGFILE = PNGFILES[NTH]
			PSFILE  = PSFILES[NTH]
			SPECIAL_SCALE = SPECIAL_SCALES[NTH]
			APROD = PRODS[NTH]
			MAP = MAPS[NTH]
			IF APROD EQ 'GRAD_MAG' THEN TITLE = '!Eo!NC  km!E-1!N'
			IF APROD EQ 'GRAD_DIR' THEN TITLE = 'Gradient Direction'
			IF APROD EQ 'GRAD_MAG_RATIO' THEN TITLE = 'Chlorophyll Gradient Magnitude (ratio)'
			IF APROD EQ 'CHLOR_A'  THEN TITLE = UNITS('CHLOROPHYLL')
			IF APROD EQ 'SST'      THEN TITLE = UNITS('SST')

			IMAGE = READ_PNG(PNGFILE,R,G,B)
			SZ=SIZE(IMAGE,/STRUCT)
			TRUE_COLOR  = SZ.N_DIMENSIONS EQ 3
	  	PX_IMAGE = 1.0*SZ.DIMENSIONS(0+TRUE_COLOR)
	  	PY_IMAGE = 1.0*SZ.DIMENSIONS(1+TRUE_COLOR)
	;  	===> Postscript (idl) has 1000/cm resolution
	;  	A 2400 pixel wide PCX or PNG file printed at 300dpi  will be 8 inches wide or 2.54cm*8
	   	XSIZE = DOUBLE(2.54*(PX_IMAGE/300.))
	   	YSIZE = DOUBLE(2.54*(PY_IMAGE/300.))
	;		===> Dimensions of postscript page (LANDSCAPE)
	 		HEIGHT = 20.5  &   WIDTH = 26.9  ; MAX SIZE
			XOFFSET = -3
	  	YOFFSET = 26.5
	    SCALE = 0.85
	;		===> Dimensions of postscript page (PORTRAIT)
;	 		HEIGHT = 26.9  &   WIDTH = 20.5  ; MAX SIZE
;			XOFFSET = 1
;	  	YOFFSET = -1
;	    SCALE = 0.67

	;		===> Set up the postscript device
	    OLDDEVICE= !D.NAME  ; Get present graphics device
	  	!P.FONT = 0
	    SET_PLOT,'ps'
	    DEVICE,FILENAME=psfile
			DEVICE, /LANDSCAPE
			DEVICE,/COLOR
	 		CALL_PROCEDURE,PAL,R,G,B
	 		TVLCT,R,G,B
	 		COLOR=1
			DEVICE,BITS_PER_PIXEL=8
			DEVICE,/HELVETICA
	    DEVICE, XOFFSET=xoffset, YOFFSET=yoffset, XSIZE=xsize, YSIZE=ysize, SCALE_FACTOR=scale
	    TV,IMAGE, TRUE=TRUE_COLOR

			X = 0.06
			Y = 0.95
			IX = 0.335
			IY = -0.33
			CHARSIZE 	= 2.75
			COLOR     = 0
			CHARTHICK = 1
			ALIGN     = 0.5
			XYOUTS,X,Y,'2001', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
			XYOUTS,X+IX,Y,'2002', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
			XYOUTS,X+2*IX,Y,'2003', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
			XYOUTS,X,Y+IY,'2004', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
			XYOUTS,X+IX,Y+IY,'2005', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
			XYOUTS,X+2*IX,Y+IY,'2006', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'

			IF APROD EQ 'GRAD_DIR' THEN BEGIN
				CHARSIZE = 2.5
				LABELS_COMPASS=['N','E','S','W']
				IF MAP EQ 'NEC' 	 THEN BEGIN
					POLY_X = [0.87,0.87,1.01,1.01,0.87] & POLY_Y = [0.25,0.345,0.345,0.25,0.25]
					CIR_POS = [0.91,0.265,0.975,0.325]
					XYOUTS,0.675,0.225,TITLE,CHARSIZE=CHARSIZE,/NORMAL,FONT='HELVETICA'
				ENDIF
				IF MAP EQ 'EQ_NWA' THEN BEGIN
					POLY_X = [0.91,0.91,1.0,1.0,0.91] & POLY_Y = [0.325,0.435,0.435,0.325,0.325]
					CIR_POS = [0.93,0.345,1.0,0.415]
					XYOUTS,0.8,0.3,TITLE,CHARSIZE=CHARSIZE,/NORMAL,FONT='HELVETICA'
				ENDIF
				POLYFILL,POLY_X ,POLY_Y,COLOR=255,/NORMAL
				COLOR_CIRCLE ,LABELS_COMPASS,CHARSIZE=30,POSITION=CIR_POS,FONT='HELVETICA'
			ENDIF ELSE $
		;	LEG=COLOR_BAR_SCALE(PROD=APROD,POSITION=POSITION,PAL='PAL_SW3',CHARSIZE=3,/BOTTOM,TITLE=TITLE,/NO_UNIT, SPECIAL_SCALE=SPECIAL_SCALE,FONT='HELVETICA')
	    DEVICE,/CLOSE
	    SET_PLOT,olddevice
		ENDFOR

		PNGFILES = [DIR_OUT + 'Figure_18-!Y-AT-NEC-SST-4UM-GRAD_MAG-MEAN-COMPOSITE-1_6.PNG',$
								DIR_OUT + 'Figure_18b-!Y-AT-NEC-SST-4UM-GRAD_DIR-MEAN-COMPOSITE-1_6.PNG',$
								DIR_OUT + 'Figure_sst-!Y-AT-NEC-SST-4UM-MEAN-COMPOSITE-1_6.PNG']
		PSFILES  = [DIR_MANU + 'Figure_18-!Y-AT-NEC-SST-4UM-GRAD_MAG-MEAN-COMPOSITE-1_6.PS',$
								DIR_MANU + 'Figure_18b-!Y-AT-NEC-SST-4UM-GRAD_DIR-MEAN-COMPOSITE-1_6.PS',$
								DIR_MANU + 'Figure_sst-!Y-AT-NEC-SST-4UM-MEAN-COMPOSITE-1_6.PS']
		SPECIAL_SCALES = ['LOW_1','','']
		PRODS = ['GRAD_MAG','GRAD_DIR','SST']
		MAPS = ['NEC','NEC','NEC']
		FOR NTH = 0L, N_ELEMENTS(PNGFILES)-1 DO BEGIN
			PNGFILE = PNGFILES[NTH]
			PSFILE  = PSFILES[NTH]
			SPECIAL_SCALE = SPECIAL_SCALES[NTH]
			APROD = PRODS[NTH]
			MAP = MAPS[NTH]
			IF APROD EQ 'GRAD_MAG' THEN TITLE = '!Eo!NC  km!E-1!N'
			IF APROD EQ 'GRAD_DIR' THEN TITLE = 'Gradient Direction'
			IF APROD EQ 'GRAD_MAG_RATIO' THEN TITLE = 'Chlorophyll Gradient Magnitude (ratio)'
			IF APROD EQ 'CHLOR_A'  THEN TITLE = UNITS('CHLOROPHYLL')
			IF APROD EQ 'SST'      THEN TITLE = UNITS('SST')

			IMAGE = READ_PNG(PNGFILE,R,G,B)
			SZ=SIZE(IMAGE,/STRUCT)
			TRUE_COLOR  = SZ.N_DIMENSIONS EQ 3
	  	PX_IMAGE = 1.0*SZ.DIMENSIONS(0+TRUE_COLOR)
	  	PY_IMAGE = 1.0*SZ.DIMENSIONS(1+TRUE_COLOR)
	;  	===> Postscript (idl) has 1000/cm resolution
	;  	A 2400 pixel wide PCX or PNG file printed at 300dpi  will be 8 inches wide or 2.54cm*8
	   	XSIZE = DOUBLE(2.54*(PX_IMAGE/300.))
	   	YSIZE = DOUBLE(2.54*(PY_IMAGE/300.))
	;		===> Dimensions of postscript page (LANDSCAPE)
	 		HEIGHT = 20.5  &   WIDTH = 26.9  ; MAX SIZE
			XOFFSET = -3
	  	YOFFSET = 26.5
	    SCALE = 0.67
	;		===> Dimensions of postscript page (PORTRAIT)
;	 		HEIGHT = 26.9  &   WIDTH = 20.5  ; MAX SIZE
;			XOFFSET = 1
;	  	YOFFSET = 15
;	    SCALE = 0.24

			IF MAP EQ 'NEC' THEN XOFFSET = 12   & IF MAP EQ 'EQ_NWA' THEN XOFFSET = 5
	  	IF MAP EQ 'NEC' THEN YOFFSET = 27.5 & IF MAP EQ 'EQ_NWA' THEN YOFFSET = 29.5
	    IF MAP EQ 'NEC' THEN SCALE = 0.48   & IF MAP EQ 'EQ_NWA' THEN SCALE = 0.265

	;		===> Set up the postscript device
	    OLDDEVICE= !D.NAME  ; Get present graphics device
	  	!P.FONT = 0
	    SET_PLOT,'ps'
	    DEVICE,FILENAME=psfile
			DEVICE, /LANDSCAPE
			DEVICE,/COLOR
	 		CALL_PROCEDURE,PAL,R,G,B
	 		TVLCT,R,G,B
	 		COLOR=1
			DEVICE,BITS_PER_PIXEL=8
			DEVICE,/HELVETICA
	    DEVICE, XOFFSET=xoffset, YOFFSET=yoffset, XSIZE=xsize, YSIZE=ysize, SCALE_FACTOR=scale
	    TV,IMAGE, TRUE=TRUE_COLOR

			X = 0.028
			Y = 0.85
			IX = 0.168
			CHARSIZE 	= 2.75
			COLOR     = 0
			CHARTHICK = 1
			ALIGN     = 0.5
			XYOUTS,X+0*IX,Y,'2001', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
			XYOUTS,X+1*IX,Y,'2002', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
			XYOUTS,X+2*IX,Y,'2003', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
			XYOUTS,X+3*IX,Y,'2004', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
			XYOUTS,X+4*IX,Y,'2005', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'
			XYOUTS,X+5*IX,Y,'2006', ALIGN=ALIGN, CHARSIZE=CHARSIZE, COLOR=COLOR, CHARTHICK=CHARTHICK,/NORMAL,FONT='HELVETICA'

;			IF APROD EQ 'GRAD_DIR' THEN BEGIN
;				CHARSIZE = 2.5
;				LABELS_COMPASS=['N','E','S','W']
;				IF MAP EQ 'NEC' 	 THEN BEGIN
;					POLY_X = [0.87,0.87,1.01,1.01,0.87] & POLY_Y = [0.25,0.345,0.345,0.25,0.25]
;					CIR_POS = [0.91,0.265,0.975,0.325]
;					XYOUTS,0.675,0.225,TITLE,CHARSIZE=CHARSIZE,/NORMAL,FONT='HELVETICA'
;				ENDIF
;				IF MAP EQ 'EQ_NWA' THEN BEGIN
;					POLY_X = [0.91,0.91,1.0,1.0,0.91] & POLY_Y = [0.325,0.435,0.435,0.325,0.325]
;					CIR_POS = [0.93,0.345,1.0,0.415]
;					XYOUTS,0.8,0.3,TITLE,CHARSIZE=CHARSIZE,/NORMAL,FONT='HELVETICA'
;				ENDIF
;				POLYFILL,POLY_X ,POLY_Y,COLOR=255,/NORMAL
;				COLOR_CIRCLE ,LABELS_COMPASS,CHARSIZE=30,POSITION=CIR_POS,FONT='HELVETICA'
;			ENDIF ELSE $
;			LEG=COLOR_BAR_SCALE(PROD=APROD,POSITION=POSITION,PAL='PAL_SW3',CHARSIZE=3,/BOTTOM,TITLE=TITLE,/NO_UNIT, SPECIAL_SCALE=SPECIAL_SCALE,FONT='HELVETICA')
	    DEVICE,/CLOSE
	    SET_PLOT,olddevice
		ENDFOR




;		FIGURE 23: Monthly Chlorophyll examples
		SAVEFILES = [DIR_SAVE  + '!M_200010-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_MAG_RATIO-MEAN.SAVE', $
								 DIR_SAVE  + '!M_200010-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_DIR-MEAN.SAVE', $
								 DIR_SAVE  + '!M_199807-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_MAG_RATIO-MEAN.SAVE', $
								 DIR_SAVE  + '!M_200007-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_MAG_RATIO-MEAN.SAVE']
		PNGFILES  = [DIR_OUT   + '!M_200010-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_MAG_RATIO-MEAN.PNG', $
								 DIR_OUT   + '!M_200010-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_DIR-MEAN.PNG', $
								 DIR_OUT   + '!M_199807-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_MAG_RATIO-MEAN.PNG', $
								 DIR_OUT   + '!M_200007-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_MAG_RATIO-MEAN.PNG']
		OUTFILE = DIR_OUT + 'FIGURE_23-!M-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_MAG_RATIO-MEAN-COMPOSITE.PNG'
		PSFILE 	 = DIR_PLOTS + 'FIGURE_23-!M-SEAWIFS-REPRO5-NEC-CHLOR_A-GRAD_MAG_RATIO-MEAN-COMPOSITE.PS'
		STRUCT_SD_2PNG,SAVEFILES,DIR_OUT=DIR_OUT,/ADD_LAND,/ADD_COAST,MISS_COLOR=0,/OVERWRITE

		ROWS = 2
		COLS = 2
		IMAGE_WELD_PAGE,FILES=PNGFILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=OUTFILE,SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM

		IMAGE = READ_PNG(OUTFILE,r,g,b)
		SZ=SIZE(IMAGE,/STRUCT)
		TRUE_COLOR  = SZ.N_DIMENSIONS EQ 3
  	PX_IMAGE = 1.0*SZ.DIMENSIONS(0+TRUE_COLOR)
  	PY_IMAGE = 1.0*SZ.DIMENSIONS(1+TRUE_COLOR)
;  ===> Postscript (idl) has 1000/cm resolution
;  	A 2400 pixel wide PCX or PNG file printed at 300dpi  will be 8 inches wide or 2.54cm*8
   	xsize = DOUBLE(2.54*(PX_IMAGE/300.))    &   ysize = DOUBLE(2.54*(PY_IMAGE/300.))
;		===> Dimensions of postscript page (LANDSCAPE)
 		HEIGHT = 20.5  &   WIDTH = 26.9  ; MAX SIZE
		XOFFSET = -3
  	YOFFSET = 26.5
    SCALE = 0.67
;		===> Dimensions of postscript page (PORTRAIT)
 		HEIGHT = 26.9  &   WIDTH = 20.5  ; MAX SIZE
		XOFFSET = 1.5
  	YOFFSET = 5
    SCALE = 1.07

;		===> Set up the postscript device
    OLDDEVICE= !D.NAME  ; Get present graphics device
  	!P.FONT = 0
    SET_PLOT,'ps'
    DEVICE,FILENAME=psfile
		DEVICE, /PORTRAIT
		DEVICE,/COLOR
 		CALL_PROCEDURE,PAL,R,G,B
 		TVLCT,R,G,B
 		COLOR=1
		DEVICE,BITS_PER_PIXEL=8
		DEVICE,/HELVETICA
    DEVICE, XOFFSET=xoffset, YOFFSET=yoffset, XSIZE=xsize, YSIZE=ysize, SCALE_FACTOR=scale
    TV,IMAGE, TRUE=TRUE_COLOR


    DEVICE,/CLOSE
    SET_PLOT,olddevice

		STOP
		SKIP_SEA_COMP:
	ENDIF


END; #####################  End of Routine ################################



