; $ID:	MANUSCRIPT_FIGURES.PRO,	2020-07-08-15,	USER-KJWH	$

 PRO MANUSCRIPT_FIGURES
;+
; NAME:
;       MANUSCRIPT_FIGURES
;
; PURPOSE:
;				To create the final figures for Kim Hyde's first manuscript
;
;	NOTES:
;				Most procedures are copied from other programs
;
; MODIFICATION HISTORY:

;

ROUTINE_NAME='MANUSCRIPT_FIGURES'

TIMER

;	===> Load simple color palette
 	PAL_36,r,g,b

; **************************************************
; ***** SWITCHES CONTROLLING PROCESSING STEPS  *****
; **************************************************
;		Switch	Operation
;		0  			Do not do Step
;		1				Do Step (unless output from this step already exists, then skip this step)
; 	2     	Do Step (make output file from step and overwrite output if it already exists)

		DO_MAN1_TABLES				= 1
		DO_MAN1_FIGURES				= 2
		DO_SEA_COMP						= 1

;	*** Define names of input and output files so that they are available to various steps

	DATA_98_06							= 'D:\PROJECTS\MASS_BAY\DATA\MWRA_DATA\MWRA_DATA_98_06.SAVE'
	SURF_DATA								= 'D:\PROJECTS\MASS_BAY\DATA\MWRA_DATA\CHL_INSITU_DATA.SAVE'
	SAT_DATA								= 'D:\PROJECTS\MASS_BAY\DATA\MWRA_DATA\CHL_SAT_SHIP_DATA.SAVE'
	SAT_STATIONS						= 'D:\PROJECTS\MASS_BAY\CHL_SAT_STATIONS_DATA.SAVE'
	ENV_DATA								= 'D:\PROJECTS\MASS_BAY\DATA/ENV_DATA/ENV_DATA.SAVE'
	CHL_PROFILES 						= 'D:\PROJECTS\MASS_BAY\DATA\MWRA_DATA\CHL_PROFILES.SAVE'
	CHL_EXTRACT 						= 'D:\PROJECTS\MASS_BAY\DATA\MWRA_DATA\!S-LATLON_SUBAREA-MASS_BAY-SITES-PXY_160_160-REPRO5-CHLOR_A.SAVE'
	COR_EXTRACT 						= 'D:\PROJECTS\MASS_BAY\DATA\MWRA_DATA\!S-LATLON_SUBAREA-MASS_BAY-SITES-PXY_160_160-REPRO5-CHLOR_A_MB.SAVE'

	MAN1_FIGURES						= 'D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT1\MAN1_FIGURES.PS'
	MAN1_TABLES							= 'D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT1\MAN1_TABLES.SAVE'


	!X.OMARGIN = 0
	!Y.OMARGIN = 0


; *******************************************************
	IF DO_MAN1_TABLES GE 1 THEN BEGIN
; *******************************************************
		OVERWRITE = DO_MAN1_TABLES GE 2
		EXIST = FILE_TEST(MAN1_TABLES)
		IF EXIST AND OVERWRITE EQ 0 THEN GOTO, SKIP_TABLES  ; >>>>>>>>>>>>>>>>>>>>>>>>>

		IN = IDL_RESTORE(SURF_DATA)

		SAT = IDL_RESTORE(CHL_EXTRACT)
		OK  = WHERE(SAT.N GE 11 AND SAT.MEAN NE MISSINGS(0.0) AND SAT.SUBAREA_NAME EQ 'N04')
		SAT = SAT[OK] & FS = PARSE_IT(SAT.FIRST_NAME,/ALL) & SDATE = JD_2DATE(PERIOD_2JD(FS.PERIOD))
		SYEAR = STRMID(SDATE,0,4) & SMON = STRMID(SDATE,4,2)

		COR = IDL_RESTORE(COR_EXTRACT)
		OK  = WHERE(COR.N GE 11 AND COR.MEAN NE MISSINGS(0.0) AND COR.SUBAREA_NAME EQ 'N04')
		COR = COR[OK] & FC = PARSE_IT(COR.FIRST_NAME,/ALL) & CDATE = JD_2DATE(PERIOD_2JD(FC.PERIOD))
		CYEAR = STRMID(CDATE,0,4) & CMON = STRMID(CDATE,4,2)

		NEW = CREATE_STRUCT('DATE','','IN_N', '','IN_MEAN', 0.0,'IN_MIN', 0.0,'IN_MAX', 0.0,'IN_1', 0.0,'IN_99', 0.0,$
																	'SAT_N','','SAT_MEAN',0.0,'SAT_MIN',0.0,'SAT_MAX',0.0,'SAT_1',0.0,'SAT_99',0.0,$
																	'COR_N','','COR_MEAN',0.0,'COR_MIN',0.0,'COR_MAX',0.0,$
																	'COR_1',0.0,'COR_25',0.0,'COR_50',0.0,'COR_75',0.0,'COR_99',0.0)
		NEW = STRUCT_2MISSINGS(NEW)
		YEARS = ['1998','1999','2000','2001','2002','2003','2004','2005']
		MON = MONTH_NAMES([1,2,3,4,5,6,7,8,9,10,11,12],/SHORT)
		MONTHS = MONTH_NUMBER(MON)
		DATES = ['1998-2005',YEARS,MON]
		N = N_ELEMENTS(DATES)
		NEW = REPLICATE(NEW,N)
		NEW.DATE = DATES

		FOR NTH = 0L, N-1 DO BEGIN
			IF DATES[NTH] EQ '1998-2005' THEN BEGIN
				II = IN		& COUNTI = 1
				SS = SAT	& COUNTS = 1
				CC = COR 	& COUNTC = 1
			ENDIF	ELSE BEGIN
				IF DATES[NTH] GE 1998 THEN BEGIN
					OK = WHERE(IN.YEAR EQ DATES[NTH],COUNTI) 	& IF COUNTI GE 1 THEN II = IN[OK]
					OK = WHERE(SYEAR EQ DATES[NTH],COUNTS) 		& IF COUNTC GE 1 THEN SS = SAT[OK]
					OK = WHERE(CYEAR EQ DATES[NTH],COUNTC) 		& IF COUNTS GE 1 THEN CC = COR[OK]
				ENDIF
				IF DATES[NTH] LT 19 THEN BEGIN
					OK = WHERE(IN.MONTH EQ MONTH_NUMBER(DATES[NTH]),COUNTI) & IF COUNTI GE 1 THEN II = IN[OK]
					OK = WHERE(SMON EQ MONTH_NUMBER(DATES[NTH]),COUNTC) 		& IF COUNTC GE 1 THEN SS = SAT[OK]
					OK = WHERE(CMON EQ MONTH_NUMBER(DATES[NTH]),COUNTS) 		& IF COUNTS GE 1 THEN CC = COR[OK]
				ENDIF
			ENDELSE

			IF COUNTI GE 1 THEN BEGIN
				STAT = STATS(ALOG10(II.WT_CHL))
				PER = PERCENTILE(II.WT_CHL,PERCENT=[0.5,99.5])
				NEW[NTH].IN_N 		= STAT.N
				NEW[NTH].IN_MIN 	= 10^STAT.MIN
				NEW[NTH].IN_MAX 	= 10^STAT.MAX
				NEW[NTH].IN_MEAN 	= 10^STAT.MEAN
				NEW[NTH].IN_1 		= PER[0]
				NEW[NTH].IN_99 		= PER[1]
			ENDIF

			IF COUNTS GE 1 THEN BEGIN
				STAT = STATS(ALOG10(SS.MEAN))
				PER = PERCENTILE(SS.MEAN,PERCENT=[0.5,99.5])
				NEW[NTH].SAT_N 		= STAT.N
				NEW[NTH].SAT_MIN 	= 10^STAT.MIN
				NEW[NTH].SAT_MAX 	= 10^STAT.MAX
				NEW[NTH].SAT_MEAN = 10^STAT.MEAN
				NEW[NTH].SAT_1 		= PER[0]
				NEW[NTH].SAT_99 	= PER[1]
			ENDIF

			IF COUNTC GE 1 THEN BEGIN
				STAT = STATS(ALOG10(CC.MEAN))
				PER = PERCENTILE(CC.MEAN,PERCENT=[1,25,50,75,99])
				NEW[NTH].COR_N 		= STAT.N
				NEW[NTH].COR_MIN 	= 10^STAT.MIN
				NEW[NTH].COR_MAX 	= 10^STAT.MAX
				NEW[NTH].COR_MEAN = 10^STAT.MEAN
				NEW[NTH].COR_1 		= PER[0]
				NEW[NTH].COR_25		= PER[1]
				NEW[NTH].COR_50		= PER(2)
				NEW[NTH].COR_75		= PER(3)
				NEW[NTH].COR_99 	= PER(4)
			ENDIF
		ENDFOR

		SAVE, FILENAME=MAN1_TABLES, NEW, /COMPRESS
		SAVE_2CSV, MAN1_TABLES
STOP
		SKIP_TABLES:
	ENDIF

; *******************************************************
	IF DO_MAN1_FIGURES GE 1 THEN BEGIN
; *******************************************************
		OVERWRITE = DO_MAN1_FIGURES GE 2
		EXIST = FILE_TEST(MAN1_FIGURES)
		IF EXIST AND OVERWRITE EQ 0 THEN GOTO, SKIP_FINAL  ; >>>>>>>>>>>>>>>>>>>>>>>>>

		C = IDL_RESTORE(DATA_98_06)
		OK = WHERE(C.LOCATION NE 'HARBOR' AND C.LOCATION NE 'MOUTH' AND STRMID(C.GMT_DATE,0,4) GT 1997 AND STRMID(C.GMT_DATE,0,4) LT 2006)
		C = C[OK]
		E = IDL_RESTORE(ENV_DATA)
		D = IDL_RESTORE(SURF_DATA)
		CP = IDL_RESTORE(CHL_PROFILES)
		SAT = IDL_RESTORE(SAT_DATA)
		ECHL = IDL_RESTORE(CHL_EXTRACT)
		ECOR = IDL_RESTORE(COR_EXTRACT)
		SAT = SAT[SORT(SAT.GMT_DATE)]
;		STA = IDL_RESTORE(SAT_STATIONS)

		HPARAMS=[0,1,3,6]
		HYMARGIN = [1,1]
		HXMARGIN = [5,7]
		HCHARSIZE = 1.5
		BAR_COLOR = 31
		PARAMS = [3,4,8]
		CHARSIZE = 2
		XMARGIN = [5,2]
		YMARGIN = [1,1]
		SYM_COLOR = 32
		STATS_CHARSIZE = 1.5
		SYMSIZE = 1.25
		REG_THICK = 12
		THICK = 2
		FONT = 0
	;	CIR = CIRCLE(0,0,1,49)
	;	USERSYM, CIR(0,*),CIR(1,*),THICK=3,/FILL
		CIRCLE,32, COLOR=32
		PSYM = 8
		ONE_COLOR = 0
		ONE_THICK = 5
		ONE_LINESTYLE = 2
		X = DATE_2JD([19980101,20040101])
		AX = DATE_AXIS(X,/MONTH)
		X2 = DATE_2JD([20200101,20210101])
		AX2 = DATE_AXIS(X2, /FYEAR)
		AY = [0.01,60]
		AYR = DATE_AXIS(X,/YEAR)
		CTICKNAME = ['0.01','0.1','1','10','100']

		PSPRINT,FILENAME=MAN1_FIGURES,/COLOR,/Full,/TIMES
		!P.MULTI=[0,1,2]

;		X 			= [2.45,2.45,3.96,6.12,4.56,1.26,1.12]			; Chlorophyll
;		Y 			= [0,1.14,4.12,7.88,12.28,17.71,28.08]*(-1)	; Depth
;		Z 			= -10.5																			; Z90 depth
;		ZZ 			= -29.68																		; Euphotic depth
;		STRUCT= CHL_Z90(DEPTH=Y*(-1), CHL=X, KD_Z90=(-1/Z), Z_90=Z_90,ERROR=error)
;		ST, STRUCT
;		W 			= STRUCT.WCHL																; Weighted chlorophyll
;		XRANGE 	= [0,10]
;		YRANGE 	= [-35,0]
;		PLOT, X,Y,XRANGE=XRANGE,YRANGE=YRANGE,XSTYLE=XSTYLE,XTITLE='Chlorophyll !8a!7 (mg m!E-3!N)',YTITLE='Depth (m)',/NODATA,CHARSIZE=CHARSIZE,XMARGIN=XMARGIN, YMARGIN=YMARGIN
;		OPLOT,X,Y,PSYM=-8,COLOR=TC(32), THICK = 7, SYMSIZE = 2
;	  OPLOT,XRANGE,[ZZ,ZZ],LINESTYLE=0, THICK = 10, COLOR = TC[0]
;	  OPLOT,XRANGE,[Z,Z],LINESTYLE=3, THICK = 10, COLOR = TC[0]
;	  OPLOT,[W,W],[0.0,Z],LINESTYLE=2,COLOR=TC[0],THICK=10
;		LABEL = 'Euphotic Depth'
;		coor = COORD_2PLOT(0.67,0.27)
;		XYOUTS, COOR.X,COOR.Y ,LABEL,/DATA,ALIGN=0.0, COLOR=TC[0],CHARSIZE=1.75
;		LABEL = 'Z!D90!N'
;		COOR = COORD_2PLOT(0.82,0.76)
;		XYOUTS, COOR.X,COOR.Y ,LABEL,/DATA,ALIGN=0.0, COLOR=TC[0],CHARSIZE=1.75
;		LABEL = 'Weighted !CChlorophyll !8a!7 !C= ' + STRMID(STRTRIM(STRUCT.WCHL,2),0,4) + ' (mg m!E-3!N)'
;		COOR = COORD_2PLOT(0.045,0.87)
;		XYOUTS, COOR.X,COOR.Y ,LABEL,/DATA,ALIGN=0.0, COLOR=TC[0],CHARSIZE=1.75
;		FIGURE = 'Figure 2'
;		FIGSIZE = 1.5
;		FIGCOOR = COORD_2PLOT(-0.1,1.08)
;;		XYOUTS, FIGCOOR.X,FIGCOOR.Y,FIGURE,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=FIGSIZE

		!P.MULTI=[0,3,4]

		OK = WHERE(ECOR.MEAN NE MISSINGS(0.0) AND ECOR.N GE 11,COUNT)
		CORDATA = ECOR[OK] & FC = PARSE_IT(CORDATA.FIRST_NAME,/ALL) & CDATE = JD_2DATE(PERIOD_2JD(FC.PERIOD))
		MON = STRMID(CDATE,4,2)
		B = WHERE_SETS(MON)
		FOR NTH=0L, N_ELEMENTS(B)-1 DO BEGIN
			AMON = B[NTH].VALUE
			SUBS = WHERE_SETS_SUBS(B[NTH])
			SET  = CORDATA(SUBS)
			HISTPLOT,ALOG10(SET.MEAN),PARAMS=HPARAMS,DECIMALS=2,OMIN=OMIN,MIN=-2,MAX=2,OMAX=OMAX, BINSIZE=0.1,BAR_COLOR=BAR_COLOR,yticks=10,$;/STATS_NONE, $
				COLOR=0,CUM_THICK=3,XSTYLE=5,XRANGE=[-2,2],YRANGE=[0,240], TITLE=' ', YTITLE=' ',grids_thick=1.25,grids_color=31,grids_linestyle=1,/bar_opaque,CUM_CHARSIZE=HCHARSIZE, XMARGIN=HXMARGIN, YMARGIN=HYMARGIN, CHARSIZE=HCHARSIZE
				AXIS,XAXIS=0,/XLOG, XRANGE=[0.01,100], CHARSIZE=HCHARSIZE,XTICKNAME=CTICKNAME, XTITLE=' '
				AXIS,XAXIS=1,/XLOG, XRANGE=[0.01,100], CHARSIZE=HCHARSIZE,XTICKNAME=[' ',' ',' ',' ',' ']
			FIGURE = MONTH_NAMES(AMON,/SHORT)
			FIGCOOR = COORD_2PLOT(0.05,0.5)
			XYOUTS, FIGCOOR.X,FIGCOOR.Y,FIGURE,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=FIGSIZE
		ENDFOR

		!P.MULTI=[0,1,2]
		OK = WHERE(C.CHLA NE MISSINGS(0.0) AND C.CHLA GE 0.001,COUNT)
		HISTPLOT,ALOG10(C[OK].CHLA),PARAMS=HPARAMS,OMIN=OMIN,MIN=-2,MAX=2,OMAX=OMAX, BINSIZE=0.1,BAR_COLOR=BAR_COLOR,yticks=10,$;/STATS_NONE, $
			/STATS_NONE,COLOR=0,CUM_THICK=3,XSTYLE=5,XRANGE=[-2,2],YRANGE=[0,600], TITLE=' ', YTITLE='Frequency',grids_thick=1.25,grids_color=31,grids_linestyle=1,/bar_opaque,CUM_CHARSIZE=HCHARSIZE, XMARGIN=HXMARGIN, YMARGIN=HYMARGIN, CHARSIZE=HCHARSIZE
			AXIS,XAXIS=0,/XLOG, XRANGE=[0.01,100], CHARSIZE=HCHARSIZE,XTICKNAME=CTICKNAME, XTITLE='Chlorophyll !8a!7 (mg m!E-3!N)'
			AXIS,XAXIS=1,/XLOG, XRANGE=[0.01,100], CHARSIZE=HCHARSIZE,XTICKNAME=[' ',' ',' ',' ',' ']
		FIGURE = 'Figure 3'
		FIGCOOR = COORD_2PLOT(-0.1,1.06)
	;	XYOUTS, FIGCOOR.X,FIGCOOR.Y,FIGURE,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=FIGSIZE
PRINT, 10^(MEAN(ALOG10(C[OK].CHLA)))

;		!P.MULTI=[0,1,2]
;		OK = WHERE(CP.CHL_MAX_POS EQ 'SUB_MAX' AND CP.CHL_MAX GT CP.SURF_CHL)
;		HISTPLOT,CP[OK].RATIO,PARAMS=HPARAMS,OMIN=OMIN,MIN=1,MAX=5, CHARSIZE=HCHARSIZE,CUM_CHARSIZE=HCHARSIZE,OMAX=OMAX, BINSIZE=0.1,BAR_COLOR=BAR_COLOR,DECIMALS=2,yticks=10,XMARGIN=HXMARGIN,YMARGIN=HYMARGIN, $
;			CUM_THICK=3,XRANGE=[1,5],YRANGE=[0,120], YTITLE='Frequency', XTITLE='Maximum:Surface Chlorophyll Ratio', TITLE = '',grids_thick=1.25,grids_color=31,grids_linestyle=1,/bar_opaque;,/STATS_NONE
;		FIGURE = 'Figure 4'
;		FIGCOOR = COORD_2PLOT(-0.1,1.06)
;	;	XYOUTS, FIGCOOR.X,FIGCOOR.Y,FIGURE,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=FIGSIZE
;
;		!P.MULTI=[0,1,2]
;		OK = WHERE(D.SURF_CHL NE MISSINGS(0.0) AND D.SURF_CHL GT 0.001 AND D.WT_CHL GT 0.001 AND D.WT_CHL NE MISSINGS(0.0))
;		SCHL = D[OK].SURF_CHL
;		WCHL = D[OK].WT_CHL
;		PLOTXY, SCHL,WCHL,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,XMARGIN=[5,1],YMARGIN=YMARGIN,CHARSIZE=CHARSIZE,STATS_CHARSIZE=STATS_CHARSIZE,XTITLE='Surface Chlorophyll !8a!7 (mg m!E-3!N)',$;/STATS_NONE, $
;			YTITLE='Weighted Chlorophyll !8a!7 (mg m!E-3!N)',SYM_COLOR=SYM_COLOR,THICK=2,SYMSIZE=symsize,XRANGE=[0.01,100],YRANGE=[0.01,100],REG_COLOR=0,REG_THICK=9,/GRID_NONE,$
;			XTICKNAME=CTICKNAME,YTICKNAME=CTICKNAME,/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle
;		FIGURE = 'Figure 5'
;		FIGCOOR = COORD_2PLOT(-0.1,1.08)
;	;	XYOUTS, FIGCOOR.X,FIGCOOR.Y,FIGURE,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=FIGSIZE

;		!P.MULTI=[0,1,2]
;		OK = WHERE(SAT.CHLOR_A_MEAN NE MISSINGS(0.0) AND SAT.CHLOR_A_N GE 11 AND SAT.WT_CHL NE MISSINGS(0.0) AND SAT.CHLOR_A_MEAN GT 0.001 AND ABS(SAT.DELTA_T) LT 12)
;		HISTPLOT,ALOG10(SAT[OK].CHLOR_A_MEAN),PARAMS=HPARAMS,OMIN=OMIN,MIN=-2,MAX=2, CHARSIZE=HCHARSIZE,CUM_CHARSIZE=HCHARSIZE,OMAX=OMAX,BINSIZE=0.1,BAR_COLOR=BAR_COLOR,DECIMALS=2,yticks=10, $
;			CUM_THICK=3,XSTYLE=5,XRANGE=[-2,2],YRANGE=[0,100], YTITLE='Frequency',TITLE='',grids_thick=1.25,grids_color=31,grids_linestyle=1,/bar_opaque,XMARGIN=HXMARGIN,YMARGIN=HYMARGIN;,/STATS_NONE
;			AXIS,XAXIS=0,/XLOG, XRANGE=[0.01,100], CHARSIZE=CHARSIZE,XTICKNAME=[' ',' ',' ',' ',' '], XTITLE=' '
;			AXIS,XAXIS=1,/XLOG, XRANGE=[0.01,100], CHARSIZE=CHARSIZE,XTICKNAME=[' ',' ',' ',' ',' ']
;		LABEL = 'A'
;		COOR = COORD_2PLOT(0.925,0.925)
;		XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=2.5, COLOR=0, CHARTHICK=1
;		FIGURE = 'Figure 6'
;		FIGCOOR = COORD_2PLOT(-0.1,1.06)
;	;	XYOUTS, FIGCOOR.X,FIGCOOR.Y,FIGURE,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=FIGSIZE
;
;		OK = WHERE(FLOAT(ECHL.MEAN) NE MISSINGS(0.0) AND LONG(ECHL.N) GE 11 AND FLOAT(ECHL.MEAN) GT 0.001 AND ECHL.MEAN LT 100)
;		HISTPLOT,ALOG10(FLOAT(ECHL[OK].MEAN)),PARAMS=HPARAMS,OMIN=OMIN,MIN=-2,MAX=2,CHARSIZE=HCHARSIZE,CUM_CHARSIZE=HCHARSIZE,OMAX=OMAX,BINSIZE=0.1,BAR_COLOR=BAR_COLOR,DECIMALS=2,yticks=10, $
;			CUM_THICK=3,XSTYLE=5,XRANGE=[-2,2],YRANGE=[0,3000], YTITLE='Frequency',TITLE='',grids_thick=1.25,grids_color=31,grids_linestyle=1,/bar_opaque,XMARGIN=HXMARGIN,YMARGIN=HYMARGIN;,/STATS_NONE
;			AXIS,XAXIS=0,/XLOG, XRANGE=[0.01,100], CHARSIZE=CHARSIZE,XTICKNAME=CTICKNAME, XTITLE='SeaWiFS Chlorophyll !8a!7 (mg m!E-3!N)'
;			AXIS,XAXIS=1,/XLOG, XRANGE=[0.01,100], CHARSIZE=CHARSIZE,XTICKNAME=[' ',' ',' ',' ',' ']
;			LABEL = 'B'
;			COOR = COORD_2PLOT(0.945,0.9)
;			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=2.5, COLOR=0, CHARTHICK=1

;		!P.MULTI = [0,1,3]
;		CTICKNAME=['0.1','1','10','100']
;		OK = WHERE(SAT.CHLOR_A_MEAN NE MISSINGS(0.0) AND SAT.CHLOR_A_N GE 11 AND SAT.WT_CHL NE MISSINGS(0.0) AND SAT.WT_CHL GT 0.1)
;		TIME = SAT[OK].DELTA_T
;		SATC = SAT[OK].CHLOR_A_MEAN
;		CHL = SAT[OK].WT_CHL
;		OK = WHERE(ABS(TIME) LE 12, COUNT)
;		X12 = CHL[OK] & Y12 = SATC[OK] & N12 = COUNT
;		OK = WHERE(ABS(TIME) LE 24, COUNT)
;		X24 = CHL[OK] & Y24 = SATC[OK] & N24 = COUNT
;		OK = WHERE(ABS(TIME) LE 3, COUNT)
;		X3  = CHL[OK] & Y3  = SATC[OK] & N3  = COUNT
;
;		PLOTXY, X3,Y3,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,CHARSIZE=2.75,psym=psym,STATS_COLOR=0,XTITLE=' ', $
;			YTITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize, XRANGE=[0.1,100], YRANGE=[0.1,100],STATS_CHARSIZE=STATS_CHARSIZE,REG_COLOR=0, REG_THICK=REG_THICK,/GRID_NONE,XMARGIN=XMARGIN,YMARGIN=YMARGIN,$
;			XTICKNAME=CTICKNAME,YTICKNAME=CTICKNAME,/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle
;		TITLE = '+/- 3 HOURS'
;		COOR = COORD_2PLOT(0.72,0.1)
;		XYOUTS, COOR.X,COOR.Y,TITLE, ALIGN=-0.1, CHARSIZE=STATS_CHARSIZE, COLOR=0, CHARTHICK=1
;		LABEL = 'A'
;		COOR = COORD_2PLOT(0.945,0.87)
;		XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=2, COLOR=0, CHARTHICK=1
;		FIGURE = 'Figure 7'
;		FIGCOOR = COORD_2PLOT(-0.1,1.10)
;	;	XYOUTS, FIGCOOR.X,FIGCOOR.Y,FIGURE,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=FIGSIZE
;
;		TT = T_TEST_2SLOPES(X1=X3,Y1=Y3,X2=X24,Y2=Y24,ALPHA=0.01,SLOPE_P=SLOPE_P,INT_P=INT_P)
;		PLOTXY, X12,Y12,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,CHARSIZE=2.75,psym=psym,STATS_COLOR=0,XTITLE=' ', $
;			YTITLE='SeaWiFS Chlorophyll !8a!7 (mg m!E-3!N)',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,XRANGE=[0.1,100],YRANGE=[0.1,100],STATS_CHARSIZE=STATS_CHARSIZE,REG_COLOR=0,REG_THICK=REG_THICK,/GRID_NONE,XMARGIN=XMARGIN,YMARGIN=YMARGIN,$
;			XTICKNAME=CTICKNAME,YTICKNAME=CTICKNAME,/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle
;		TITLE = '+/- 12 HOURS'
;		COOR = COORD_2PLOT(0.72,0.1)
;		XYOUTS, COOR.X,COOR.Y,TITLE, ALIGN=-0.1, CHARSIZE=STATS_CHARSIZE, COLOR=0, CHARTHICK=1
;		TT = T_TEST_2SLOPES(X1=X12,Y1=Y12,X2=X24,Y2=Y24,ALPHA=0.05,SLOPE_P=SLOPE_P,INT_P=INT_P)
;		LABEL = 'B'
;		COOR = COORD_2PLOT(0.945,0.86)
;		XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=2, COLOR=0, CHARTHICK=1
;
;		PLOTXY, X24,Y24,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,CHARSIZE=2.75,psym=psym,STATS_COLOR=0,XTITLE='!8 in situ !7Chlorophyll !8a!7 (mg m!E-3!N)', $
;			YTITLE=' ',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize, XRANGE=[0.1,100], YRANGE=[0.1,100],STATS_CHARSIZE=STATS_CHARSIZE,REG_COLOR=0,REG_THICK=REG_THICK,/GRID_NONE,XMARGIN=XMARGIN,YMARGIN=YMARGIN,$
;			XTICKNAME=CTICKNAME,YTICKNAME=CTICKNAME,/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle
;		TITLE = '+/- 24 HOURS'
;		COOR = COORD_2PLOT(0.72,0.1)
;		XYOUTS, COOR.X,COOR.Y,TITLE, ALIGN=-0.1, CHARSIZE=STATS_CHARSIZE, COLOR=0, CHARTHICK=1
;		LABEL = 'C'
;		COOR = COORD_2PLOT(0.945,0.87)
;		XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=2, COLOR=0, CHARTHICK=1

		!P.MULTI=[0,1,2]
		CTICKNAME=['0.1','1','10','100']
		OK = WHERE(SAT.CHLOR_A_MEAN NE MISSINGS(0.0) AND SAT.CHLOR_A_N GE 11 AND SAT.WT_CHL NE MISSINGS(0.0) AND SAT.CHLOR_A_MEAN GT 0.1 AND SAT.WT_CHL GT 0.1 AND ABS(SAT.DELTA_T) LE 12 AND SAT.CHLOR_A_MEAN LT 64)
		SSAT = SAT[OK]
		SCHL = SAT[OK].CHLOR_A_MEAN
		CHL = SAT[OK].WT_CHL
		CIRCLE,32, COLOR=32,/fill
		PLOTXY, CHL,SCHL,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,CHARSIZE=CHARSIZE,psym=psym,REG_COLOR=0, REG_THICK=REG_THICK,XTITLE=' ', $
			YTITLE='SeaWiFS Chlorophyll !8a!7',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,THICK=THICK,XRANGE=[0.1,100], YRANGE=[0.1,100],/GRID_NONE,XMARGIN=XMARGIN,YMARGIN=YMARGIN,STATS_CHARSIZE=STATS_CHARSIZE,$
			XTICKNAME=CTICKNAME,YTICKNAME=CTICKNAME,/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle
		LABEL = 'A'
		COOR = COORD_2PLOT(0.945,0.9)
	;	XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=2.5, COLOR=0, CHARTHICK=1
		FIGURE = 'Figure 13'
		FIGCOOR = COORD_2PLOT(-0.1,1.08)
	;	XYOUTS, FIGCOOR.X,FIGCOOR.Y,FIGURE,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=1.5

		!P.MULTI=[0,1,2]
		OK = WHERE(D.SURF_TSS NE MISSINGS(0.0))
		HISTPLOT,D[OK].TSS,PARAMS=HPARAMS,OMIN=OMIN,MIN=0,MAX=5,CHARSIZE=HCHARSIZE,OMAX=OMAX, BINSIZE=0.1,BAR_COLOR=BAR_COLOR,DECIMALS=2,CUM_THICK=3,CUM_CHARSIZE=HCHARSIZE,yticks=10,xticks=5, $
			/STATS_NONE,XRANGE=[0,5],YRANGE=[0,100], TITLE=' ',YTITLE='Frequency',XTITLE='Total Suspended Solids (mg L!E-1!N)',grids_thick=1.25,grids_color=31,grids_linestyle=1,/bar_opaque,XMARGIN=HXMARGIN,YMARGIN=HYMARGIN;,/STATS_NONE
		FIGURE = 'Figure 9'
		FIGCOOR = COORD_2PLOT(-0.1,1.06)
	;	XYOUTS, FIGCOOR.X,FIGCOOR.Y,FIGURE,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=FIGSIZE

		!P.MULTI=[0,1,2]
		OK = WHERE(SAT.SURF_TSS GT 0 AND SAT.SURF_TSS NE MISSINGS(0.0) AND SAT.CHLOR_A_MEAN NE MISSINGS(0.0) AND SAT.CHLOR_A_N GE 11 AND SAT.WT_CHL NE MISSINGS(0.0) AND SAT.WT_CHL GT 0.1 AND ABS(SAT.DELTA_T) LT 12)
		;USERSYM, CIR(0,*),CIR(1,*),THICK=3
		CIRCLE,32, COLOR=32, FILL=0
		PLOTXY, SAT[OK].WT_CHL,SAT[OK].CHLOR_A_MEAN,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=CHARSIZE,STATS_COLOR=0,XTITLE='!8 in situ !7Chlorophyll !8a!7 (mg/m!E3!N)', $
			YTITLE='SeaWiFS Chlorophyll !8a!7 (mg m!E-3!N)',SYM_COLOR=32,SYMSIZE=SYMSIZE,THICK=THICK,XRANGE=[0.1,100],YRANGE=[0.1,100],STATS_CHARSIZE=STATS_CHARSIZE,REG_COLOR=0,REG_THICK=REG_THICK,/GRID_NONE,XMARGIN=XMARGIN,YMARGIN=YMARGIN,$
			XTICKNAME=CTICKNAME,YTICKNAME=CTICKNAME,/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle
		TITLE = 'TSS < 2 mg L!E-1!N'
		LEG,pos = [0.64,0.155,0.69,0.185], color=32,label=TITLE,THICK=THICK,PSYM=8,LSIZE=1.75,SYMSIZE=SYMSIZE, FONT=FONT
		TOK = WHERE(SAT.SURF_TSS GT 2 AND SAT.SURF_TSS NE MISSINGS(0.0) AND SAT.CHLOR_A_MEAN NE MISSINGS(0.0) AND SAT.CHLOR_A_N GE 11 AND SAT.WT_CHL NE MISSINGS(0.0) AND SAT.WT_CHL GT 0.1)
		;USERSYM, CIR(0,*),CIR(1,*),THICK=3,/FILL
		CIRCLE,32, COLOR=0,/fill
		OPLOT,SAT(TOK).WT_CHL,SAT(TOK).CHLOR_A_MEAN, COLOR=0, PSYM=8, SYMSIZE=SYMSIZE, THICK=THICK
		TITLE = 'TSS > 2 mg L!E-1!N'
		LEG,pos = [0.64,0.105,0.69,0.135], color=0,label=TITLE,THICK=THICK,PSYM=8,LSIZE=1.75,SYMSIZE=SYMSIZE, FONT=FONT
		TOK = WHERE(SAT.SURF_TSS LT 2 AND SAT.SURF_TSS NE MISSINGS(0.0) AND SAT.SURF_TSS GT 0 AND SAT.CHLOR_A_MEAN NE MISSINGS(0.0) AND SAT.CHLOR_A_N GE 11 AND SAT.WT_CHL NE MISSINGS(0.0) AND SAT.WT_CHL GT 0.1 AND ABS(SAT.DELTA_T) LT 12)
		TT = T_TEST_2SLOPES(X1=SAT[OK].WT_CHL,Y1=SAT[OK].CHLOR_A_MEAN,X2=SAT(TOK).WT_CHL,Y2=SAT(TOK).CHLOR_A_MEAN,ALPHA=0.2,SLOPE_P=SLOPE_P,INT_P=INT_P)
		FIGURE = 'Figure 10'
		FIGCOOR = COORD_2PLOT(-0.1,1.08)
	;	XYOUTS, FIGCOOR.X,FIGCOOR.Y,FIGURE,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=1.5


		!P.MULTI=[0,1,2]
; 	Plot the cumulative frequency of NLW_412 (see sd_stats_freq_plot.pro)
		NLW = 'F:\SEAWIFS_MLAC-MASS_BAY\stats_freq\!STUDY-SEAWIFS-REPRO5-MASS_BAY-NLW_412-FREQ.SAVE'
		AFREQ = STRUCT_SD_READ(NLW, STRUCT=STRUCT)
		OK=WHERE(AFREQ EQ MISSINGS(AFREQ),COUNT)
		IF COUNT GE 1 THEN AFREQ[OK]=0.0
		II_X = (IINDGEN()*STRUCT.FREQ_SLOPE) - STRUCT.FREQ_INTERCEPT
		BFREQ = DOUBLE(STRUCT.IMAGE)
		MAX_FREQ = MAX(BFREQ)
		OK = WHERE(BFREQ EQ MAX_FREQ)
		MODE = II_X(OK[0])
    CUM=cumulate(BFREQ)
   	MAX_CUM = MAX(CUM)
    CUM_NORM = CUM/MAX_CUM
    OK = WHERE(CUM_NORM GE 0.5)
    _MEDIAN = II_X(OK[0])
    _LOWER = 0.001
    _UPPER = 0.999
    OK = WHERE(CUM_NORM GE _LOWER AND CUM_NORM LT _UPPER)
    LOWER_RANGE = II_X(FIRST[OK]) & UPPER_RANGE = II_X(LAST[OK])
    OK_NEG = WHERE(II_X LE 0.0,COUNT_NEG) ; NEG
    PNEG = 0.0
    IF COUNT_NEG GE 1 THEN PNEG = 100.0*TOTAL(AFREQ(OK_NEG))/TOTAL(AFREQ)
    TXT_RANGE = '('+NUM2STR(LOWER_RANGE,FORMAT='(F7.3)')+' , '+NUM2STR(UPPER_RANGE,FORMAT='(F7.3)')+')'
    PROD_NAME = NICKNAME('NLW_412')
    FREQ_COLOR  = 6 & FREQ_LINESTYLE=0 & FREQ_THICK=14
    CUM_COLOR   = 22 & CUM_LINESTYLE=0  & CUM_THICK=12
		STR_RANGE= STRING(100*(_upper-_lower),FORMAT='(F4.1)')+'%'
    PLOT, II_X, CUM_NORM, XRANGE = [-1,2], $
      XTICKS=XTICKS,XTICKV=XTICKV,XTICKNAME=XTICKNAME,$
      XSTYLE=1,XMINOR=1,YSTYLE=5,YTICKS=5,YMINOR=1,$
      XTHICK=4,YTHICK=4,$
      XTITLE=UNITS('NLW_412'),/NODATA,$
      CHARSIZE=1.5,XMARGIN=[5,7], YMARGIN=YMARGIN
		AXIS, YAXIS=0,YMINOR= 1, YTITLE='Relative Frequency',YCHARSIZE=1.5
    AXIS, YAXIS=1,YMINOR= 1, YTITLE='Cumulative Frequency',YCHARSIZE=1.5

    OPLOT, II_X, SMOOTH(BFREQ/MAX_FREQ,11),COLOR=32,THICK=10
    OPLOT, II_X, SMOOTH(CUM_NORM,11),COLOR=0,THICK=10,LINESTYLE=5
    OPLOT, [0,0],[0,1], COLOR=33, LINESTYLE=1, THICK=8
    P=COORD_2PLOT(0.60,0.68)
   ;XYOUTS,P.X,P.Y,'Central '+STR_RANGE+'!C'+TXT_RANGE,CHARSIZE=1.5
    P=COORD_2PLOT(0.60,0.54)
   ;XYOUTS,P.X,P.Y,'Median = '+NUM2STR(_median,format='(f7.3)'),CHARSIZE=1.5
    P=COORD_2PLOT(0.60,0.48)
   ;XYOUTS,P.X,P.Y,'Mode =   '+NUM2STR(MODE,format='(f7.3)'),CHARSIZE=1.5

    P=COORD_2PLOT(0.60,0.42)
   ;XYOUTS,P.X,P.Y,'% Neg =   '+NUM2STR(PNEG,format='(f7.1)'),CHARSIZE=1.5




		!P.MULTI=[0,1,2]


		!P.MULTI	 			= [0,3,4]
		DXMARGIN	 			= [1.5,1.5]
		DYMARGIN 				= [1,1]
		ISOTROPIC		 		= 0
		PARAMS		 			= [3,4,8]
		PPP							= 12
		AXES						= [0,0,0,0]
		!Y.OMARGIN			= [6,2]
		!X.OMARGIN			= [6,6]
		YTITLE					= 'Percent Negative L!Dwn!N 412'
		XTITLE					= 'Chlorohyll !8a!7 (mg/m!E3!N)'
		PAL							= 'PAL_SW3'
		TOP_COLOR 			= 235
		MAG							= 16
		MEAN_SYMSIZE		= 70
		DECIMALS				= 2
		VMAX						= 200
		BIN1 = 0.05 & BIN2 = 2
		MIN_X = -1   & MIN_Y = 0
		MAX_X = 1    & MAX_Y = 100
		CTICKNAME = ['0.1','0.3','1','3','10']
		DIR_CHL = 'F:\SEAWIFS_MLAC-MASS_BAY\stats\!MONTH*CHLOR_A-OC4*-MEAN.SAVE';'D:/PROJECTS/MASS_BAY/SEAWIFS/MASS_BAY/MB_CHLOR_A/AVERAGE_DATA/*.SAVE'
		FILESC = FILE_SEARCH(DIR_CHL)
		FC = PARSE_IT(FILESC,/ALL)
		FILESC = FILESC[SORT(FC.MONTH_START)]
		DIR_412 = 'F:\SEAWIFS_MLAC-MASS_BAY\stats\!MONTH*NLW_412*-PNEG.SAVE'
		FILES4 = FILE_SEARCH(DIR_412)
		F4 = PARSE_IT(FILES4,/ALL)
		FILES4 = FILES4[SORT(F4.MONTH_START)]

		LSIZE = 1.5
		DCHARSIZE = 2
		DSTATS_CHARSIZE = 1.15
		LAB_POS = [0.01,0.03]
		COUNTER = 0
		PAL = 'PAL_SW3'
		SMO=4
		LOG_FREQ=1
		REG_COLOR=0
		REG_THICK2=5
		FOR NTH = 0L, N_ELEMENTS(FILESC)-1 DO BEGIN
			IF F4[NTH].MONTH_START NE FC[NTH].MONTH_START THEN STOP
			LABEL = STRUPCASE(MONTH_NAMES(FC[NTH].MONTH_START,/SHORT))

			XFILE = STRUCT_SD_READ(FILESC[NTH],STRUCT=STRUCTC, SUBS=SUBSC)
			YFILE = STRUCT_SD_READ(FILES4[NTH],STRUCT=STRUCT4, SUBS=SUBS4)

			OK = WHERE(XFILE NE MISSINGS(0.0) AND YFILE NE MISSINGS(0.0) AND YFILE GT 0,COUNT)
			IF COUNT LT 1 THEN STOP
			X = ALOG10(XFILE[OK])
			Y = YFILE[OK]*100

			IF COUNTER MOD PPP EQ 0 THEN $
				PLOT_HIST2D, X,Y, BIN1=BIN1,BIN2=BIN2,MAX_X=MAX_X,MAX_Y=MAX_Y, MIN_X=MIN_X, MIN_Y=MIN_Y,VMAX=VMAX,REG_COLOR=REG_COLOR,REG_THICK=REG_THICK2,$
					PAL=PAL,LAB_TXT=LABEL,LAB_POS=LAB_POS,LAB_CHARSIZE=LSIZE,XMARGIN=DXMARGIN,YMARGIN=DYMARGIN,STAT_PARAMS=PARAMS,$
					STATS_CHARSIZE=DSTATS_CHARSIZE,DECIMALS=DECIMALS,ISOTROPIC=ISOTROPIC,CHARSIZE=DCHARSIZE,/NO_TIMESTAMP,/PERCENT,$
					/ONE_NONE,/MEAN_NONE,/BAR_NONE,YTITLE=YTITLE,AXES=[0,1,1,0],XTICKNAME=CTICKNAME,/LOGX,SMO=SMO,XTICKS=4,LOG_FREQ=LOG_FREQ

			IF COUNTER MOD PPP EQ 1 THEN $
				PLOT_HIST2D, X,Y, BIN1=BIN1,BIN2=BIN2,MAX_X=MAX_X,MAX_Y=MAX_Y, MIN_X=MIN_X, MIN_Y=MIN_Y,VMAX=VMAX,REG_COLOR=REG_COLOR,REG_THICK=REG_THICK2,$
					PAL=PAL,LAB_TXT=LABEL,LAB_POS=LAB_POS,LAB_CHARSIZE=LSIZE,XMARGIN=DXMARGIN,YMARGIN=DYMARGIN,STAT_PARAMS=PARAMS,$
					STATS_CHARSIZE=DSTATS_CHARSIZE,DECIMALS=DECIMALS,ISOTROPIC=ISOTROPIC,CHARSIZE=DCHARSIZE,/NO_TIMESTAMP,/PERCENT,$
					/ONE_NONE,/MEAN_NONE,/BAR_NONE,AXES=[0,0,1,0],XTICKNAME=CTICKNAME,/LOGX,SMO=SMO,XTICKS=4,LOG_FREQ=LOG_FREQ

			IF COUNTER MOD PPP EQ 2 THEN $
				PLOT_HIST2D, X,Y, BIN1=BIN1,BIN2=BIN2,MAX_X=MAX_X,MAX_Y=MAX_Y, MIN_X=MIN_X, MIN_Y=MIN_Y,VMAX=VMAX,REG_COLOR=REG_COLOR,REG_THICK=REG_THICK2,$
					PAL=PAL,LAB_TXT=LABEL,LAB_POS=LAB_POS,LAB_CHARSIZE=LSIZE,XMARGIN=DXMARGIN,YMARGIN=DYMARGIN,STAT_PARAMS=PARAMS,$
					STATS_CHARSIZE=DSTATS_CHARSIZE,DECIMALS=DECIMALS,ISOTROPIC=ISOTROPIC,CHARSIZE=DCHARSIZE,/NO_TIMESTAMP,/PERCENT,$
					/ONE_NONE,/MEAN_NONE,/BAR_NONE,AXES=[0,0,1,1],XTICKNAME=CTICKNAME,/LOGX,SMO=SMO,XTICKS=4,LOG_FREQ=LOG_FREQ

			IF COUNTER MOD PPP EQ 3 OR COUNTER MOD PPP EQ 6 THEN $
				PLOT_HIST2D, X,Y, BIN1=BIN1,BIN2=BIN2,MAX_X=MAX_X,MAX_Y=MAX_Y, MIN_X=MIN_X, MIN_Y=MIN_Y,VMAX=VMAX,REG_COLOR=REG_COLOR,REG_THICK=REG_THICK2,$
					PAL=PAL,LAB_TXT=LABEL,LAB_POS=LAB_POS,LAB_CHARSIZE=LSIZE,XMARGIN=DXMARGIN,YMARGIN=DYMARGIN,STAT_PARAMS=PARAMS,$
					STATS_CHARSIZE=DSTATS_CHARSIZE,DECIMALS=DECIMALS,ISOTROPIC=ISOTROPIC,CHARSIZE=DCHARSIZE,/NO_TIMESTAMP,/PERCENT,$
					/ONE_NONE,/MEAN_NONE,/BAR_NONE,YTITLE=YTITLE,AXES=[0,1,0,0],XTICKV=ALOG10(CTICKNAME),/LOGX,SMO=SMO,XTICKS=4,LOG_FREQ=LOG_FREQ

			IF COUNTER MOD PPP EQ 4 OR COUNTER MOD PPP EQ 7 THEN $
				PLOT_HIST2D, X,Y, BIN1=BIN1,BIN2=BIN2,MAX_X=MAX_X,MAX_Y=MAX_Y, MIN_X=MIN_X, MIN_Y=MIN_Y,VMAX=VMAX,REG_COLOR=REG_COLOR,REG_THICK=REG_THICK2,$
					PAL=PAL,LAB_TXT=LABEL,LAB_POS=LAB_POS,LAB_CHARSIZE=LSIZE,XMARGIN=DXMARGIN,YMARGIN=DYMARGIN,STAT_PARAMS=PARAMS,$
					STATS_CHARSIZE=DSTATS_CHARSIZE,DECIMALS=DECIMALS,ISOTROPIC=ISOTROPIC,CHARSIZE=DCHARSIZE,/NO_TIMESTAMP,/PERCENT,$
					/ONE_NONE,/MEAN_NONE,/BAR_NONE,AXES=[0,0,0,0],XTICKV=ALOG10(CTICKNAME),/LOGX,SMO=SMO,XTICKS=4,LOG_FREQ=LOG_FREQ

			IF COUNTER MOD PPP EQ 5 OR COUNTER MOD PPP EQ 8 THEN $
				PLOT_HIST2D, X,Y, BIN1=BIN1,BIN2=BIN2,MAX_X=MAX_X,MAX_Y=MAX_Y, MIN_X=MIN_X, MIN_Y=MIN_Y,VMAX=VMAX,REG_COLOR=REG_COLOR,REG_THICK=REG_THICK2,$
					PAL=PAL,LAB_TXT=LABEL,LAB_POS=LAB_POS,LAB_CHARSIZE=LSIZE,XMARGIN=DXMARGIN,YMARGIN=DYMARGIN,STAT_PARAMS=PARAMS,$
					STATS_CHARSIZE=DSTATS_CHARSIZE,DECIMALS=DECIMALS,ISOTROPIC=ISOTROPIC,CHARSIZE=DCHARSIZE,/NO_TIMESTAMP,/PERCENT,$
					/ONE_NONE,/MEAN_NONE,/BAR_NONE,AXES=[0,0,0,1],XTICKV=ALOG10(CTICKNAME),/LOGX,SMO=SMO,XTICKS=4,LOG_FREQ=LOG_FREQ

			IF COUNTER MOD PPP EQ 9 THEN $
				PLOT_HIST2D, X,Y, BIN1=BIN1,BIN2=BIN2,MAX_X=MAX_X,MAX_Y=MAX_Y, MIN_X=MIN_X, MIN_Y=MIN_Y,VMAX=VMAX,REG_COLOR=REG_COLOR,REG_THICK=REG_THICK2,$
					PAL=PAL,LAB_TXT=LABEL,LAB_POS=LAB_POS,LAB_CHARSIZE=LSIZE,XMARGIN=DXMARGIN,YMARGIN=DYMARGIN,STAT_PARAMS=PARAMS,$
					STATS_CHARSIZE=DSTATS_CHARSIZE,DECIMALS=DECIMALS,ISOTROPIC=ISOTROPIC,CHARSIZE=DCHARSIZE,/NO_TIMESTAMP,/PERCENT,$
					/ONE_NONE,/MEAN_NONE,/BAR_NONE,YTITLE=YTITLE,XTITLE=XTITLE,AXES=[1,1,0,0],XTICKNAME=CTICKNAME,/LOGX,SMO=SMO,XTICKS=4,LOG_FREQ=LOG_FREQ

			IF COUNTER MOD PPP EQ 10 THEN $
				PLOT_HIST2D, X,Y, BIN1=BIN1,BIN2=BIN2,MAX_X=MAX_X,MAX_Y=MAX_Y, MIN_X=MIN_X, MIN_Y=MIN_Y,VMAX=VMAX,REG_COLOR=REG_COLOR,REG_THICK=REG_THICK2,$
					PAL=PAL,LAB_TXT=LABEL,LAB_POS=LAB_POS,LAB_CHARSIZE=LSIZE,XMARGIN=DXMARGIN,YMARGIN=DYMARGIN,STAT_PARAMS=PARAMS,$
					STATS_CHARSIZE=DSTATS_CHARSIZE,DECIMALS=DECIMALS,ISOTROPIC=ISOTROPIC,CHARSIZE=DCHARSIZE,/NO_TIMESTAMP,/PERCENT,$
					/ONE_NONE,/MEAN_NONE,/HORIZONTAL,BAR_POS=[-1,-0.6,2,-0.45],BAR_TITLE='Percent Frequeny (%)',BAR_CHARSIZE=2.25,AXES=[0,0,0,0],/LOGX,SMO=SMO,XTICKS=4,LOG_FREQ=LOG_FREQ

			IF COUNTER MOD PPP EQ 11 THEN $
				PLOT_HIST2D, X,Y, BIN1=BIN1,BIN2=BIN2,MAX_X=MAX_X,MAX_Y=MAX_Y, MIN_X=MIN_X, MIN_Y=MIN_Y,VMAX=VMAX,REG_COLOR=REG_COLOR,REG_THICK=REG_THICK2,$
					PAL=PAL,LAB_TXT=LABEL,LAB_POS=LAB_POS,LAB_CHARSIZE=LSIZE,XMARGIN=DXMARGIN,YMARGIN=DYMARGIN,STAT_PARAMS=PARAMS,$
					STATS_CHARSIZE=DSTATS_CHARSIZE,DECIMALS=DECIMALS,ISOTROPIC=ISOTROPIC,CHARSIZE=DCHARSIZE,/NO_TIMESTAMP,/PERCENT,$
					/ONE_NONE,/MEAN_NONE,/BAR_NONE,XTITLE=XTITLE,AXES=[1,0,0,1],XTICKNAME=CTICKNAME,/LOGX,SMO=SMO,XTICKS=4,LOG_FREQ=LOG_FREQ

			COUNTER = COUNTER+1

		ENDFOR
;		COLORBAR,BOTTOM=1, NCOLORS=234, POSITION=[0.1, 0.13, 0.9, 0.145], MINRANGE=0,MAXRANGE=200,DIVISIONS=5, MINOR=1,charsize=1.85, TITLE='Relative Frequency'
		!Y.OMARGIN=0
		!X.OMARGIN=0
		PAL_36,r,g,b

;		!P.MULTI = [0,2,2]
;		OK = WHERE((SSAT.YEAR GE 1998 AND SSAT.YEAR LE 2000) OR (SSAT.YEAR EQ 2003 AND SSAT.MONTH EQ '02' OR SSAT.MONTH EQ '03'),COMPLEMENT=COMPLEMENT)
;		PLOTXY, CHL[OK],SCHL[OK],DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,CHARSIZE=CHARSIZE,psym=psym,REG_COLOR=0, REG_THICK=REG_THICK,XTITLE=' ', $
;			YTITLE='SeaWiFS Chlorophyll !8a!7',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,THICK=THICK,XRANGE=[0.1,100], YRANGE=[0.1,100],/GRID_NONE,XMARGIN=XMARGIN,YMARGIN=YMARGIN,STATS_CHARSIZE=STATS_CHARSIZE,$
;			XTICKNAME=CTICKNAME,YTICKNAME=CTICKNAME,/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle
;		PLOTXY, CHL(COMPLEMENT),SCHL(COMPLEMENT),DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,CHARSIZE=CHARSIZE,psym=psym,REG_COLOR=0, REG_THICK=REG_THICK,XTITLE=' ', $
;			YTITLE='SeaWiFS Chlorophyll !8a!7',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,THICK=THICK,XRANGE=[0.1,100], YRANGE=[0.1,100],/GRID_NONE,XMARGIN=XMARGIN,YMARGIN=YMARGIN,STATS_CHARSIZE=STATS_CHARSIZE,$
;			XTICKNAME=CTICKNAME,YTICKNAME=CTICKNAME,/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle
;		TT = T_TEST_2SLOPES(ALPHA=0.05,X1=ALOG10(CHL),Y1=ALOG10(SCHL),X2=ALOG10(SSAT(COMPLEMENT).WT_CHL),Y2=ALOG10(SSAT(COMPLEMENT).CHLOR_A_MEAN),SLOPE_P=SLOPE_P,INT_P=INT_P)
;
;		PLOTXY, CHL[OK],CSAT[OK],DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,CHARSIZE=CHARSIZE,psym=psym,REG_COLOR=0, REG_THICK=REG_THICK,XTITLE=' ', $
;			YTITLE='SeaWiFS Chlorophyll !8a!7',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,THICK=THICK,XRANGE=[0.1,100], YRANGE=[0.1,100],/GRID_NONE,XMARGIN=XMARGIN,YMARGIN=YMARGIN,STATS_CHARSIZE=STATS_CHARSIZE,$
;			XTICKNAME=CTICKNAME,YTICKNAME=CTICKNAME,/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle
;		PLOTXY, CHL(COMPLEMENT),CSAT(COMPLEMENT),DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,CHARSIZE=CHARSIZE,psym=psym,REG_COLOR=0, REG_THICK=REG_THICK,XTITLE=' ', $
;			YTITLE='SeaWiFS Chlorophyll !8a!7',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,THICK=THICK,XRANGE=[0.1,100], YRANGE=[0.1,100],/GRID_NONE,XMARGIN=XMARGIN,YMARGIN=YMARGIN,STATS_CHARSIZE=STATS_CHARSIZE,$
;			XTICKNAME=CTICKNAME,YTICKNAME=CTICKNAME,/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle


		!P.MULTI=[0,1,2]
		CTICKNAME=['0.1','1','10','100']
		OK = WHERE(SAT.CHLOR_A_MEAN NE MISSINGS(0.0) AND SAT.CHLOR_A_N GE 11 AND SAT.WT_CHL NE MISSINGS(0.0) AND SAT.CHLOR_A_MEAN GT 0.1 AND SAT.WT_CHL GT 0.1 AND ABS(SAT.DELTA_T) LE 12 AND SAT.CHLOR_A_MEAN LT 64)

		SCHL = SAT[OK].CHLOR_A_MEAN
		CHL = SAT[OK].WT_CHL
		CIRCLE,32, COLOR=32,/fill
		STAT = STATS2(ALOG10(CHL),ALOG10(SCHL),MODEL='RMA')
		SLOPE = STAT.SLOPE
		INT = STAT.INT
		CSAT = 10^((ALOG10(SCHL)-INT)/SLOPE)

		PLOTXY, CHL,CSAT,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,CHARSIZE=CHARSIZE,psym=psym,STATS_COLOR=0,XTITLE='!8 in situ !7Chlorophyll !8a!7 (mg m!E-3!N)', $
			YTITLE='Corrected SeaWiFS Chlorophyll !8a!7',SYM_COLOR=SYM_COLOR,SYMSIZE=symsize,THICK=THICK,XRANGE=[0.1,100], YRANGE=[0.1,100],STATS_CHARSIZE=STATS_CHARSIZE,REG_COLOR=0,REG_THICK=REG_THICK,/GRID_NONE,XMARGIN=XMARGIN,YMARGIN=YMARGIN,$
			XTICKNAME=CTICKNAME,YTICKNAME=CTICKNAME,/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle
		LABEL = 'B'
		COOR = COORD_2PLOT(0.945,0.9)
	;	XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=2.5, COLOR=0, CHARTHICK=1


;		YTITLE='SeaWiFS Chlorophyll !8a!7'
;		XTITLE='!8 in situ !7Chlorophyll !8a!7 (mg m!E-3!N)'
;		!P.MULTI = [0,2,3]
;		STATION = 'N04'
;		OK = WHERE(SAT.WT_CHL NE MISSINGS(0.0) AND SAT.WT_CHL GT 0.1 AND SAT.CHLOR_A_MEAN NE MISSINGS(0.0) AND SAT.CHLOR_A_N GE 11 AND SAT.CHLOR_A_MEAN GT 0.01 AND SAT.STATION EQ STATION AND SAT.DELTA_T LE 12)
;		SET4 = SAT[OK]
;		CHL = SET4.WT_CHL
;		CSAT = SET4.CHLOR_A_MEAN
;		COR = SET4.CHLOR_A_MB_MEAN
;		STATION = 'N18'
;		OK = WHERE(SAT.WT_CHL NE MISSINGS(0.0) AND SAT.WT_CHL GT 0.1 AND SAT.CHLOR_A_MEAN NE MISSINGS(0.0) AND SAT.CHLOR_A_N GE 11 AND SAT.CHLOR_A_MEAN GT 0.01 AND SAT.STATION EQ STATION AND SAT.DELTA_T LE 12)
;		SET8 = SAT[OK]
;		CHL8 = SET8.WT_CHL
;		CSAT8 = SET8.CHLOR_A_MEAN
;		COR8 = SET8.CHLOR_A_MB_MEAN

;		PLOTXY, CHL,CSAT,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=3,STATS_COLOR=0,XTITLE=' ',XMARGIN=[4,2],YMARGIN=YMARGIN, $
;			YTITLE=YTITLE,SYM_COLOR=SYM_COLOR,THICK=THICK,SYMSIZE=SYMSIZE,XRANGE=[0.1,100],YRANGE=[0.1,100],STATS_CHARSIZE=1.25,REG_COLOR=0,REG_THICK=REG_THICK,/GRID_NONE,$
;			XTICKNAME=CTICKNAME,YTICKNAME=CTICKNAME,/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle
;		TITLE = 'N04'
;		COOR = COORD_2PLOT(0.77,0.1)
;		XYOUTS, COOR.X,COOR.Y,TITLE, ALIGN=-0.1, CHARSIZE=2, COLOR=0, CHARTHICK=1.25
;		LABEL = 'A'
;		COOR = COORD_2PLOT(0.9,0.86)
;		XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=2, COLOR=0, CHARTHICK=1
;		FIGURE = 'Figure 14'
;		FIGCOOR = COORD_2PLOT(-0.1,1.10)
;		XYOUTS,FIGCOOR.X,FIGCOOR.Y,FIGURE,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=FIGSIZE
;
;		PLOTXY, CHL8,CSAT8,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=3,STATS_COLOR=0,XTITLE=' ',XMARGIN=[4,2],YMARGIN=YMARGIN, $
;			YTITLE=' ',SYM_COLOR=SYM_COLOR,THICK=THICK,SYMSIZE=SYMSIZE,XRANGE=[0.1,100],YRANGE=[0.1,100],STATS_CHARSIZE=1.25,REG_COLOR=0,REG_THICK=REG_THICK,/GRID_NONE,$
;			XTICKNAME=CTICKNAME,YTICKNAME=CTICKNAME,/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle
;		TITLE = STATION
;		COOR = COORD_2PLOT(0.77,0.1)
;		XYOUTS, COOR.X,COOR.Y,TITLE, ALIGN=-0.1, CHARSIZE=2, COLOR=0, CHARTHICK=1.25
;		LABEL = 'B'
;		COOR = COORD_2PLOT(0.9,0.86)
;		XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=2, COLOR=0, CHARTHICK=1
;
;		PLOTXY, CHL,COR,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=3,STATS_COLOR=0,XMARGIN=[4,2],YMARGIN=YMARGIN,XTITLE=XTITLE,$
;			YTITLE='Corrected ' + YTITLE,SYM_COLOR=SYM_COLOR,THICK=THICK,SYMSIZE=SYMSIZE,XRANGE=[0.1,100],YRANGE=[0.1,100],STATS_CHARSIZE=1.25,REG_COLOR=0,REG_THICK=REG_THICK,/GRID_NONE,$
;			XTICKNAME=CTICKNAME,YTICKNAME=CTICKNAME,/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle
;		TITLE = 'N04'
;		COOR = COORD_2PLOT(0.77,0.1)
;		XYOUTS, COOR.X,COOR.Y,TITLE, ALIGN=-0.1, CHARSIZE=2, COLOR=0, CHARTHICK=1.25
;		LABEL = 'C'
;		COOR = COORD_2PLOT(0.9,0.86)
;		XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=2, COLOR=0, CHARTHICK=1
;
;		PLOTXY, CHL8,COR8,DECIMALS=3,/LOGLOG,/QUIET,MODEL='RMA',PARAMS=PARAMS,psym=psym,CHARSIZE=3,STATS_COLOR=0,XMARGIN=[4,2],YMARGIN=YMARGIN,XTITLE=XTITLE,$
;			YTITLE=' ',SYM_COLOR=SYM_COLOR,THICK=THICK,SYMSIZE=SYMSIZE,XRANGE=[0.1,100],YRANGE=[0.1,100],STATS_CHARSIZE=1.25,REG_COLOR=0,REG_THICK=REG_THICK,/GRID_NONE,$
;			XTICKNAME=CTICKNAME,YTICKNAME=CTICKNAME,/ONE2ONE,ONE_COLOR=one_color,ONE_THICK=one_thick, ONE_LINESTYLE=one_linestyle
;		TITLE = STATION
;		COOR = COORD_2PLOT(0.77,0.1)
;		XYOUTS, COOR.X,COOR.Y,TITLE, ALIGN=-0.1, CHARSIZE=2, COLOR=0, CHARTHICK=1.25
;		LABEL = 'D'
;		COOR = COORD_2PLOT(0.9,0.86)
;		XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=2, COLOR=0, CHARTHICK=1

		XTICKNAME = REPLICATE(' ',N_ELEMENTS(AX.TICKNAME))
		COLORS = [0,31]
		THICKS = [3,3]
 		SYMS = [-8,-2]
 		LINES = [0,0]
 		LCOLOR = [0,0]
 		BOX = [36,0,2]
 		LEG_POS = [0.02 ,0.81,0.06,0.89]
 		STATION = 'N04'
 		OK = WHERE(D.STATION EQ STATION AND D.SURF_CHL NE MISSINGS(0.0) AND D.SURF_CHL GT 0.1)
 		DSET = D[OK]
;		!P.MULTI=[0,1,4]

		CHL 	= DSET.SURF_CHL
		CDATE = DATE_2JD(DSET.GMT_DATE) &	SRT 	= SORT(CDATE) & CDATE = CDATE(SRT) & CHL = CHL(SRT)

;		OK = WHERE(ECHL.SUBAREA_NAME EQ STATION AND ECHL.MEAN NE MISSINGS(0.0) AND ECHL.N GE 11)
;		CSAT = ECHL[OK].MEAN
;		FA = PARSE_IT(ECHL[OK].FIRST_NAME,/ALL)
;		PERIOD = FA.PERIOD
;		SDATE = PERIOD_2JD(PERIOD) & SRT = SORT(SDATE) & SDATE = SDATE(SRT) & CSAT = CSAT(SRT)

		OK = WHERE(ECOR.SUBAREA_NAME EQ STATION AND ECOR.MEAN NE MISSINGS(0.0) AND ECOR.N GE 11)
		COR = ECOR[OK].MEAN
		FA = PARSE_IT(ECOR[OK].FIRST_NAME,/ALL)
		PERIOD = FA.PERIOD
		SDATE2 = PERIOD_2JD(PERIOD) & SRT = SORT(SDATE2) & SDATE2 = SDATE2(SRT) & COR = COR(SRT)

		!P.MULTI=[0,1,28]
		DATES = DATE_2JD([19980101,20040101])
		AX = DATE_AXIS(DATES,/MONTH)
		AYR = DATE_AXIS(DATES,/YEAR)
		XTICKNAME = REPLICATE(' ',N_ELEMENTS(AX.TICKNAME))
		MAXDEPTH = 1
		DEPTHS = 3
		CDEPTH = REPLICATE(0.5,N_ELEMENTS(CDATE))
		SDEPTH = REPLICATE(0.5,N_ELEMENTS(SDATE2))
		ND = N_ELEMENTS(DEPTHS)
		YRANGE = [-MAXDEPTH,0]
		MINDATE = 19980101000000
		MAXDATE = 20040101000000
		AX2 = DATE_AXIS([MINDATE,MAXDATE], /MONTH)
		X2TICKNAME = REPLICATE(' ',N_ELEMENTS(AX2.TICKNAME))
		YTICKNAMES=[' ',' ',' ']
		TXMARGIN=[5.8,6.94]
		TYMARGIN = [0.4,0.4]
		CHARSIZE = 2.5

		MAXDEPTH = 1
		DEPTHS = 3
		ND = N_ELEMENTS(DEPTHS)
		YRANGE = [-MAXDEPTH,0]
		MINDATE = 20200101000000
		MAXDATE = 20210101000000
		VRANGE=[0.1,30]
		AX2 = DATE_AXIS([MINDATE,MAXDATE], /FYEAR)
		X2TICKNAME = REPLICATE(' ',N_ELEMENTS(AX2.TICKNAME))
		PAL_SW3 ,R,G,B
		YTICKNAMES=[' ',' ',' ']
		CHARSIZE = 2
		CCHARSIZE = 1.25
		XMARGIN = [5.8,6.9]
		PLOT,AX2.JD,[0,1],YSTYLE=1,XMARGIN=XMARGIN,YMARGIN=[0,0],YTICKS=1,YMINOR=0,YTICKNAME=YTICKNAMES,XTICKNAME=X2TICKNAME,/NODATA,CHARSIZE=CHARSIZE
		FIGURE = 'Figure 16'
		FIGCOOR = COORD_2PLOT(-0.01,1.4)
;		XYOUTS, FIGCOOR.X,FIGCOOR.Y,FIGURE,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=FIGSIZE
		LABEL = '!8  In situ!7 Chlorophyll !8a!7 (mg m!E-3!N)'
		LABEL2 = 'A'
		CDATE = STRMID(JD_2DATE(CDATE),0,8) + '000000'
		SDATE = STRMID(JD_2DATE(SDATE2),0,8) + '000000'
		COOR = COORD_2PLOT(-0.05,0.3)
		XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=CCHARSIZE, COLOR=0, CHARTHICK=1
		COOR = COORD_2PLOT(0.95,0.3)
		XYOUTS, COOR.X,COOR.Y,LABEL2, ALIGN=-0.1, CHARSIZE=CCHARSIZE, COLOR=0, CHARTHICK=1
		YEARS = ['1998','1999','2000','2001','2002','2003','2004','2005']
		CDOY = DATE_2DOY(CDATE)
		CYDATE = YDOY_2DATE('2020',CDOY)
		USERSYM,[-0.4,0,0.4],[0,-0.6,0],THICK=2
		FOR YTH = 0L, N_ELEMENTS(YEARS)-1 DO BEGIN
			OK = WHERE(STRMID(CDATE,0,4) EQ YEARS(YTH))
			PAL_SW3 ,R,G,B
			TIME_DEPTH_GRID,CYDATE[OK],CDEPTH[OK],CHL[OK],/LOG,DEPTH_INTERVAL=0.5,MDATE=[MINDATE,MAXDATE],MDEPTH=[MAXDEPTH,0],VRANGE=VRANGE,CUTOFF=[1,0],YTICKS=1,YTICKNAME=[' ',' ',' '],$
				XTICKLENTH=-0.3,/NODEPTH,DIMENSIONS=[500,50],AX_INTERVAL='MONTH',AY_GRID='YEAR',/FYEAR,YTITLE=' ',YMARGIN=[0,0],XMARGIN=TXMARGIN,CHARSIZE=CHARSIZE,/INTERPOLATE,YMINOR=0,/NOXDATES
			PAL_36,r,g,b
			LABEL = YEARS(YTH)
			COOR = COORD_2PLOT(-0.08,0.3)
			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1
			OPLOT,DATE_2DOY(CYDATE[OK]),REPLICATE(0,N_ELEMENTS(OK)),COLOR=32,PSYM=8,SYMSIZE=1.5
		ENDFOR

		PLOT,AX2.JD,[0,1],YSTYLE=1,XMARGIN=XMARGIN,YMARGIN=[0,0],YTICKS=1,YMINOR=0,YTICKNAME=YTICKNAMES,XTICKNAME=X2TICKNAME,/NODATA,CHARSIZE=CHARSIZE
		LABEL = ' Corrected SeaWiFS Chlorophyll !8a!7 (mg m!E-3!N)'
		LABEL2 = 'B'
		COOR = COORD_2PLOT(-0.05,0.3)
		XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=CCHARSIZE, COLOR=0, CHARTHICK=1
		COOR = COORD_2PLOT(0.95,0.3)
		XYOUTS, COOR.X,COOR.Y,LABEL2, ALIGN=-0.1, CHARSIZE=CCHARSIZE, COLOR=0, CHARTHICK=1
		SDOY = DATE_2DOY(SDATE)
		SYDATE = YDOY_2DATE('2020',SDOY)

		FOR YTH = 0L, N_ELEMENTS(YEARS)-1 DO BEGIN
			OK = WHERE(STRMID(SDATE,0,4) EQ YEARS(YTH))
			PAL_SW3 ,R,G,B
			IF YTH LT N_ELEMENTS(YEARS)-1 THEN $
				TIME_DEPTH_GRID,SYDATE[OK],SDEPTH[OK],COR[OK],/LOG,DEPTH_INTERVAL=0.5,MDATE=[MINDATE,MAXDATE],MDEPTH=[MAXDEPTH,0],VRANGE=VRANGE,CUTOFF=[1,0],YTICKS=1,YTICKNAME=[' ',' ',' '],$
					/NODEPTH,DIMENSIONS=[500,50],AX_INTERVAL='MONTH',AY_GRID='YEAR',/FYEAR,YTITLE=' ',YMARGIN=[0,0],XMARGIN=TXMARGIN,CHARSIZE=CHARSIZE,/INTERPOLATE,YMINOR=0,/NOXDATES $
			ELSE $
				TIME_DEPTH_GRID,SYDATE[OK],SDEPTH[OK],COR[OK],/LOG,DEPTH_INTERVAL=0.5,MDATE=[MINDATE,MAXDATE],MDEPTH=[MAXDEPTH,0],VRANGE=VRANGE,CUTOFF=[1,0],YTICKS=1,YTICKNAME=[' ',' ',' '],$
					/NODEPTH,DIMENSIONS=[500,50],AX_INTERVAL='MONTH',AY_GRID='YEAR',/FYEAR,YTITLE=' ',YMARGIN=[0,0],XMARGIN=TXMARGIN,CHARSIZE=CHARSIZE,/INTERPOLATE,YMINOR=0
			PAL_36,r,g,b
			LABEL = YEARS(YTH)
			COOR = COORD_2PLOT(-0.08,0.3)
			XYOUTS, COOR.X,COOR.Y,LABEL, ALIGN=-0.1, CHARSIZE=1.25, COLOR=0, CHARTHICK=1
			OPLOT,DATE_2DOY(SYDATE[OK]),REPLICATE(0,N_ELEMENTS(OK)),COLOR=31,PSYM=8,SYMSIZE=1.5
		ENDFOR
		TICKNAMES = ['0.1','0.3','1','3','10','30']
		TICKV	= [0.1,0.3,1,3,10,30]
		PAL_SW3 ,R,G,B

		BAR=COLOR_BAR_SCALE(POSITION=[0.94, 0.35, 0.965, 0.998],PAL='PAL_SW3',CHARSIZE=2.25,MINVAL=ALOG10(0.1),MAXVAL=ALOG10(30),MINCOLOR=1,MAXCOLOR=250,YTICKS=5,/YLOG,YTICKV=[0.1,0.3,1,3,10,30],YTICKNAME=['0.1','0.3','1','3','10','30'],/VERTICAL)

	PAL_36,r,g,b

	PSPRINT

stop

	SKIP_FINAL:
	ENDIF


; *******************************************************
	IF DO_SEA_COMP GE 1 THEN BEGIN
; *******************************************************
		OVERWRITE = DO_SEA_COMP GE 2
		EXIST = FILE_TEST('D:\PROJECTS\MASS_BAY\PLOT\SEAWIFS_COR_CHL_MON_BY_YEAR_COMPOSITE.PNG')
		IF EXIST AND OVERWRITE EQ 0 THEN GOTO, SKIP_SEA_COMP  ; >>>>>>>>>>>>>>>>>>>>>>>>>

		PAL_SW3,R,G,B
;
;;	MAKE BLANK IMAGE TO CREATE A PLACE HOLDER
;		IM = BYTARR(640,640)
;		IM(*,*) = 255
		BLANK = 'D:\IDL\Images\BLANK_640_BY_640_IMAGE.PNG'
;		WRITE_PNG,BLANK, IM, R,G,B
;
		PAL = 'PAL_SW3'
		BACKGROUND = 255
		SPACE = 20
		PX = 160
		PY = 160
		!P.FONT = 0
		FIGSIZE = 1.5


		FILE1 = FILE_SEARCH('E:\SEAWIFS_MLAC-MASS_BAY\stats\!STUDY*-SEAWIFS-REPRO5-MASS_BAY-NLW_412-PNEG.SAVE')
		FILE2 = FILE_SEARCH('E:\SEAWIFS_MLAC-MASS_BAY\stats\!MONTH*-SEAWIFS-REPRO5-MASS_BAY-NLW_412-PNEG.SAVE')
		DIR_OUT='D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT1\'
;		STRUCT_SD_2PNG,[FILE1,FILE2],DIR_OUT=DIR_OUT,/ADD_LAND,/ADD_COAST,MISS_COLOR=0,/OVERWRITE
		FILE1 = FILE_SEARCH(DIR_OUT+'!SS*-SEAWIFS-REPRO5-MASS_BAY-PXY_640_640-NLW_412-PNEG.PNG')
		FILE2 = FILE_SEARCH(DIR_OUT+'!MONTH*-SEAWIFS-REPRO5-MASS_BAY-PXY_640_640-NLW_412-PNEG.PNG')
		FILES = [BLANK,FILE1,BLANK,FILE2]
		ROWS = 6
		COLS = 3
		PNGFILE = 'D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT1\SEAWIFS_NEG_412_COMPOSITE.PNG'
;		IMAGE_WELD_PAGE,FILES=FILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=pngfile,SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM
		PSFILE = 'D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT1\SEAWIFS_NEG_412_COMPOSITE.PS'
		IMAGE = READ_PNG(PNGFILE,r,g,b)
		SZ=SIZE(IMAGE,/STRUCT)
		TRUE_COLOR  = SZ.N_DIMENSIONS EQ 3
  	PX_IMAGE = 1.0*SZ.DIMENSIONS(0+TRUE_COLOR)
  	PY_IMAGE = 1.0*SZ.DIMENSIONS(1+TRUE_COLOR)
;  ===> Postscript (idl) has 1000/cm resolution
;  	A 2400 pixel wide PCX or PNG file printed at 300dpi  will be 8 inches wide or 2.54cm*8
   	xsize = DOUBLE(2.54*(PX_IMAGE/300.))    &   ysize = DOUBLE(2.54*(PY_IMAGE/300.))
;  ===> Dimensions of postscript page
   	width = 20.5  &   height = 26.9  ; MAX SIZE
		xoffset = 3.5
    yoffset  = -0.5
    SCALE = 0.85
; ===> Set up the postscript device
    olddevice= !d.name  ; Get present graphics device
    SET_PLOT,'ps'
    DEVICE,FILENAME=psfile
		DEVICE, /PORTRAIT
		DEVICE,/COLOR
 		CALL_PROCEDURE,PAL,R,G,B
 		TVLCT,R,G,B
 		COLOR=1
		DEVICE,BITS_PER_PIXEL=8
    DEVICE, XOFFSET=xoffset, YOFFSET=yoffset, $
    XSIZE=xsize, YSIZE=ysize, $
    SCALE_FACTOR=scale
    TV,IMAGE, TRUE=TRUE_COLOR

		X = 0.01
		Y = 0.982
		IX = 0.337
		IY = 0.17
		CHARSIZE = 1.7
		XYOUTS,0.33,Y,'!71998-!C2005', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
		XYOUTS,X,Y-IY,'!7J', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
		XYOUTS,X+IX,Y-IY,'!7F', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
		XYOUTS,X+2*IX,Y-IY,'!7M', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
		XYOUTS,X,Y-(2*IY),'!7A', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
		XYOUTS,X+IX,Y-(2*IY),'!7M', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
		XYOUTS,X+2*IX,Y-(2*IY),'!7J', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
		XYOUTS,X,Y-(3*IY),'!7J', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
		XYOUTS,X+IX,Y-(3*IY),'!7A', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
		XYOUTS,X+2*IX,Y-(3*IY),'!7S', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
		XYOUTS,X,Y-(4*IY),'!7O', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
		XYOUTS,X+IX,Y-(4*IY),'!7N', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
		XYOUTS,X+2*IX,Y-(4*IY),'!7D', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1

		TITLE = '!7 Percent (%)'
		LEG=COLOR_BAR_SCALE(PROD='PERCENT',POSITION=[0.02, 0.12,0.98, 0.14],PAL='PAL_SW3',CHARSIZE=1.5,/BOTTOM,TITLE=TITLE,/NO_UNIT)
    DEVICE,/CLOSE
    SET_PLOT,olddevice

stop

		FILES = FILE_SEARCH('E:\SEAWIFS_MLAC-MASS_BAY\ratio\browse\*-PROB.PNG')
		FP = FILE_PARSE(FILES)
		FILES = REVERSE(FILES)
		ROWS = 2
		COLS = 3
		PNGFILE = 'D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT1\SEAWIFS_PERCENT_RATIOS_COMPOSITE.PNG'
	;	IMAGE_WELD_PAGE,FILES=FILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=pngfile,SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM
		PSFILE = 'D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT1\SEAWIFS_PERCENT_RATIOS_COMPOSITE.PS'
		IMAGE = READ_PNG(PNGFILE,r,g,b)
		SZ=SIZE(IMAGE,/STRUCT)
		TRUE_COLOR  = SZ.N_DIMENSIONS EQ 3
  	PX_IMAGE = 1.0*SZ.DIMENSIONS(0+TRUE_COLOR)
  	PY_IMAGE = 1.0*SZ.DIMENSIONS(1+TRUE_COLOR)
;  ===> Postscript (idl) has 1000/cm resolution
;  	A 2400 pixel wide PCX or PNG file printed at 300dpi  will be 8 inches wide or 2.54cm*8
   	xsize = DOUBLE(2.54*(PX_IMAGE/300.))    &   ysize = DOUBLE(2.54*(PY_IMAGE/300.))
;  ===> Dimensions of postscript page
   	HEIGHT = 20.5  &   WIDTH = 26.9
		xoffset = 0.25
  	yoffset = 27
    SCALE = 1.5

; ===> Set up the postscript device
    olddevice= !d.name  ; Get present graphics device
    SET_PLOT,'ps'
    DEVICE,FILENAME=psfile
		DEVICE, /LANDSCAPE
		DEVICE,/COLOR
 		CALL_PROCEDURE,PAL,R,G,B
 		TVLCT,R,G,B
 		COLOR=1
		DEVICE,BITS_PER_PIXEL=8
    DEVICE, XOFFSET=xoffset, YOFFSET=yoffset, $
    XSIZE=xsize, YSIZE=ysize, $
    SCALE_FACTOR=scale
    TV,IMAGE, TRUE=TRUE_COLOR

		X = -0.001
		Y = 0.96
		IX = 0.338
		IY = -0.257
		CHARSIZE = 0.85
		XYOUTS,X,Y,'!7 A!C510/555', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
		XYOUTS,X+IX,Y,'!7 B!C490/555', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
		XYOUTS,X+2*IX,Y,'!7 C!C443/555', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
		TITLE = '!7 Percent (%)'
		LEG=COLOR_BAR_SCALE(PROD='PERCENT',POSITION=[0.1, 0.45,0.9, 0.48],PAL='PAL_SW3',CHARSIZE=1,/BOTTOM,TITLE=TITLE,/NO_UNIT)
		FIGURE = 'Figure 12'
	;	XYOUTS,0,1.08,FIGURE,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=FIGSIZE
    DEVICE,/CLOSE
    SET_PLOT,olddevice


		ROWS = 2
		COLS = 2
		FILE1 = FILE_SEARCH('E:\SEAWIFS_MLAC-MASS_BAY\stats\!STUDY-SEAWIFS-REPRO5-MASS_BAY-CHLOR_A-MEAN.SAVE')
		FILE2 = FILE_SEARCH('E:\SEAWIFS_MLAC-MASS_BAY\stats\!STUDY-SEAWIFS-REPRO5-MASS_BAY-CHLOR_A_MB-MEAN.SAVE')
		DIR_OUT='D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT1\'
		FILES = [FILE1,FILE2]
		FOR NTH=0L, N_ELEMENTS(FILES)-1 DO BEGIN
			FA = PARSE_IT(FILES[NTH])
			IM=STRUCT_SD_CONTOUR(FILES[NTH], LEVELS=[1],C_COLOR=[0],C_THICK=3, MED=7,MISS_COLOR=0, SPECIAL_SCALE='HIGH',/ADD_LAND,/ADD_COASTM)
			PNG_FILE = DIR_OUT + FA.NAME + '-CONTOUR.PNG'
;			WRITE_PNG,PNG_FILE,IM,R,G,B
		ENDFOR
;		STRUCT_SD_2PNG,[FILE1,FILE2],DIR_OUT=DIR_OUT,/ADD_LAND,/ADD_COAST,MISS_COLOR=0,/OVERWRITE, SPECIAL_SCALE='HIGH'
		FILE1 = FILE_SEARCH(DIR_OUT+'!STUDY-SEAWIFS-REPRO5-MASS_BAY-PXY_640_640-CHLOR_A-MEAN.PNG')
		FILE2 = FILE_SEARCH(DIR_OUT+'!STUDY-SEAWIFS-REPRO5-MASS_BAY-PXY_640_640-CHLOR_A_MB-MEAN.PNG')
		FILES = [FILE1,FILE2]
		PNGFILE = 'D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT1\SEAWIFS_CHL.PNG'
		PSFILE = 'D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT1\SEAWIFS_CHL.PS'
;		IMAGE_WELD_PAGE,FILES=FILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=pngfile,SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM

		FILE1 = FILE_SEARCH(DIR_OUT+'!STUDY-SEAWIFS-REPRO5-MASS_BAY-CHLOR_A-MEAN-CONTOUR.PNG')
		FILE2 = FILE_SEARCH(DIR_OUT+'!STUDY-SEAWIFS-REPRO5-MASS_BAY-CHLOR_A_MB-MEAN-CONTOUR.PNG')
		CFILES = [FILE1,FILE2]
		CPNGFILE = 'D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT1\SEAWIFS_CHL-CONTOUR.PNG'
		CPSFILE = 'D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT1\SEAWIFS_CHL-CONTOUR.PS'
	;	IMAGE_WELD_PAGE,FILES=CFILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=cpngfile,SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM

		PSFILES = [PSFILE,CPSFILE]
		PNGFILES = [PNGFILE,CPNGFILE]

		FOR NTH=0L, N_ELEMENTS(PSFILES)-1 DO BEGIN
			IMAGE = READ_PNG(PNGFILES[NTH],r,g,b)
			SZ=SIZE(IMAGE,/STRUCT)
			TRUE_COLOR  = SZ.N_DIMENSIONS EQ 3
	  	PX_IMAGE = 1.0*SZ.DIMENSIONS(0+TRUE_COLOR)
	  	PY_IMAGE = 1.0*SZ.DIMENSIONS(1+TRUE_COLOR)
;  		===> Postscript (idl) has 1000/cm resolution
;  		A 2400 pixel wide PCX or PNG file printed at 300dpi  will be 8 inches wide or 2.54cm*8
   		xsize = DOUBLE(2.54*(PX_IMAGE/300.))    &   ysize = DOUBLE(2.54*(PY_IMAGE/300.))
;  		===> Dimensions of postscript page
	   	HEIGHT = 20.5  &   WIDTH = 26.9  ; MAX SIZE
			xoffset = -6
	  	yoffset = 25
	    SCALE = 2

; 		===> Set up the postscript device
	    olddevice= !d.name  ; Get present graphics device
	    SET_PLOT,'ps'
	    DEVICE,FILENAME=psfiles(nth)
			DEVICE, /LANDSCAPE
			DEVICE,/COLOR
	 		CALL_PROCEDURE,PAL,R,G,B
	 		TVLCT,R,G,B
	 		COLOR=1
			DEVICE,BITS_PER_PIXEL=8
	    DEVICE, XOFFSET=xoffset, YOFFSET=yoffset, $
	    XSIZE=xsize, YSIZE=ysize, $
	    SCALE_FACTOR=scale
	    TV,IMAGE, TRUE=TRUE_COLOR

			X = 0.001
			Y = 0.96
			IX = 0.5
			IY = -0.257
			CHARSIZE = 0.85
			XYOUTS,X,Y,'!7 A!CSeaWiFS', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+IX,Y,'!7  B!C Corrected!C SeaWiFS', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			TICKNAMES = ['0.1','0.2','0.4','0.7','1.4','2.7','5','10','20']
			TITLE = '!7 Chlorophyll !8a!7 ' + UNITS('CHLOR_A',/NO_NAME)
			LEG=COLOR_BAR_SCALE(PROD='CHLOR_A',POSITION=[0.1, 0.44,0.9, 0.47],PAL='PAL_SW3',CHARSIZE=0.75,/BOTTOM,TITLE=TITLE,/NO_UNIT, SPECIAL_SCALE='HIGH')

		;	XYOUTS,0.33,0.37,TITLE, ALIGN=-0.1, CHARSIZE=0.75, COLOR=0, CHARTHICK=1
			FIGURE = 'Figure 14'
		;	XYOUTS,0.01,1.04,FIGURE,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=FIGSIZE
	    DEVICE,/CLOSE
	    SET_PLOT,olddevice
	  ENDFOR


		FILE1 = FILE_SEARCH('E:\SEAWIFS_MLAC-MASS_BAY\stats\!MONTH*-SEAWIFS-REPRO5-MASS_BAY-CHLOR_A_MB-MEAN.SAVE')
		FILE2 = FILE_SEARCH('E:\SEAWIFS_MLAC-MASS_BAY\stats\!Y_*-SEAWIFS-REPRO5-MASS_BAY-CHLOR_A_MB-MEAN.SAVE')
		DIR_OUT='D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT1\'
		FILES = [FILE1,FILE2]
		FOR NTH=0L, N_ELEMENTS(FILES)-1 DO BEGIN
			FA = PARSE_IT(FILES[NTH])
			IM=STRUCT_SD_CONTOUR(FILES[NTH], LEVELS=[1],C_COLOR=[0],C_THICK=3, MED=7,MISS_COLOR=0, SPECIAL_SCALE='HIGH',/ADD_LAND,/ADD_COASTM)
			PNG_FILE = DIR_OUT + FA.NAME + '-CONTOUR.PNG'
		;	WRITE_PNG,PNG_FILE,IM,R,G,B
		ENDFOR
	;	STRUCT_SD_2PNG,[FILE1,FILE2],DIR_OUT=DIR_OUT,/ADD_LAND,/ADD_COAST,MISS_COLOR=0,/OVERWRITE, SPECIAL_SCALE='HIGH'
		FILE1 = FILE_SEARCH(DIR_OUT+'!MONTH_*-SEAWIFS-REPRO5-MASS_BAY-PXY_640_640-CHLOR_A_MB-MEAN.PNG')
		FILE2 = FILE_SEARCH(DIR_OUT+'!Y_*-SEAWIFS-REPRO5-MASS_BAY-PXY_640_640-CHLOR_A_MB-MEAN.PNG')
		FILES = [BLANK,FILE2(1:4),BLANK,BLANK,FILE2(5:8),BLANK,FILE1]
		CFILE1 = FILE_SEARCH(DIR_OUT+'!MONTH_*-SEAWIFS-REPRO5-MASS_BAY-CHLOR_A_MB-MEAN-CONTOUR.PNG')
		CFILE2 = FILE_SEARCH(DIR_OUT+'!Y_*-SEAWIFS-REPRO5-MASS_BAY-CHLOR_A_MB-MEAN-CONTOUR.PNG')
		CFILES = [BLANK,CFILE2(1:4),BLANK,BLANK,CFILE2(5:8),BLANK,CFILE1]
		ROWS = 5
		COLS = 6
		PNGFILE = 'D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT1\SEAWIFS_COR_CHL_COMPOSITE.PNG'
		PSFILE 	= 'D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT1\SEAWIFS_COR_CHL_COMPOSITE.PS'
	;	IMAGE_WELD_PAGE,FILES=FILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=pngfile,SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM
		CPNGFILE = 'D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT1\SEAWIFS_COR_CHL-CONTOUR_COMPOSITE.PNG'
		CPSFILE 	= 'D:\PROJECTS\MASS_BAY\PLOT\MANUSCRIPT1\SEAWIFS_COR_CHL-CONTOUR_COMPOSITE.PS'
	;	IMAGE_WELD_PAGE,FILES=CFILES,ROWS=ROWS,COLS=COLS,PAL=PAL,PNGFILE=cpngfile,SPACE=space,PX=px,py=py,BACKGROUND=BACKGROUND,/NOTRIM
		PSFILES = [PSFILE,CPSFILE]
		PNGFILES = [PNGFILE,CPNGFILE]
		FOR NTH=0L, N_ELEMENTS(PSFILES)-1 DO BEGIN
			IMAGE = READ_PNG(PNGFILES[NTH],r,g,b)
			SZ=SIZE(IMAGE,/STRUCT)
			TRUE_COLOR  = SZ.N_DIMENSIONS EQ 3
  		PX_IMAGE = 1.0*SZ.DIMENSIONS(0+TRUE_COLOR)
  		PY_IMAGE = 1.0*SZ.DIMENSIONS(1+TRUE_COLOR)
;  		===> Postscript (idl) has 1000/cm resolution
;  		A 2400 pixel wide PCX or PNG file printed at 300dpi  will be 8 inches wide or 2.54cm*8
   		xsize = DOUBLE(2.54*(PX_IMAGE/300.))    &   ysize = DOUBLE(2.54*(PY_IMAGE/300.))
;  		===> Dimensions of postscript page
   		HEIGHT = 20.5  &   WIDTH = 26.9  ; MAX SIZE
			xoffset = -1
	  	yoffset = 27
	    SCALE = 0.75

; 		===> Set up the postscript device
	    olddevice= !d.name  ; Get present graphics device
	    SET_PLOT,'ps'
	    DEVICE,FILENAME=PSFILES[NTH]
			DEVICE, /LANDSCAPE
			DEVICE,/COLOR
	 		CALL_PROCEDURE,PAL,R,G,B
	 		TVLCT,R,G,B
	 		COLOR=1
			DEVICE,BITS_PER_PIXEL=8
	    DEVICE, XOFFSET=xoffset, YOFFSET=yoffset, $
	    XSIZE=xsize, YSIZE=ysize, $
	    SCALE_FACTOR=scale
	    TV,IMAGE, TRUE=TRUE_COLOR

			X = 0.002
			Y = 0.97
			IX = 0.168
			IY = -0.203
			CHARSIZE = 1.7
			XYOUTS,X,Y+(2*IY),'!7J', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+IX,Y+(2*IY),'!7F', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+2*IX,Y+(2*IY),'!7M', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+3*IX,Y+(2*IY),'!7A', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+4*IX,Y+(2*IY),'!7M', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+5*IX,Y+(2*IY),'!7J', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X,Y+(3*IY),'!7J', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+IX,Y+(3*IY),'!7A', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+2*IX,Y+(3*IY),'!7S', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+3*IX,Y+(3*IY),'!7O', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+4*IX,Y+(3*IY),'!7N', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+5*IX,Y+(3*IY),'!7D', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			X = -0.003
			XYOUTS,X+1*IX,Y,'!71998', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+2*IX,Y,'!71999', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+3*IX,Y,'!72000', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+4*IX,Y,'!72001', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+1*IX,Y+1*IY,'!72002', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+2*IX,Y+1*IY,'!72003', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+3*IX,Y+1*IY,'!72004', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1
			XYOUTS,X+4*IX,Y+1*IY,'!72005', ALIGN=-0.1, CHARSIZE=CHARSIZE, COLOR=0, CHARTHICK=1


			TITLE = '!7 Chlorophyll !8a!7 ' + UNITS('CHLOR_A',/NO_NAME)
			LEG=COLOR_BAR_SCALE(PROD='CHLOR_A',POSITION=[0.1, 0.165,0.9, 0.185],PAL='PAL_SW3',CHARSIZE=1.5,/BOTTOM,TITLE=TITLE,/NO_UNIT, SPECIAL_SCALE='HIGH')
			FIGURE = 'Figure 15'
		;	XYOUTS,0,1.08,FIGURE,/DATA,ALIGN=0.0,COLOR=0,CHARSIZE=FIGSIZE

	    DEVICE,/CLOSE
	    SET_PLOT,olddevice
	  ENDFOR

		STOP
		SKIP_SEA_COMP:
	ENDIF


END; #####################  End of Routine ################################



