; $ID:	LOWESS_DEMO.PRO,	2020-07-01-12,	USER-KJWH	$

;#############################################################################
PRO LOWESS_DEMO
;
;+
; NAME:
;	LOWESS_DEMO  ZWIN
;
; PURPOSE:
;	DEMONSTRATES ROBUST SMOOTHING OF 1D DATA USING LOWESS
;

; DATA FROM:
;LOWESS NIST EXAMPLE: HTTP://WWW.ITL.NIST.GOV/DIV898/HANDBOOK/PMD/SECTION1/DEP/DEP144.HTM

; J.O'REILLY  MAY 1,2002
; AUG 18,2011,JOR ADDED ZWIN AND SLIDEW
; JUL 13,2014,JOR FORMATTING
;#############################################################################
;-
;***************************
ROUTINE_NAME = 'LOWESS_DEMO'
;***************************
;
; DISTANCE
 !P.MULTI=[0,3,2]
 PAL_36,R,G,B
 ;GOTO, CLEVELAND
; ************************************************************************************************************
; NIST EXAMPLE
 X =[0.5578196D,2.0217271,2.5773252,3.4140288,4.3014084,4.7448394,5.1073781,6.5411662,6.7216176,7.2600583]
 X =[X,8.1335874,9.1224379,11.9296663,12.3797674,13.2728619,14.2767453,15.3731026,15.6476637,18.5605355,18.5866354,18.7572812]

 Y = [18.63654D,103.49646,150.35391,190.51031,208.70115,213.71135,228.49353,233.55387,234.55054,223.89225]
 Y=  [Y,227.68339,223.91982,168.01999,164.9575,152.61107,160.78742,168.55567,152.42658,221.70702,222.6904,243.18828]

 Z_NIST=[20.593020000,107.160300000,139.767400000,174.263000000,207.233400000,216.661600000,220.544500000,229.860700000,229.834700000,229.43010000]
 Z_NIST=[Z_NIST,226.604500000,220.390400000,172.348000000,163.841700000,161.849000000,160.335100000,160.192000000,161.055600000,227.340000000,227.898500000,231.558600000]
 PSFILE = !S.IDL_TEMP + ROUTINE_NAME + '.PS'
PSPRINT,FILENAME = PSFILE,/COLOR& SETCOLOR,255,0& PAL_36& ERASE,31
 X=DOUBLE(X)
 Y=DOUBLE(Y)
	FRACTION = 0.33
  DEG = 0 ; BUT BOTH EXAMPLES USE DEG = 1
;STOP
 Z=LOWESS(X,Y,FRACTION=FRACTION, DEG=DEG, NOISE=NOISE, EXTEND=EXTEND)
 PLOT,X,Y,PSYM=1,SYMSIZE=3,TITLE='LOWESS NIST EXAMPLE',CHARSIZE = 1
 HELP,X,Y
 OPLOT,X,Z,COLOR=34, THICK=5
 OPLOT, X,Z_NIST,COLOR=26
 XYOUTS,.5,.5,  '  DEGREE= '+ NUM2STR(DEG),CHARSIZE = 0.75

 DEG = 1 ; BUT BOTH EXAMPLES USE DEG = 1

 Z=LOWESS(X,Y,FRACTION=FRACTION, DEG=DEG, NOISE=NOISE, EXTEND=EXTEND)
 PLOT,X,Y,PSYM=1,SYMSIZE=3,TITLE='LOWESS NIST EXAMPLE',CHARSIZE = 1
 HELP,X,Y
 OPLOT,X,Z,COLOR=34, THICK=5
 OPLOT, X,Z_NIST,COLOR=26
 XYOUTS,.5,.5,  '  DEGREE= '+ NUM2STR(DEG),CHARSIZE = 0.75

	DEG = 2
	Z=LOWESS(X,Y,FRACTION=FRACTION, DEG=DEG, NOISE=NOISE, EXTEND=EXTEND)
 PLOT,X,Y,PSYM=1,SYMSIZE=3,TITLE='LOWESS NIST EXAMPLE',CHARSIZE = 1
 HELP,X,Y
 OPLOT,X,Z,COLOR=34, THICK=5
 OPLOT, X,Z_NIST,COLOR=26
 XYOUTS,.5,.5,  '  DEGREE= '+ NUM2STR(DEG),CHARSIZE = 0.75
; |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||




CLEVELAND:
; *********************************************************************************************************
; ********** CLEVLAND EXAMPLE IN LOWESS.FOR

;   X VALUES:
;*          1  2  3  4  5  (10)6  8  10  12  14  50
;*
;*        Y VALUES:
;*           18  2  15  6  10  4  16  11  7  3  14  17  20  12  9  13  1  8  5  19
;*
;*
;*        YS VALUES WITH F = .25, NSTEPS = 0, DELTA = 0.0
;*         13.659  11.145  8.701  9.722  10.000  (10)11.300  13.000  6.440  5.596
;*           5.456  18.998
;*
;*        YS VALUES WITH F = .25, NSTEPS = 0 ,  DELTA = 3.0
;*          13.659  12.347  11.034  9.722  10.511  (10)11.300  13.000  6.440  5.596
;*            5.456  18.998
;*
;*        YS VALUES WITH F = .25, NSTEPS = 2, DELTA = 0.0
;*          14.811  12.115  8.984  9.676  10.000  (10)11.346  13.000  6.734  5.744
;*            5.415  18.998
;*

 X = [1,  2,  3,  4,  5,  REPLICATE(6,10),  8,  10,  12,  14,  50]
 Y = [18,  2,  15,  6,  10,  4,  16,  11,  7,  3,  14,  17,  20,  12,  9,  13,  1,  8,  5,  19]
 ; YS VALUES WITH F = .25, NSTEPS = 0, DELTA = 0.0
;*         13.659  11.145  8.701  9.722  10.000  (10)11.300  13.000  6.440  5.596
;*           5.456  18.998
 Z_CLEVELAND=[13.659,11.145,8.701,9.722,10.000, REPLICATE(11.3,10),13.000,6.440,5.596,5.456,18.998]

DEG = 0
 X=DOUBLE(X)
 Y=DOUBLE(Y)
  Z=LOWESS(X,Y,FRACTION=.25, DEG=DEG, NOISE=NOISE, EXTEND=0)
  PLOT,X,Y,PSYM=1,TITLE='CLEVELAND LOWESS EXAMPLE'
 	OPLOT,X,Z,COLOR=34, THICK=5
 	OPLOT, X,Z_CLEVELAND,COLOR=26
 	XYOUTS,.5,.5,  '  DEGREE= '+ NUM2STR(DEG),CHARSIZE = 0.75
 	XYOUTS,.5,.5,  '  DEGREE= '+ NUM2STR(DEG),CHARSIZE = 0.75
  PRINT, Z

DEG = 1
 X=DOUBLE(X)
 Y=DOUBLE(Y)
  Z=LOWESS(X,Y,FRACTION=.25, DEG=DEG, NOISE=NOISE, EXTEND=0)
  PLOT,X,Y,PSYM=1,TITLE='CLEVELAND LOWESS EXAMPLE'
 	OPLOT,X,Z,COLOR=34, THICK=5
 	OPLOT, X,Z_CLEVELAND,COLOR=26
 	XYOUTS,.5,.5,  '  DEGREE= '+ NUM2STR(DEG),CHARSIZE = 0.75
 	XYOUTS,.5,.5,  '  DEGREE= '+ NUM2STR(DEG),CHARSIZE = 0.75
  PRINT, Z


DEG=2
 Z=LOWESS(X,Y,FRACTION=.25, DEG=DEG, NOISE=NOISE, EXTEND=0)
  PLOT,X,Y,PSYM=1,TITLE='CLEVELAND LOWESS EXAMPLE',CHARSIZE = 1
 	OPLOT,X,Z,COLOR=34, THICK=5
 	OPLOT, X,Z_CLEVELAND,COLOR=26
 	XYOUTS,.5,.5,  '  DEGREE= '+ NUM2STR(DEG),CHARSIZE=0.7
 	XYOUTS,.5,.5,  '  DEGREE= '+ NUM2STR(DEG),CHARSIZE=0.7
  PRINT, Z

P
PSPRINT & PFILE,PSFILE
  !P.MULTI=[0]

DONE:

END
