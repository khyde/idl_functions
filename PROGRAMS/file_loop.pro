; $ID:	FILE_LOOP.PRO,	2020-06-30-17,	USER-KJWH	$
;+
;#############################################################################################################
	PRO FILE_LOOP,FILES,PROG,P3,P4,P5, NUM=NUM,VERBOSE=VERBOSE,_EXTRA=_EXTRA

; PURPOSE: LOOPS ON FILES PASSING EACH FILE  TO A PROGRAM VIA CALL_PROCEDURE
;
; CATEGORY:	FILE
;
; CALLING SEQUENCE: FILE_LOOP,FILES,PROG,P3,P4,P5,_EXTRA=_EXTRA
;
; INPUTS: 
;   FILES: FULL NAMES OF FILES TO PROCESS WITH PROG
;	   PROG: NAME OF THE IDL PROGRAM TO PROCESS THE FILES [ NO EXTENSION]
;	   P3  : ANY THIRD PARAMETER REQUIRED BY THE PROG
;	   P4  : ANY FOURTH PARAMETER REQUIRED BY THE PROG
;    P5  : ANY FIFTH PARAMETER REQUIRED BY THE PROG
;		
; OPTIONAL INPUTS:
;		_EXTRA:	USED TO PASS ANY KEYWORDS TO THE PROG 
;		
; KEYWORD PARAMETERS:
;		PROG: NAME OF PROGRAM TO USE TO PROCESS THE FILES [NO EXTENSION]
;   NUM : NUMBER OF FILES TO PROCESS
;   VERBOSE: PRINT STATUS REPORTS

; OUTPUTS: DEPENDS ON THE PROG
;		
; EXAMPLES: 
;    FILES = FILE_SEARCH('MAPS_*.PRO')& FILE_LOOP,FILES,'PRINT'
;    FILES = FILE_SEARCH('MAPS_*.PRO')&  FILE_LOOP,FILES,'PFILE',/X

;   
;   FILES = FLS('C:\SMI\STATS_PERIODS','A_*-OSTAM-2010_12-SMI-CHLOR_A-STATS.SAVE') 
;   FILE_LOOP,FILES,'PRODS_2PNG',DIR_OUT = !S.IDL_TEMP,/BUFFER 
;    
;    
; MODIFICATION HISTORY:
;			 MAR 29,2014 WRITTEN BY J.O'REILLY
;			 DEC 14,2014,JOR,ADDED NEW LOGICAL FUNCTIONS
;			 JAN 8,2015,JOR, ADDED P3,P4,P5
;		   JAN 11,2015,JOR, ADDED CASE
;			
;#################################################################################
;-
;***************************
ROUTINE_NAME  = 'FILE_LOOP'
;***************************

IF NONE(FILES) THEN MESSAGE,'FILES ARE REQUIRED'
IF NONE(PROG)  THEN MESSAGE,'PROG IS REQUIRED'
IF NONE(NUM) THEN NUM = N_ELEMENTS(FILES) ELSE NUM = 1 > NUM < (N_ELEMENTS(FILES))
;FFFFFFFFFFFFFFFFFFFFFFFFF
FOR NTH = 0,NUM-1 DO BEGIN
  FILE = FILES[NTH]
  CASE (N_PARAMS()) OF
    2: BEGIN
    CALL_PROCEDURE,PROG,FILE,_EXTRA=_EXTRA 
    END;2
    3: BEGIN
      CALL_PROCEDURE,PROG,P3,FILE,_EXTRA=_EXTRA
    END;3
    4: BEGIN
      CALL_PROCEDURE,PROG,P3,P4,FILE,_EXTRA=_EXTRA
    END;4
    5: BEGIN
      CALL_PROCEDURE,PROG,P3,P4,P5,FILE,_EXTRA=_EXTRA
    END;5
    ELSE: BEGIN
      MESSAGE,'ERROR: TOO MANY PARAMETERS'
    END
  ENDCASE
 ENDFOR;FOR NTH = 0,N_ELEMENTS(FILES)-1 DO BEGIN
;FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF

END; #####################  END OF ROUTINE ################################
