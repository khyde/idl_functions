; $ID:	STR_CAP.PRO,	2020-06-30-17,	USER-KJWH	$
;#############################################################
	FUNCTION STR_CAP, TEXT, ALL=ALL, DELIM=DELIM,DO_LOWER=DO_LOWER,DO_UPPER=DO_UPPER

;+
; NAME:
;		STR_CAP
;
; PURPOSE:;
;		THIS FUNCTION CAPITALIZES THE FIRST LETTER OF THE TEXT PROVIDED.
;
; CATEGORY:
;		STRING
;
; CALLING SEQUENCE:

;		RESULT = STR_CAP(TEXT)
;
; INPUTS:
;		TEXT:	STRING TYPE
;
;	KEYWORD PARAMETERS:
;		ALL: 	CAPITALIZE THE FIRST LETTER OF ALL WORDS ON EACH LINE OF INPUT TEXT
;		DELIM: DELIMITER FOR PARSING WORDS (DEFAULT IS SPACES)
;		DO_LOWER: PHRASES TO EXCLUDE[DO_LOWER]
;		ERROR: ERROR MESSAGE
;
; OUTPUTS:
;		STRING WITH THE FIRST LETTER UPPER CASE
;
; EXAMPLE:
;		===> Capitalize the first letter of the first word on each line of text
;   PRINT,STR_CAP(['hELLo gOODBY' , '   hELLO          gOODBY    '],DELIM= ' ')
;		===> Capitalize the first letter of all words on each line of text
;		PRINT,STR_CAP(['hELLo gOODBY' , '   hELLO          gOODBY    '],DELIM= ' ',/ALL)
;
;	NOTES:
;		A FUTURE IMPROVEMENT MIGHT BE TO PREVENT ANY CASE CHANGES TO RESTRICTED PHRASES SUCH AS '!C' USED IN
;		PLOTTING STRINGS VIA XYOUTS
;
;
; MODIFICATION HISTORY:
;			WRITTEN NOV 11, 2006 BY J.O'REILLY
;			MAY 21,2012,JOR, FORMATING,REMOVED KEYWORD ERROR
;			AUG 17,2014,JOR ADDED KEY DO_LOWER
;			
;#############################################################
;-
;	**********************
ROUTINE_NAME = 'STR_CAP'
; **********************
; ===> DEFAULTS TO DO_LOWER
IF NONE(DO_LOWER) THEN DO_LOWER = ['THE','OF']
IF NONE(DO_UPPER) THEN DO_UPPER = ['US']
;	===> DEFAULT DELIMITER FOR PARSING WORDS IS BLANK(S)
IF N_ELEMENTS(DELIM) NE 1 THEN _DELIM = ' ' ELSE _DELIM = DELIM
IF _DELIM EQ '' THEN _DELIM = ' '


TXT=TEXT
;	FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
	FOR NTH=0,N_ELEMENTS(TXT)-1L DO BEGIN
		T = STRSPLIT( TXT[NTH],_DELIM,/EXTRACT,/PRESERVE_NULL)

		OK=WHERE(STRLEN(T) GE 1,COUNT)
   
    

		IF COUNT GE 1 THEN BEGIN
		  T = T[OK]
			IF NOT KEYWORD_SET(ALL) THEN BEGIN
				T(OK[0]) = STRUPCASE(STRMID(T(OK[0]),0,1)) + STRLOWCASE(STRMID(T(OK[0]),1))
			ENDIF ELSE BEGIN
				T[OK] = STRUPCASE(STRMID(T[OK],0,1)) + STRLOWCASE(STRMID(T[OK],1))
			ENDELSE
		ENDIF
		;===> CHECK ON DO_LOWER
		T = STRSPLIT( TXT[NTH],_DELIM,/EXTRACT,/PRESERVE_NULL)		
		OK = WHERE_MATCH(T,DO_LOWER,COUNT)
		IF COUNT GE 1 THEN T[OK] =STRLOWCASE(T[OK])
		;===> CHECK ON DO_UPPER
		OK = WHERE_MATCH(T,DO_UPPER,COUNT)
		IF COUNT GE 1 THEN T[OK] =STRUPCASE(T[OK])
		
		IF N_ELEMENTS(T) EQ 1 THEN TXT[NTH] = T ELSE TXT[NTH] = STRJOIN(T+_DELIM)
	ENDFOR;FOR NTH=0,N_ELEMENTS(TXT)-1L DO BEGIN
;FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF	



RETURN, TXT



	END; #####################  END OF ROUTINE ################################
