; $ID:	WHERE_WORDS.PRO,	2020-06-30-17,	USER-KJWH	$
;#######################################################################
  FUNCTION WHERE_WORDS, TEXT , DELIM=DELIM , ORDER=ORDER
;+
; NAME:
;       WHERE_WORDS
;
; PURPOSE:
;       WORKS LIKE WHERE_SETS: IDENTIFIES UNIQUE WORDS FROM THE INPUT TEXT AND INDICATES THE LINES ON WHICH THESE WORDS APPEAR
;
;
; INPUTS:
;       TEXT
;
; KEYWORD PARAMETERS:
;				DELIM:	THE DELIMITER TO USE TO PARSE EACH LINE OF TEXT INTO WORDS E.G. '-' OR ';'
; OUTPUTS:
;       STRUCTURE WITH:
;								 	THE WORD,
;									THE NUMBER OF REPEATS, AND
;									THE SUBSCRIPTS (THE TEXT LINE # ) WHERE THE WORD OCCURS
;
; EXAMPLE:
;		ST,WHERE_WORDS(['CAT','DOG','CAT-DOG','MOUSE'])

; MODIFICATION HISTORY:
;       WRITTEN BY:  J.E.O'REILLY, JAN 4,2005
;       ???? KWJH,REMOVED RETURN, -1 TO BE COMPATIBLE WITH IDL 8.1 - MAY NOT BE COMPATIBLE WITH EALIER VERSIONS OF IDL
;  NOV 13,2014,JOR FORMATTING 

;-
;**************************
ROUTINE_NAME='WHERE_WORDS'
;**************************
	

	IF N_ELEMENTS(DELIM) EQ 0 THEN _DELIM = '-' ELSE _DELIM = DELIM

	W=WORDS(TEXT,LINE=LINE,DELIM=_DELIM)
  SETS = WHERE_SETS(W, ORDER=ORDER)

;	===> REMOVE THE SET WITH BLANKS SINCE THIS RESULTED FROM THE DELIMITER
	OK=WHERE(SETS.VALUE NE '',COUNT)
	IF COUNT GE 1 THEN 	SETS=SETS[OK] ELSE RETURN, []    


;	===> USE THE SUBS TO FIND THE CORRESPONDING LINES
	FOR NTH=0L,N_ELEMENTS(SETS)-1L DO BEGIN
		SUBS=WHERE_SETS_SUBS(SETS[NTH])
		SETS[NTH].SUBS = STRJOIN(STRTRIM(LINE(SUBS),2)+',')
		SETS[NTH].FIRST = LINE(SETS[NTH].FIRST)
	ENDFOR

	RETURN,SETS


  END; #####################  END OF ROUTINE ################################
