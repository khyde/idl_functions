; $ID:	LONLAT_2METERS.PRO,	2020-06-30-17,	USER-KJWH	$
;+
;;#############################################################################################################
	FUNCTION LONLAT_2METERS,LON0, LAT0, LON1, LAT1 

; PURPOSE: THIS FUNCTION COMPUTES THE DISTANCE IN METERS BETWEEN TWO LONLATS 
; 
; 
; CATEGORY:	LONLAT;		 
;
; CALLING SEQUENCE: RESULT = LONLAT_2METERS(VAR)
;
; INPUTS: LON0, LAT0, LON1, LAT1  
;                     LON1, LAT1  MAY BE ARRAYS 

; OPTIONAL INPUTS: NONE
;		
; KEYWORD PARAMETERS: NONE

; OUTPUTS: DISTANCE IN METERS BETWEEN THE TWO LONLATS
; USING THE CLARKE 1866 EQUATORIAL RADIUS OF THE EARTH.
;		
;; EXAMPLES:
;  PC, LONLAT_2METERS(-69, 0, -70, 0 ) & PRINT,'SHOULD BE: 111,320M'
;  PC, LONLAT_2METERS(0, 0.D, 180, 0 )& PRINT,'SHOULD BE 20,037,580 METERS
;  PC, LONLAT_2METERS(0, 0.D, [180,180,180], [0,0,0] )& PRINT,'SHOULD BE 20,037,580 METERS
;	NOTES-WIKIPEDIA:
;THE RADIUS OF THE SEMI-MAJOR AXIS OF THE EARTH AT THE EQUATOR IS 6,378,160.0 METERS[1] 
; RESULTING IN A CIRCUMFERENCE OF 40,075,161.2 METERS. 
; [IDLUSES THE  CLARKE 1866  ELIPSOID 
; MODIFICATION HISTORY:
;			WRITTEN OCT 1, 2014 J.O'REILLY
;#################################################################################
;-
;******************************
ROUTINE_NAME  = 'LONLAT_2METERS'
;******************************
IF N_ELEMENTS(LON1) NE N_ELEMENTS(LAT1) THEN MESSAGE,'ERROR:LON1,LAT1 NOT SAME SIZE'
METERS = REPLICATE(MISSINGS(0.0),N_ELEMENTS(LON1))

;FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
FOR NTH = 0L,N_ELEMENTS(LON1) -1L DO BEGIN
  METERS[NTH] = MAP_2POINTS(LON0, LAT0, LON1[NTH], LAT1[NTH] ,/METERS)  
ENDFOR;FOR NTH = 0L,N_ELEMENTS(LON1) -1L DO BEGIN
;FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
RETURN,METERS
          
	END; #####################  END OF ROUTINE ################################
