; $ID:	LOCATE_MAIN.PRO,	2020-07-08-15,	USER-KJWH	$
;#############################################################################################################
	PRO LOCATE_MAIN
	
;  PRO LOCATE_MAIN
;+
; NAME:
;		LOCATE_MAIN
;
; PURPOSE: THIS  IS A MAIN ROUTINE FOR MAKING THE LOCATE.CSV DATABASE OF KEY LOCATIONS USED BT TS_MAIN.PRO
;
; CATEGORY:
;		TIME SERIES
;
; CALLING SEQUENCE:LOCATE_MAIN
;
; INPUTS:
;		NONE 
;		
; OPTIONAL INPUTS:
;		NONE:	
;		
; KEYWORD PARAMETERS:
;		NONE:

; OUTPUTS: A CSV FILE AND MAPS SHOWING THE LOCATIONS OF SITES IN THE CSV FILE
;		
;
; MODIFICATION HISTORY:
;			WRITTEN MAY  19,2012  J.O'REILLY
;			MAY 20,2012,JOR : S=STATS(DATA,/ACTUAL)
;     MAY 23,2012,JOR, ADDED SMI_UPPER_RIGHT
;     MAR 12,2013,JOR, NECESSARY TO MASK DATA WITH LAND TO AVOID ERRONEOUS MINIMUM CHL XP,YP VALUES[OVER IBERIAN PININSULA?]:
                                            ;LANDMASK ='D:\IDL\IMAGES\MASK_LAND-SMI-PXY_4320_2160.PNG'
                                            ;S=READ_LANDMASK(LANDMASK,/STRUCT)
                                            ;DATA(S.LAND) = MISSINGS(DATA)
;     MAR 14,2013,JOR, ADDED LME_CODE LME_NAME TO CSV STRUCTURE
;     OCT 27,2013,JOR GET_PATH() ; GET_DIRS()

;			
;#################################################################################
;  READ
;
;-
;	*******************************************
ROUTINE_NAME='LOCATE_MAIN'
; *******************************************
;D:\  PAINT  LNP_DAN_PEAK
; GB_TMF PRINT EASTER dan_peak JMAX ENDFOR SWITCHES  RETURN  FONT    SMI_CEN  BERMUDA  STRUCT_2CSV
;===> RESTORE DIR FROM SMI_MAIN

;CCCCC     CONSTANTS     CCCCC
SMI_MAP = 'SMI' 
SMI_PX=4320
SMI_PY=2160
DIR = GET_DIRS()
CSVFILE = GET_PATH() + 'IDL\DATA\LOCATE.CSV'
LANDMASK_FILE =GET_PATH() + 'IDL\IMAGES\MASK_LAND-SMI-PXY_4320_2160.PNG'
S=READ_LANDMASK(LANDMASK_FILE,/STRUCT) & PFILE,LANDMASK_FILE,/R
FONT_HELVETICA

;CCCCC     CONSTANTS     CCCCC

DB =  READ_LME_DB()

;SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS  SWITCHES  SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS
DO_MAKE_CSV               = 2; 2= REMAKE CSVFILE
DO_ADD_MIN_CHLOR_A_2CSV   = 1
DO_ADD_DAN_PEAK_2CSV      = 1
DO_ADD_JMAX_CPY_2CSV      = 1
DO_ADD_CPYS_2CSV          = 1
DO_LONLATS_SITES          = 1
DO_EDIT_CSV               = 1
DO_PLOT_CSV               = 1
;SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS  SWITCHES  SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS



;***************************************************
IF DO_MAKE_CSV GE 1 THEN BEGIN
;***************************************************
OVERWRITE = DO_MAKE_CSV GE 2 
,'DO_MAKE_CSV'
IF DO_MAKE_CSV EQ 3 THEN STOP
IF FILE_TEST(CSVFILE) EQ 1 AND OVERWRITE EQ 0 THEN BEGIN
PRINT,'SKIPPING STEP DO_MAKE_CSV BECAUSE ' +CSVFILE +' ALREADY EXISTS'
GOTO,DONE
ENDIF;IF FILE_TEST(CSVFILE) EQ 1 AND OVERWRITE EQ 0 THEN BEGIN

CSV=CREATE_STRUCT( 'PANEL','', 'SITE','','TITLE','','EQUATION','','LABEL','','LME_CODE',0,'LME_NAME','',$
                    'PROD','','VALUE','','LON',MISSINGS(0.0),'LAT',MISSINGS(0.0),$
                    'MAP',SMI_MAP,'PX',SMI_PX,'PY',SMI_PY,$
                    'XP','','YP','',$
                    'XPAINT','','YPAINT','',$
                    'INFILE','')
                  
PFILE,CSVFILE
STRUCT_2CSV,CSVFILE,CSV                  
,'DO_MAKE_CSV'
ENDIF;IF DO_MAKE_CSV GE 1 THEN BEGIN
;|||||||||||||||||||||||||||||||||||;


;***************************************************
IF DO_ADD_MIN_CHLOR_A_2CSV GE 1 THEN BEGIN
;***************************************************
  ,'DO_ADD_MIN_CHLOR_A_2CSV'
  IF DO_ADD_MIN_CHLOR_A_2CSV EQ 3 THEN STOP
  CSV=CSV_READ(CSVFILE) & PFILE,CSVFILE,/R   
  TITLE = 'MINIMUM CHLOR_A'
  TARGET = '!ANNUAL*CHLOR_A-MEAN.SAVE'
  FILE =FILE_SEARCH(DIR.STATS_ALL,TARGET) &  PFILE,FILE,/X 
  DATA=STRUCT_SD_READ(FILE,STRUCT=STRUCT) & DATA(S.LAND) = MISSINGS(DATA) & SZ=SIZEXYZ(DATA) & PX=SZ.PX &  PY = SZ.PY
  VAL  = MIN(DATA,SUB,/NAN)& PRINT,TITLE +' :',VAL,DATA(SUB)
  XY= ARRAY_INDICES(DATA,SUB) & XP = XY[0] & YP = XY[1]
  
  ;===> ADD TO D  
  D=STRUCT_2MISSINGS(CSV[0])
  D.TITLE  = TITLE  
  D.MAP = SMI_MAP & D.PX = STRUCT.PX & D.PY = STRUCT.PY & FN = FILE_PARSE(FILE) & PROD =VALIDS('PRODS',FN.NAME)
  D.PROD      = PROD
  D.SITE      = 'CHLOR_A_MIN'
  D.EQUATION  = 'CHLOR_A_MIN'
  D.VALUE = VAL
  D.INFILE = FILE  
  LL=MAP_XYP_2LONLAT(SMI_MAP, PX=PX,PY=PY,XP=XP, YP=YP) & D.LON =LL.LON & D.LAT =LL.LAT
  CSV=STRUCT_CONCAT(CSV,D) 
  OK = WHERE(CSV.SITE NE '',COUNT) & IF COUNT GE 1 THEN CSV = CSV[OK]
  PFILE,CSVFILE & STRUCT_2CSV,CSVFILE,CSV 
  ,'DO_ADD_MIN_CHLOR_A_2CSV'
ENDIF;IF DO_ADD_MIN_CHLOR_A_2CSV GE 1 THEN BEGIN
;|||||||||||||||||||||||||||||||||||||||||||||||


;**************************************
IF DO_ADD_DAN_PEAK_2CSV GE 1 THEN BEGIN
;**************************************
   ,'DO_ADD_DAN_PEAK_2CSV'
   IF DO_ADD_DAN_PEAK_2CSV EQ 3 THEN STOP
   CSV=CSV_READ(CSVFILE) & PFILE,CSVFILE,/R   
  TITLE = 'LNP_DAN_PEAK'
  TARGET = '!STUDY*LNP_DAN_PEAK.SAVE'
  FILE =FILE_SEARCH(DIR.LNP,TARGET) &  PFILE,FILE,/X 
  DATA=STRUCT_SD_READ(FILE,STRUCT=STRUCT) & DATA(S.LAND) = MISSINGS(DATA) & SZ=SIZEXYZ(DATA) &PX=SZ.PX &  PY = SZ.PY
  VAL  = MAX(DATA,SUB,/NAN)& PRINT,TITLE +' :',VAL,DATA(SUB)
  XY= ARRAY_INDICES(DATA,SUB) & XP = XY[0] & YP = XY[1]
  
  ;===> ADD TO D
  D=STRUCT_2MISSINGS(CSV[0])
  D.TITLE  = TITLE    
  D.MAP = SMI_MAP & D.PX = STRUCT.PX & D.PY = STRUCT.PY & FN = FILE_PARSE(FILE) & PROD =VALIDS('PRODS',FN.NAME)
  D.PROD      = PROD  
  D.SITE      = 'LNP_DAN_PEAK'
  D.EQUATION  = 'LNP_DAN_PEAK'
  D.VALUE = VAL
  D.INFILE = FILE  
  LL =MAP_XYP_2LONLAT(  'SMI', PX=PX,PY=PY,XP=XP, YP=YP, ERROR=ERROR,PAINT=PAINT)
  D.LON = LL.LON & D.LAT = LL.LAT & D.XP = XP & D.YP = YP  
  CSV=STRUCT_CONCAT(CSV,D) & PFILE,CSVFILE & STRUCT_2CSV,CSVFILE,CSV 
  ,'DO_ADD_DAN_PEAK_2CSV'
  PFILE,CSVFILE  &  STRUCT_2CSV,CSVFILE,CSV 
  ,'DO_ADD_DAN_PEAK_2CSV'
ENDIF;IF DO_ADD_DAN_PEAK_2CSV GE 1 THEN BEGIN
;|||||||||||||||||||||||||||||||||||||||||||||||



;**************************************
IF DO_ADD_JMAX_CPY_2CSV GE 1 THEN BEGIN
;**************************************
   ,'DO_ADD_JMAX_CPY_2CSV'
   IF DO_ADD_JMAX_CPY_2CSV EQ 3 THEN STOP
   CSV=CSV_READ(CSVFILE) & PFILE,CSVFILE,/R   
  TITLE = 'LNP_JMAX_CPY' 
  TARGET = '!STUDY*LNP_JMAX_CPY.SAVE'
  FILE =FILE_SEARCH(DIR.LNP,TARGET) &  PFILE,FILE,/X 
  DATA=STRUCT_SD_READ(FILE,STRUCT=STRUCT) & DATA(S.LAND) = MISSINGS(DATA) & SZ=SIZEXYZ(DATA) &PX=SZ.PX &  PY = SZ.PY
  VAL  = MAX(DATA,SUB,/NAN)& PRINT,TITLE +' :',VAL,DATA(SUB)
  XY= ARRAY_INDICES(DATA,SUB) & XP = XY[0] & YP = XY[1]
  
  ;===> ADD TO D
  D=STRUCT_2MISSINGS(CSV[0])
  D.SITE  = TITLE &   D.TITLE=D.SITE & D.EQUATION = D.SITE   
  D.MAP = SMI_MAP & D.PX = STRUCT.PX & D.PY = STRUCT.PY & FN = FILE_PARSE(FILE) & PROD =VALIDS('PRODS',FN.NAME)
  D.PROD      = PROD  
  
  D.VALUE = VAL
  D.INFILE = FILE  
  LL =MAP_XYP_2LONLAT(  'SMI', PX=PX,PY=PY,XP=XP, YP=YP, ERROR=ERROR,PAINT=PAINT) 
  CSV=STRUCT_CONCAT(CSV,D) & PFILE,CSVFILE & STRUCT_2CSV,CSVFILE,CSV 
  ,'DO_ADD_DAN_PEAK_2CSV'
  PFILE,CSVFILE  &  STRUCT_2CSV,CSVFILE,CSV 
  ,'DO_ADD_JMAX_CPY_2CSV'
ENDIF;IF DO_ADD_JMAX_CPY_2CSV GE 1 THEN BEGIN
;|||||||||||||||||||||||||||||||||||||||||||||||

;***************************************************
IF DO_ADD_CPYS_2CSV GE 1 THEN BEGIN
;***************************************************
  ,'DO_ADD_CPYS_2CSV'
  IF DO_ADD_CPYS_2CSV EQ 3 THEN STOP
  CSV=CSV_READ(CSVFILE) & PFILE,CSVFILE,/R 
  PLINES,2
  TARGETS = '!STUDY*LNP_*' + 'CPY.SAVE'
  FILES =FILE_SEARCH(DIR.LNP,TARGETS) & FN=FILE_PARSE(FILES) & NAMES = FN.NAME & PRODS = VALIDS('PRODS',NAMES)
   CPYS= ['006','012', '025', '050','075', '1','2','3','4','5']
  ;FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
  FOR NTH = 0,N_ELEMENTS(CPYS)-1 DO BEGIN
    CPY = CPYS[NTH]
    PROD = PRODS[NTH]
 ;;   IF CPY EQ '1' THEN STOP
    OK = WHERE_STRING(NAMES,PROD,COUNT) & IF COUNT EQ 1 THEN FILE = FILES[OK] ELSE STOP
    TITLE= 'MAX ' + CPY+ 'CPY'
    IF FILE_TEST(FILE) EQ 0 THEN STOP ELSE PFILE,FILE,/X
    DATA=STRUCT_SD_READ(FILE,STRUCT=STRUCT) & DATA(S.LAND) = MISSINGS(DATA) & SZ=SIZEXYZ(DATA) &PX=SZ.PX &  PY = SZ.PY
    VAL  = MAX(DATA,SUB,/NAN)& PRINT,TITLE +' :',VAL,DATA(SUB)
    XY= ARRAY_INDICES(DATA,SUB) & XP = XY[0] & YP = XY[1]
   
    ;===> ADD TO D  
    D=STRUCT_2MISSINGS(CSV[0])
    PROD=STRUCT.PROD
    MAP=STRUCT.MAP
    PX=STRUCT.PX
    PY=STRUCT.PY
    D.TITLE  = TITLE  
    D.MAP = 'SMI' & D.PX = STRUCT.PX & D.PY = STRUCT.PY
    FN = FILE_PARSE(FILE) & PROD =VALIDS('PRODS',FN.NAME)
    D.PROD      = PROD
    D.SITE      = PROD
    D.EQUATION  = PROD    
    D.VALUE = VAL
    D.INFILE = FILE
    LL=MAP_XYP_2LONLAT(MAP, PX=PX,PY=PY,XP=XP, YP=YP) & D.LON =LL.LON & D.LAT =LL.LAT   
    CSV=STRUCT_CONCAT(CSV,D) & PFILE,CSVFILE & STRUCT_2CSV,CSVFILE,CSV 
  ENDFOR;FOR NTH = 0,N_ELEMENTS(CPYS)-1 DO BEGIN
  ;FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
  ,'DO_ADD_CPYS_2CSV'
ENDIF;IF DO_ADD_CPYS_2CSV GE 1 THEN BEGIN
;|||||||||||||||||||||||||||||||||||||||||||||||

;**********************************
IF DO_LONLATS_SITES GE 1 THEN BEGIN
;**********************************
  ,'DO_LONLATS_SITES'
  IF DO_LONLATS_SITES EQ 3 THEN STOP

  CSV=CSV_READ(CSVFILE) & PFILE,CSVFILE,/R  

 ;************************
 ;===> ADD SMI_UPPER_RIGHT
 ;************************
  D=STRUCT_2MISSINGS(CSV[0])
  D.SITE = 'SMI_UPPER_RIGHT'& D.EQUATION = D.SITE &   D.TITLE = D.SITE 
 
  D.PROD = 'CHLOR_A'
  D.INFILE = '' & D.MAP = SMI_MAP & D.PX = SMI_PX & D.PY = SMI_PY
  XP =PX-1
  YP =PY-1
  LL=MAP_XYP_2LONLAT( MAP, PX=PX,PY=PY,XP=XP, YP=YP)
  D.LON=LL.LON
  D.LAT=LL.LAT
  CSV=STRUCT_CONCAT(CSV,D)
  ;||||||||||||||||||||||||||||
 
;*******************
;===> ADD SMI_CENTER
;******************* 
  D=STRUCT_2MISSINGS(CSV[0])
  D.SITE = 'SMI_CENTER'& D.EQUATION = D.SITE &   D.TITLE = D.SITE 
  
  D.PROD = 'CHLOR_A'
  D.INFILE = '' & D.MAP = SMI_MAP & D.PX = SMI_PX & D.PY = SMI_PY
  D.LON =0.0
  D.LAT =0.0
  CSV=STRUCT_CONCAT(CSV,D)
  ;|||||||||||||||||||||||
 
 
;**************** 
;===> ADD BERMUDA
;**************** 
  D=STRUCT_2MISSINGS(CSV[0])
  D.INFILE = '' & D.MAP = SMI_MAP & D.PX = SMI_PX & D.PY = SMI_PY &   D.PROD = 'CHLOR_A'
  D.SITE = 'BERMUDA'& D.EQUATION = D.SITE &   D.TITLE = D.SITE 

  D.LON = -64.833333  & D.LAT = 32.25
  CSV=STRUCT_CONCAT(CSV,D)
  ;||||||||||||||||||||||||||||  ;
  ;
  ;
;===> ADD GEORGES BANK SOUTHERN FLANK
  D=STRUCT_2MISSINGS(CSV[0])
  D.INFILE = '' & D.MAP = SMI_MAP & D.PX = SMI_PX & D.PY = SMI_PY &   D.PROD = 'CHLOR_A'
  
  D.SITE = 'GB_S_FLANK'& D.EQUATION = D.SITE &   D.TITLE = D.SITE 
 
  D.PROD = 'CHLOR_A'
  D.LON = -66.25  & D.LAT = 41.25
  CSV=STRUCT_CONCAT(CSV,D)
  ;||||||||||||||||||||||||||||  
  
  ;===> ADD GEORGES BANK SOUTHERN FLANK_2
  D=STRUCT_2MISSINGS(CSV[0])
  D.INFILE = '' & D.MAP = SMI_MAP & D.PX = SMI_PX & D.PY = SMI_PY &   D.PROD = 'CHLOR_A'
  
  D.SITE = 'GB_S_FLANK_2'& D.EQUATION = D.SITE &   D.TITLE = D.SITE 
  
  D.PROD = 'CHLOR_A'
  D.XPAINT = 1348  & D.YPAINT = 592
  CSV=STRUCT_CONCAT(CSV,D)
  ;||||||||||||||||||||||||||||  
  
  ;===> ADD GEORGES BANK TIDAL MIXING FRONT
  D=STRUCT_2MISSINGS(CSV[0])
  D.INFILE = '' & D.MAP = SMI_MAP & D.PX = SMI_PX & D.PY = SMI_PY &   D.PROD = 'CHLOR_A'
  
  D.SITE = 'GB_TMF'& D.EQUATION = D.SITE &   D.TITLE = D.SITE 
  
  D.PROD = 'CHLOR_A'
  D.XPAINT = 1355  & D.YPAINT = 586
  CSV=STRUCT_CONCAT(CSV,D)
  ;||||||||||||||||||||||||||||  
  
  ;===> ADD BAY_OF_FUNDY
  D=STRUCT_2MISSINGS(CSV[0])
  D.INFILE = '' & D.MAP = SMI_MAP & D.PX = SMI_PX & D.PY = SMI_PY &   D.PROD = 'CHLOR_A'
  
  D.SITE = 'BAY_OF_FUNDY'& D.EQUATION = D.SITE &   D.TITLE = D.SITE 
  
  D.PROD = 'CHLOR_A'
  D.XPAINT = 1369  & D.YPAINT = 540
  CSV=STRUCT_CONCAT(CSV,D)
  ;||||||||||||||||||||||||||||  
  
  
   ;===> ADD NEWFOUND_LABRADOR_SHELF
  D=STRUCT_2MISSINGS(CSV[0])
  D.INFILE = '' & D.MAP = SMI_MAP & D.PX = SMI_PX & D.PY = SMI_PY &   D.PROD = 'CHLOR_A'
  
  D.SITE = 'NEWFOUND_LABRADOR_SHELF'& D.EQUATION = D.SITE &   D.TITLE = D.SITE 
  
  D.PROD = 'CHLOR_A'
  D.XPAINT = 1427  & D.YPAINT = 498
  CSV=STRUCT_CONCAT(CSV,D)
  ;|||||||||||||||||||||||||||| 
  
  
   
   ;===> ADD BARENTS_SEA_5CPY
  D=STRUCT_2MISSINGS(CSV[0])
  D.INFILE = '' & D.MAP = SMI_MAP & D.PX = SMI_PX & D.PY = SMI_PY &   D.PROD = 'CHLOR_A'
  
  D.SITE = 'BARENTS_SEA_5CPY'& D.EQUATION = D.SITE &   D.TITLE = D.SITE 
    
  D.PROD = 'CHLOR_A'
  D.XPAINT = 2521  & D.YPAINT = 187
  CSV=STRUCT_CONCAT(CSV,D)
  ;|||||||||||||||||||||||||||| 
  
  ;===> ADD BARENTS_SEA_4CPY
  D=STRUCT_2MISSINGS(CSV[0])
  D.INFILE = '' & D.MAP = SMI_MAP & D.PX = SMI_PX & D.PY = SMI_PY &   D.PROD = 'CHLOR_A'
  
  D.SITE = 'BARENTS_SEA_4CPY' & D.EQUATION = D.SITE &   D.TITLE = D.SITE 
 
  D.PROD = 'CHLOR_A'
  D.XPAINT = 2576  & D.YPAINT = 212
  CSV=STRUCT_CONCAT(CSV,D)
  ;|||||||||||||||||||||||||||| 
  ;
  ;===> ADD BARENTS_SEA_3CPY
  D=STRUCT_2MISSINGS(CSV[0])
  D.INFILE = '' & D.MAP = SMI_MAP & D.PX = SMI_PX & D.PY = SMI_PY &   D.PROD = 'CHLOR_A'
  
  D.SITE = 'BARENTS_SEA_3CPY' & D.EQUATION = D.SITE &   D.TITLE = D.SITE 
 
  D.PROD = 'CHLOR_A'
  D.XPAINT = 2661  & D.YPAINT = 195
  CSV=STRUCT_CONCAT(CSV,D)
  ;|||||||||||||||||||||||||||| 
  ;
  ;
   ;===> ADD GULF_OF_MEXICO_2CPY
  D=STRUCT_2MISSINGS(CSV[0])
  D.INFILE = '' & D.MAP = SMI_MAP & D.PX = SMI_PX & D.PY = SMI_PY &   D.PROD = 'CHLOR_A'
  
  D.SITE = 'GULF_OF_MEXICO_2CPY'  & D.EQUATION = D.SITE &   D.TITLE = D.SITE 
  
  D.PROD = 'CHLOR_A'
  D.XPAINT = 1115  & D.YPAINT = 734
  CSV=STRUCT_CONCAT(CSV,D)
  ;||||||||||||||||||||||||||||
  ; 
   ;===> ADD GULF_OF_MEXICO_0#5CPY
  D=STRUCT_2MISSINGS(CSV[0])
  D.INFILE = '' & D.MAP = SMI_MAP & D.PX = SMI_PX & D.PY = SMI_PY &   D.PROD = 'CHLOR_A'
  
  D.SITE = 'GULF_OF_MEXICO_0#5CPY'  & D.EQUATION = D.SITE &   D.TITLE = D.SITE 
  
  D.PROD = 'CHLOR_A'
  D.XPAINT = 1149  & D.YPAINT = 725
  CSV=STRUCT_CONCAT(CSV,D)
  ;|||||||||||||||||||||||||||| 
  
   ;===> ADD GULF_OF_MEXICO_0#1CPY
  D=STRUCT_2MISSINGS(CSV[0])
  D.INFILE = '' & D.MAP = SMI_MAP & D.PX = SMI_PX & D.PY = SMI_PY &   D.PROD = 'CHLOR_A'
  
  D.SITE = 'GULF_OF_MEXICO_0#1CPY'& D.EQUATION = D.SITE &   D.TITLE = D.SITE 
  
  D.PROD = 'CHLOR_A'
  D.XPAINT = 1150  & D.YPAINT = 721
  CSV=STRUCT_CONCAT(CSV,D)
  ;|||||||||||||||||||||||||||| 
  ;
   ;===> ADD ARABIAN_SEA_2CPY
  D=STRUCT_2MISSINGS(CSV[0])
  D.INFILE = '' & D.MAP = SMI_MAP & D.PX = SMI_PX & D.PY = SMI_PY &   D.PROD = 'CHLOR_A'
  
  D.SITE = 'ARABIAN_SEA_2CPY' & D.EQUATION = D.SITE &   D.TITLE = D.SITE 
  D.PROD = 'CHLOR_A'
  D.XPAINT = 2942  & D.YPAINT = 841
  CSV=STRUCT_CONCAT(CSV,D)
  ;|||||||||||||||||||||||||||| 
  
  
   ;===> ADD ARABIAN_SEA_3CPY
  D=STRUCT_2MISSINGS(CSV[0])
  D.INFILE = '' & D.MAP = SMI_MAP & D.PX = SMI_PX & D.PY = SMI_PY &   D.PROD = 'CHLOR_A'
  
  D.SITE = 'ARABIAN_SEA_3CPY' & D.EQUATION = D.SITE &   D.TITLE = D.SITE 
  D.PROD = 'CHLOR_A'
  D.XPAINT = 2864  & D.YPAINT = 847
  CSV=STRUCT_CONCAT(CSV,D)
  ;|||||||||||||||||||||||||||| 
  
  ;===> ADD SOUTHERN_OCEAN_2CPY
  D=STRUCT_2MISSINGS(CSV[0])
  D.INFILE = '' & D.MAP = SMI_MAP & D.PX = SMI_PX & D.PY = SMI_PY &   D.PROD = 'CHLOR_A'
  
  D.SITE = 'SOUTHERN_OCEAN_2CPY' & D.EQUATION = D.SITE &   D.TITLE = D.SITE 
  D.PROD = 'CHLOR_A'
  D.XPAINT = 676  & D.YPAINT = 1757
  CSV=STRUCT_CONCAT(CSV,D)
  ;|||||||||||||||||||||||||||| 
  
  ;******************************  
  ;===> ADD GULF OF MAINE CENTRAL
  ;******************************
  D=STRUCT_2MISSINGS(CSV[0])
  D.SITE = 'GOM_CEN' & D.TITLE = D.SITE & D.INFILE = '' & D.MAP = SMI_MAP & D.PX = SMI_PX & D.PY = SMI_PY &   D.PROD = 'CHLOR_A'
  D.LON = -68.666667  & D.LAT = 42.5
  CSV=STRUCT_CONCAT(CSV,D)
  ;|||||||||||||||||||||||
  
  ;******************************
  ;===> ADD BROWNS_BANK
  ;******************************
  D=STRUCT_2MISSINGS(CSV[0])
  D.SITE = 'BROWNS_BANK' & D.TITLE = D.SITE  & D.INFILE = '' & D.MAP = SMI_MAP & D.PX = SMI_PX & D.PY = SMI_PY &   D.PROD = 'CHLOR_A'
  D.LON = -65.916667  & D.LAT =  43  
  CSV=STRUCT_CONCAT(CSV,D) 
  ;||||||||||||||||||||||

;******************************
;===> ADD EASTER ISLAND
;******************************
;WIKEPEDIA: EASTER ISLAND IS LOCATED AT 27°8′ S AND 190°25′ W, ABOUT 4,200 KILOMETERS OFF THE COAST OF CHILE AND 1,760 KILOMETERS EAST OF PITCAIRN ISLAND,
D=STRUCT_2MISSINGS(CSV[0])
D.SITE = 'EASTER_ISLAND'
D.PROD = 'CHLOR_A'
D.INFILE = '' & D.MAP = MAP & D.PX = SMI_PX & D.PY = SMI_PY
D.TITLE = 'EASTER_ISLAND'
;D.LON =  -190.41667
D.LON =  190.41667
D.LAT = -27.133333
CSV=STRUCT_CONCAT(CSV,D)

;******************************
;===> ADD SITES FROM OLD LOCATE.PRO
;******************************
 ; 'NEW YORK' :        BEGIN & LON=  -74.00    &LAT= 40.00+45./60  & LABEL='NY'& END
D=STRUCT_2MISSINGS(CSV[0])
D.SITE = 'NEW YORK' & D.TITLE = D.SITE
D.PROD = ''
D.LON =  -74.00
D.LAT = 40.00+45./60
CSV=STRUCT_CONCAT(CSV,D)
;|||||||||||||||||||||||

;'SANDY HOOK':       BEGIN & LON=  -74.00    & LAT=40.00+25./60  & LABEL='Sandy Hook'& END ;SANDY HOOK, NJ, PAR QUANTUM SENSOR AT SANDY HOOK MARINE LAB
D=STRUCT_2MISSINGS(CSV[0])
D.SITE = 'SANDY HOOK' & D.TITLE = D.SITE
D.PROD = ''
D.LON =  -74.00
D.LAT = 40.00+25./60
CSV=STRUCT_CONCAT(CSV,D)
;||||||||||||||||||||||

;'MOBY'      :      BEGIN & LON=  -1*(157.0 + 11.4/60.0) & LAT= 20.0+49.7/60 &LABEL='Moby' & END; MOBY, MARINE OPTICAL BUOY, LANAI, HAWAII
D=STRUCT_2MISSINGS(CSV[0])
D.SITE = 'MOBY' & D.TITLE = D.SITE
D.PROD = ''
D.LON =  -1*(157.0 + 11.4/60.0)
D.LAT = 20.0+49.7/60
CSV=STRUCT_CONCAT(CSV,D)
;|||||||||||||||||||||||

;  'WICKFORD'  :       BEGIN & LON=  -71.4461  & LAT= 41.5744      & LABEL='Wickford' &END ; Wickford, RI
D=STRUCT_2MISSINGS(CSV[0])
D.SITE = 'WICKFORD' & D.TITLE = D.SITE
D.PROD = ''
D.LON = -71.4461
D.LAT = 41.5744
CSV=STRUCT_CONCAT(CSV,D)
;||||||||||||||||||||||

;    'BBOP'      :      BEGIN & LON=  -64.14    & LAT= 31.703       & LABEL='BBOP'& END ; BBOP bats bermuda
D=STRUCT_2MISSINGS(CSV[0])
D.SITE = 'BBOP' & D.TITLE = D.SITE
D.PROD = 'CHLOR_A'
 D.LON =  -64.14 
 D.LAT = 31.703
CSV=STRUCT_CONCAT(CSV,D)
;|||||||||||||||||||||||

;      'BATS'      :       BEGIN & LON= -64.10     & LAT= 31.6667      & LABEL='BATS' & END ; 
D=STRUCT_2MISSINGS(CSV[0])
D.SITE = 'BATS' & D.TITLE = D.SITE
D.PROD = ''
 D.LON =  -64.10 
 D.LAT = 31.6667
CSV=STRUCT_CONCAT(CSV,D)
;|||||||||||||||||||||||

;   'BIOWATT'      :    BEGIN & LON= -70.00     & LAT= 35.0         & LABEL='BIOWATT' & END ;BIOWATT STATION 19 AT 35”N, 7O”W. 
D=STRUCT_2MISSINGS(CSV[0])
D.SITE = 'BIOWATT' & D.TITLE = D.SITE
D.PROD = ''
 D.LON =  -70.00 
 D.LAT =  35.0
CSV=STRUCT_CONCAT(CSV,D)
;|||||||||||||||||||||||

;    'HOTS2'     :       BEGIN & LON = -158.0    & LAT= 22.75        & LABEL='HOTS2' & END 
D=STRUCT_2MISSINGS(CSV[0])
D.SITE = 'HOTS2' & D.TITLE = D.SITE
D.PROD = ''
 D.LON =  -158.0 
 D.LAT =  22.75
CSV=STRUCT_CONCAT(CSV,D)
;|||||||||||||||||||||||

;     'HEILIGENDAMM' :    BEGIN & LON= -11.84333  & LAT= 54.1425      & LABEL='HEILIGENDAMM' & END ;der Seebr�cke Heiligendamm (54�08,55' N; 11�50,60' E) durchgef�hrt
D=STRUCT_2MISSINGS(CSV[0])
D.SITE = 'HEILIGENDAMM' & D.TITLE = D.SITE
D.PROD = ''
 D.LON = -11.84333 
 D.LAT = 54.1425
CSV=STRUCT_CONCAT(CSV,D)
;|||||||||||||||||||||||

;   'CHES BAY LIGHT' :  BEGIN & LON=  -75.71    & LAT= 36.91        & LABEL='CBL'& END ; Ches Bay Light
D=STRUCT_2MISSINGS(CSV[0])
D.SITE = 'CHES BAY LIGHT' & D.TITLE = D.SITE
D.PROD = ''
 D.LON = -75.71 
 D.LAT = 36.91
CSV=STRUCT_CONCAT(CSV,D)
;||||||||||||||||||||||

;     'AMBROSE LIGHT':    BEGIN & LON=  -73.832    & LAT= 40.458        & LABEL='Ambrose Light' & END ; 40 27.50 N,73 49.90 W. Coast Guard
D=STRUCT_2MISSINGS(CSV[0])
D.SITE = 'AMBROSE LIGHT' & D.TITLE = D.SITE
D.PROD = ''
 D.LON = -73.832 
 D.LAT = 40.458
CSV=STRUCT_CONCAT(CSV,D)
;|||||||||||||||||||||||

;  'BOOTH BAY HARBOR' :BEGIN & LON=  -69.67      & LAT= 43.75        & LABEL='BBH'& END ; Booth Bay Harbor
D=STRUCT_2MISSINGS(CSV[0])
D.SITE = 'BOOTH BAY HARBOR' & D.TITLE = D.SITE
D.PROD = 'CHLOR_A'
 D.LON = -69.67 
 D.LAT = 43.75
CSV=STRUCT_CONCAT(CSV,D)
;|||||||||||||||||||||||

;   'MED_SEA_LEE'      : BEGIN & LON= 7.66667   & LAT = 43.3333     & LABEL='Med. C.Lee' & END
D=STRUCT_2MISSINGS(CSV[0])
D.SITE = 'MED_SEA_LEE' & D.TITLE = D.SITE
D.PROD = ''
 D.LON = 7.66667 
 D.LAT = 43.3333
CSV=STRUCT_CONCAT(CSV,D)
;||||||||||||||||||||||

; 'WHOI CLARK'      : BEGIN & LON= -70.65   & LAT = 41.53         & LABEL='WHOI CLARK BLDG' & END
D=STRUCT_2MISSINGS(CSV[0])
D.SITE = 'WHOI CLARK' & D.TITLE = D.SITE
D.PROD = ''
 D.LON = -70.65 
 D.LAT = 41.53
CSV=STRUCT_CONCAT(CSV,D)
;|||||||||||||||||||||||

; 'CAPE HATTERAS SBF'   : BEGIN & LON= -75.00   & LAT = 35.25         & LABEL='CHat' & END
D=STRUCT_2MISSINGS(CSV[0])
D.SITE = 'CAPE HATTERAS SBF' & D.TITLE = D.SITE
D.PROD = 'CHLOR_A'
 D.LON = -75.00 
 D.LAT = 35.25
CSV=STRUCT_CONCAT(CSV,D)
;|||||||||||||||||||||||


;   'HUDSON CANYON'   : BEGIN     & LON= -72.25   & LAT = 39.20         & LABEL='HCan' & END
D=STRUCT_2MISSINGS(CSV[0])
D.SITE = 'HUDSON CANYON' & D.TITLE = D.SITE
D.PROD = ''
 D.LON = -72.25 
 D.LAT = 39.20
CSV=STRUCT_CONCAT(CSV,D)
;|||||||||||||||||||||||

;   'DEER ISLAND':      BEGIN & LON=  -70.9646    & LAT=42.3511   & LABEL='Deer Island'& END ; DEER ISLAND MWRA, PAR QUANTUM SENSOR
D=STRUCT_2MISSINGS(CSV[0])
D.SITE = 'DEER ISLAND' & D.TITLE = D.SITE
D.PROD = ''
 D.LON = -70.9646 
 D.LAT = 42.3511
CSV=STRUCT_CONCAT(CSV,D)
;|||||||||||||||||||||||

;    'LBT_1': BEGIN & LON= -73.973333 & LAT = 40.303333 & LABEL=ANAME   & END ; AT PIER
D=STRUCT_2MISSINGS(CSV[0])
D.SITE = 'LBT_1' & D.TITLE = D.SITE
D.PROD = ''
 D.LON = -73.973333 
 D.LAT = 40.303333
CSV=STRUCT_CONCAT(CSV,D)
;|||||||||||||||||||||||

;  'LBT_2': BEGIN & LON= -73.973333 & LAT = 40.303333 & LABEL=ANAME   & END
D=STRUCT_2MISSINGS(CSV[0])
D.SITE = 'LBT_2' & D.TITLE = D.SITE
D.PROD = ''
 D.LON = -73.973333 
 D.LAT = 40.303333
CSV=STRUCT_CONCAT(CSV,D)
;|||||||||||||||||||||||

;   'LBT_3': BEGIN & LON= -73.950000 & LAT = 40.303333 & LABEL=ANAME  & END
D=STRUCT_2MISSINGS(CSV[0])
D.SITE = 'LBT_3' & D.TITLE = D.SITE
D.PROD = ''
D.LON = -73.950000 
D.LAT = 40.303333
CSV=STRUCT_CONCAT(CSV,D)
;|||||||||||||||||||||||

;   'LBT_4': BEGIN & LON= -73.925000 & LAT = 40.303333 & LABEL=ANAME  & END
D=STRUCT_2MISSINGS(CSV[0])
D.SITE = 'LBT_4' & D.TITLE = D.SITE
D.PROD = ''
D.LON = -73.925000 
D.LAT = 40.303333
CSV=STRUCT_CONCAT(CSV,D)
;||||||||||||||||||||||

;   'LBT_5': BEGIN & LON= -73.890000 & LAT = 40.303333 & LABEL=ANAME  & END
D=STRUCT_2MISSINGS(CSV[0])
D.SITE = 'LBT_5' & D.TITLE = D.SITE
D.PROD = ''
D.LON = -73.890000 
D.LAT = 40.303333
CSV=STRUCT_CONCAT(CSV,D)
;|||||||||||||||||||||||

;  'LBT_6': BEGIN & LON= -73.836667 & LAT = 40.303333 & LABEL=ANAME   & END
D=STRUCT_2MISSINGS(CSV[0])
D.SITE = 'LBT_6' & D.TITLE = D.SITE
D.PROD = ''
D.LON = -73.836667 
D.LAT = 40.303333
CSV=STRUCT_CONCAT(CSV,D)
;|||||||||||||||||||||||

;   'LBT_7': BEGIN & LON= -73.791667 & LAT = 40.303333 & LABEL=ANAME  & END
D=STRUCT_2MISSINGS(CSV[0])
D.SITE = 'LBT_7' & D.TITLE = D.SITE
D.PROD = ''
D.LON = -73.791667 
D.LAT = 40.303333
CSV=STRUCT_CONCAT(CSV,D)
;|||||||||||||||||||||||

; MASS BAY OUTFALL RISER LOCATIONS (MIKE MICKELSON, MWRA, DEC 27,2000)
;  'R01': BEGIN & LON= -70.780090d & LAT = 42.388683d  & LABEL=ANAME & END
D=STRUCT_2MISSINGS(CSV[0])
D.SITE = 'R01' & D.TITLE = D.SITE
D.PROD = ''
 D.LON = -70.780090d 
 D.LAT = 42.388683d
 CSV=STRUCT_CONCAT(CSV,D)
 ;|||||||||||||||||||||||
 
 
  PFILE,CSVFILE  &  STRUCT_2CSV,CSVFILE,CSV 
  ,'DO_LONLATS_SITES'
ENDIF;IF DO_LONLATS_SITES GE 1 THEN BEGIN
;|||||||||||||||||||||||||||||||||||||||||||||



;**********************************
IF DO_EDIT_CSV GE 1 THEN BEGIN
;**********************************
  ,'DO_EDIT_CSV'
  IF DO_EDIT_CSV EQ 3 THEN STOP
  CSV=CSV_READ(CSVFILE) & PFILE,CSVFILE,/R  
  ;===> STANDARDIZE MAP,PX,PY
  CSV.MAP = SMI_MAP & CSV.PX = SMI_PX & CSV.PY = SMI_PY
  
  ;===> REMOVE MEAN
  OK=WHERE(CSV.SITE EQ'CHLOR_A_MEAN',COUNT)
  IF COUNT EQ 1 THEN BEGIN
    PRINT,'REMOVING '+'CHLOR_A_MEAN'
    PRINT,'REMOVING '+'CHLOR_A_MEAN'
    PRINT,'REMOVING '+'CHLOR_A_MEAN'
    CSV=REMOVE(CSV,OK)
    WAIT,1
  ENDIF;IF COUNT EQ 1 THEN BEGIN

;===> XP,YP COORDS D.XP
;FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
FOR NTH = 0,N_ELEMENTS(CSV)-1 DO BEGIN
   LON = CSV[NTH].LON & LAT = CSV[NTH].LAT
   PXY=MAP_LONLAT_2XYP(  SMI_MAP, PX=SMI_PX,PY=SMI_PY,LON=LON, LAT=LAT)
   CSV[NTH].XP =REFORM(PXY(0,*))
   CSV[NTH].YP =REFORM(PXY(1,*))
ENDFOR;FOR NTH = 0,N_ELEMENTS(OK)-1 DO BEGIN
;FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
;STOP

OK = WHERE(CSV.XPAINT NE '',COUNT)
DB= CSV[OK]
;FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
FOR NTH = 0,N_ELEMENTS(DB)-1 DO BEGIN
  D = DB[NTH]
  LL=MAP_XYP_2LONLAT('SMI', PX=SMI_PX,PY=SMI_PY,XP=D.XPAINT, YP=D.YPAINT,/PAINT) & D.LON =LL.LON & D.LAT =LL.LAT  
  D.XP = D.XPAINT
  D.YP = SMI_PY-D.YPAINT
  DB[NTH] = D 
  ENDFOR;FOR NTH = 0,N_ELEMENTS(DB)-1 DO BEGIN
  CSV[OK] = DB
  ;FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF

;
;######################   
  ;===> LME CODES & NAMES  [ NOT WORKING YET]
  GOTO,SKIP_LME_NAMES
  LME_PNGFILE      =FILE_SEARCH(GET_PATH() + 'IDL\LME\LME-AREAS-SMI.PNG') & PFILE,LME_PNGFILE,/X  & LME = READ_PNG(LME_PNGFILE,R,G,B) & HELP,LME
  LME_CODES = FIX(LME(CSV.XP, CSV.YP))
  ;FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
  FOR NTH = 0,N_ELEMENTS(CSV) -1 DO BEGIN
    C = CSV[NTH]
    CODE = LME(C.XP,C.YP)
    IF CODE NE 255 THEN BEGIN
      OK_CODE = WHERE(DB.CODE EQ CODE,COUNT_CODE)
      IF COUNT_CODE EQ 1 THEN BEGIN
        C.LME_NAME = DB(OK_CODE).NAME
        C.LME_CODE = DB(OK_CODE).CODE
      ENDIF;IF COUNT_CODE EQ 1 THEN BEGIN
    ENDIF;IF CODE NE 255 THEN BEGIN
    CSV[NTH] = C  
  ENDFOR;FOR NTH = 0,N_ELEMENTS(CSV) -1 DO BEGIN
  ;FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
;  OK = WHERE_IN(FIX(DB.CODE) , FIX(LME_CODES),COUNT) 
  OK = WHERE_MATCH(FIX(DB.CODE) , FIX(LME_CODES),COUNT) 
  IF COUNT GE 1 THEN BEGIN 
    CSV[OK].LME_CODE =LME_CODES[OK] 
    CSV[OK].LME_NAME=DB[OK].NAME  
  ENDIF;IF COUNT EQ 1 THEN BEGIN
   ;===> MAKE TITLE LME_NAME
  OK = WHERE(CSV.LME_NAME NE '',COUNT) & IF COUNT GE 1 THEN CSV[OK].TITLE = CSV[OK].LME_NAME
  
  
;######################   
  
  
SKIP_LME_NAMES:  
  OK = WHERE(CSV.TITLE EQ '',COUNT)
  IF COUNT GE 1 THEN CSV[OK].TITLE = CSV[OK].SITE
;
  CSV.TITLE=REPLACE(CSV.TITLE,'_',' ')
  CSV.TITLE=REPLACE(CSV.TITLE,'-',' ')


  CSV.TITLE=STR_CAP(CSV.TITLE,/ALL)
  
  PLIST,CSV.TITLE
  DO_EDIT_LOCATE_TITLES             = 2; ALWAYS OVERWRITE SO TITLES ARE UP TO DATE
  
  
  
  
  PFILE,CSVFILE
STRUCT_2CSV,CSVFILE,CSV 
,'DO_EDIT_CSV'
ENDIF;IF DO_EDIT_CSV GE 1 THEN BEGIN
;|||||||||||||||||||||||||||||||||||||


;**********************************
IF DO_PLOT_CSV GE 1 THEN BEGIN
;**********************************
,'DO_PLOT_CSV'
  IF DO_PLOT_CSV EQ 3 THEN STOP


LME_PNGFILE      =FILE_SEARCH(GET_PATH() + 'IDL\LME\LME-AREAS-SMI.PNG') & PFILE,LME_PNGFILE,/X  & LME = READ_PNG(LME_PNGFILE,R,G,B) & HELP,LME
DAN_PEAK_PNGFILE =FILE_SEARCH(DIR.LNP_PNG,'!STUDY-OCTS_SEAWIFS_TERRA_AQUA_MERIS-SMI-2010_12-9KM-CHLOR_A-LNP_DAN_PEAK.PNG') & PFILE,DAN_PEAK_PNGFILE,/X
JMAX_CPY_PNGFILE =FILE_SEARCH(DIR.LNP_PNG,'!STUDY-OCTS_SEAWIFS_TERRA_AQUA_MERIS-SMI-2010_12-9KM-CHLOR_A-LNP_JMAX_CPY.PNG') & PFILE,JMAX_CPY_PNGFILE,/X
CHL_MEAN_PNGFILE =FILE_SEARCH(GET_PATH() + 'IDL\IMAGES\!MONTH_12-OCTS_SEAWIFS_TERRA_AQUA_MERIS-SMI-PXY_4320_2160-2010_12-CHLOR_A-MEAN.PNG') & PFILE,CHL_MEAN_PNGFILE,/X


CSV=CSV_READ(CSVFILE) & PFILE,CSVFILE,/R  
DIR_OUT=GET_PATH() + 'IDL\PLOTS\'
PX=4320
PY=2160
ZWIN,[SMI_PX,SMI_PY]
SETCOLOR,255
PAL_36,R,G,B
MAP_GEQ
MAP_CONTINENTS,/HIRES,/COASTS,COLOR = 0


;FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
FOR _SITE = 0,N_ELEMENTS(CSV)-1 DO BEGIN
  D=CSV(_SITE)
  IF D.VALUE NE '' THEN BEGIN
    SITE=D.SITE 
;;;    IF D.LME_NAME NE '' THEN SITE = D.LME_NAME
    SYMSIZE=3
    THICK = 3
  ENDIF ELSE BEGIN
    SITE = D.SITE 
    SYMSIZE=1
    THICK = 1
  ENDELSE;IF D.VALUE NE '' THEN BEGIN
  PRINT
  PRINT,D
  LON=D.LON
  LAT=D.LAT
  IF SITE EQ 'SMI_UPPER_RIGHT' OR LON GE 150 THEN ALIGN = 1.3 ELSE ALIGN = -0.1
  XYOUTS2,LON,LAT,SITE,ALIGN = ALIGN,CHARSIZE=3.0,COLOR = 21,CHARTHICK=1,/DATA
  ;IF SITE EQ 'LNP_DAN_PEAK' THEN STOP
  SITE=REPLACE(SITE,'_',' ')
  PLOTS,LON,LAT,PSYM=1,SYMSIZE=SYMSIZE,COLOR=21,THICK=THICK
ENDFOR;FOR _SITE = 0,N_ELEMENTS(SITES)-1 DO BEGIN
;FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
IM=TVRD() & PNG = IM
OK=WHERE(IM EQ 21,COUNT) & PNG[OK]= 0
PNGFILE = DIR_OUT+ROUTINE_NAME +'-CSV-SITES.PNG'
WRITE_PNG,PNGFILE,PNG,R,G,B
PFILE,PNGFILE

PNG = READ_PNG(DAN_PEAK_PNGFILE,R,G,B) & PNG[OK]= 0
PNGFILE = DIR_OUT+ROUTINE_NAME +'-LNP_DAN_PEAK-SITES.PNG'
WRITE_PNG,PNGFILE,PNG,R,G,B & PFILE,PNGFILE


PNG = READ_PNG(CHL_MEAN_PNGFILE,R,G,B) & PNG[OK]= 0
PNGFILE = DIR_OUT+ROUTINE_NAME +'-CHL_MEAN-SITES.PNG'
WRITE_PNG,PNGFILE,PNG,R,G,B & PFILE,PNGFILE


PNG = READ_PNG(JMAX_CPY_PNGFILE,R,G,B) & PNG[OK]= 0
PNGFILE = DIR_OUT+ROUTINE_NAME +'-LNP_JMAX-SITES.PNG'
WRITE_PNG,PNGFILE,PNG,R,G,B & PFILE,PNGFILE


,'DO_PLOT_CSV'
ENDIF;IF DO_PLOT_CSV GE 1 THEN BEGIN
;|||||||||||||||||||||||||||||||||||||

DONE:


	END; #####################  END OF ROUTINE ################################
