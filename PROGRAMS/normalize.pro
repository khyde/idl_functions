; $ID:	NORMALIZE.PRO,	2020-06-30-17,	USER-KJWH	$
;########################################################################
FUNCTION NORMALIZE, ARRAY, TOTAL_UNITY=TOTAL_1, MAX_UNITY=MAX_1

;+
; NAME:
; NORMALIZE
; PURPOSE:
; SCALE THE INPUT ARRAY SO THAT MEAN_VALUE=1 (DEFAULT ACTION),
; OR OPTIONALLY, SO TOTAL=1, OR EITHER MAX=1.
; CALLING:
; AM1 = NORMALIZE( ARRAY )
; INPUTS:
; ARRAY = DATA TO BE NORMALIZED
; KEYWORDS:
; /TOTAL : JUST DIVIDE BY TOTAL( ARRAY ) SO THAT TOTAL OF RESULT =1.
; /MAX : JUST DIVIDE BY MAX( ARRAY ) SO THAT MAXIMUM OF RESULT =1.
;   DEFAULT IS TO ALSO DIVIDE BY # ELEMENTS SO MEAN VALUE =1.
; HISTORY:
; WRITTEN, FRANK VAROSI NASA/GSFC 1992.
; ;#############################################################################
;-
;************************
ROUTINE_NAME= 'NORMALIZE'
;************************


  SA = SIZE( ARRAY )
  NA = SA(SA[0]+2)
  
  IF (NA LE 1) THEN BEGIN
    MESSAGE,"EXPECTING AN ARRAY",/INFO
    RETURN,ARRAY
  ENDIF
  
  IF KEYWORD_SET( TOTAL_1 ) THEN RETURN, ARRAY/TOTAL( ARRAY ) $
  ELSE IF KEYWORD_SET( MAX_1 ) THEN RETURN, ARRAY/MAX( ARRAY ) $
  ELSE RETURN, ARRAY/( TOTAL( ARRAY )/NA )
END
