; $ID:	MAKE_EC_LNP_SUBAREAS.PRO,	2014-12-18	$
PRO MAKE_EC_LNP_SUBAREAS
     DIR='D:\IDL\IMAGES\'
   DIR='e:\oc-sea_aqu-lac-ec\'
     LNPFILE = DIR +'ANNUAL-SEA_AQU-LAC-EC-CHLOR_A-PSERIES_4318-LNP-MAX_YP.PNG'
     TRIMFILE = DIR +'MASK_SUBAREA-EC-PXY_1024_1024-LNP-TRIM.PNG'

     TEMPFILE = DIR + 'MASK_SUBAREA-EC-PXY_1024_1024-LNP-TEMP.CSV'
     BOXFILE =  DIR + 'MASK_SUBAREA-EC-PXY_1024_1024-LNP-BOXES.PNG'
     MASKFILE = DIR + 'MASK_SUBAREA-EC-PXY_1024_1024-LNP.PNG'

   CSVFILE = DIR+'MASK_SUBAREA-EC-PXY_1024_1024-LNP.CSV'

 SAVEFILE = DIR +'MASK_SUBAREA-EC-PXY_1024_1024-LNP.SAVE'


stop

ROUTINE_NAME= 'MAKE_EC_LNP_SUBAREAS'
;  FOR  ST  HELP  READ  COPY TVALL   CSV  SLIDEW  DRAW STOP  LNP  CUT   FOR  ZWIN  TVRD  PLOT  PNG   PLOTTING  MASK  BEGIN
;  >>>>>>>>>>>>>>>>>>>>>>>>   SWITCHES  >>>>>>>>>>>>>>>>
;  TRIM THE UPPER 200 PIXELS FROM THE LNP IMAGE AND MAKE A PNG (TRIMFILE)
DO_MAKE_TRIM_LNP_PNG  = 0
; MAKE A CSV TEMPLATE FILE
  DO_MAKE_TEMPFILE  = 0
; OPEN TEMPFILE IN EXCEL  TO ADDSUBAREA NAMES, XP, AND YP COORDINATES FOR MIDDLE OF EACH SUBAREA SQUARE ,VIA TVALL
  DO_GET_XP_YP  = 0
; PLOT OPEN SQUARES (FROM THE CSVFILE) ON THE TRIMMED LNP IMAGE AND MAKE A PNG
    DO_LNP_SUBAREA_BOXES = 1

      DO_MASK_EC_LNP_MASK  = 1

;  NO MORE SWITCHES


;   $$$ ***************************************************************************************************
     IF DO_MAKE_TRIM_LNP_PNG GE 1 THEN BEGIN
    ;  TRIM THE UPPER 200 PIXELS FROM THE LNP IMAGE AND MAKE A PNG (TRIMFILE)

     LNP=READ_PNG(LNPFILE,R,G,B)
     PAL_SW3,R,G,B
     SLIDEW,LNP

;     >>>TRIM UPPER 200 PIXELS (LABEL) FROM LNP IMAGE
     LNP =LNP(*,0:1023)
             SLIDEW,LNP,TITLE='TRIM'

           WRITE_PNG,TRIMFILE,LNP,R,G,B
ENDIF ;     IF DO_MAKE_TRIM_LNP_PNG GE 1 THEN BEGIN

  IF DO_MAKE_TEMPFILE GE 1 THEN BEGIN
      TEMPLATE=CREATE_STRUCT('SUBAREA_CODE',0, 'SUBAREA_NAME',' ','NICKNAME',' ','XP',0,'YP',0,'WIDTH',0)

      STRUCT_2CSV,TEMPFILE, TEMPLATE
 ENDIF;  IF DO_MAKE_TEMPFILE GE 1 THEN BEGIN

;**********************************************
  IF DO_GET_XP_YP GE 1 THEN BEGIN
    TRIM = READ_PNG(TRIMFILE)

     CSV=READ_CSV( CSVFILE )


    TVALL, TRIM

ENDIF;  IF DO_GET_XP_YP GE 1 THEN BEGIN


; CSV=READ_CSV( CSVFILE )
;IMAGE=BYTARR(1024,1024)
;IMAGE(*,*)= 0
;ZWIN,IMAGE
;    PLOT,[0,1024],[0,1024],XSTYLE=5,YSTYLE=5,XMARGIN=[0.,0.],YMARGIN = [0.,0.],/NODATA,/DEVICE,/NOERASE
;    PLOTS,CSV.XP,CSV.YP,PSYM=6,SYMSIZE=1,THICK=2,COLOR= CSV.SUBAREA_CODE
;;        XYOUTS,CSV.XP,CSV.YP,CSV.SUBAREA_CODE,COLOR=0,CHARSIZE=2,CHARTHICK=2
;        MASK=TVRD()
;ZWIN



IF DO_LNP_SUBAREA_BOXES GE 1 THEN BEGIN
; PLOT OPEN SQUARES (FROM THE COMPLETED CSVFILE) ON THE TRIMMED LNP IMAGE AND MAKE A PNG

stop

  CSV=READ_CSV( CSVFILE )
  TRIM = READ_PNG(TRIMFILE)
  PAL_SW3
  ZWIN,TRIM
;   XSTYLE=5,YSTYLE=5,SUPPRESSES THE DRAWING OF X,Y AXES
    PLOT,[0,1024],[0,1024],XSTYLE=5,YSTYLE=5,XMARGIN=[0.,0.],YMARGIN = [0.,0.],/NODATA,/DEVICE,/NOERASE
  TV,TRIM
    PLOTS,CSV.XP,CSV.YP,PSYM=6,SYMSIZE=1,THICK=2,COLOR= 0
;        XYOUTS,CSV.XP,CSV.YP,CSV.SUBAREA_CODE,COLOR=0,CHARSIZE=2,CHARTHICK=2
        NEW=TVRD()
        ZWIN
SLIDEW,NEW,TITLE='SUBAREA BOXES'
PAL_SW3,R,G,B

  WRITE_PNG,BOXFILE,NEW,R,G,B
ENDIF;IF DO_LNP_SUBAREA_BOXES GE 1 THEN BEGIN


  IF DO_MASK_EC_LNP_MASK EQ 1 THEN BEGIN

;    >>> MAKING SUBAREA MASK

  CSV=READ_CSV( CSVFILE )
 IMAGE=BYTARR(1024,1024)
 IMAGE(*,*)= 0B; ALL BLACK
 XP=CSV.XP
 YP=CSV.YP
 COLOR=CSV.SUBAREA_CODE
 WIDTH=  10 ;WIDTH OF SUBAREA BOXES(PIXELS)
 MASK=DRAW_BOXES(IMAGE=IMAGE,WIDTH=WIDTH, COLOR=COLOR, XP=XP,YP=YP,ERROR = ERROR)
 PAL_36,R,G,B
 WRITE_PNG,MASKFILE,MASK,R,G,B


    WIDTH= 10

ENDIF; IF DO_MASK_EC_LNP_MASK EQ 1 THEN BEGIN


END;END OF ROUTINE
